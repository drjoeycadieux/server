/*! third party licenses: dist/vendor.LICENSE.txt */
import{c7 as A,bW as Qt,cb as Te,c0 as J,F as Jt,I as Ie,bS as z,b_ as pt,c2 as Ce,bY as xe,d8 as Xt,G as Zt,a$ as Se,a7 as Oe,ai as te,bv as Rt,aY as Et,bT as kt,b$ as lt,aW as Tt}from"./core-common.mjs";import{A as Le,r as Ae}from"./chunks/AppOrderSelector-CwX1_l01.mjs";import{R as De}from"./chunks/index-BHGcQw02.mjs";import{J as je,f as Me,l as Pe}from"./chunks/_overRest-BQssXRnF.mjs";import{_ as Re}from"./chunks/_baseEach-B1XNSXSY.mjs";import{a as Ee,h as Ue}from"./chunks/_baseIteratee-BO74Rk4T.mjs";import{d as Fe}from"./chunks/index-D61A_Z5g.mjs";import{a as Ne,b as qe}from"./chunks/_isIterateeCall-DqjdgTx_.mjs";import{e as Be}from"./chunks/_setToArray-DQD3_W3v.mjs";import{ac as Ve,aK as He,bi as ze,n as _t,bj as Ge}from"./chunks/icons-Dg_LJaFK.mjs";import{z as It}from"./chunks/_plugin-vue2_normalizer-VrK6B12S-B9aYHv6f.mjs";import"./chunks/index-7XKGWWeV.mjs";import"./chunks/sortable.esm-D5slCXxa.mjs";import"./chunks/preload-helper-BG02UnR2.mjs";import"./chunks/isSymbol-UhdPAdTg.mjs";var ct={},dt={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getColorIndex=e.getColorDiffStatus=e.hexDiff=e.rgbDiff=e.deltaE94=e.rgbToCIELab=e.xyzToCIELab=e.rgbToXyz=e.hslToRgb=e.rgbToHsl=e.rgbToHex=e.hexToRgb=e.defer=e.RSHIFT=e.SIGBITS=e.DELTAE94_DIFF_STATUS=void 0,e.DELTAE94_DIFF_STATUS={NA:0,PERFECT:1,CLOSE:2,GOOD:10,SIMILAR:50},e.SIGBITS=5,e.RSHIFT=8-e.SIGBITS;function n(){var u,c,f=new Promise(function(v,g){u=v,c=g});return{resolve:u,reject:c,promise:f}}e.defer=n;function r(u){var c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(u);return c===null?null:[c[1],c[2],c[3]].map(function(f){return parseInt(f,16)})}e.hexToRgb=r;function o(u,c,f){return"#"+((1<<24)+(u<<16)+(c<<8)+f).toString(16).slice(1,7)}e.rgbToHex=o;function a(u,c,f){u/=255,c/=255,f/=255;var v=Math.max(u,c,f),g=Math.min(u,c,f),_,T,I=(v+g)/2;if(v===g)_=T=0;else{var C=v-g;switch(T=I>.5?C/(2-v-g):C/(v+g),v){case u:_=(c-f)/C+(c<f?6:0);break;case c:_=(f-u)/C+2;break;case f:_=(u-c)/C+4;break}_/=6}return[_,T,I]}e.rgbToHsl=a;function i(u,c,f){var v,g,_;function T(j,S,O){return O<0&&(O+=1),O>1&&(O-=1),O<1/6?j+(S-j)*6*O:O<1/2?S:O<2/3?j+(S-j)*(2/3-O)*6:j}if(c===0)v=g=_=f;else{var I=f<.5?f*(1+c):f+c-f*c,C=2*f-I;v=T(C,I,u+1/3),g=T(C,I,u),_=T(C,I,u-1/3)}return[v*255,g*255,_*255]}e.hslToRgb=i;function s(u,c,f){u/=255,c/=255,f/=255,u=u>.04045?Math.pow((u+.005)/1.055,2.4):u/12.92,c=c>.04045?Math.pow((c+.005)/1.055,2.4):c/12.92,f=f>.04045?Math.pow((f+.005)/1.055,2.4):f/12.92,u*=100,c*=100,f*=100;var v=u*.4124+c*.3576+f*.1805,g=u*.2126+c*.7152+f*.0722,_=u*.0193+c*.1192+f*.9505;return[v,g,_]}e.rgbToXyz=s;function l(u,c,f){var v=95.047,g=100,_=108.883;u/=v,c/=g,f/=_,u=u>.008856?Math.pow(u,1/3):7.787*u+16/116,c=c>.008856?Math.pow(c,1/3):7.787*c+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116;var T=116*c-16,I=500*(u-c),C=200*(c-f);return[T,I,C]}e.xyzToCIELab=l;function d(u,c,f){var v=s(u,c,f),g=v[0],_=v[1],T=v[2];return l(g,_,T)}e.rgbToCIELab=d;function m(u,c){var f=1,v=1,g=1,_=u[0],T=u[1],I=u[2],C=c[0],j=c[1],S=c[2],O=_-C,P=T-j,$=I-S,W=Math.sqrt(T*T+I*I),V=Math.sqrt(j*j+S*S),R=C-_,U=V-W,L=Math.sqrt(O*O+P*P+$*$),K=Math.sqrt(L)>Math.sqrt(Math.abs(R))+Math.sqrt(Math.abs(U))?Math.sqrt(L*L-R*R-U*U):0,it=1+.045*W,st=1+.015*W;return R/=f,U/=v*it,K/=g*st,Math.sqrt(R*R+U*U+K*K)}e.deltaE94=m;function b(u,c){var f=d.apply(void 0,u),v=d.apply(void 0,c);return m(f,v)}e.rgbDiff=b;function w(u,c){var f=r(u),v=r(c);return b(f,v)}e.hexDiff=w;function h(u){return u<e.DELTAE94_DIFF_STATUS.NA?"N/A":u<=e.DELTAE94_DIFF_STATUS.PERFECT?"Perfect":u<=e.DELTAE94_DIFF_STATUS.CLOSE?"Close":u<=e.DELTAE94_DIFF_STATUS.GOOD?"Good":u<e.DELTAE94_DIFF_STATUS.SIMILAR?"Similar":"Wrong"}e.getColorDiffStatus=h;function p(u,c,f){return(u<<2*e.SIGBITS)+(c<<e.SIGBITS)+f}e.getColorIndex=p})(dt);var $e=Re;function We(e,n){var r=[];return $e(e,function(o,a,i){n(o,a,i)&&r.push(o)}),r}var Ke=We,Ye=je,Qe=Ke,Je=Ee,Xe=Me;function Ze(e,n){var r=Xe(e)?Ye:Qe;return r(e,Je(n))}var tr=Ze;Object.defineProperty(ct,"__esModule",{value:!0}),ct.Swatch=void 0;var Ut=dt,er=tr,rr=function(){function e(n,r){this._rgb=n,this._population=r}return e.applyFilter=function(n,r){return typeof r=="function"?er(n,function(o){var a=o.r,i=o.g,s=o.b;return r(a,i,s,255)}):n},Object.defineProperty(e.prototype,"r",{get:function(){return this._rgb[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this._rgb[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this._rgb[2]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rgb",{get:function(){return this._rgb},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hsl",{get:function(){if(!this._hsl){var n=this._rgb,r=n[0],o=n[1],a=n[2];this._hsl=Ut.rgbToHsl(r,o,a)}return this._hsl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hex",{get:function(){if(!this._hex){var n=this._rgb,r=n[0],o=n[1],a=n[2];this._hex=Ut.rgbToHex(r,o,a)}return this._hex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"population",{get:function(){return this._population},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return{rgb:this.rgb,population:this.population}},e.prototype.getRgb=function(){return this._rgb},e.prototype.getHsl=function(){return this.hsl},e.prototype.getPopulation=function(){return this._population},e.prototype.getHex=function(){return this.hex},e.prototype.getYiq=function(){if(!this._yiq){var n=this._rgb;this._yiq=(n[0]*299+n[1]*587+n[2]*114)/1e3}return this._yiq},Object.defineProperty(e.prototype,"titleTextColor",{get:function(){return this._titleTextColor||(this._titleTextColor=this.getYiq()<200?"#fff":"#000"),this._titleTextColor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bodyTextColor",{get:function(){return this._bodyTextColor||(this._bodyTextColor=this.getYiq()<150?"#fff":"#000"),this._bodyTextColor},enumerable:!1,configurable:!0}),e.prototype.getTitleTextColor=function(){return this.titleTextColor},e.prototype.getBodyTextColor=function(){return this.bodyTextColor},e}();ct.Swatch=rr;var mt={},bt={},Ft;function nr(){if(Ft)return bt;Ft=1;var e=A&&A.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(bt,"__esModule",{value:!0});var n=e(se()),r=Ue,o=function(){function a(i,s){s===void 0&&(s={}),this._src=i,this._opts=s,this._opts.filters=r(n.default.DefaultOpts.filters)}return a.prototype.maxColorCount=function(i){return this._opts.colorCount=i,this},a.prototype.maxDimension=function(i){return this._opts.maxDimension=i,this},a.prototype.addFilter=function(i){return this._opts.filters.push(i),this},a.prototype.removeFilter=function(i){var s=this._opts.filters.indexOf(i);return s>0&&this._opts.filters.splice(s),this},a.prototype.clearFilters=function(){return this._opts.filters=[],this},a.prototype.quality=function(i){return this._opts.quality=i,this},a.prototype.useImageClass=function(i){return this._opts.ImageClass=i,this},a.prototype.useGenerator=function(i){return this._opts.generator=i,this},a.prototype.useQuantizer=function(i){return this._opts.quantizer=i,this},a.prototype.build=function(){return new n.default(this._src,this._opts)},a.prototype.getPalette=function(i){return this.build().getPalette(i)},a.prototype.getSwatches=function(i){return this.build().getPalette(i)},a}();return bt.default=o,bt}var ee={},Ct={},jt={};Object.defineProperty(jt,"__esModule",{value:!0});var q=dt,or=function(){function e(n,r,o,a,i,s,l){this._volume=-1,this._count=-1,this.dimension={r1:n,r2:r,g1:o,g2:a,b1:i,b2:s},this.hist=l}return e.build=function(n,r){var o=1<<3*q.SIGBITS,a=new Uint32Array(o),i,s,l,d,m,b,w,h,p,u;i=l=m=0,s=d=b=Number.MAX_VALUE;for(var c=n.length/4,f=0;f<c;){var v=f*4;if(f++,w=n[v+0],h=n[v+1],p=n[v+2],u=n[v+3],u!==0){w=w>>q.RSHIFT,h=h>>q.RSHIFT,p=p>>q.RSHIFT;var g=q.getColorIndex(w,h,p);a[g]+=1,w>i&&(i=w),w<s&&(s=w),h>l&&(l=h),h<d&&(d=h),p>m&&(m=p),p<b&&(b=p)}}return new e(s,i,d,l,b,m,a)},e.prototype.invalidate=function(){this._volume=this._count=-1,this._avg=null},e.prototype.volume=function(){if(this._volume<0){var n=this.dimension,r=n.r1,o=n.r2,a=n.g1,i=n.g2,s=n.b1,l=n.b2;this._volume=(o-r+1)*(i-a+1)*(l-s+1)}return this._volume},e.prototype.count=function(){if(this._count<0){for(var n=this.hist,r=this.dimension,o=r.r1,a=r.r2,i=r.g1,s=r.g2,l=r.b1,d=r.b2,m=0,b=o;b<=a;b++)for(var w=i;w<=s;w++)for(var h=l;h<=d;h++){var p=q.getColorIndex(b,w,h);m+=n[p]}this._count=m}return this._count},e.prototype.clone=function(){var n=this.hist,r=this.dimension,o=r.r1,a=r.r2,i=r.g1,s=r.g2,l=r.b1,d=r.b2;return new e(o,a,i,s,l,d,n)},e.prototype.avg=function(){if(!this._avg){var n=this.hist,r=this.dimension,o=r.r1,a=r.r2,i=r.g1,s=r.g2,l=r.b1,d=r.b2,m=0,b=1<<8-q.SIGBITS,w=void 0,h=void 0,p=void 0;w=h=p=0;for(var u=o;u<=a;u++)for(var c=i;c<=s;c++)for(var f=l;f<=d;f++){var v=q.getColorIndex(u,c,f),g=n[v];m+=g,w+=g*(u+.5)*b,h+=g*(c+.5)*b,p+=g*(f+.5)*b}m?this._avg=[~~(w/m),~~(h/m),~~(p/m)]:this._avg=[~~(b*(o+a+1)/2),~~(b*(i+s+1)/2),~~(b*(l+d+1)/2)]}return this._avg},e.prototype.contains=function(n){var r=n[0],o=n[1],a=n[2],i=this.dimension,s=i.r1,l=i.r2,d=i.g1,m=i.g2,b=i.b1,w=i.b2;return r>>=q.RSHIFT,o>>=q.RSHIFT,a>>=q.RSHIFT,r>=s&&r<=l&&o>=d&&o<=m&&a>=b&&a<=w},e.prototype.split=function(){var n=this.hist,r=this.dimension,o=r.r1,a=r.r2,i=r.g1,s=r.g2,l=r.b1,d=r.b2,m=this.count();if(!m)return[];if(m===1)return[this.clone()];var b=a-o+1,w=s-i+1,h=d-l+1,p=Math.max(b,w,h),u=null,c,f;c=f=0;var v=null;if(p===b){v="r",u=new Uint32Array(a+1);for(var g=o;g<=a;g++){c=0;for(var _=i;_<=s;_++)for(var T=l;T<=d;T++){var I=q.getColorIndex(g,_,T);c+=n[I]}f+=c,u[g]=f}}else if(p===w){v="g",u=new Uint32Array(s+1);for(var _=i;_<=s;_++){c=0;for(var g=o;g<=a;g++)for(var T=l;T<=d;T++){var I=q.getColorIndex(g,_,T);c+=n[I]}f+=c,u[_]=f}}else{v="b",u=new Uint32Array(d+1);for(var T=l;T<=d;T++){c=0;for(var g=o;g<=a;g++)for(var _=i;_<=s;_++){var I=q.getColorIndex(g,_,T);c+=n[I]}f+=c,u[T]=f}}for(var C=-1,j=new Uint32Array(u.length),S=0;S<u.length;S++){var O=u[S];C<0&&O>f/2&&(C=S),j[S]=f-O}var P=this;function $(W){var V=W+"1",R=W+"2",U=P.dimension[V],L=P.dimension[R],K=P.clone(),it=P.clone(),st=C-U,y=L-C;for(st<=y?(L=Math.min(L-1,~~(C+y/2)),L=Math.max(0,L)):(L=Math.max(U,~~(C-1-st/2)),L=Math.min(P.dimension[R],L));!u[L];)L++;for(var k=j[L];!k&&u[L-1];)k=j[--L];return K.dimension[R]=L,it.dimension[V]=L+1,[K,it]}return $(v)},e}();jt.default=or;var Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});var ar=function(){function e(n){this._comparator=n,this.contents=[],this._sorted=!1}return e.prototype._sort=function(){this._sorted||(this.contents.sort(this._comparator),this._sorted=!0)},e.prototype.push=function(n){this.contents.push(n),this._sorted=!1},e.prototype.peek=function(n){return this._sort(),n=typeof n=="number"?n:this.contents.length-1,this.contents[n]},e.prototype.pop=function(){return this._sort(),this.contents.pop()},e.prototype.size=function(){return this.contents.length},e.prototype.map=function(n){return this._sort(),this.contents.map(n)},e}();Mt.default=ar;var re=A&&A.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ct,"__esModule",{value:!0});var ir=ct,sr=re(jt),Nt=re(Mt),ur=.75;function qt(e,n){for(var r=e.size();e.size()<n;){var o=e.pop();if(o&&o.count()>0){var a=o.split(),i=a[0],s=a[1];if(e.push(i),s&&s.count()>0&&e.push(s),e.size()===r)break;r=e.size()}else break}}var lr=function(e,n){if(e.length===0||n.colorCount<2||n.colorCount>256)throw new Error("Wrong MMCQ parameters");var r=sr.default.build(e),o=r.hist;Object.keys(o).length;var a=new Nt.default(function(s,l){return s.count()-l.count()});a.push(r),qt(a,ur*n.colorCount);var i=new Nt.default(function(s,l){return s.count()*s.volume()-l.count()*l.volume()});return i.contents=a.contents,qt(i,n.colorCount-i.size()),hr(i)};function hr(e){for(var n=[];e.size();){var r=e.pop(),o=r.avg();o[0],o[1],o[2],n.push(new ir.Swatch(o,r.count()))}return n}Ct.default=lr,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WebWorker=void 0;var n=Ct;Object.defineProperty(e,"MMCQ",{enumerable:!0,get:function(){return n.default}}),e.WebWorker=null}(ee);var ne={},xt={},cr=Ne,pr=Be,fr=qe,dr=Pe,oe=Object.prototype,gr=oe.hasOwnProperty,mr=cr(function(e,n){e=Object(e);var r=-1,o=n.length,a=o>2?n[2]:void 0;for(a&&fr(n[0],n[1],a)&&(o=1);++r<o;)for(var i=n[r],s=dr(i),l=-1,d=s.length;++l<d;){var m=s[l],b=e[m];(b===void 0||pr(b,oe[m])&&!gr.call(e,m))&&(e[m]=i[m])}return e}),ae=mr;Object.defineProperty(xt,"__esModule",{value:!0});var et=ct,rt=dt,br=ae,vr={targetDarkLuma:.26,maxDarkLuma:.45,minLightLuma:.55,targetLightLuma:.74,minNormalLuma:.3,targetNormalLuma:.5,maxNormalLuma:.7,targetMutesSaturation:.3,maxMutesSaturation:.4,targetVibrantSaturation:1,minVibrantSaturation:.35,weightSaturation:3,weightLuma:6.5,weightPopulation:.5};function yr(e){var n=0;return e.forEach(function(r){n=Math.max(n,r.getPopulation())}),n}function _r(e,n){return e.Vibrant===n||e.DarkVibrant===n||e.LightVibrant===n||e.Muted===n||e.DarkMuted===n||e.LightMuted===n}function wr(e,n,r,o,a,i,s){function l(){for(var m=[],b=0;b<arguments.length;b++)m[b]=arguments[b];for(var w=0,h=0,p=0;p<m.length;p+=2){var u=m[p],c=m[p+1];w+=u*c,h+=c}return w/h}function d(m,b){return 1-Math.abs(m-b)}return l(d(e,n),s.weightSaturation,d(r,o),s.weightLuma,a/i,s.weightPopulation)}function ut(e,n,r,o,a,i,s,l,d,m){var b=null,w=0;return n.forEach(function(h){var p=h.getHsl(),u=p[1],c=p[2];if(u>=l&&u<=d&&c>=a&&c<=i&&!_r(e,h)){var f=wr(u,s,c,o,h.getPopulation(),r,m);(b===null||f>w)&&(b=h,w=f)}}),b}function kr(e,n,r){var o={};return o.Vibrant=ut(o,e,n,r.targetNormalLuma,r.minNormalLuma,r.maxNormalLuma,r.targetVibrantSaturation,r.minVibrantSaturation,1,r),o.LightVibrant=ut(o,e,n,r.targetLightLuma,r.minLightLuma,1,r.targetVibrantSaturation,r.minVibrantSaturation,1,r),o.DarkVibrant=ut(o,e,n,r.targetDarkLuma,0,r.maxDarkLuma,r.targetVibrantSaturation,r.minVibrantSaturation,1,r),o.Muted=ut(o,e,n,r.targetNormalLuma,r.minNormalLuma,r.maxNormalLuma,r.targetMutesSaturation,0,r.maxMutesSaturation,r),o.LightMuted=ut(o,e,n,r.targetLightLuma,r.minLightLuma,1,r.targetMutesSaturation,0,r.maxMutesSaturation,r),o.DarkMuted=ut(o,e,n,r.targetDarkLuma,0,r.maxDarkLuma,r.targetMutesSaturation,0,r.maxMutesSaturation,r),o}function Tr(e,n,r){if(e.Vibrant===null&&e.DarkVibrant===null&&e.LightVibrant===null){if(e.DarkVibrant===null&&e.DarkMuted!==null){var o=e.DarkMuted.getHsl(),a=o[0],i=o[1],s=o[2];s=r.targetDarkLuma,e.DarkVibrant=new et.Swatch(rt.hslToRgb(a,i,s),0)}if(e.LightVibrant===null&&e.LightMuted!==null){var l=e.LightMuted.getHsl(),a=l[0],i=l[1],s=l[2];s=r.targetDarkLuma,e.DarkVibrant=new et.Swatch(rt.hslToRgb(a,i,s),0)}}if(e.Vibrant===null&&e.DarkVibrant!==null){var d=e.DarkVibrant.getHsl(),a=d[0],i=d[1],s=d[2];s=r.targetNormalLuma,e.Vibrant=new et.Swatch(rt.hslToRgb(a,i,s),0)}else if(e.Vibrant===null&&e.LightVibrant!==null){var m=e.LightVibrant.getHsl(),a=m[0],i=m[1],s=m[2];s=r.targetNormalLuma,e.Vibrant=new et.Swatch(rt.hslToRgb(a,i,s),0)}if(e.DarkVibrant===null&&e.Vibrant!==null){var b=e.Vibrant.getHsl(),a=b[0],i=b[1],s=b[2];s=r.targetDarkLuma,e.DarkVibrant=new et.Swatch(rt.hslToRgb(a,i,s),0)}if(e.LightVibrant===null&&e.Vibrant!==null){var w=e.Vibrant.getHsl(),a=w[0],i=w[1],s=w[2];s=r.targetLightLuma,e.LightVibrant=new et.Swatch(rt.hslToRgb(a,i,s),0)}if(e.Muted===null&&e.Vibrant!==null){var h=e.Vibrant.getHsl(),a=h[0],i=h[1],s=h[2];s=r.targetMutesSaturation,e.Muted=new et.Swatch(rt.hslToRgb(a,i,s),0)}if(e.DarkMuted===null&&e.DarkVibrant!==null){var p=e.DarkVibrant.getHsl(),a=p[0],i=p[1],s=p[2];s=r.targetMutesSaturation,e.DarkMuted=new et.Swatch(rt.hslToRgb(a,i,s),0)}if(e.LightMuted===null&&e.LightVibrant!==null){var u=e.LightVibrant.getHsl(),a=u[0],i=u[1],s=u[2];s=r.targetMutesSaturation,e.LightMuted=new et.Swatch(rt.hslToRgb(a,i,s),0)}}var Ir=function(e,n){n=br({},n,vr);var r=yr(e),o=kr(e,r,n);return Tr(o,r,n),o};xt.default=Ir,function(e){Object.defineProperty(e,"__esModule",{value:!0});var n=xt;Object.defineProperty(e,"Default",{enumerable:!0,get:function(){return n.default}})}(ne);var ie={},St={};Object.defineProperty(St,"__esModule",{value:!0});function Cr(e,n,r,o){return o>=125&&!(e>250&&n>250&&r>250)}St.default=Cr,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.combineFilters=void 0;var n=St;Object.defineProperty(e,"Default",{enumerable:!0,get:function(){return n.default}});function r(o){return!Array.isArray(o)||o.length===0?null:function(a,i,s,l){if(l===0)return!1;for(var d=0;d<o.length;d++)if(!o[d](a,i,s,l))return!1;return!0}}e.combineFilters=r}(ie);var Bt;function se(){if(Bt)return mt;Bt=1;var e=A&&A.__createBinding||(Object.create?function(h,p,u,c){c===void 0&&(c=u),Object.defineProperty(h,c,{enumerable:!0,get:function(){return p[u]}})}:function(h,p,u,c){c===void 0&&(c=u),h[c]=p[u]}),n=A&&A.__setModuleDefault||(Object.create?function(h,p){Object.defineProperty(h,"default",{enumerable:!0,value:p})}:function(h,p){h.default=p}),r=A&&A.__importStar||function(h){if(h&&h.__esModule)return h;var p={};if(h!=null)for(var u in h)u!=="default"&&Object.hasOwnProperty.call(h,u)&&e(p,h,u);return n(p,h),p},o=A&&A.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(mt,"__esModule",{value:!0});var a=ct,i=o(nr()),s=r(dt),l=r(ee),d=r(ne),m=r(ie),b=ae,w=function(){function h(p,u){this._src=p,this.opts=b({},u,h.DefaultOpts),this.opts.combinedFilter=m.combineFilters(this.opts.filters)}return h.from=function(p){return new i.default(p)},h.prototype._process=function(p,u){var c=u.quantizer,f=u.generator;return p.scaleDown(u),p.applyFilter(u.combinedFilter).then(function(v){return c(v.data,u)}).then(function(v){return a.Swatch.applyFilter(v,u.combinedFilter)}).then(function(v){return Promise.resolve(f(v))})},h.prototype.palette=function(){return this.swatches()},h.prototype.swatches=function(){return this._palette},h.prototype.getPalette=function(p){var u=this,c=new this.opts.ImageClass,f=c.load(this._src).then(function(v){return u._process(v,u.opts)}).then(function(v){return u._palette=v,c.remove(),v},function(v){throw c.remove(),v});return p&&f.then(function(v){return p(null,v)},function(v){return p(v)}),f},h.Builder=i.default,h.Quantizer=l,h.Generator=d,h.Filter=m,h.Util=s,h.Swatch=a.Swatch,h.DefaultOpts={colorCount:64,quality:5,generator:d.Default,ImageClass:null,quantizer:l.MMCQ,filters:[m.Default]},h}();return mt.default=w,mt}var Pt={},yt={};Object.defineProperty(yt,"__esModule",{value:!0}),yt.ImageBase=void 0;var xr=function(){function e(){}return e.prototype.scaleDown=function(n){var r=this.getWidth(),o=this.getHeight(),a=1;if(n.maxDimension>0){var i=Math.max(r,o);i>n.maxDimension&&(a=n.maxDimension/i)}else a=1/n.quality;a<1&&this.resize(r*a,o*a,a)},e.prototype.applyFilter=function(n){var r=this.getImageData();if(typeof n=="function")for(var o=r.data,a=o.length/4,i=void 0,s=void 0,l=void 0,d=void 0,m=void 0,b=0;b<a;b++)i=b*4,s=o[i+0],l=o[i+1],d=o[i+2],m=o[i+3],n(s,l,d,m)||(o[i+3]=0);return Promise.resolve(r)},e}();yt.ImageBase=xr;var vt={exports:{}};vt.exports,function(e,n){(function(r){var o=n&&!n.nodeType&&n,a=e&&!e.nodeType&&e,i=typeof A=="object"&&A;(i.global===i||i.window===i||i.self===i)&&(r=i);var s,l=2147483647,d=36,m=1,b=26,w=38,h=700,p=72,u=128,c="-",f=/^xn--/,v=/[^\x20-\x7E]/,g=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},T=d-m,I=Math.floor,C=String.fromCharCode,j;function S(y){throw new RangeError(_[y])}function O(y,k){for(var x=y.length,D=[];x--;)D[x]=k(y[x]);return D}function P(y,k){var x=y.split("@"),D="";x.length>1&&(D=x[0]+"@",y=x[1]),y=y.replace(g,".");var M=y.split("."),N=O(M,k).join(".");return D+N}function $(y){for(var k=[],x=0,D=y.length,M,N;x<D;)M=y.charCodeAt(x++),M>=55296&&M<=56319&&x<D?(N=y.charCodeAt(x++),(N&64512)==56320?k.push(((M&1023)<<10)+(N&1023)+65536):(k.push(M),x--)):k.push(M);return k}function W(y){return O(y,function(k){var x="";return k>65535&&(k-=65536,x+=C(k>>>10&1023|55296),k=56320|k&1023),x+=C(k),x}).join("")}function V(y){return y-48<10?y-22:y-65<26?y-65:y-97<26?y-97:d}function R(y,k){return y+22+75*(y<26)-((k!=0)<<5)}function U(y,k,x){var D=0;for(y=x?I(y/h):y>>1,y+=I(y/k);y>T*b>>1;D+=d)y=I(y/T);return I(D+(T+1)*y/(y+w))}function L(y){var k=[],x=y.length,D,M=0,N=u,E=p,B,Y,X,tt,F,H,Q,nt,at;for(B=y.lastIndexOf(c),B<0&&(B=0),Y=0;Y<B;++Y)y.charCodeAt(Y)>=128&&S("not-basic"),k.push(y.charCodeAt(Y));for(X=B>0?B+1:0;X<x;){for(tt=M,F=1,H=d;X>=x&&S("invalid-input"),Q=V(y.charCodeAt(X++)),(Q>=d||Q>I((l-M)/F))&&S("overflow"),M+=Q*F,nt=H<=E?m:H>=E+b?b:H-E,!(Q<nt);H+=d)at=d-nt,F>I(l/at)&&S("overflow"),F*=at;D=k.length+1,E=U(M-tt,D,tt==0),I(M/D)>l-N&&S("overflow"),N+=I(M/D),M%=D,k.splice(M++,0,N)}return W(k)}function K(y){var k,x,D,M,N,E,B,Y,X,tt,F,H=[],Q,nt,at,wt;for(y=$(y),Q=y.length,k=u,x=0,N=p,E=0;E<Q;++E)F=y[E],F<128&&H.push(C(F));for(D=M=H.length,M&&H.push(c);D<Q;){for(B=l,E=0;E<Q;++E)F=y[E],F>=k&&F<B&&(B=F);for(nt=D+1,B-k>I((l-x)/nt)&&S("overflow"),x+=(B-k)*nt,k=B,E=0;E<Q;++E)if(F=y[E],F<k&&++x>l&&S("overflow"),F==k){for(Y=x,X=d;tt=X<=N?m:X>=N+b?b:X-N,!(Y<tt);X+=d)wt=Y-tt,at=d-tt,H.push(C(R(tt+wt%at,0))),Y=I(wt/at);H.push(C(R(Y,0))),N=U(x,nt,D==M),x=0,++D}++x,++k}return H.join("")}function it(y){return P(y,function(k){return f.test(k)?L(k.slice(4).toLowerCase()):k})}function st(y){return P(y,function(k){return v.test(k)?"xn--"+K(k):k})}if(s={version:"1.4.1",ucs2:{decode:$,encode:W},decode:L,encode:K,toASCII:st,toUnicode:it},o&&a)if(e.exports==o)a.exports=s;else for(j in s)s.hasOwnProperty(j)&&(o[j]=s[j]);else r.punycode=s})(A)}(vt,vt.exports);var Sr=vt.exports;const Or=Qt(Sr);function Lr(e,n){return Object.prototype.hasOwnProperty.call(e,n)}var Ar=function(e,n,r,o){n=n||"&",r=r||"=";var a={};if(typeof e!="string"||e.length===0)return a;var i=/\+/g;e=e.split(n);var s=1e3;o&&typeof o.maxKeys=="number"&&(s=o.maxKeys);var l=e.length;s>0&&l>s&&(l=s);for(var d=0;d<l;++d){var m=e[d].replace(i,"%20"),b=m.indexOf(r),w,h,p,u;b>=0?(w=m.substr(0,b),h=m.substr(b+1)):(w=m,h=""),p=decodeURIComponent(w),u=decodeURIComponent(h),Lr(a,p)?Dr(a[p])?a[p].push(u):a[p]=[a[p],u]:a[p]=u}return a},Dr=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},ft=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},jr=function(e,n,r,o){return n=n||"&",r=r||"=",e===null&&(e=void 0),typeof e=="object"?Vt(Pr(e),function(a){var i=encodeURIComponent(ft(a))+r;return Mr(e[a])?Vt(e[a],function(s){return i+encodeURIComponent(ft(s))}).join(n):i+encodeURIComponent(ft(e[a]))}).join(n):o?encodeURIComponent(ft(o))+r+encodeURIComponent(ft(e)):""},Mr=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};function Vt(e,n){if(e.map)return e.map(n);for(var r=[],o=0;o<e.length;o++)r.push(n(e[o],o));return r}var Pr=Object.keys||function(e){var n=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(r);return n},ue,le,Rr=le=Ar,Er=ue=jr;function Ur(e){return encodeURIComponent(e)}function Fr(e){return decodeURIComponent(e)}var Nr={decode:Rr,encode:Er,parse:le,stringify:ue,escape:Ur,unescape:Fr},qr={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}},Br=Or,Z=qr,Vr=gt,Hr=en,he=rn,zr=tn,Gr=G;function G(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var $r=/^([a-z0-9.+-]+:)/i,Wr=/:[0-9]*$/,Kr=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Yr=["<",">",'"',"`"," ","\r","\n","	"],Qr=["{","}","|","\\","^","`"].concat(Yr),Ot=["'"].concat(Qr),Ht=["%","/","?",";","#"].concat(Ot),zt=["/","?","#"],Jr=255,Gt=/^[+a-z0-9A-Z_-]{0,63}$/,Xr=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Zr={javascript:!0,"javascript:":!0},Lt={javascript:!0,"javascript:":!0},ht={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},At=Nr;function gt(e,n,r){if(e&&Z.isObject(e)&&e instanceof G)return e;var o=new G;return o.parse(e,n,r),o}G.prototype.parse=function(e,n,r){if(!Z.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),a=o!==-1&&o<e.indexOf("#")?"?":"#",i=e.split(a),s=/\\/g;i[0]=i[0].replace(s,"/"),e=i.join(a);var l=e;if(l=l.trim(),!r&&e.split("#").length===1){var d=Kr.exec(l);if(d)return this.path=l,this.href=l,this.pathname=d[1],d[2]?(this.search=d[2],n?this.query=At.parse(this.search.substr(1)):this.query=this.search.substr(1)):n&&(this.search="",this.query={}),this}var m=$r.exec(l);if(m){m=m[0];var b=m.toLowerCase();this.protocol=b,l=l.substr(m.length)}if(r||m||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var w=l.substr(0,2)==="//";w&&!(m&&Lt[m])&&(l=l.substr(2),this.slashes=!0)}if(!Lt[m]&&(w||m&&!ht[m])){for(var h=-1,p=0;p<zt.length;p++){var u=l.indexOf(zt[p]);u!==-1&&(h===-1||u<h)&&(h=u)}var c,f;h===-1?f=l.lastIndexOf("@"):f=l.lastIndexOf("@",h),f!==-1&&(c=l.slice(0,f),l=l.slice(f+1),this.auth=decodeURIComponent(c)),h=-1;for(var p=0;p<Ht.length;p++){var u=l.indexOf(Ht[p]);u!==-1&&(h===-1||u<h)&&(h=u)}h===-1&&(h=l.length),this.host=l.slice(0,h),l=l.slice(h),this.parseHost(),this.hostname=this.hostname||"";var v=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!v)for(var g=this.hostname.split(/\./),p=0,_=g.length;p<_;p++){var T=g[p];if(T&&!T.match(Gt)){for(var I="",C=0,j=T.length;C<j;C++)T.charCodeAt(C)>127?I+="x":I+=T[C];if(!I.match(Gt)){var S=g.slice(0,p),O=g.slice(p+1),P=T.match(Xr);P&&(S.push(P[1]),O.unshift(P[2])),O.length&&(l="/"+O.join(".")+l),this.hostname=S.join(".");break}}}this.hostname.length>Jr?this.hostname="":this.hostname=this.hostname.toLowerCase(),v||(this.hostname=Br.toASCII(this.hostname));var $=this.port?":"+this.port:"",W=this.hostname||"";this.host=W+$,this.href+=this.host,v&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),l[0]!=="/"&&(l="/"+l))}if(!Zr[b])for(var p=0,_=Ot.length;p<_;p++){var V=Ot[p];if(l.indexOf(V)!==-1){var R=encodeURIComponent(V);R===V&&(R=escape(V)),l=l.split(V).join(R)}}var U=l.indexOf("#");U!==-1&&(this.hash=l.substr(U),l=l.slice(0,U));var L=l.indexOf("?");if(L!==-1?(this.search=l.substr(L),this.query=l.substr(L+1),n&&(this.query=At.parse(this.query)),l=l.slice(0,L)):n&&(this.search="",this.query={}),l&&(this.pathname=l),ht[b]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var $=this.pathname||"",K=this.search||"";this.path=$+K}return this.href=this.format(),this};function tn(e){return Z.isString(e)&&(e=gt(e)),e instanceof G?e.format():G.prototype.format.call(e)}G.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var n=this.protocol||"",r=this.pathname||"",o=this.hash||"",a=!1,i="";this.host?a=e+this.host:this.hostname&&(a=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&Z.isObject(this.query)&&Object.keys(this.query).length&&(i=At.stringify(this.query));var s=this.search||i&&"?"+i||"";return n&&n.substr(-1)!==":"&&(n+=":"),this.slashes||(!n||ht[n])&&a!==!1?(a="//"+(a||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):a||(a=""),o&&o.charAt(0)!=="#"&&(o="#"+o),s&&s.charAt(0)!=="?"&&(s="?"+s),r=r.replace(/[?#]/g,function(l){return encodeURIComponent(l)}),s=s.replace("#","%23"),n+a+r+s+o};function en(e,n){return gt(e,!1,!0).resolve(n)}G.prototype.resolve=function(e){return this.resolveObject(gt(e,!1,!0)).format()};function rn(e,n){return e?gt(e,!1,!0).resolveObject(n):n}G.prototype.resolveObject=function(e){if(Z.isString(e)){var n=new G;n.parse(e,!1,!0),e=n}for(var r=new G,o=Object.keys(this),a=0;a<o.length;a++){var i=o[a];r[i]=this[i]}if(r.hash=e.hash,e.href==="")return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),l=0;l<s.length;l++){var d=s[l];d!=="protocol"&&(r[d]=e[d])}return ht[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!ht[e.protocol]){for(var m=Object.keys(e),b=0;b<m.length;b++){var w=m[b];r[w]=e[w]}return r.href=r.format(),r}if(r.protocol=e.protocol,!e.host&&!Lt[e.protocol]){for(var _=(e.pathname||"").split("/");_.length&&!(e.host=_.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),r.pathname=_.join("/")}else r.pathname=e.pathname;if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var h=r.pathname||"",p=r.search||"";r.path=h+p}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var u=r.pathname&&r.pathname.charAt(0)==="/",c=e.host||e.pathname&&e.pathname.charAt(0)==="/",f=c||u||r.host&&e.pathname,v=f,g=r.pathname&&r.pathname.split("/")||[],_=e.pathname&&e.pathname.split("/")||[],T=r.protocol&&!ht[r.protocol];if(T&&(r.hostname="",r.port=null,r.host&&(g[0]===""?g[0]=r.host:g.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(_[0]===""?_[0]=e.host:_.unshift(e.host)),e.host=null),f=f&&(_[0]===""||g[0]==="")),c)r.host=e.host||e.host===""?e.host:r.host,r.hostname=e.hostname||e.hostname===""?e.hostname:r.hostname,r.search=e.search,r.query=e.query,g=_;else if(_.length)g||(g=[]),g.pop(),g=g.concat(_),r.search=e.search,r.query=e.query;else if(!Z.isNullOrUndefined(e.search)){if(T){r.hostname=r.host=g.shift();var I=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;I&&(r.auth=I.shift(),r.host=r.hostname=I.shift())}return r.search=e.search,r.query=e.query,(!Z.isNull(r.pathname)||!Z.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!g.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var C=g.slice(-1)[0],j=(r.host||e.host||g.length>1)&&(C==="."||C==="..")||C==="",S=0,O=g.length;O>=0;O--)C=g[O],C==="."?g.splice(O,1):C===".."?(g.splice(O,1),S++):S&&(g.splice(O,1),S--);if(!f&&!v)for(;S--;S)g.unshift("..");f&&g[0]!==""&&(!g[0]||g[0].charAt(0)!=="/")&&g.unshift(""),j&&g.join("/").substr(-1)!=="/"&&g.push("");var P=g[0]===""||g[0]&&g[0].charAt(0)==="/";if(T){r.hostname=r.host=P?"":g.length?g.shift():"";var I=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;I&&(r.auth=I.shift(),r.host=r.hostname=I.shift())}return f=f||r.host&&g.length,f&&!P&&g.unshift(""),g.length?r.pathname=g.join("/"):(r.pathname=null,r.path=null),(!Z.isNull(r.pathname)||!Z.isNull(r.search))&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},G.prototype.parseHost=function(){var e=this.host,n=Wr.exec(e);n&&(n=n[0],n!==":"&&(this.port=n.substr(1)),e=e.substr(0,e.length-n.length)),e&&(this.hostname=e)};function nn(e,n){for(var r=0,o=e.length-1;o>=0;o--){var a=e[o];a==="."?e.splice(o,1):a===".."?(e.splice(o,1),r++):r&&(e.splice(o,1),r--)}if(n)for(;r--;r)e.unshift("..");return e}function on(){for(var e="",n=!1,r=arguments.length-1;r>=-1&&!n;r--){var o=r>=0?arguments[r]:"/";if(typeof o!="string")throw new TypeError("Arguments to path.resolve must be strings");o&&(e=o+"/"+e,n=o.charAt(0)==="/")}return e=nn(an(e.split("/"),function(a){return!!a}),!n).join("/"),(n?"/":"")+e||"."}function an(e,n){if(e.filter)return e.filter(n);for(var r=[],o=0;o<e.length;o++)n(e[o],o,e)&&r.push(e[o]);return r}var ce=function(e){function n(){var o=this||self;return delete e.prototype.__magic__,o}if(typeof globalThis=="object")return globalThis;if(this)return n();e.defineProperty(e.prototype,"__magic__",{configurable:!0,get:n});var r=__magic__;return r}(Object),sn=zr,pe=Vr,fe=Hr,de=Gr,ot=ce.URL,ge=ce.URLSearchParams,un=/%/g,ln=/\\/g,hn=/\n/g,cn=/\r/g,pn=/\t/g,fn=47;function dn(e){var n=e!=null?e:null;return!!(n!==null&&(n!=null&&n.href)&&(n!=null&&n.origin))}function gn(e){if(e.hostname!=="")throw new TypeError('File URL host must be "localhost" or empty on browser');for(var n=e.pathname,r=0;r<n.length;r++)if(n[r]==="%"){var o=n.codePointAt(r+2)|32;if(n[r+1]==="2"&&o===102)throw new TypeError("File URL path must not include encoded / characters")}return decodeURIComponent(n)}function mn(e){return e.includes("%")&&(e=e.replace(un,"%25")),e.includes("\\")&&(e=e.replace(ln,"%5C")),e.includes("\n")&&(e=e.replace(hn,"%0A")),e.includes("\r")&&(e=e.replace(cn,"%0D")),e.includes("	")&&(e=e.replace(pn,"%09")),e}var me=function(e){if(typeof e>"u")throw new TypeError('The "domain" argument must be specified');return new ot("http://"+e).hostname},be=function(e){if(typeof e>"u")throw new TypeError('The "domain" argument must be specified');return new ot("http://"+e).hostname},ve=function(e){var n=new ot("file://"),r=on(e),o=e.charCodeAt(e.length-1);return o===fn&&r[r.length-1]!=="/"&&(r+="/"),n.pathname=mn(r),n},ye=function(e){if(!dn(e)&&typeof e!="string")throw new TypeError('The "path" argument must be of type string or an instance of URL. Received type '+typeof e+" ("+e+")");var n=new ot(e);if(n.protocol!=="file:")throw new TypeError("The URL must be of scheme file");return gn(n)},_e=function(e,n){var r,o,a;if(n===void 0&&(n={}),!(e instanceof ot))return sn(e);if(typeof n!="object"||n===null)throw new TypeError('The "options" argument must be of type object.');var i=(r=n.auth)!=null?r:!0,s=(o=n.fragment)!=null?o:!0,l=(a=n.search)!=null?a:!0,d=new ot(e.toString());return i||(d.username="",d.password=""),s||(d.hash=""),l||(d.search=""),d.toString()},bn={format:_e,parse:pe,resolve:fe,resolveObject:he,Url:de,URL:ot,URLSearchParams:ge,domainToASCII:me,domainToUnicode:be,pathToFileURL:ve,fileURLToPath:ye};const vn=Object.freeze(Object.defineProperty({__proto__:null,URL:ot,URLSearchParams:ge,Url:de,default:bn,domainToASCII:me,domainToUnicode:be,fileURLToPath:ye,format:_e,parse:pe,pathToFileURL:ve,resolve:fe,resolveObject:he},Symbol.toStringTag,{value:"Module"})),yn=Te(vn);var _n=A&&A.__extends||function(){var e=function(n,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,a){o.__proto__=a}||function(o,a){for(var i in a)a.hasOwnProperty(i)&&(o[i]=a[i])},e(n,r)};return function(n,r){e(n,r);function o(){this.constructor=n}n.prototype=r===null?Object.create(r):(o.prototype=r.prototype,new o)}}(),wn=A&&A.__createBinding||(Object.create?function(e,n,r,o){o===void 0&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return n[r]}})}:function(e,n,r,o){o===void 0&&(o=r),e[o]=n[r]}),kn=A&&A.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),Tn=A&&A.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&wn(n,e,r);return kn(n,e),n};Object.defineProperty(Pt,"__esModule",{value:!0});var In=yt,Dt=Tn(yn);function Cn(e){var n=Dt.parse(e);return n.protocol===null&&n.host===null&&n.port===null}function xn(e,n){var r=Dt.parse(e),o=Dt.parse(n);return r.protocol===o.protocol&&r.hostname===o.hostname&&r.port===o.port}var Sn=function(e){_n(n,e);function n(){return e!==null&&e.apply(this,arguments)||this}return n.prototype._initCanvas=function(){var r=this.image,o=this._canvas=document.createElement("canvas"),a=this._context=o.getContext("2d");o.className="vibrant-canvas",o.style.display="none",this._width=o.width=r.width,this._height=o.height=r.height,a.drawImage(r,0,0),document.body.appendChild(o)},n.prototype.load=function(r){var o=this,a=null,i=null;if(typeof r=="string")a=document.createElement("img"),!Cn(r)&&!xn(window.location.href,r)&&(a.crossOrigin="anonymous"),i=a.src=r;else if(r instanceof HTMLImageElement)a=r,i=r.src;else return Promise.reject(new Error("Cannot load buffer as an image in browser"));return this.image=a,new Promise(function(s,l){var d=function(){o._initCanvas(),s(o)};a.complete?d():(a.onload=d,a.onerror=function(m){return l(new Error("Fail to load image: "+i))})})},n.prototype.clear=function(){this._context.clearRect(0,0,this._width,this._height)},n.prototype.update=function(r){this._context.putImageData(r,0,0)},n.prototype.getWidth=function(){return this._width},n.prototype.getHeight=function(){return this._height},n.prototype.resize=function(r,o,a){var i=this,s=i._canvas,l=i._context,d=i.image;this._width=s.width=r,this._height=s.height=o,l.scale(a,a),l.drawImage(d,0,0)},n.prototype.getPixelCount=function(){return this._width*this._height},n.prototype.getImageData=function(){return this._context.getImageData(0,0,this._width,this._height)},n.prototype.remove=function(){this._canvas&&this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas)},n}(In.ImageBase);Pt.default=Sn;var we=A&&A.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},ke=we(se()),On=we(Pt);ke.default.DefaultOpts.ImageClass=On.default;var Ln=ke.default;const An=Qt(Ln),Dn=J("theming","backgroundImage"),$t=J("theming","shippedBackgrounds"),Wt=J("theming","themingDefaultBackground"),jn=J("theming","defaultShippedBackground"),Kt=e=>Xt("theming","","img/background/")+e,Mn={name:"BackgroundSettings",components:{Check:Ve,Close:He,ImageEdit:ze,NcButton:Jt,NcColorPicker:Ie},data(){return{loading:!1,Theming:J("theming","data",{}),backgroundImage:Dn}},computed:{shippedBackgrounds(){return Object.keys($t).map(e=>({name:e,url:Kt(e),preview:Kt("preview/"+e),details:$t[e]})).filter(e=>!this.isGlobalBackgroundDeleted&&!this.isGlobalBackgroundDefault?e.name!==jn:!0)},isGlobalBackgroundDefault(){return!!Wt},isGlobalBackgroundDeleted(){return Wt==="backgroundColor"},isBackgroundDisabled(){return this.backgroundImage==="disabled"||!this.backgroundImage}},methods:{invertTextColor(e){return this.calculateLuma(e)>.6},calculateLuma(e){const[n,r,o]=this.hexToRGB(e);return(.2126*n+.7152*r+.0722*o)/255},hexToRGB(e){const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return n?[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]:null},async update(e){this.backgroundImage=e.backgroundImage,this.Theming.color=e.backgroundColor,this.$emit("update:background"),this.loading=!1},async setDefault(){this.loading="default";const e=await z.post(pt("/apps/theming/background/default"));this.update(e.data)},async setShipped(e){this.loading=e;const n=await z.post(pt("/apps/theming/background/shipped"),{value:e});this.update(n.data)},async setFile(e,n=null){this.loading="custom";const r=await z.post(pt("/apps/theming/background/custom"),{value:e,color:n});this.update(r.data)},async removeBackground(){this.loading="remove";const e=await z.delete(pt("/apps/theming/background/custom"));this.update(e.data)},async pickColor(e){var o,a,i;this.loading="color";const n=((a=(o=e==null?void 0:e.target)==null?void 0:o.dataset)==null?void 0:a.color)||((i=this.Theming)==null?void 0:i.color)||"#0082c9",r=await z.post(pt("/apps/theming/background/color"),{color:n});this.update(r.data)},debouncePickColor:Fe(function(...e){this.pickColor(...e)},200),pickFile(){De(t("theming","Select a background from your files")).allowDirectories(!1).setMimeTypeFilter(["image/png","image/gif","image/jpeg","image/svg+xml","image/svg"]).setMultiSelect(!1).addButton({id:"select",label:t("theming","Select background"),callback:e=>{var n;this.applyFile((n=e[0])==null?void 0:n.path)},type:"primary"}).build().pick()},async applyFile(e){var o;if(!e||typeof e!="string"||e.trim().length===0||e==="/"){console.error("No valid background have been selected",{path:e}),It(t("theming","No background has been selected"));return}this.loading="custom";let n=null,r=null;try{const a=Ce("dav/files/"+xe().uid+e);n=await z.get(a,{responseType:"blob"});const i=URL.createObjectURL(n.data),s=await this.getColorPaletteFromBlob(i);r=(o=s==null?void 0:s.DarkVibrant)==null?void 0:o.hex,this.setFile(e,r),console.debug("Extracted colour",r,"from custom image",e,s)}catch(a){this.setFile(e),console.error("Unable to extract colour from custom image",{error:a,path:e,response:n,color:r})}},getColorPaletteFromBlob(e){return new Promise((n,r)=>{new An(e).getPalette((o,a)=>{o&&r(o),n(a)})})}}};var Pn=function(){var e=this,n=e._self._c;return n("div",{staticClass:"background-selector",attrs:{"data-user-theming-background-settings":""}},[n("button",{class:{"icon-loading":e.loading==="custom","background background__filepicker":!0,"background--active":e.backgroundImage==="custom"},attrs:{"aria-pressed":e.backgroundImage==="custom","data-color-bright":e.invertTextColor(e.Theming.color),"data-user-theming-background-custom":"",tabindex:"0"},on:{click:e.pickFile}},[e._v(" "+e._s(e.t("theming","Custom background"))+" "),e.backgroundImage!=="custom"?n("ImageEdit",{attrs:{size:26}}):e._e(),n("Check",{attrs:{size:44}})],1),n("button",{class:{"icon-loading":e.loading==="default","background background__default":!0,"background--active":e.backgroundImage==="default"},style:{"--border-color":e.Theming.defaultColor},attrs:{"aria-pressed":e.backgroundImage==="default","data-color-bright":e.invertTextColor(e.Theming.defaultColor),"data-user-theming-background-default":"",tabindex:"0"},on:{click:e.setDefault}},[e._v(" "+e._s(e.t("theming","Default background"))+" "),n("Check",{attrs:{size:44}})],1),n("div",{staticClass:"background-color",attrs:{"data-user-theming-background-color":""}},[n("NcColorPicker",{on:{input:e.debouncePickColor},model:{value:e.Theming.color,callback:function(r){e.$set(e.Theming,"color",r)},expression:"Theming.color"}},[n("NcButton",{attrs:{type:"ternary"}},[e._v(" "+e._s(e.t("theming","Change color"))+" ")])],1)],1),n("button",{class:{"background background__delete":!0,"background--active":e.isBackgroundDisabled},attrs:{"aria-pressed":e.isBackgroundDisabled,"data-user-theming-background-clear":"",tabindex:"0"},on:{click:e.removeBackground}},[e._v(" "+e._s(e.t("theming","No background"))+" "),e.isBackgroundDisabled?e._e():n("Close",{attrs:{size:32}}),n("Check",{attrs:{size:44}})],1),e._l(e.shippedBackgrounds,function(r){return n("button",{key:r.name,class:{"background background__shipped":!0,"icon-loading":e.loading===r.name,"background--active":e.backgroundImage===r.name},style:{backgroundImage:"url("+r.preview+")","--border-color":r.details.primary_color},attrs:{title:r.details.attribution,"aria-label":r.details.description,"aria-pressed":e.backgroundImage===r.name,"data-color-bright":r.details.theming==="dark","data-user-theming-background-shipped":r.name,tabindex:"0"},on:{click:function(o){return e.setShipped(r.name)}}},[n("Check",{attrs:{size:44}})],1)})],2)},Rn=[],En=_t(Mn,Pn,Rn,!1,null,"6341317c");const Un=En.exports,Fn={name:"ItemPreview",components:{NcCheckboxRadioSwitch:Zt},props:{enforced:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},theme:{type:Object,required:!0},type:{type:String,default:""},unique:{type:Boolean,default:!1}},computed:{switchType(){return this.unique?"switch":"radio"},name(){return this.unique?null:this.type},img(){return Xt("theming","img",this.theme.id+".jpg")},checked:{get(){return this.selected},set(e){if(console.debug("Changed theme",this.theme.id,e),!this.unique){this.$emit("change",{enabled:!0,id:this.theme.id});return}this.$emit("change",{enabled:e===!0,id:this.theme.id})}}},methods:{onToggle(){if(this.switchType==="radio"){this.checked=!0;return}this.checked=!this.checked}}};var Nn=function(){var e=this,n=e._self._c;return n("div",{staticClass:"theming__preview",class:"theming__preview--"+e.theme.id},[n("div",{staticClass:"theming__preview-image",style:{backgroundImage:"url("+e.img+")"},on:{click:e.onToggle}}),n("div",{staticClass:"theming__preview-description"},[n("h3",[e._v(e._s(e.theme.title))]),n("p",{staticClass:"theming__preview-explanation"},[e._v(e._s(e.theme.description))]),e.enforced?n("span",{staticClass:"theming__preview-warning",attrs:{role:"note"}},[e._v(" "+e._s(e.t("theming","Theme selection is enforced"))+" ")]):e._e(),n("NcCheckboxRadioSwitch",{staticClass:"theming__preview-toggle",attrs:{checked:e.checked,disabled:e.enforced,name:e.name,type:e.switchType},on:{"update:checked":function(r){e.checked=r}}},[e._v(" "+e._s(e.theme.enableLabel)+" ")])],1)])},qn=[],Bn=_t(Fn,Nn,qn,!1,null,"fecfd930");const Vn=Bn.exports,Hn=Se({name:"UserAppMenuSection",components:{AppOrderSelector:Le,IconUndo:Ge,NcButton:Jt,NcNoteCard:Oe,NcSettingsSection:te},setup(){const{userAppOrder:e,enforcedDefaultApp:n}=J("theming","navigationBar"),r=Object.values(J("core","apps")).filter(({type:h})=>h==="link").map(h=>({...h,label:h.name,default:h.default&&h.app===n})),o=Rt(!Array.isArray(e)||Object.values(e).length>0),a=Et(()=>r.some(({id:h},p)=>h!==d.value[p].id)),i="theming-apporder-changed-infocard",s="theming-apporder-changed-infocard",l=Et(()=>(a.value?"".concat(i," "):"")+(n?s:"")),d=Rt([...r]),m=h=>{const p={};h.forEach(({app:u,id:c},f)=>{p[c]={order:f,app:u}}),w("apporder",p).then(()=>{d.value=h,o.value=!0}).catch(u=>{console.warn("Could not set the app order",u),It(kt("theming","Could not set the app order"))})},b=async()=>{try{await w("apporder",[]),o.value=!1;const{data:h}=await z.get(lt("/core/navigation/apps"),{headers:{"OCS-APIRequest":"true"}});d.value=h.ocs.data.map(p=>({...p,label:p.name,default:p.default&&p.app===n}))}catch(h){console.warn(h),It(kt("theming","Could not reset the app order"))}},w=async(h,p)=>{const u=lt("apps/provisioning_api/api/v1/config/users/{appId}/{configKey}",{appId:"core",configKey:h});return await z.post(u,{configValue:JSON.stringify(p)})};return{appOrder:d,updateAppOrder:m,resetAppOrder:b,enforcedDefaultApp:n,hasAppOrderChanged:a,hasCustomAppOrder:o,ariaDetailsAppOrder:l,elementIdAppOrderChanged:i,elementIdEnforcedDefaultApp:s,t:kt}}});var zn=function(){var e=this,n=e._self._c;return e._self._setupProxy,n("NcSettingsSection",{attrs:{name:e.t("theming","Navigation bar settings")}},[n("p",[e._v(" "+e._s(e.t("theming","You can configure the app order used for the navigation bar. The first entry will be the default app, opened after login or when clicking on the logo."))+" ")]),e.enforcedDefaultApp?n("NcNoteCard",{attrs:{id:e.elementIdEnforcedDefaultApp,type:"info"}},[e._v(" "+e._s(e.t("theming","The default app can not be changed because it was configured by the administrator."))+" ")]):e._e(),e.hasAppOrderChanged?n("NcNoteCard",{attrs:{id:e.elementIdAppOrderChanged,type:"info"}},[e._v(" "+e._s(e.t("theming","The app order was changed, to see it in action you have to reload the page."))+" ")]):e._e(),n("AppOrderSelector",{staticClass:"user-app-menu-order",attrs:{"aria-details":e.ariaDetailsAppOrder,value:e.appOrder},on:{"update:value":e.updateAppOrder}}),n("NcButton",{attrs:{"data-test-id":"btn-apporder-reset",disabled:!e.hasCustomAppOrder,type:"tertiary"},on:{click:e.resetAppOrder},scopedSlots:e._u([{key:"icon",fn:function(){return[n("IconUndo",{attrs:{size:20}})]},proxy:!0}])},[e._v(" "+e._s(e.t("theming","Reset default app order"))+" ")])],1)},Gn=[],$n=_t(Hn,zn,Gn,!1,null,"be01f40d");const Wn=$n.exports,Kn=J("theming","themes",[]),Yn=J("theming","enforceTheme",""),Qn=J("theming","shortcutsDisabled",!1),Jn=J("theming","isUserThemingDisabled"),Xn={name:"UserThemes",components:{ItemPreview:Vn,NcCheckboxRadioSwitch:Zt,NcSettingsSection:te,BackgroundSettings:Un,UserAppMenuSection:Wn},data(){return{availableThemes:Kn,enforceTheme:Yn,shortcutsDisabled:Qn,isUserThemingDisabled:Jn}},computed:{themes(){return this.availableThemes.filter(e=>e.type===1)},fonts(){return this.availableThemes.filter(e=>e.type===2)},selectedTheme(){return this.themes.find(e=>e.enabled===!0)||this.themes[0]},description(){return t("theming","Universal access is very important to us. We follow web standards and check to make everything usable also without mouse, and assistive software such as screenreaders. We aim to be compliant with the {guidelines}Web Content Accessibility Guidelines{linkend} 2.1 on AA level, with the high contrast theme even on AAA level.").replace("{guidelines}",this.guidelinesLink).replace("{linkend}","</a>")},guidelinesLink(){return'<a target="_blank" href="https://www.w3.org/WAI/standards-guidelines/wcag/" rel="noreferrer nofollow">'},descriptionDetail(){return t("theming","If you find any issues, do not hesitate to report them on {issuetracker}our issue tracker{linkend}. And if you want to get involved, come join {designteam}our design team{linkend}!").replace("{issuetracker}",this.issuetrackerLink).replace("{designteam}",this.designteamLink).replace(/\{linkend\}/g,"</a>")},issuetrackerLink(){return'<a target="_blank" href="https://github.com/nextcloud/server/issues/" rel="noreferrer nofollow">'},designteamLink(){return'<a target="_blank" href="https://nextcloud.com/design" rel="noreferrer nofollow">'}},watch:{shortcutsDisabled(e){this.changeShortcutsDisabled(e)}},methods:{refreshGlobalStyles(){[...document.head.querySelectorAll("link.theme")].forEach(e=>{const n=new URL(e.href);n.searchParams.set("v",Date.now());const r=e.cloneNode();r.href=n.toString(),r.onload=()=>e.remove(),document.head.append(r)})},updateBackground(e){this.background=e.type==="custom"||e.type==="default"?e.type:e.value,this.refreshGlobalStyles()},changeTheme({enabled:e,id:n}){this.themes.forEach(r=>{if(r.id===n&&e){r.enabled=!0;return}r.enabled=!1}),this.updateBodyAttributes(),this.selectItem(e,n)},changeFont({enabled:e,id:n}){this.fonts.forEach(r=>{if(r.id===n&&e){r.enabled=!0;return}r.enabled=!1}),this.updateBodyAttributes(),this.selectItem(e,n)},async changeShortcutsDisabled(e){e?await z({url:lt("apps/provisioning_api/api/v1/config/users/{appId}/{configKey}",{appId:"theming",configKey:"shortcuts_disabled"}),data:{configValue:"yes"},method:"POST"}):await z({url:lt("apps/provisioning_api/api/v1/config/users/{appId}/{configKey}",{appId:"theming",configKey:"shortcuts_disabled"}),method:"DELETE"})},updateBodyAttributes(){const e=this.themes.filter(r=>r.enabled===!0).map(r=>r.id),n=this.fonts.filter(r=>r.enabled===!0).map(r=>r.id);this.themes.forEach(r=>{document.body.toggleAttribute("data-theme-".concat(r.id),r.enabled)}),this.fonts.forEach(r=>{document.body.toggleAttribute("data-theme-".concat(r.id),r.enabled)}),document.body.setAttribute("data-themes",[...e,...n].join(","))},async selectItem(e,n){try{e?await z({url:lt("apps/theming/api/v1/theme/{themeId}/enable",{themeId:n}),method:"PUT"}):await z({url:lt("apps/theming/api/v1/theme/{themeId}",{themeId:n}),method:"DELETE"})}catch(r){console.error(r,r.response),OC.Notification.showTemporary(t("theming",r.response.data.ocs.meta.message+". Unable to apply the setting."))}}}};var Zn=function(){var e=this,n=e._self._c;return n("section",[n("NcSettingsSection",{staticClass:"theming",attrs:{name:e.t("theming","Appearance and accessibility settings"),"limit-width":!1}},[n("p",{domProps:{innerHTML:e._s(e.description)}}),n("p",{domProps:{innerHTML:e._s(e.descriptionDetail)}}),n("div",{staticClass:"theming__preview-list"},e._l(e.themes,function(r){return n("ItemPreview",{key:r.id,attrs:{enforced:r.id===e.enforceTheme,selected:e.selectedTheme.id===r.id,theme:r,unique:e.themes.length===1,type:"theme"},on:{change:e.changeTheme}})}),1),n("div",{staticClass:"theming__preview-list"},e._l(e.fonts,function(r){return n("ItemPreview",{key:r.id,attrs:{selected:r.enabled,theme:r,unique:e.fonts.length===1,type:"font"},on:{change:e.changeFont}})}),1)]),n("NcSettingsSection",{staticClass:"background",attrs:{name:e.t("theming","Background and color"),"data-user-theming-background-disabled":""}},[e.isUserThemingDisabled?[n("p",[e._v(e._s(e.t("theming","Customization has been disabled by your administrator")))])]:[n("p",[e._v(e._s(e.t("theming","The background can be set to an image from the default set, a custom uploaded image, or a plain color. The primary color will automatically be adapted based on this and used for elements like folder icons, primary buttons and highlights.")))]),n("BackgroundSettings",{staticClass:"background__grid",on:{"update:background":e.refreshGlobalStyles}})]],2),n("NcSettingsSection",{attrs:{name:e.t("theming","Keyboard shortcuts")}},[n("p",[e._v(e._s(e.t("theming","In some cases keyboard shortcuts can interfere with accessibility tools. In order to allow focusing on your tool correctly you can disable all keyboard shortcuts here. This will also disable all available shortcuts in apps.")))]),n("NcCheckboxRadioSwitch",{staticClass:"theming__preview-toggle",attrs:{checked:e.shortcutsDisabled,type:"switch"},on:{"update:checked":function(r){e.shortcutsDisabled=r},change:e.changeShortcutsDisabled}},[e._v(" "+e._s(e.t("theming","Disable all keyboard shortcuts"))+" ")])],1),n("UserAppMenuSection")],1)},to=[],eo=_t(Xn,Zn,to,!1,null,"a371288d");const ro=eo.exports;Tt.prototype.OC=OC,Tt.prototype.t=t;const no=Tt.extend(ro),Yt=new no;Yt.$mount("#theming"),Yt.$on("update:background",Ae);
