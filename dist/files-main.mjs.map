{"version":3,"file":"files-main.mjs","sources":["../apps/files/src/router/router.ts","../apps/files/src/services/RouterService.ts","../apps/files/src/models/Setting.js","../apps/files/src/services/Settings.js","../apps/files/src/store/viewConfig.ts","../node_modules/throttle-debounce/esm/index.js","../apps/files/src/components/NavigationQuota.vue","../apps/files/src/components/Setting.vue","../apps/files/src/views/Settings.vue","../apps/files/src/views/Navigation.vue","../node_modules/natural-orderby/dist/index.js","../node_modules/xml2js/lib/defaults.js","../node_modules/xmlbuilder/lib/Utility.js","../node_modules/xmlbuilder/lib/XMLDOMImplementation.js","../node_modules/xmlbuilder/lib/XMLDOMErrorHandler.js","../node_modules/xmlbuilder/lib/XMLDOMStringList.js","../node_modules/xmlbuilder/lib/XMLDOMConfiguration.js","../node_modules/xmlbuilder/lib/NodeType.js","../node_modules/xmlbuilder/lib/XMLAttribute.js","../node_modules/xmlbuilder/lib/XMLNamedNodeMap.js","../node_modules/xmlbuilder/lib/XMLElement.js","../node_modules/xmlbuilder/lib/XMLCharacterData.js","../node_modules/xmlbuilder/lib/XMLCData.js","../node_modules/xmlbuilder/lib/XMLComment.js","../node_modules/xmlbuilder/lib/XMLDeclaration.js","../node_modules/xmlbuilder/lib/XMLDTDAttList.js","../node_modules/xmlbuilder/lib/XMLDTDEntity.js","../node_modules/xmlbuilder/lib/XMLDTDElement.js","../node_modules/xmlbuilder/lib/XMLDTDNotation.js","../node_modules/xmlbuilder/lib/XMLDocType.js","../node_modules/xmlbuilder/lib/XMLRaw.js","../node_modules/xmlbuilder/lib/XMLText.js","../node_modules/xmlbuilder/lib/XMLProcessingInstruction.js","../node_modules/xmlbuilder/lib/XMLDummy.js","../node_modules/xmlbuilder/lib/XMLNodeList.js","../node_modules/xmlbuilder/lib/DocumentPosition.js","../node_modules/xmlbuilder/lib/XMLNode.js","../node_modules/xmlbuilder/lib/XMLStringifier.js","../node_modules/xmlbuilder/lib/WriterState.js","../node_modules/xmlbuilder/lib/XMLWriterBase.js","../node_modules/xmlbuilder/lib/XMLStringWriter.js","../node_modules/xmlbuilder/lib/XMLDocument.js","../node_modules/xmlbuilder/lib/XMLDocumentCB.js","../node_modules/xmlbuilder/lib/XMLStreamWriter.js","../node_modules/xmlbuilder/lib/index.js","../node_modules/xml2js/lib/builder.js","../node_modules/events/events.js","../node_modules/readable-stream/lib/internal/streams/stream-browser.js","../node_modules/readable-stream/lib/internal/streams/buffer_list.js","../node_modules/readable-stream/lib/internal/streams/destroy.js","../node_modules/readable-stream/errors-browser.js","../node_modules/readable-stream/lib/internal/streams/state.js","../node_modules/util-deprecate/browser.js","../node_modules/readable-stream/lib/_stream_writable.js","../node_modules/readable-stream/lib/_stream_duplex.js","../node_modules/safe-buffer/index.js","../node_modules/string_decoder/lib/string_decoder.js","../node_modules/readable-stream/lib/internal/streams/end-of-stream.js","../node_modules/readable-stream/lib/internal/streams/async_iterator.js","../node_modules/readable-stream/lib/internal/streams/from-browser.js","../node_modules/readable-stream/lib/_stream_readable.js","../node_modules/readable-stream/lib/_stream_transform.js","../node_modules/readable-stream/lib/_stream_passthrough.js","../node_modules/readable-stream/lib/internal/streams/pipeline.js","../node_modules/stream-browserify/index.js","../node_modules/sax/lib/sax.js","../node_modules/xml2js/lib/bom.js","../node_modules/xml2js/lib/processors.js","../node_modules/setimmediate/setImmediate.js","../node_modules/timers-browserify/main.js","../node_modules/xml2js/lib/parser.js","../node_modules/xml2js/lib/xml2js.js","../apps/files/src/store/files.ts","../apps/files/src/store/paths.ts","../apps/files/src/store/selection.ts","../apps/files/src/store/uploader.ts","../apps/files/src/services/DropServiceUtils.ts","../apps/files/src/services/DropService.ts","../apps/files/src/store/dragging.ts","../apps/files/src/mixins/filesListWidth.ts","../apps/files/src/components/BreadCrumbs.vue","../apps/files/src/store/actionsmenu.ts","../apps/files/src/store/renaming.ts","../apps/files/src/components/DragAndDropPreview.vue","../apps/files/src/utils/dragUtils.ts","../apps/files/src/components/FileEntryMixin.ts","../apps/files/src/components/CustomElementRender.vue","../apps/files/src/components/FileEntry/FileEntryActions.vue","../apps/files/src/store/keyboard.ts","../apps/files/src/components/FileEntry/FileEntryCheckbox.vue","../apps/files/src/components/FileEntry/FileEntryName.vue","../apps/files/src/components/FileEntry/CollectivesIcon.vue","../apps/files/src/components/FileEntry/FavoriteIcon.vue","../apps/files/src/components/FileEntry/FileEntryPreview.vue","../apps/files/src/components/FileEntry.vue","../apps/files/src/components/FileEntryGrid.vue","../apps/files/src/components/FilesListHeader.vue","../apps/files/src/components/FilesListTableFooter.vue","../apps/files/src/mixins/filesSorting.ts","../apps/files/src/components/FilesListTableHeaderButton.vue","../apps/files/src/components/FilesListTableHeader.vue","../apps/files/src/components/VirtualList.vue","../apps/files/src/components/FilesListTableHeaderActions.vue","../apps/files/src/components/FilesListVirtual.vue","../apps/files/src/components/DragAndDropNotice.vue","../apps/files/src/views/FilesList.vue","../apps/files/src/FilesApp.vue","../apps/files/src/main.ts"],"sourcesContent":["/**\n * @copyright Copyright (c) 2022 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport type { RawLocation, Route } from 'vue-router'\nimport type { ErrorHandler } from 'vue-router/types/router.d.ts'\n\nimport { generateUrl } from '@nextcloud/router'\nimport queryString from 'query-string'\nimport Router from 'vue-router'\nimport Vue from 'vue'\n\nVue.use(Router)\n\n// Prevent router from throwing errors when we're already on the page we're trying to go to\nconst originalPush = Router.prototype.push as (to, onComplete?, onAbort?) => Promise<Route>\nRouter.prototype.push = function push(to: RawLocation, onComplete?: ((route: Route) => void) | undefined, onAbort?: ErrorHandler | undefined): Promise<Route> {\n\tif (onComplete || onAbort) return originalPush.call(this, to, onComplete, onAbort)\n\treturn originalPush.call(this, to).catch(err => err)\n}\n\nconst router = new Router({\n\tmode: 'history',\n\n\t// if index.php is in the url AND we got this far, then it's working:\n\t// let's keep using index.php in the url\n\tbase: generateUrl('/apps/files'),\n\tlinkActiveClass: 'active',\n\n\troutes: [\n\t\t{\n\t\t\tpath: '/',\n\t\t\t// Pretending we're using the default view\n\t\t\tredirect: { name: 'filelist', params: { view: 'files' } },\n\t\t},\n\t\t{\n\t\t\tpath: '/:view/:fileid(\\\\d+)?',\n\t\t\tname: 'filelist',\n\t\t\tprops: true,\n\t\t},\n\t],\n\n\t// Custom stringifyQuery to prevent encoding of slashes in the url\n\tstringifyQuery(query) {\n\t\tconst result = queryString.stringify(query).replace(/%2F/gmi, '/')\n\t\treturn result ? ('?' + result) : ''\n\t},\n})\n\nexport default router\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport type { Route } from 'vue-router'\nimport type VueRouter from 'vue-router'\nimport type { Dictionary, Location } from 'vue-router/types/router'\n\nexport default class RouterService {\n\n\tprivate _router: VueRouter\n\n\tconstructor(router: VueRouter) {\n\t\tthis._router = router\n\t}\n\n\tget name(): string | null | undefined {\n\t\treturn this._router.currentRoute.name\n\t}\n\n\tget query(): Dictionary<string | (string | null)[] | null | undefined> {\n\t\treturn this._router.currentRoute.query || {}\n\t}\n\n\tget params(): Dictionary<string> {\n\t\treturn this._router.currentRoute.params || {}\n\t}\n\n\t/**\n\t * Trigger a route change on the files app\n\t *\n\t * @param path the url path, eg: '/trashbin?dir=/Deleted'\n\t * @param replace replace the current history\n\t * @see https://router.vuejs.org/guide/essentials/navigation.html#navigate-to-a-different-location\n\t */\n\tgoTo(path: string, replace = false): Promise<Route> {\n\t\treturn this._router.push({\n\t\t\tpath,\n\t\t\treplace,\n\t\t})\n\t}\n\n\t/**\n\t * Trigger a route change on the files App\n\t *\n\t * @param name the route name\n\t * @param params the route parameters\n\t * @param query the url query parameters\n\t * @param replace replace the current history\n\t * @see https://router.vuejs.org/guide/essentials/navigation.html#navigate-to-a-different-location\n\t */\n\tgoToRoute(\n\t\tname?: string,\n\t\tparams?: Dictionary<string>,\n\t\tquery?: Dictionary<string | (string | null)[] | null | undefined>,\n\t\treplace?: boolean,\n\t): Promise<Route> {\n\t\treturn this._router.push({\n\t\t\tname,\n\t\t\tquery,\n\t\t\tparams,\n\t\t\treplace,\n\t\t} as Location)\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Gary Kim <gary@garykim.dev>\n * @copyright Copyright (c) 2019 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default class Setting {\n\n\t_close\n\t_el\n\t_name\n\t_open\n\n\t/**\n\t * Create a new files app setting\n\t *\n\t * @since 19.0.0\n\t * @param {string} name the name of this setting\n\t * @param {object} component the component\n\t * @param {Function} component.el function that returns an unmounted dom element to be added\n\t * @param {Function} [component.open] callback for when setting is added\n\t * @param {Function} [component.close] callback for when setting is closed\n\t */\n\tconstructor(name, { el, open, close }) {\n\t\tthis._name = name\n\t\tthis._el = el\n\t\tthis._open = open\n\t\tthis._close = close\n\n\t\tif (typeof this._open !== 'function') {\n\t\t\tthis._open = () => {}\n\t\t}\n\n\t\tif (typeof this._close !== 'function') {\n\t\t\tthis._close = () => {}\n\t\t}\n\t}\n\n\tget name() {\n\t\treturn this._name\n\t}\n\n\tget el() {\n\t\treturn this._el\n\t}\n\n\tget open() {\n\t\treturn this._open\n\t}\n\n\tget close() {\n\t\treturn this._close\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2019 Gary Kim <gary@garykim.dev>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport default class Settings {\n\n\t_settings\n\n\tconstructor() {\n\t\tthis._settings = []\n\t\tconsole.debug('OCA.Files.Settings initialized')\n\t}\n\n\t/**\n\t * Register a new setting\n\t *\n\t * @since 19.0.0\n\t * @param {OCA.Files.Settings.Setting} view element to add to settings\n\t * @return {boolean} whether registering was successful\n\t */\n\tregister(view) {\n\t\tif (this._settings.filter(e => e.name === view.name).length > 0) {\n\t\t\tconsole.error('A setting with the same name is already registered')\n\t\t\treturn false\n\t\t}\n\t\tthis._settings.push(view)\n\t\treturn true\n\t}\n\n\t/**\n\t * All settings elements\n\t *\n\t * @return {OCA.Files.Settings.Setting[]} All currently registered settings\n\t */\n\tget settings() {\n\t\treturn this._settings\n\t}\n\n}\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { defineStore } from 'pinia'\nimport { emit, subscribe } from '@nextcloud/event-bus'\nimport { generateUrl } from '@nextcloud/router'\nimport { loadState } from '@nextcloud/initial-state'\nimport axios from '@nextcloud/axios'\nimport Vue from 'vue'\n\nimport type { ViewConfigs, ViewConfigStore, ViewId, ViewConfig } from '../types'\n\nconst viewConfig = loadState('files', 'viewConfigs', {}) as ViewConfigs\n\nexport const useViewConfigStore = function(...args) {\n\tconst store = defineStore('viewconfig', {\n\t\tstate: () => ({\n\t\t\tviewConfig,\n\t\t} as ViewConfigStore),\n\n\t\tgetters: {\n\t\t\tgetConfig: (state) => (view: ViewId): ViewConfig => state.viewConfig[view] || {},\n\t\t},\n\n\t\tactions: {\n\t\t\t/**\n\t\t\t * Update the view config local store\n\t\t\t */\n\t\t\tonUpdate(view: ViewId, key: string, value: string | number | boolean) {\n\t\t\t\tif (!this.viewConfig[view]) {\n\t\t\t\t\tVue.set(this.viewConfig, view, {})\n\t\t\t\t}\n\t\t\t\tVue.set(this.viewConfig[view], key, value)\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Update the view config local store AND on server side\n\t\t\t */\n\t\t\tasync update(view: ViewId, key: string, value: string | number | boolean) {\n\t\t\t\taxios.put(generateUrl(`/apps/files/api/v1/views/${view}/${key}`), {\n\t\t\t\t\tvalue,\n\t\t\t\t})\n\n\t\t\t\temit('files:viewconfig:updated', { view, key, value })\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Set the sorting key AND sort by ASC\n\t\t\t * The key param must be a valid key of a File object\n\t\t\t * If not found, will be searched within the File attributes\n\t\t\t */\n\t\t\tsetSortingBy(key = 'basename', view = 'files') {\n\t\t\t\t// Save new config\n\t\t\t\tthis.update(view, 'sorting_mode', key)\n\t\t\t\tthis.update(view, 'sorting_direction', 'asc')\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Toggle the sorting direction\n\t\t\t */\n\t\t\ttoggleSortingDirection(view = 'files') {\n\t\t\t\tconst config = this.getConfig(view) || { sorting_direction: 'asc' }\n\t\t\t\tconst newDirection = config.sorting_direction === 'asc' ? 'desc' : 'asc'\n\n\t\t\t\t// Save new config\n\t\t\t\tthis.update(view, 'sorting_direction', newDirection)\n\t\t\t},\n\t\t},\n\t})\n\n\tconst viewConfigStore = store(...args)\n\n\t// Make sure we only register the listeners once\n\tif (!viewConfigStore._initialized) {\n\t\tsubscribe('files:viewconfig:updated', function({ view, key, value }: { view: ViewId, key: string, value: boolean }) {\n\t\t\tviewConfigStore.onUpdate(view, key, value)\n\t\t})\n\t\tviewConfigStore._initialized = true\n\t}\n\n\treturn viewConfigStore\n}\n","/* eslint-disable no-undefined,no-param-reassign,no-shadow */\n\n/**\n * Throttle execution of a function. Especially useful for rate limiting\n * execution of handlers on events like resize and scroll.\n *\n * @param {number} delay -                  A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher)\n *                                            are most useful.\n * @param {Function} callback -               A function to be executed after delay milliseconds. The `this` context and all arguments are passed through,\n *                                            as-is, to `callback` when the throttled-function is executed.\n * @param {object} [options] -              An object to configure options.\n * @param {boolean} [options.noTrailing] -   Optional, defaults to false. If noTrailing is true, callback will only execute every `delay` milliseconds\n *                                            while the throttled-function is being called. If noTrailing is false or unspecified, callback will be executed\n *                                            one final time after the last throttled-function call. (After the throttled-function has not been called for\n *                                            `delay` milliseconds, the internal counter is reset).\n * @param {boolean} [options.noLeading] -   Optional, defaults to false. If noLeading is false, the first throttled-function call will execute callback\n *                                            immediately. If noLeading is true, the first the callback execution will be skipped. It should be noted that\n *                                            callback will never executed if both noLeading = true and noTrailing = true.\n * @param {boolean} [options.debounceMode] - If `debounceMode` is true (at begin), schedule `clear` to execute after `delay` ms. If `debounceMode` is\n *                                            false (at end), schedule `callback` to execute after `delay` ms.\n *\n * @returns {Function} A new, throttled, function.\n */\nfunction throttle (delay, callback, options) {\n  var _ref = options || {},\n      _ref$noTrailing = _ref.noTrailing,\n      noTrailing = _ref$noTrailing === void 0 ? false : _ref$noTrailing,\n      _ref$noLeading = _ref.noLeading,\n      noLeading = _ref$noLeading === void 0 ? false : _ref$noLeading,\n      _ref$debounceMode = _ref.debounceMode,\n      debounceMode = _ref$debounceMode === void 0 ? undefined : _ref$debounceMode;\n  /*\n   * After wrapper has stopped being called, this timeout ensures that\n   * `callback` is executed at the proper times in `throttle` and `end`\n   * debounce modes.\n   */\n\n\n  var timeoutID;\n  var cancelled = false; // Keep track of the last time `callback` was executed.\n\n  var lastExec = 0; // Function to clear existing timeout\n\n  function clearExistingTimeout() {\n    if (timeoutID) {\n      clearTimeout(timeoutID);\n    }\n  } // Function to cancel next exec\n\n\n  function cancel(options) {\n    var _ref2 = options || {},\n        _ref2$upcomingOnly = _ref2.upcomingOnly,\n        upcomingOnly = _ref2$upcomingOnly === void 0 ? false : _ref2$upcomingOnly;\n\n    clearExistingTimeout();\n    cancelled = !upcomingOnly;\n  }\n  /*\n   * The `wrapper` function encapsulates all of the throttling / debouncing\n   * functionality and when executed will limit the rate at which `callback`\n   * is executed.\n   */\n\n\n  function wrapper() {\n    for (var _len = arguments.length, arguments_ = new Array(_len), _key = 0; _key < _len; _key++) {\n      arguments_[_key] = arguments[_key];\n    }\n\n    var self = this;\n    var elapsed = Date.now() - lastExec;\n\n    if (cancelled) {\n      return;\n    } // Execute `callback` and update the `lastExec` timestamp.\n\n\n    function exec() {\n      lastExec = Date.now();\n      callback.apply(self, arguments_);\n    }\n    /*\n     * If `debounceMode` is true (at begin) this is used to clear the flag\n     * to allow future `callback` executions.\n     */\n\n\n    function clear() {\n      timeoutID = undefined;\n    }\n\n    if (!noLeading && debounceMode && !timeoutID) {\n      /*\n       * Since `wrapper` is being called for the first time and\n       * `debounceMode` is true (at begin), execute `callback`\n       * and noLeading != true.\n       */\n      exec();\n    }\n\n    clearExistingTimeout();\n\n    if (debounceMode === undefined && elapsed > delay) {\n      if (noLeading) {\n        /*\n         * In throttle mode with noLeading, if `delay` time has\n         * been exceeded, update `lastExec` and schedule `callback`\n         * to execute after `delay` ms.\n         */\n        lastExec = Date.now();\n\n        if (!noTrailing) {\n          timeoutID = setTimeout(debounceMode ? clear : exec, delay);\n        }\n      } else {\n        /*\n         * In throttle mode without noLeading, if `delay` time has been exceeded, execute\n         * `callback`.\n         */\n        exec();\n      }\n    } else if (noTrailing !== true) {\n      /*\n       * In trailing throttle mode, since `delay` time has not been\n       * exceeded, schedule `callback` to execute `delay` ms after most\n       * recent execution.\n       *\n       * If `debounceMode` is true (at begin), schedule `clear` to execute\n       * after `delay` ms.\n       *\n       * If `debounceMode` is false (at end), schedule `callback` to\n       * execute after `delay` ms.\n       */\n      timeoutID = setTimeout(debounceMode ? clear : exec, debounceMode === undefined ? delay - elapsed : delay);\n    }\n  }\n\n  wrapper.cancel = cancel; // Return the wrapper function.\n\n  return wrapper;\n}\n\n/* eslint-disable no-undefined */\n/**\n * Debounce execution of a function. Debouncing, unlike throttling,\n * guarantees that a function is only executed a single time, either at the\n * very beginning of a series of calls, or at the very end.\n *\n * @param {number} delay -               A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher) are most useful.\n * @param {Function} callback -          A function to be executed after delay milliseconds. The `this` context and all arguments are passed through, as-is,\n *                                        to `callback` when the debounced-function is executed.\n * @param {object} [options] -           An object to configure options.\n * @param {boolean} [options.atBegin] -  Optional, defaults to false. If atBegin is false or unspecified, callback will only be executed `delay` milliseconds\n *                                        after the last debounced-function call. If atBegin is true, callback will be executed only at the first debounced-function call.\n *                                        (After the throttled-function has not been called for `delay` milliseconds, the internal counter is reset).\n *\n * @returns {Function} A new, debounced function.\n */\n\nfunction debounce (delay, callback, options) {\n  var _ref = options || {},\n      _ref$atBegin = _ref.atBegin,\n      atBegin = _ref$atBegin === void 0 ? false : _ref$atBegin;\n\n  return throttle(delay, callback, {\n    debounceMode: atBegin !== false\n  });\n}\n\nexport { debounce, throttle };\n//# sourceMappingURL=index.js.map\n","<template>\n\t<NcAppNavigationItem v-if=\"storageStats\"\n\t\t:aria-label=\"t('files', 'Storage informations')\"\n\t\t:class=\"{ 'app-navigation-entry__settings-quota--not-unlimited': storageStats.quota >= 0}\"\n\t\t:loading=\"loadingStorageStats\"\n\t\t:name=\"storageStatsTitle\"\n\t\t:title=\"storageStatsTooltip\"\n\t\tclass=\"app-navigation-entry__settings-quota\"\n\t\tdata-cy-files-navigation-settings-quota\n\t\t@click.stop.prevent=\"debounceUpdateStorageStats\">\n\t\t<ChartPie slot=\"icon\" :size=\"20\" />\n\n\t\t<!-- Progress bar -->\n\t\t<NcProgressBar v-if=\"storageStats.quota >= 0\"\n\t\t\tslot=\"extra\"\n\t\t\t:error=\"storageStats.relative > 80\"\n\t\t\t:value=\"Math.min(storageStats.relative, 100)\" />\n\t</NcAppNavigationItem>\n</template>\n\n<script>\nimport { debounce, throttle } from 'throttle-debounce'\nimport { formatFileSize } from '@nextcloud/files'\nimport { generateUrl } from '@nextcloud/router'\nimport { loadState } from '@nextcloud/initial-state'\nimport { showError } from '@nextcloud/dialogs'\nimport { subscribe } from '@nextcloud/event-bus'\nimport { translate } from '@nextcloud/l10n'\nimport axios from '@nextcloud/axios'\n\nimport ChartPie from 'vue-material-design-icons/ChartPie.vue'\nimport NcAppNavigationItem from '@nextcloud/vue/dist/Components/NcAppNavigationItem.js'\nimport NcProgressBar from '@nextcloud/vue/dist/Components/NcProgressBar.js'\n\nimport logger from '../logger.js'\n\nexport default {\n\tname: 'NavigationQuota',\n\n\tcomponents: {\n\t\tChartPie,\n\t\tNcAppNavigationItem,\n\t\tNcProgressBar,\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tloadingStorageStats: false,\n\t\t\tstorageStats: loadState('files', 'storageStats', null),\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tstorageStatsTitle() {\n\t\t\tconst usedQuotaByte = formatFileSize(this.storageStats?.used, false, false)\n\t\t\tconst quotaByte = formatFileSize(this.storageStats?.quota, false, false)\n\n\t\t\t// If no quota set\n\t\t\tif (this.storageStats?.quota < 0) {\n\t\t\t\treturn this.t('files', '{usedQuotaByte} used', { usedQuotaByte })\n\t\t\t}\n\n\t\t\treturn this.t('files', '{used} of {quota} used', {\n\t\t\t\tused: usedQuotaByte,\n\t\t\t\tquota: quotaByte,\n\t\t\t})\n\t\t},\n\t\tstorageStatsTooltip() {\n\t\t\tif (!this.storageStats.relative) {\n\t\t\t\treturn ''\n\t\t\t}\n\n\t\t\treturn this.t('files', '{relative}% used', this.storageStats)\n\t\t},\n\t},\n\n\tbeforeMount() {\n\t\t/**\n\t\t * Update storage stats every minute\n\t\t * TODO: remove when all views are migrated to Vue\n\t\t */\n\t\tsetInterval(this.throttleUpdateStorageStats, 60 * 1000)\n\n\t\tsubscribe('files:node:created', this.throttleUpdateStorageStats)\n\t\tsubscribe('files:node:deleted', this.throttleUpdateStorageStats)\n\t\tsubscribe('files:node:moved', this.throttleUpdateStorageStats)\n\t\tsubscribe('files:node:updated', this.throttleUpdateStorageStats)\n\t},\n\n\tmounted() {\n\t\t// If the user has a quota set, warn if the available account storage is <=0\n\t\t//\n\t\t// NOTE: This doesn't catch situations where actual *server* \n\t\t// disk (non-quota) space is low, but those should probably\n\t\t// be handled differently anyway since a regular user can't\n\t\t// can't do much about them (If we did want to indicate server disk \n\t\t// space matters to users, we'd probably want to use a warning\n\t\t// specific to that situation anyhow. So this covers warning covers \n\t\t// our primary day-to-day concern (individual account quota usage).\n\t\t//\n\t\tif (this.storageStats?.quota > 0 && this.storageStats?.free <= 0) {\n\t\t\tthis.showStorageFullWarning()\n\t\t}\n\t},\n\n\tmethods: {\n\t\t// From user input\n\t\tdebounceUpdateStorageStats: debounce(200, function(event) {\n\t\t\tthis.updateStorageStats(event)\n\t\t}),\n\t\t// From interval or event bus\n\t\tthrottleUpdateStorageStats: throttle(1000, function(event) {\n\t\t\tthis.updateStorageStats(event)\n\t\t}),\n\n\t\t/**\n\t\t * Update the storage stats\n\t\t * Throttled at max 1 refresh per minute\n\t\t *\n\t\t * @param {Event} [event = null] if user interaction\n\t\t */\n\t\tasync updateStorageStats(event = null) {\n\t\t\tif (this.loadingStorageStats) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tthis.loadingStorageStats = true\n\t\t\ttry {\n\t\t\t\tconst response = await axios.get(generateUrl('/apps/files/api/v1/stats'))\n\t\t\t\tif (!response?.data?.data) {\n\t\t\t\t\tthrow new Error('Invalid storage stats')\n\t\t\t\t}\n\n\t\t\t\t// Warn the user if the available account storage changed from > 0 to 0 \n\t\t\t\t// (unless only because quota was intentionally set to 0 by admin in the interim)\n\t\t\t\tif (this.storageStats?.free > 0 && response.data.data?.free <= 0 && response.data.data?.quota > 0) {\n\t\t\t\t\tthis.showStorageFullWarning()\n\t\t\t\t}\n\n\t\t\t\tthis.storageStats = response.data.data\n\t\t\t} catch (error) {\n\t\t\t\tlogger.error('Could not refresh storage stats', { error })\n\t\t\t\t// Only show to the user if it was manually triggered\n\t\t\t\tif (event) {\n\t\t\t\t\tshowError(t('files', 'Could not refresh storage stats'))\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tthis.loadingStorageStats = false\n\t\t\t}\n\t\t},\n\n\t\tshowStorageFullWarning() {\n\t\t\tshowError(this.t('files', 'Your storage is full, files can not be updated or synced anymore!'))\n\t\t},\n\n\t\tt: translate,\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n// User storage stats display\n.app-navigation-entry__settings-quota {\n\t// Align title with progress and icon\n\t&--not-unlimited::v-deep .app-navigation-entry__name {\n\t\tmargin-top: -6px;\n\t}\n\n\tprogress {\n\t\tposition: absolute;\n\t\tbottom: 12px;\n\t\tmargin-left: 44px;\n\t\twidth: calc(100% - 44px - 22px);\n\t}\n}\n</style>\n","<!--\n  - @copyright Copyright (c) 2020 Gary Kim <gary@garykim.dev>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<div />\n</template>\n<script>\nexport default {\n\tname: 'Setting',\n\tprops: {\n\t\tel: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.$el.appendChild(this.el())\n\t},\n}\n</script>\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<NcAppSettingsDialog :open=\"open\"\n\t\t:show-navigation=\"true\"\n\t\t:name=\"t('files', 'Files settings')\"\n\t\t@update:open=\"onClose\">\n\t\t<!-- Settings API-->\n\t\t<NcAppSettingsSection id=\"settings\" :name=\"t('files', 'Files settings')\">\n\t\t\t<NcCheckboxRadioSwitch data-cy-files-settings-setting=\"sort_favorites_first\"\n\t\t\t\t:checked=\"userConfig.sort_favorites_first\"\n\t\t\t\t@update:checked=\"setConfig('sort_favorites_first', $event)\">\n\t\t\t\t{{ t('files', 'Sort favorites first') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t<NcCheckboxRadioSwitch data-cy-files-settings-setting=\"sort_folders_first\"\n\t\t\t\t:checked=\"userConfig.sort_folders_first\"\n\t\t\t\t@update:checked=\"setConfig('sort_folders_first', $event)\">\n\t\t\t\t{{ t('files', 'Sort folders before files') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t<NcCheckboxRadioSwitch data-cy-files-settings-setting=\"show_hidden\"\n\t\t\t\t:checked=\"userConfig.show_hidden\"\n\t\t\t\t@update:checked=\"setConfig('show_hidden', $event)\">\n\t\t\t\t{{ t('files', 'Show hidden files') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t<NcCheckboxRadioSwitch data-cy-files-settings-setting=\"crop_image_previews\"\n\t\t\t\t:checked=\"userConfig.crop_image_previews\"\n\t\t\t\t@update:checked=\"setConfig('crop_image_previews', $event)\">\n\t\t\t\t{{ t('files', 'Crop image previews') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\t\t\t<NcCheckboxRadioSwitch v-if=\"enableGridView\"\n\t\t\t\tdata-cy-files-settings-setting=\"grid_view\"\n\t\t\t\t:checked=\"userConfig.grid_view\"\n\t\t\t\t@update:checked=\"setConfig('grid_view', $event)\">\n\t\t\t\t{{ t('files', 'Enable the grid view') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\t\t</NcAppSettingsSection>\n\n\t\t<!-- Settings API-->\n\t\t<NcAppSettingsSection v-if=\"settings.length !== 0\"\n\t\t\tid=\"more-settings\"\n\t\t\t:name=\"t('files', 'Additional settings')\">\n\t\t\t<template v-for=\"setting in settings\">\n\t\t\t\t<Setting :key=\"setting.name\" :el=\"setting.el\" />\n\t\t\t</template>\n\t\t</NcAppSettingsSection>\n\n\t\t<!-- Webdav URL-->\n\t\t<NcAppSettingsSection id=\"webdav\" :name=\"t('files', 'WebDAV')\">\n\t\t\t<NcInputField id=\"webdav-url-input\"\n\t\t\t\t:label=\"t('files', 'WebDAV URL')\"\n\t\t\t\t:show-trailing-button=\"true\"\n\t\t\t\t:success=\"webdavUrlCopied\"\n\t\t\t\t:trailing-button-label=\"t('files', 'Copy to clipboard')\"\n\t\t\t\t:value=\"webdavUrl\"\n\t\t\t\treadonly=\"readonly\"\n\t\t\t\ttype=\"url\"\n\t\t\t\t@focus=\"$event.target.select()\"\n\t\t\t\t@trailing-button-click=\"copyCloudId\">\n\t\t\t\t<template #trailing-button-icon>\n\t\t\t\t\t<Clipboard :size=\"20\" />\n\t\t\t\t</template>\n\t\t\t</NcInputField>\n\t\t\t<em>\n\t\t\t\t<a class=\"setting-link\"\n\t\t\t\t\t:href=\"webdavDocs\"\n\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\trel=\"noreferrer noopener\">\n\t\t\t\t\t{{ t('files', 'Use this address to access your Files via WebDAV') }} ↗\n\t\t\t\t</a>\n\t\t\t</em>\n\t\t\t<br>\n\t\t\t<em>\n\t\t\t\t<a class=\"setting-link\" :href=\"appPasswordUrl\">\n\t\t\t\t\t{{ t('files', 'If you have enabled 2FA, you must create and use a new app password by clicking here.') }} ↗\n\t\t\t\t</a>\n\t\t\t</em>\n\t\t</NcAppSettingsSection>\n\t</NcAppSettingsDialog>\n</template>\n\n<script>\nimport NcAppSettingsDialog from '@nextcloud/vue/dist/Components/NcAppSettingsDialog.js'\nimport NcAppSettingsSection from '@nextcloud/vue/dist/Components/NcAppSettingsSection.js'\nimport NcCheckboxRadioSwitch from '@nextcloud/vue/dist/Components/NcCheckboxRadioSwitch.js'\nimport Clipboard from 'vue-material-design-icons/Clipboard.vue'\nimport NcInputField from '@nextcloud/vue/dist/Components/NcInputField.js'\nimport Setting from '../components/Setting.vue'\n\nimport { generateRemoteUrl, generateUrl } from '@nextcloud/router'\nimport { getCurrentUser } from '@nextcloud/auth'\nimport { showError, showSuccess } from '@nextcloud/dialogs'\nimport { translate } from '@nextcloud/l10n'\nimport { loadState } from '@nextcloud/initial-state'\nimport { useUserConfigStore } from '../store/userconfig.ts'\n\nexport default {\n\tname: 'Settings',\n\tcomponents: {\n\t\tClipboard,\n\t\tNcAppSettingsDialog,\n\t\tNcAppSettingsSection,\n\t\tNcCheckboxRadioSwitch,\n\t\tNcInputField,\n\t\tSetting,\n\t},\n\n\tprops: {\n\t\topen: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tsetup() {\n\t\tconst userConfigStore = useUserConfigStore()\n\t\treturn {\n\t\t\tuserConfigStore,\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\t// Settings API\n\t\t\tsettings: window.OCA?.Files?.Settings?.settings || [],\n\n\t\t\t// Webdav infos\n\t\t\twebdavUrl: generateRemoteUrl('dav/files/' + encodeURIComponent(getCurrentUser()?.uid)),\n\t\t\twebdavDocs: 'https://docs.nextcloud.com/server/stable/go.php?to=user-webdav',\n\t\t\tappPasswordUrl: generateUrl('/settings/user/security#generate-app-token-section'),\n\t\t\twebdavUrlCopied: false,\n\t\t\tenableGridView: (loadState('core', 'config', [])['enable_non-accessible_features'] ?? true),\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tuserConfig() {\n\t\t\treturn this.userConfigStore.userConfig\n\t\t},\n\t},\n\n\tbeforeMount() {\n\t\t// Update the settings API entries state\n\t\tthis.settings.forEach(setting => setting.open())\n\t},\n\n\tbeforeDestroy() {\n\t\t// Update the settings API entries state\n\t\tthis.settings.forEach(setting => setting.close())\n\t},\n\n\tmethods: {\n\t\tonClose() {\n\t\t\tthis.$emit('close')\n\t\t},\n\n\t\tsetConfig(key, value) {\n\t\t\tthis.userConfigStore.update(key, value)\n\t\t},\n\n\t\tasync copyCloudId() {\n\t\t\tdocument.querySelector('input#webdav-url-input').select()\n\n\t\t\tif (!navigator.clipboard) {\n\t\t\t\t// Clipboard API not available\n\t\t\t\tshowError(t('files', 'Clipboard is not available'))\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tawait navigator.clipboard.writeText(this.webdavUrl)\n\t\t\tthis.webdavUrlCopied = true\n\t\t\tshowSuccess(t('files', 'WebDAV URL copied to clipboard'))\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.webdavUrlCopied = false\n\t\t\t}, 5000)\n\t\t},\n\n\t\tt: translate,\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.setting-link:hover {\n\ttext-decoration: underline;\n}\n</style>\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<NcAppNavigation data-cy-files-navigation\n\t\t:aria-label=\"t('files', 'Files')\">\n\t\t<template #list>\n\t\t\t<NcAppNavigationItem v-for=\"view in parentViews\"\n\t\t\t\t:key=\"view.id\"\n\t\t\t\t:allow-collapse=\"true\"\n\t\t\t\t:data-cy-files-navigation-item=\"view.id\"\n\t\t\t\t:exact=\"useExactRouteMatching(view)\"\n\t\t\t\t:icon=\"view.iconClass\"\n\t\t\t\t:name=\"view.name\"\n\t\t\t\t:open=\"isExpanded(view)\"\n\t\t\t\t:pinned=\"view.sticky\"\n\t\t\t\t:to=\"generateToNavigation(view)\"\n\t\t\t\t@update:open=\"onToggleExpand(view)\">\n\t\t\t\t<!-- Sanitized icon as svg if provided -->\n\t\t\t\t<NcIconSvgWrapper v-if=\"view.icon\" slot=\"icon\" :svg=\"view.icon\" />\n\n\t\t\t\t<!-- Child views if any -->\n\t\t\t\t<NcAppNavigationItem v-for=\"child in childViews[view.id]\"\n\t\t\t\t\t:key=\"child.id\"\n\t\t\t\t\t:data-cy-files-navigation-item=\"child.id\"\n\t\t\t\t\t:exact-path=\"true\"\n\t\t\t\t\t:icon=\"child.iconClass\"\n\t\t\t\t\t:name=\"child.name\"\n\t\t\t\t\t:to=\"generateToNavigation(child)\">\n\t\t\t\t\t<!-- Sanitized icon as svg if provided -->\n\t\t\t\t\t<NcIconSvgWrapper v-if=\"child.icon\" slot=\"icon\" :svg=\"child.icon\" />\n\t\t\t\t</NcAppNavigationItem>\n\t\t\t</NcAppNavigationItem>\n\t\t</template>\n\n\t\t<!-- Non-scrollable navigation bottom elements -->\n\t\t<template #footer>\n\t\t\t<ul class=\"app-navigation-entry__settings\">\n\t\t\t\t<!-- User storage usage statistics -->\n\t\t\t\t<NavigationQuota />\n\n\t\t\t\t<!-- Files settings modal toggle-->\n\t\t\t\t<NcAppNavigationItem :aria-label=\"t('files', 'Open the files app settings')\"\n\t\t\t\t\t:name=\"t('files', 'Files settings')\"\n\t\t\t\t\tdata-cy-files-navigation-settings-button\n\t\t\t\t\t@click.prevent.stop=\"openSettings\">\n\t\t\t\t\t<Cog slot=\"icon\" :size=\"20\" />\n\t\t\t\t</NcAppNavigationItem>\n\t\t\t</ul>\n\t\t</template>\n\n\t\t<!-- Settings modal-->\n\t\t<SettingsModal :open=\"settingsOpened\"\n\t\t\tdata-cy-files-navigation-settings\n\t\t\t@close=\"onSettingsClose\" />\n\t</NcAppNavigation>\n</template>\n\n<script lang=\"ts\">\nimport type { View } from '@nextcloud/files'\n\nimport { emit } from '@nextcloud/event-bus'\nimport { translate } from '@nextcloud/l10n'\nimport Cog from 'vue-material-design-icons/Cog.vue'\nimport NcAppNavigation from '@nextcloud/vue/dist/Components/NcAppNavigation.js'\nimport NcAppNavigationItem from '@nextcloud/vue/dist/Components/NcAppNavigationItem.js'\nimport NcIconSvgWrapper from '@nextcloud/vue/dist/Components/NcIconSvgWrapper.js'\n\nimport { useViewConfigStore } from '../store/viewConfig.ts'\nimport logger from '../logger.js'\nimport NavigationQuota from '../components/NavigationQuota.vue'\nimport SettingsModal from './Settings.vue'\n\nexport default {\n\tname: 'Navigation',\n\n\tcomponents: {\n\t\tCog,\n\t\tNavigationQuota,\n\t\tNcAppNavigation,\n\t\tNcAppNavigationItem,\n\t\tNcIconSvgWrapper,\n\t\tSettingsModal,\n\t},\n\n\tsetup() {\n\t\tconst viewConfigStore = useViewConfigStore()\n\t\treturn {\n\t\t\tviewConfigStore,\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tsettingsOpened: false,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tcurrentViewId() {\n\t\t\treturn this.$route?.params?.view || 'files'\n\t\t},\n\n\t\tcurrentView(): View {\n\t\t\treturn this.views.find(view => view.id === this.currentViewId)!\n\t\t},\n\n\t\tviews(): View[] {\n\t\t\treturn this.$navigation.views\n\t\t},\n\n\t\tparentViews(): View[] {\n\t\t\treturn this.views\n\t\t\t\t// filter child views\n\t\t\t\t.filter(view => !view.parent)\n\t\t\t\t// sort views by order\n\t\t\t\t.sort((a, b) => {\n\t\t\t\t\treturn a.order - b.order\n\t\t\t\t})\n\t\t},\n\n\t\tchildViews(): Record<string, View[]> {\n\t\t\treturn this.views\n\t\t\t\t// filter parent views\n\t\t\t\t.filter(view => !!view.parent)\n\t\t\t\t// create a map of parents and their children\n\t\t\t\t.reduce((list, view) => {\n\t\t\t\t\tlist[view.parent!] = [...(list[view.parent!] || []), view]\n\t\t\t\t\t// Sort children by order\n\t\t\t\t\tlist[view.parent!].sort((a, b) => {\n\t\t\t\t\t\treturn a.order - b.order\n\t\t\t\t\t})\n\t\t\t\t\treturn list\n\t\t\t\t}, {} as Record<string, View[]>)\n\t\t},\n\t},\n\n\twatch: {\n\t\tcurrentView(view, oldView) {\n\t\t\tif (view.id !== oldView?.id) {\n\t\t\t\tthis.$navigation.setActive(view)\n\t\t\t\tlogger.debug(`Navigation changed from ${oldView.id} to ${view.id}`, { from: oldView, to: view })\n\n\t\t\t\tthis.showView(view)\n\t\t\t}\n\t\t},\n\t},\n\n\tbeforeMount() {\n\t\tif (this.currentView) {\n\t\t\tlogger.debug('Navigation mounted. Showing requested view', { view: this.currentView })\n\t\t\tthis.showView(this.currentView)\n\t\t}\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * Only use exact route matching on routes with child views\n\t\t * Because if a view does not have children (like the files view) then multiple routes might be matched for it\n\t\t * Like for the 'files' view this does not work because of optional 'fileid' param so /files and /files/1234 are both in the 'files' view\n\t\t * @param view The view to check\n\t\t */\n\t\tuseExactRouteMatching(view: View): boolean {\n\t\t\treturn this.childViews[view.id]?.length > 0\n\t\t},\n\n\t\tshowView(view: View) {\n\t\t\t// Closing any opened sidebar\n\t\t\twindow?.OCA?.Files?.Sidebar?.close?.()\n\t\t\tthis.$navigation.setActive(view)\n\t\t\temit('files:navigation:changed', view)\n\t\t},\n\n\t\t/**\n\t\t * Expand/collapse a a view with children and permanently\n\t\t * save this setting in the server.\n\t\t * @param view View to toggle\n\t\t */\n\t\tonToggleExpand(view: View) {\n\t\t\t// Invert state\n\t\t\tconst isExpanded = this.isExpanded(view)\n\t\t\t// Update the view expanded state, might not be necessary\n\t\t\tview.expanded = !isExpanded\n\t\t\tthis.viewConfigStore.update(view.id, 'expanded', !isExpanded)\n\t\t},\n\n\t\t/**\n\t\t * Check if a view is expanded by user config\n\t\t * or fallback to the default value.\n\t\t * @param view View to check if expanded\n\t\t */\n\t\tisExpanded(view: View): boolean {\n\t\t\treturn typeof this.viewConfigStore.getConfig(view.id)?.expanded === 'boolean'\n\t\t\t\t? this.viewConfigStore.getConfig(view.id).expanded === true\n\t\t\t\t: view.expanded === true\n\t\t},\n\n\t\t/**\n\t\t * Generate the route to a view\n\t\t * @param view View to generate \"to\" navigation for\n\t\t */\n\t\tgenerateToNavigation(view: View) {\n\t\t\tif (view.params) {\n\t\t\t\tconst { dir } = view.params\n\t\t\t\treturn { name: 'filelist', params: view.params, query: { dir } }\n\t\t\t}\n\t\t\treturn { name: 'filelist', params: { view: view.id } }\n\t\t},\n\n\t\t/**\n\t\t * Open the settings modal\n\t\t */\n\t\topenSettings() {\n\t\t\tthis.settingsOpened = true\n\t\t},\n\n\t\t/**\n\t\t * Close the settings modal\n\t\t */\n\t\tonSettingsClose() {\n\t\t\tthis.settingsOpened = false\n\t\t},\n\n\t\tt: translate,\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n// TODO: remove when https://github.com/nextcloud/nextcloud-vue/pull/3539 is in\n.app-navigation::v-deep .app-navigation-entry-icon {\n\tbackground-repeat: no-repeat;\n\tbackground-position: center;\n}\n\n.app-navigation::v-deep .app-navigation-entry.active .button-vue.icon-collapse:not(:hover) {\n\tcolor: var(--color-primary-element-text);\n}\n\n.app-navigation > ul.app-navigation__list {\n\t// Use flex gap value for more elegant spacing\n\tpadding-bottom: var(--default-grid-baseline, 4px);\n}\n\n.app-navigation-entry__settings {\n\theight: auto !important;\n\toverflow: hidden !important;\n\tpadding-top: 0 !important;\n\t// Prevent shrinking or growing\n\tflex: 0 0 auto;\n}\n</style>\n","/**\n * natural-orderby v3.0.2\n *\n * Copyright (c) Olaf Ennen\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE.md file in the root directory of this source tree.\n *\n * @license MIT\n */\nvar compareNumbers = function compareNumbers(numberA, numberB) {\n  if (numberA < numberB) {\n    return -1;\n  }\n  if (numberA > numberB) {\n    return 1;\n  }\n  return 0;\n};\n\nvar compareUnicode = function compareUnicode(stringA, stringB) {\n  var result = stringA.localeCompare(stringB);\n  return result ? result / Math.abs(result) : 0;\n};\n\nvar RE_NUMBERS = /(^0x[\\da-fA-F]+$|^([+-]?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:[eE][+-]?\\d+)?(?!\\.\\d+)(?=\\D|\\s|$))|\\d+)/g;\nvar RE_LEADING_OR_TRAILING_WHITESPACES = /^\\s+|\\s+$/g; // trim pre-post whitespace\nvar RE_WHITESPACES = /\\s+/g; // normalize all whitespace to single ' ' character\nvar RE_INT_OR_FLOAT = /^[+-]?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:[eE][+-]?\\d+)?$/; // identify integers and floats\nvar RE_DATE = /(^([\\w ]+,?[\\w ]+)?[\\w ]+,?[\\w ]+\\d+:\\d+(:\\d+)?[\\w ]?|^\\d{1,4}[/-]\\d{1,4}[/-]\\d{1,4}|^\\w+, \\w+ \\d+, \\d{4})/; // identify date strings\nvar RE_LEADING_ZERO = /^0+[1-9]{1}[0-9]*$/;\n// eslint-disable-next-line no-control-regex\nvar RE_UNICODE_CHARACTERS = /[^\\x00-\\x80]/;\n\nvar stringCompare = function stringCompare(stringA, stringB) {\n  if (stringA < stringB) {\n    return -1;\n  }\n  if (stringA > stringB) {\n    return 1;\n  }\n  return 0;\n};\n\nvar compareChunks = function compareChunks(chunksA, chunksB) {\n  var lengthA = chunksA.length;\n  var lengthB = chunksB.length;\n  var size = Math.min(lengthA, lengthB);\n  for (var i = 0; i < size; i++) {\n    var chunkA = chunksA[i];\n    var chunkB = chunksB[i];\n    if (chunkA.normalizedString !== chunkB.normalizedString) {\n      if (chunkA.normalizedString === '' !== (chunkB.normalizedString === '')) {\n        // empty strings have lowest value\n        return chunkA.normalizedString === '' ? -1 : 1;\n      }\n      if (chunkA.parsedNumber !== undefined && chunkB.parsedNumber !== undefined) {\n        // compare numbers\n        var result = compareNumbers(chunkA.parsedNumber, chunkB.parsedNumber);\n        if (result === 0) {\n          // compare string value, if parsed numbers are equal\n          // Example:\n          // chunkA = { parsedNumber: 1, normalizedString: \"001\" }\n          // chunkB = { parsedNumber: 1, normalizedString: \"01\" }\n          // chunkA.parsedNumber === chunkB.parsedNumber\n          // chunkA.normalizedString < chunkB.normalizedString\n          return stringCompare(chunkA.normalizedString, chunkB.normalizedString);\n        }\n        return result;\n      } else if (chunkA.parsedNumber !== undefined || chunkB.parsedNumber !== undefined) {\n        // number < string\n        return chunkA.parsedNumber !== undefined ? -1 : 1;\n      } else if (RE_UNICODE_CHARACTERS.test(chunkA.normalizedString + chunkB.normalizedString)) {\n        // use locale comparison only if one of the chunks contains unicode characters\n        return compareUnicode(chunkA.normalizedString, chunkB.normalizedString);\n      } else {\n        // use common string comparison for performance reason\n        return stringCompare(chunkA.normalizedString, chunkB.normalizedString);\n      }\n    }\n  }\n  // if the chunks are equal so far, the one which has more chunks is greater than the other one\n  if (lengthA > size || lengthB > size) {\n    return lengthA <= size ? -1 : 1;\n  }\n  return 0;\n};\n\nvar compareOtherTypes = function compareOtherTypes(valueA, valueB) {\n  if (!valueA.chunks ? valueB.chunks : !valueB.chunks) {\n    return !valueA.chunks ? 1 : -1;\n  }\n  if (valueA.isNaN ? !valueB.isNaN : valueB.isNaN) {\n    return valueA.isNaN ? -1 : 1;\n  }\n  if (valueA.isSymbol ? !valueB.isSymbol : valueB.isSymbol) {\n    return valueA.isSymbol ? -1 : 1;\n  }\n  if (valueA.isObject ? !valueB.isObject : valueB.isObject) {\n    return valueA.isObject ? -1 : 1;\n  }\n  if (valueA.isArray ? !valueB.isArray : valueB.isArray) {\n    return valueA.isArray ? -1 : 1;\n  }\n  if (valueA.isFunction ? !valueB.isFunction : valueB.isFunction) {\n    return valueA.isFunction ? -1 : 1;\n  }\n  if (valueA.isNull ? !valueB.isNull : valueB.isNull) {\n    return valueA.isNull ? -1 : 1;\n  }\n  return 0;\n};\n\nvar compareValues = function compareValues(valueA, valueB) {\n  if (valueA.value === valueB.value) {\n    return 0;\n  }\n  if (valueA.parsedNumber !== undefined && valueB.parsedNumber !== undefined) {\n    return compareNumbers(valueA.parsedNumber, valueB.parsedNumber);\n  }\n  if (valueA.chunks && valueB.chunks) {\n    return compareChunks(valueA.chunks, valueB.chunks);\n  }\n  return compareOtherTypes(valueA, valueB);\n};\n\nvar normalizeAlphaChunk = function normalizeAlphaChunk(chunk) {\n  return chunk.replace(RE_WHITESPACES, ' ').replace(RE_LEADING_OR_TRAILING_WHITESPACES, '');\n};\n\nvar parseNumber = function parseNumber(value) {\n  if (value.length !== 0) {\n    var parsedNumber = Number(value);\n    if (!Number.isNaN(parsedNumber)) {\n      return parsedNumber;\n    }\n  }\n  return undefined;\n};\n\nvar normalizeNumericChunk = function normalizeNumericChunk(chunk, index, chunks) {\n  if (RE_INT_OR_FLOAT.test(chunk)) {\n    // don´t parse a number, if there´s a preceding decimal point\n    // to keep significance\n    // e.g. 1.0020, 1.020\n    if (!RE_LEADING_ZERO.test(chunk) || index === 0 || chunks[index - 1] !== '.') {\n      return parseNumber(chunk) || 0;\n    }\n  }\n  return undefined;\n};\n\nvar createChunkMap = function createChunkMap(chunk, index, chunks) {\n  return {\n    parsedNumber: normalizeNumericChunk(chunk, index, chunks),\n    normalizedString: normalizeAlphaChunk(chunk)\n  };\n};\n\nvar createChunks = function createChunks(value) {\n  return value.replace(RE_NUMBERS, '\\0$1\\0').replace(/\\0$/, '').replace(/^\\0/, '').split('\\0');\n};\n\nvar createChunkMaps = function createChunkMaps(value) {\n  var chunksMaps = createChunks(value).map(createChunkMap);\n  return chunksMaps;\n};\n\nvar isFunction = function isFunction(value) {\n  return typeof value === 'function';\n};\n\nvar isNaN = function isNaN(value) {\n  return Number.isNaN(value) || value instanceof Number && Number.isNaN(value.valueOf());\n};\n\nvar isNull = function isNull(value) {\n  return value === null;\n};\n\nvar isObject = function isObject(value) {\n  return value !== null && typeof value === 'object' && !Array.isArray(value) && !(value instanceof Number) && !(value instanceof String) && !(value instanceof Boolean) && !(value instanceof Date);\n};\n\nvar isSymbol = function isSymbol(value) {\n  return typeof value === 'symbol';\n};\n\nvar isUndefined = function isUndefined(value) {\n  return value === undefined;\n};\n\nvar parseDate = function parseDate(value) {\n  try {\n    var parsedDate = Date.parse(value);\n    if (!Number.isNaN(parsedDate)) {\n      if (RE_DATE.test(value)) {\n        return parsedDate;\n      }\n    }\n    return undefined;\n  } catch (_unused) {\n    return undefined;\n  }\n};\n\nvar numberify = function numberify(value) {\n  var parsedNumber = parseNumber(value);\n  if (parsedNumber !== undefined) {\n    return parsedNumber;\n  }\n  return parseDate(value);\n};\n\nvar stringify = function stringify(value) {\n  if (typeof value === 'boolean' || value instanceof Boolean) {\n    return Number(value).toString();\n  }\n  if (typeof value === 'number' || value instanceof Number) {\n    return value.toString();\n  }\n  if (value instanceof Date) {\n    return value.getTime().toString();\n  }\n  if (typeof value === 'string' || value instanceof String) {\n    return value.toLowerCase().replace(RE_LEADING_OR_TRAILING_WHITESPACES, '');\n  }\n  return '';\n};\n\nvar getMappedValueRecord = function getMappedValueRecord(value) {\n  if (typeof value === 'string' || value instanceof String || (typeof value === 'number' || value instanceof Number) && !isNaN(value) || typeof value === 'boolean' || value instanceof Boolean || value instanceof Date) {\n    var stringValue = stringify(value);\n    var parsedNumber = numberify(stringValue);\n    var chunks = createChunkMaps(parsedNumber ? \"\" + parsedNumber : stringValue);\n    return {\n      parsedNumber: parsedNumber,\n      chunks: chunks,\n      value: value\n    };\n  }\n  return {\n    isArray: Array.isArray(value),\n    isFunction: isFunction(value),\n    isNaN: isNaN(value),\n    isNull: isNull(value),\n    isObject: isObject(value),\n    isSymbol: isSymbol(value),\n    isUndefined: isUndefined(value),\n    value: value\n  };\n};\n\nvar baseCompare = function baseCompare(options) {\n  return function (valueA, valueB) {\n    var a = getMappedValueRecord(valueA);\n    var b = getMappedValueRecord(valueB);\n    var result = compareValues(a, b);\n    return result * (options.order === 'desc' ? -1 : 1);\n  };\n};\n\nvar isValidOrder = function isValidOrder(value) {\n  return typeof value === 'string' && (value === 'asc' || value === 'desc');\n};\nvar getOptions = function getOptions(customOptions) {\n  var order = 'asc';\n  if (typeof customOptions === 'string' && isValidOrder(customOptions)) {\n    order = customOptions;\n  } else if (customOptions && typeof customOptions === 'object' && customOptions.order && isValidOrder(customOptions.order)) {\n    order = customOptions.order;\n  }\n  return {\n    order: order\n  };\n};\n\n/**\n * Creates a compare function that defines the natural sort order considering\n * the given `options` which may be passed to [`Array.prototype.sort()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort).\n */\nfunction compare(options) {\n  var validatedOptions = getOptions(options);\n  return baseCompare(validatedOptions);\n}\n\nvar compareMultiple = function compareMultiple(recordA, recordB, orders) {\n  var indexA = recordA.index,\n    valuesA = recordA.values;\n  var indexB = recordB.index,\n    valuesB = recordB.values;\n  var length = valuesA.length;\n  var ordersLength = orders.length;\n  for (var i = 0; i < length; i++) {\n    var order = i < ordersLength ? orders[i] : null;\n    if (order && typeof order === 'function') {\n      var result = order(valuesA[i].value, valuesB[i].value);\n      if (result) {\n        return result;\n      }\n    } else {\n      var _result = compareValues(valuesA[i], valuesB[i]);\n      if (_result) {\n        return _result * (order === 'desc' ? -1 : 1);\n      }\n    }\n  }\n  return indexA - indexB;\n};\n\nvar createIdentifierFn = function createIdentifierFn(identifier) {\n  if (typeof identifier === 'function') {\n    // identifier is already a lookup function\n    return identifier;\n  }\n  return function (value) {\n    if (Array.isArray(value)) {\n      var index = Number(identifier);\n      if (Number.isInteger(index)) {\n        return value[index];\n      }\n    } else if (value && typeof value === 'object') {\n      var result = Object.getOwnPropertyDescriptor(value, identifier);\n      return result == null ? void 0 : result.value;\n    }\n    return value;\n  };\n};\n\nvar getElementByIndex = function getElementByIndex(collection, index) {\n  return collection[index];\n};\n\nvar getValueByIdentifier = function getValueByIdentifier(value, getValue) {\n  return getValue(value);\n};\n\nvar baseOrderBy = function baseOrderBy(collection, identifiers, orders) {\n  var identifierFns = identifiers.length ? identifiers.map(createIdentifierFn) : [function (value) {\n    return value;\n  }];\n\n  // temporary array holds elements with position and sort-values\n  var mappedCollection = collection.map(function (element, index) {\n    var values = identifierFns.map(function (identifier) {\n      return getValueByIdentifier(element, identifier);\n    }).map(getMappedValueRecord);\n    return {\n      index: index,\n      values: values\n    };\n  });\n\n  // iterate over values and compare values until a != b or last value reached\n  mappedCollection.sort(function (recordA, recordB) {\n    return compareMultiple(recordA, recordB, orders);\n  });\n  return mappedCollection.map(function (element) {\n    return getElementByIndex(collection, element.index);\n  });\n};\n\nvar getIdentifiers = function getIdentifiers(identifiers) {\n  if (!identifiers) {\n    return [];\n  }\n  var identifierList = !Array.isArray(identifiers) ? [identifiers] : [].concat(identifiers);\n  if (identifierList.some(function (identifier) {\n    return typeof identifier !== 'string' && typeof identifier !== 'number' && typeof identifier !== 'function';\n  })) {\n    return [];\n  }\n  return identifierList;\n};\n\nvar getOrders = function getOrders(orders) {\n  if (!orders) {\n    return [];\n  }\n  var orderList = !Array.isArray(orders) ? [orders] : [].concat(orders);\n  if (orderList.some(function (order) {\n    return order !== 'asc' && order !== 'desc' && typeof order !== 'function';\n  })) {\n    return [];\n  }\n  return orderList;\n};\n\n/**\n * Creates an array of elements, natural sorted by specified identifiers and\n * the corresponding sort orders. This method implements a stable sort\n * algorithm, which means the original sort order of equal elements is\n * preserved.\n */\nfunction orderBy(collection, identifiers, orders) {\n  if (!collection || !Array.isArray(collection)) {\n    return [];\n  }\n  var validatedIdentifiers = getIdentifiers(identifiers);\n  var validatedOrders = getOrders(orders);\n  return baseOrderBy(collection, validatedIdentifiers, validatedOrders);\n}\n\nexport { compare, orderBy };\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  exports.defaults = {\n    \"0.1\": {\n      explicitCharkey: false,\n      trim: true,\n      normalize: true,\n      normalizeTags: false,\n      attrkey: \"@\",\n      charkey: \"#\",\n      explicitArray: false,\n      ignoreAttrs: false,\n      mergeAttrs: false,\n      explicitRoot: false,\n      validator: null,\n      xmlns: false,\n      explicitChildren: false,\n      childkey: '@@',\n      charsAsChildren: false,\n      includeWhiteChars: false,\n      async: false,\n      strict: true,\n      attrNameProcessors: null,\n      attrValueProcessors: null,\n      tagNameProcessors: null,\n      valueProcessors: null,\n      emptyTag: ''\n    },\n    \"0.2\": {\n      explicitCharkey: false,\n      trim: false,\n      normalize: false,\n      normalizeTags: false,\n      attrkey: \"$\",\n      charkey: \"_\",\n      explicitArray: true,\n      ignoreAttrs: false,\n      mergeAttrs: false,\n      explicitRoot: true,\n      validator: null,\n      xmlns: false,\n      explicitChildren: false,\n      preserveChildrenOrder: false,\n      childkey: '$$',\n      charsAsChildren: false,\n      includeWhiteChars: false,\n      async: false,\n      strict: true,\n      attrNameProcessors: null,\n      attrValueProcessors: null,\n      tagNameProcessors: null,\n      valueProcessors: null,\n      rootName: 'root',\n      xmldec: {\n        'version': '1.0',\n        'encoding': 'UTF-8',\n        'standalone': true\n      },\n      doctype: null,\n      renderOpts: {\n        'pretty': true,\n        'indent': '  ',\n        'newline': '\\n'\n      },\n      headless: false,\n      chunkSize: 10000,\n      emptyTag: '',\n      cdata: false\n    }\n  };\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var assign, getValue, isArray, isEmpty, isFunction, isObject, isPlainObject,\n    slice = [].slice,\n    hasProp = {}.hasOwnProperty;\n\n  assign = function() {\n    var i, key, len, source, sources, target;\n    target = arguments[0], sources = 2 <= arguments.length ? slice.call(arguments, 1) : [];\n    if (isFunction(Object.assign)) {\n      Object.assign.apply(null, arguments);\n    } else {\n      for (i = 0, len = sources.length; i < len; i++) {\n        source = sources[i];\n        if (source != null) {\n          for (key in source) {\n            if (!hasProp.call(source, key)) continue;\n            target[key] = source[key];\n          }\n        }\n      }\n    }\n    return target;\n  };\n\n  isFunction = function(val) {\n    return !!val && Object.prototype.toString.call(val) === '[object Function]';\n  };\n\n  isObject = function(val) {\n    var ref;\n    return !!val && ((ref = typeof val) === 'function' || ref === 'object');\n  };\n\n  isArray = function(val) {\n    if (isFunction(Array.isArray)) {\n      return Array.isArray(val);\n    } else {\n      return Object.prototype.toString.call(val) === '[object Array]';\n    }\n  };\n\n  isEmpty = function(val) {\n    var key;\n    if (isArray(val)) {\n      return !val.length;\n    } else {\n      for (key in val) {\n        if (!hasProp.call(val, key)) continue;\n        return false;\n      }\n      return true;\n    }\n  };\n\n  isPlainObject = function(val) {\n    var ctor, proto;\n    return isObject(val) && (proto = Object.getPrototypeOf(val)) && (ctor = proto.constructor) && (typeof ctor === 'function') && (ctor instanceof ctor) && (Function.prototype.toString.call(ctor) === Function.prototype.toString.call(Object));\n  };\n\n  getValue = function(obj) {\n    if (isFunction(obj.valueOf)) {\n      return obj.valueOf();\n    } else {\n      return obj;\n    }\n  };\n\n  module.exports.assign = assign;\n\n  module.exports.isFunction = isFunction;\n\n  module.exports.isObject = isObject;\n\n  module.exports.isArray = isArray;\n\n  module.exports.isEmpty = isEmpty;\n\n  module.exports.isPlainObject = isPlainObject;\n\n  module.exports.getValue = getValue;\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var XMLDOMImplementation;\n\n  module.exports = XMLDOMImplementation = (function() {\n    function XMLDOMImplementation() {}\n\n    XMLDOMImplementation.prototype.hasFeature = function(feature, version) {\n      return true;\n    };\n\n    XMLDOMImplementation.prototype.createDocumentType = function(qualifiedName, publicId, systemId) {\n      throw new Error(\"This DOM method is not implemented.\");\n    };\n\n    XMLDOMImplementation.prototype.createDocument = function(namespaceURI, qualifiedName, doctype) {\n      throw new Error(\"This DOM method is not implemented.\");\n    };\n\n    XMLDOMImplementation.prototype.createHTMLDocument = function(title) {\n      throw new Error(\"This DOM method is not implemented.\");\n    };\n\n    XMLDOMImplementation.prototype.getFeature = function(feature, version) {\n      throw new Error(\"This DOM method is not implemented.\");\n    };\n\n    return XMLDOMImplementation;\n\n  })();\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var XMLDOMErrorHandler;\n\n  module.exports = XMLDOMErrorHandler = (function() {\n    function XMLDOMErrorHandler() {}\n\n    XMLDOMErrorHandler.prototype.handleError = function(error) {\n      throw new Error(error);\n    };\n\n    return XMLDOMErrorHandler;\n\n  })();\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var XMLDOMStringList;\n\n  module.exports = XMLDOMStringList = (function() {\n    function XMLDOMStringList(arr) {\n      this.arr = arr || [];\n    }\n\n    Object.defineProperty(XMLDOMStringList.prototype, 'length', {\n      get: function() {\n        return this.arr.length;\n      }\n    });\n\n    XMLDOMStringList.prototype.item = function(index) {\n      return this.arr[index] || null;\n    };\n\n    XMLDOMStringList.prototype.contains = function(str) {\n      return this.arr.indexOf(str) !== -1;\n    };\n\n    return XMLDOMStringList;\n\n  })();\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var XMLDOMConfiguration, XMLDOMErrorHandler, XMLDOMStringList;\n\n  XMLDOMErrorHandler = require('./XMLDOMErrorHandler');\n\n  XMLDOMStringList = require('./XMLDOMStringList');\n\n  module.exports = XMLDOMConfiguration = (function() {\n    function XMLDOMConfiguration() {\n      var clonedSelf;\n      this.defaultParams = {\n        \"canonical-form\": false,\n        \"cdata-sections\": false,\n        \"comments\": false,\n        \"datatype-normalization\": false,\n        \"element-content-whitespace\": true,\n        \"entities\": true,\n        \"error-handler\": new XMLDOMErrorHandler(),\n        \"infoset\": true,\n        \"validate-if-schema\": false,\n        \"namespaces\": true,\n        \"namespace-declarations\": true,\n        \"normalize-characters\": false,\n        \"schema-location\": '',\n        \"schema-type\": '',\n        \"split-cdata-sections\": true,\n        \"validate\": false,\n        \"well-formed\": true\n      };\n      this.params = clonedSelf = Object.create(this.defaultParams);\n    }\n\n    Object.defineProperty(XMLDOMConfiguration.prototype, 'parameterNames', {\n      get: function() {\n        return new XMLDOMStringList(Object.keys(this.defaultParams));\n      }\n    });\n\n    XMLDOMConfiguration.prototype.getParameter = function(name) {\n      if (this.params.hasOwnProperty(name)) {\n        return this.params[name];\n      } else {\n        return null;\n      }\n    };\n\n    XMLDOMConfiguration.prototype.canSetParameter = function(name, value) {\n      return true;\n    };\n\n    XMLDOMConfiguration.prototype.setParameter = function(name, value) {\n      if (value != null) {\n        return this.params[name] = value;\n      } else {\n        return delete this.params[name];\n      }\n    };\n\n    return XMLDOMConfiguration;\n\n  })();\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  module.exports = {\n    Element: 1,\n    Attribute: 2,\n    Text: 3,\n    CData: 4,\n    EntityReference: 5,\n    EntityDeclaration: 6,\n    ProcessingInstruction: 7,\n    Comment: 8,\n    Document: 9,\n    DocType: 10,\n    DocumentFragment: 11,\n    NotationDeclaration: 12,\n    Declaration: 201,\n    Raw: 202,\n    AttributeDeclaration: 203,\n    ElementDeclaration: 204,\n    Dummy: 205\n  };\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLAttribute, XMLNode;\n\n  NodeType = require('./NodeType');\n\n  XMLNode = require('./XMLNode');\n\n  module.exports = XMLAttribute = (function() {\n    function XMLAttribute(parent, name, value) {\n      this.parent = parent;\n      if (this.parent) {\n        this.options = this.parent.options;\n        this.stringify = this.parent.stringify;\n      }\n      if (name == null) {\n        throw new Error(\"Missing attribute name. \" + this.debugInfo(name));\n      }\n      this.name = this.stringify.name(name);\n      this.value = this.stringify.attValue(value);\n      this.type = NodeType.Attribute;\n      this.isId = false;\n      this.schemaTypeInfo = null;\n    }\n\n    Object.defineProperty(XMLAttribute.prototype, 'nodeType', {\n      get: function() {\n        return this.type;\n      }\n    });\n\n    Object.defineProperty(XMLAttribute.prototype, 'ownerElement', {\n      get: function() {\n        return this.parent;\n      }\n    });\n\n    Object.defineProperty(XMLAttribute.prototype, 'textContent', {\n      get: function() {\n        return this.value;\n      },\n      set: function(value) {\n        return this.value = value || '';\n      }\n    });\n\n    Object.defineProperty(XMLAttribute.prototype, 'namespaceURI', {\n      get: function() {\n        return '';\n      }\n    });\n\n    Object.defineProperty(XMLAttribute.prototype, 'prefix', {\n      get: function() {\n        return '';\n      }\n    });\n\n    Object.defineProperty(XMLAttribute.prototype, 'localName', {\n      get: function() {\n        return this.name;\n      }\n    });\n\n    Object.defineProperty(XMLAttribute.prototype, 'specified', {\n      get: function() {\n        return true;\n      }\n    });\n\n    XMLAttribute.prototype.clone = function() {\n      return Object.create(this);\n    };\n\n    XMLAttribute.prototype.toString = function(options) {\n      return this.options.writer.attribute(this, this.options.writer.filterOptions(options));\n    };\n\n    XMLAttribute.prototype.debugInfo = function(name) {\n      name = name || this.name;\n      if (name == null) {\n        return \"parent: <\" + this.parent.name + \">\";\n      } else {\n        return \"attribute: {\" + name + \"}, parent: <\" + this.parent.name + \">\";\n      }\n    };\n\n    XMLAttribute.prototype.isEqualNode = function(node) {\n      if (node.namespaceURI !== this.namespaceURI) {\n        return false;\n      }\n      if (node.prefix !== this.prefix) {\n        return false;\n      }\n      if (node.localName !== this.localName) {\n        return false;\n      }\n      if (node.value !== this.value) {\n        return false;\n      }\n      return true;\n    };\n\n    return XMLAttribute;\n\n  })();\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var XMLNamedNodeMap;\n\n  module.exports = XMLNamedNodeMap = (function() {\n    function XMLNamedNodeMap(nodes) {\n      this.nodes = nodes;\n    }\n\n    Object.defineProperty(XMLNamedNodeMap.prototype, 'length', {\n      get: function() {\n        return Object.keys(this.nodes).length || 0;\n      }\n    });\n\n    XMLNamedNodeMap.prototype.clone = function() {\n      return this.nodes = null;\n    };\n\n    XMLNamedNodeMap.prototype.getNamedItem = function(name) {\n      return this.nodes[name];\n    };\n\n    XMLNamedNodeMap.prototype.setNamedItem = function(node) {\n      var oldNode;\n      oldNode = this.nodes[node.nodeName];\n      this.nodes[node.nodeName] = node;\n      return oldNode || null;\n    };\n\n    XMLNamedNodeMap.prototype.removeNamedItem = function(name) {\n      var oldNode;\n      oldNode = this.nodes[name];\n      delete this.nodes[name];\n      return oldNode || null;\n    };\n\n    XMLNamedNodeMap.prototype.item = function(index) {\n      return this.nodes[Object.keys(this.nodes)[index]] || null;\n    };\n\n    XMLNamedNodeMap.prototype.getNamedItemNS = function(namespaceURI, localName) {\n      throw new Error(\"This DOM method is not implemented.\");\n    };\n\n    XMLNamedNodeMap.prototype.setNamedItemNS = function(node) {\n      throw new Error(\"This DOM method is not implemented.\");\n    };\n\n    XMLNamedNodeMap.prototype.removeNamedItemNS = function(namespaceURI, localName) {\n      throw new Error(\"This DOM method is not implemented.\");\n    };\n\n    return XMLNamedNodeMap;\n\n  })();\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLAttribute, XMLElement, XMLNamedNodeMap, XMLNode, getValue, isFunction, isObject, ref,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  ref = require('./Utility'), isObject = ref.isObject, isFunction = ref.isFunction, getValue = ref.getValue;\n\n  XMLNode = require('./XMLNode');\n\n  NodeType = require('./NodeType');\n\n  XMLAttribute = require('./XMLAttribute');\n\n  XMLNamedNodeMap = require('./XMLNamedNodeMap');\n\n  module.exports = XMLElement = (function(superClass) {\n    extend(XMLElement, superClass);\n\n    function XMLElement(parent, name, attributes) {\n      var child, j, len, ref1;\n      XMLElement.__super__.constructor.call(this, parent);\n      if (name == null) {\n        throw new Error(\"Missing element name. \" + this.debugInfo());\n      }\n      this.name = this.stringify.name(name);\n      this.type = NodeType.Element;\n      this.attribs = {};\n      this.schemaTypeInfo = null;\n      if (attributes != null) {\n        this.attribute(attributes);\n      }\n      if (parent.type === NodeType.Document) {\n        this.isRoot = true;\n        this.documentObject = parent;\n        parent.rootObject = this;\n        if (parent.children) {\n          ref1 = parent.children;\n          for (j = 0, len = ref1.length; j < len; j++) {\n            child = ref1[j];\n            if (child.type === NodeType.DocType) {\n              child.name = this.name;\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    Object.defineProperty(XMLElement.prototype, 'tagName', {\n      get: function() {\n        return this.name;\n      }\n    });\n\n    Object.defineProperty(XMLElement.prototype, 'namespaceURI', {\n      get: function() {\n        return '';\n      }\n    });\n\n    Object.defineProperty(XMLElement.prototype, 'prefix', {\n      get: function() {\n        return '';\n      }\n    });\n\n    Object.defineProperty(XMLElement.prototype, 'localName', {\n      get: function() {\n        return this.name;\n      }\n    });\n\n    Object.defineProperty(XMLElement.prototype, 'id', {\n      get: function() {\n        throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n      }\n    });\n\n    Object.defineProperty(XMLElement.prototype, 'className', {\n      get: function() {\n        throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n      }\n    });\n\n    Object.defineProperty(XMLElement.prototype, 'classList', {\n      get: function() {\n        throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n      }\n    });\n\n    Object.defineProperty(XMLElement.prototype, 'attributes', {\n      get: function() {\n        if (!this.attributeMap || !this.attributeMap.nodes) {\n          this.attributeMap = new XMLNamedNodeMap(this.attribs);\n        }\n        return this.attributeMap;\n      }\n    });\n\n    XMLElement.prototype.clone = function() {\n      var att, attName, clonedSelf, ref1;\n      clonedSelf = Object.create(this);\n      if (clonedSelf.isRoot) {\n        clonedSelf.documentObject = null;\n      }\n      clonedSelf.attribs = {};\n      ref1 = this.attribs;\n      for (attName in ref1) {\n        if (!hasProp.call(ref1, attName)) continue;\n        att = ref1[attName];\n        clonedSelf.attribs[attName] = att.clone();\n      }\n      clonedSelf.children = [];\n      this.children.forEach(function(child) {\n        var clonedChild;\n        clonedChild = child.clone();\n        clonedChild.parent = clonedSelf;\n        return clonedSelf.children.push(clonedChild);\n      });\n      return clonedSelf;\n    };\n\n    XMLElement.prototype.attribute = function(name, value) {\n      var attName, attValue;\n      if (name != null) {\n        name = getValue(name);\n      }\n      if (isObject(name)) {\n        for (attName in name) {\n          if (!hasProp.call(name, attName)) continue;\n          attValue = name[attName];\n          this.attribute(attName, attValue);\n        }\n      } else {\n        if (isFunction(value)) {\n          value = value.apply();\n        }\n        if (this.options.keepNullAttributes && (value == null)) {\n          this.attribs[name] = new XMLAttribute(this, name, \"\");\n        } else if (value != null) {\n          this.attribs[name] = new XMLAttribute(this, name, value);\n        }\n      }\n      return this;\n    };\n\n    XMLElement.prototype.removeAttribute = function(name) {\n      var attName, j, len;\n      if (name == null) {\n        throw new Error(\"Missing attribute name. \" + this.debugInfo());\n      }\n      name = getValue(name);\n      if (Array.isArray(name)) {\n        for (j = 0, len = name.length; j < len; j++) {\n          attName = name[j];\n          delete this.attribs[attName];\n        }\n      } else {\n        delete this.attribs[name];\n      }\n      return this;\n    };\n\n    XMLElement.prototype.toString = function(options) {\n      return this.options.writer.element(this, this.options.writer.filterOptions(options));\n    };\n\n    XMLElement.prototype.att = function(name, value) {\n      return this.attribute(name, value);\n    };\n\n    XMLElement.prototype.a = function(name, value) {\n      return this.attribute(name, value);\n    };\n\n    XMLElement.prototype.getAttribute = function(name) {\n      if (this.attribs.hasOwnProperty(name)) {\n        return this.attribs[name].value;\n      } else {\n        return null;\n      }\n    };\n\n    XMLElement.prototype.setAttribute = function(name, value) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.getAttributeNode = function(name) {\n      if (this.attribs.hasOwnProperty(name)) {\n        return this.attribs[name];\n      } else {\n        return null;\n      }\n    };\n\n    XMLElement.prototype.setAttributeNode = function(newAttr) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.removeAttributeNode = function(oldAttr) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.getElementsByTagName = function(name) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.getAttributeNS = function(namespaceURI, localName) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.setAttributeNS = function(namespaceURI, qualifiedName, value) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.removeAttributeNS = function(namespaceURI, localName) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.getAttributeNodeNS = function(namespaceURI, localName) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.setAttributeNodeNS = function(newAttr) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.getElementsByTagNameNS = function(namespaceURI, localName) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.hasAttribute = function(name) {\n      return this.attribs.hasOwnProperty(name);\n    };\n\n    XMLElement.prototype.hasAttributeNS = function(namespaceURI, localName) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.setIdAttribute = function(name, isId) {\n      if (this.attribs.hasOwnProperty(name)) {\n        return this.attribs[name].isId;\n      } else {\n        return isId;\n      }\n    };\n\n    XMLElement.prototype.setIdAttributeNS = function(namespaceURI, localName, isId) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.setIdAttributeNode = function(idAttr, isId) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.getElementsByTagName = function(tagname) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.getElementsByTagNameNS = function(namespaceURI, localName) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.getElementsByClassName = function(classNames) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLElement.prototype.isEqualNode = function(node) {\n      var i, j, ref1;\n      if (!XMLElement.__super__.isEqualNode.apply(this, arguments).isEqualNode(node)) {\n        return false;\n      }\n      if (node.namespaceURI !== this.namespaceURI) {\n        return false;\n      }\n      if (node.prefix !== this.prefix) {\n        return false;\n      }\n      if (node.localName !== this.localName) {\n        return false;\n      }\n      if (node.attribs.length !== this.attribs.length) {\n        return false;\n      }\n      for (i = j = 0, ref1 = this.attribs.length - 1; 0 <= ref1 ? j <= ref1 : j >= ref1; i = 0 <= ref1 ? ++j : --j) {\n        if (!this.attribs[i].isEqualNode(node.attribs[i])) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n    return XMLElement;\n\n  })(XMLNode);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var XMLCharacterData, XMLNode,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  XMLNode = require('./XMLNode');\n\n  module.exports = XMLCharacterData = (function(superClass) {\n    extend(XMLCharacterData, superClass);\n\n    function XMLCharacterData(parent) {\n      XMLCharacterData.__super__.constructor.call(this, parent);\n      this.value = '';\n    }\n\n    Object.defineProperty(XMLCharacterData.prototype, 'data', {\n      get: function() {\n        return this.value;\n      },\n      set: function(value) {\n        return this.value = value || '';\n      }\n    });\n\n    Object.defineProperty(XMLCharacterData.prototype, 'length', {\n      get: function() {\n        return this.value.length;\n      }\n    });\n\n    Object.defineProperty(XMLCharacterData.prototype, 'textContent', {\n      get: function() {\n        return this.value;\n      },\n      set: function(value) {\n        return this.value = value || '';\n      }\n    });\n\n    XMLCharacterData.prototype.clone = function() {\n      return Object.create(this);\n    };\n\n    XMLCharacterData.prototype.substringData = function(offset, count) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLCharacterData.prototype.appendData = function(arg) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLCharacterData.prototype.insertData = function(offset, arg) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLCharacterData.prototype.deleteData = function(offset, count) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLCharacterData.prototype.replaceData = function(offset, count, arg) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLCharacterData.prototype.isEqualNode = function(node) {\n      if (!XMLCharacterData.__super__.isEqualNode.apply(this, arguments).isEqualNode(node)) {\n        return false;\n      }\n      if (node.data !== this.data) {\n        return false;\n      }\n      return true;\n    };\n\n    return XMLCharacterData;\n\n  })(XMLNode);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLCData, XMLCharacterData,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  NodeType = require('./NodeType');\n\n  XMLCharacterData = require('./XMLCharacterData');\n\n  module.exports = XMLCData = (function(superClass) {\n    extend(XMLCData, superClass);\n\n    function XMLCData(parent, text) {\n      XMLCData.__super__.constructor.call(this, parent);\n      if (text == null) {\n        throw new Error(\"Missing CDATA text. \" + this.debugInfo());\n      }\n      this.name = \"#cdata-section\";\n      this.type = NodeType.CData;\n      this.value = this.stringify.cdata(text);\n    }\n\n    XMLCData.prototype.clone = function() {\n      return Object.create(this);\n    };\n\n    XMLCData.prototype.toString = function(options) {\n      return this.options.writer.cdata(this, this.options.writer.filterOptions(options));\n    };\n\n    return XMLCData;\n\n  })(XMLCharacterData);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLCharacterData, XMLComment,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  NodeType = require('./NodeType');\n\n  XMLCharacterData = require('./XMLCharacterData');\n\n  module.exports = XMLComment = (function(superClass) {\n    extend(XMLComment, superClass);\n\n    function XMLComment(parent, text) {\n      XMLComment.__super__.constructor.call(this, parent);\n      if (text == null) {\n        throw new Error(\"Missing comment text. \" + this.debugInfo());\n      }\n      this.name = \"#comment\";\n      this.type = NodeType.Comment;\n      this.value = this.stringify.comment(text);\n    }\n\n    XMLComment.prototype.clone = function() {\n      return Object.create(this);\n    };\n\n    XMLComment.prototype.toString = function(options) {\n      return this.options.writer.comment(this, this.options.writer.filterOptions(options));\n    };\n\n    return XMLComment;\n\n  })(XMLCharacterData);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLDeclaration, XMLNode, isObject,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  isObject = require('./Utility').isObject;\n\n  XMLNode = require('./XMLNode');\n\n  NodeType = require('./NodeType');\n\n  module.exports = XMLDeclaration = (function(superClass) {\n    extend(XMLDeclaration, superClass);\n\n    function XMLDeclaration(parent, version, encoding, standalone) {\n      var ref;\n      XMLDeclaration.__super__.constructor.call(this, parent);\n      if (isObject(version)) {\n        ref = version, version = ref.version, encoding = ref.encoding, standalone = ref.standalone;\n      }\n      if (!version) {\n        version = '1.0';\n      }\n      this.type = NodeType.Declaration;\n      this.version = this.stringify.xmlVersion(version);\n      if (encoding != null) {\n        this.encoding = this.stringify.xmlEncoding(encoding);\n      }\n      if (standalone != null) {\n        this.standalone = this.stringify.xmlStandalone(standalone);\n      }\n    }\n\n    XMLDeclaration.prototype.toString = function(options) {\n      return this.options.writer.declaration(this, this.options.writer.filterOptions(options));\n    };\n\n    return XMLDeclaration;\n\n  })(XMLNode);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLDTDAttList, XMLNode,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  XMLNode = require('./XMLNode');\n\n  NodeType = require('./NodeType');\n\n  module.exports = XMLDTDAttList = (function(superClass) {\n    extend(XMLDTDAttList, superClass);\n\n    function XMLDTDAttList(parent, elementName, attributeName, attributeType, defaultValueType, defaultValue) {\n      XMLDTDAttList.__super__.constructor.call(this, parent);\n      if (elementName == null) {\n        throw new Error(\"Missing DTD element name. \" + this.debugInfo());\n      }\n      if (attributeName == null) {\n        throw new Error(\"Missing DTD attribute name. \" + this.debugInfo(elementName));\n      }\n      if (!attributeType) {\n        throw new Error(\"Missing DTD attribute type. \" + this.debugInfo(elementName));\n      }\n      if (!defaultValueType) {\n        throw new Error(\"Missing DTD attribute default. \" + this.debugInfo(elementName));\n      }\n      if (defaultValueType.indexOf('#') !== 0) {\n        defaultValueType = '#' + defaultValueType;\n      }\n      if (!defaultValueType.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/)) {\n        throw new Error(\"Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. \" + this.debugInfo(elementName));\n      }\n      if (defaultValue && !defaultValueType.match(/^(#FIXED|#DEFAULT)$/)) {\n        throw new Error(\"Default value only applies to #FIXED or #DEFAULT. \" + this.debugInfo(elementName));\n      }\n      this.elementName = this.stringify.name(elementName);\n      this.type = NodeType.AttributeDeclaration;\n      this.attributeName = this.stringify.name(attributeName);\n      this.attributeType = this.stringify.dtdAttType(attributeType);\n      if (defaultValue) {\n        this.defaultValue = this.stringify.dtdAttDefault(defaultValue);\n      }\n      this.defaultValueType = defaultValueType;\n    }\n\n    XMLDTDAttList.prototype.toString = function(options) {\n      return this.options.writer.dtdAttList(this, this.options.writer.filterOptions(options));\n    };\n\n    return XMLDTDAttList;\n\n  })(XMLNode);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLDTDEntity, XMLNode, isObject,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  isObject = require('./Utility').isObject;\n\n  XMLNode = require('./XMLNode');\n\n  NodeType = require('./NodeType');\n\n  module.exports = XMLDTDEntity = (function(superClass) {\n    extend(XMLDTDEntity, superClass);\n\n    function XMLDTDEntity(parent, pe, name, value) {\n      XMLDTDEntity.__super__.constructor.call(this, parent);\n      if (name == null) {\n        throw new Error(\"Missing DTD entity name. \" + this.debugInfo(name));\n      }\n      if (value == null) {\n        throw new Error(\"Missing DTD entity value. \" + this.debugInfo(name));\n      }\n      this.pe = !!pe;\n      this.name = this.stringify.name(name);\n      this.type = NodeType.EntityDeclaration;\n      if (!isObject(value)) {\n        this.value = this.stringify.dtdEntityValue(value);\n        this.internal = true;\n      } else {\n        if (!value.pubID && !value.sysID) {\n          throw new Error(\"Public and/or system identifiers are required for an external entity. \" + this.debugInfo(name));\n        }\n        if (value.pubID && !value.sysID) {\n          throw new Error(\"System identifier is required for a public external entity. \" + this.debugInfo(name));\n        }\n        this.internal = false;\n        if (value.pubID != null) {\n          this.pubID = this.stringify.dtdPubID(value.pubID);\n        }\n        if (value.sysID != null) {\n          this.sysID = this.stringify.dtdSysID(value.sysID);\n        }\n        if (value.nData != null) {\n          this.nData = this.stringify.dtdNData(value.nData);\n        }\n        if (this.pe && this.nData) {\n          throw new Error(\"Notation declaration is not allowed in a parameter entity. \" + this.debugInfo(name));\n        }\n      }\n    }\n\n    Object.defineProperty(XMLDTDEntity.prototype, 'publicId', {\n      get: function() {\n        return this.pubID;\n      }\n    });\n\n    Object.defineProperty(XMLDTDEntity.prototype, 'systemId', {\n      get: function() {\n        return this.sysID;\n      }\n    });\n\n    Object.defineProperty(XMLDTDEntity.prototype, 'notationName', {\n      get: function() {\n        return this.nData || null;\n      }\n    });\n\n    Object.defineProperty(XMLDTDEntity.prototype, 'inputEncoding', {\n      get: function() {\n        return null;\n      }\n    });\n\n    Object.defineProperty(XMLDTDEntity.prototype, 'xmlEncoding', {\n      get: function() {\n        return null;\n      }\n    });\n\n    Object.defineProperty(XMLDTDEntity.prototype, 'xmlVersion', {\n      get: function() {\n        return null;\n      }\n    });\n\n    XMLDTDEntity.prototype.toString = function(options) {\n      return this.options.writer.dtdEntity(this, this.options.writer.filterOptions(options));\n    };\n\n    return XMLDTDEntity;\n\n  })(XMLNode);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLDTDElement, XMLNode,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  XMLNode = require('./XMLNode');\n\n  NodeType = require('./NodeType');\n\n  module.exports = XMLDTDElement = (function(superClass) {\n    extend(XMLDTDElement, superClass);\n\n    function XMLDTDElement(parent, name, value) {\n      XMLDTDElement.__super__.constructor.call(this, parent);\n      if (name == null) {\n        throw new Error(\"Missing DTD element name. \" + this.debugInfo());\n      }\n      if (!value) {\n        value = '(#PCDATA)';\n      }\n      if (Array.isArray(value)) {\n        value = '(' + value.join(',') + ')';\n      }\n      this.name = this.stringify.name(name);\n      this.type = NodeType.ElementDeclaration;\n      this.value = this.stringify.dtdElementValue(value);\n    }\n\n    XMLDTDElement.prototype.toString = function(options) {\n      return this.options.writer.dtdElement(this, this.options.writer.filterOptions(options));\n    };\n\n    return XMLDTDElement;\n\n  })(XMLNode);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLDTDNotation, XMLNode,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  XMLNode = require('./XMLNode');\n\n  NodeType = require('./NodeType');\n\n  module.exports = XMLDTDNotation = (function(superClass) {\n    extend(XMLDTDNotation, superClass);\n\n    function XMLDTDNotation(parent, name, value) {\n      XMLDTDNotation.__super__.constructor.call(this, parent);\n      if (name == null) {\n        throw new Error(\"Missing DTD notation name. \" + this.debugInfo(name));\n      }\n      if (!value.pubID && !value.sysID) {\n        throw new Error(\"Public or system identifiers are required for an external entity. \" + this.debugInfo(name));\n      }\n      this.name = this.stringify.name(name);\n      this.type = NodeType.NotationDeclaration;\n      if (value.pubID != null) {\n        this.pubID = this.stringify.dtdPubID(value.pubID);\n      }\n      if (value.sysID != null) {\n        this.sysID = this.stringify.dtdSysID(value.sysID);\n      }\n    }\n\n    Object.defineProperty(XMLDTDNotation.prototype, 'publicId', {\n      get: function() {\n        return this.pubID;\n      }\n    });\n\n    Object.defineProperty(XMLDTDNotation.prototype, 'systemId', {\n      get: function() {\n        return this.sysID;\n      }\n    });\n\n    XMLDTDNotation.prototype.toString = function(options) {\n      return this.options.writer.dtdNotation(this, this.options.writer.filterOptions(options));\n    };\n\n    return XMLDTDNotation;\n\n  })(XMLNode);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLDTDAttList, XMLDTDElement, XMLDTDEntity, XMLDTDNotation, XMLDocType, XMLNamedNodeMap, XMLNode, isObject,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  isObject = require('./Utility').isObject;\n\n  XMLNode = require('./XMLNode');\n\n  NodeType = require('./NodeType');\n\n  XMLDTDAttList = require('./XMLDTDAttList');\n\n  XMLDTDEntity = require('./XMLDTDEntity');\n\n  XMLDTDElement = require('./XMLDTDElement');\n\n  XMLDTDNotation = require('./XMLDTDNotation');\n\n  XMLNamedNodeMap = require('./XMLNamedNodeMap');\n\n  module.exports = XMLDocType = (function(superClass) {\n    extend(XMLDocType, superClass);\n\n    function XMLDocType(parent, pubID, sysID) {\n      var child, i, len, ref, ref1, ref2;\n      XMLDocType.__super__.constructor.call(this, parent);\n      this.type = NodeType.DocType;\n      if (parent.children) {\n        ref = parent.children;\n        for (i = 0, len = ref.length; i < len; i++) {\n          child = ref[i];\n          if (child.type === NodeType.Element) {\n            this.name = child.name;\n            break;\n          }\n        }\n      }\n      this.documentObject = parent;\n      if (isObject(pubID)) {\n        ref1 = pubID, pubID = ref1.pubID, sysID = ref1.sysID;\n      }\n      if (sysID == null) {\n        ref2 = [pubID, sysID], sysID = ref2[0], pubID = ref2[1];\n      }\n      if (pubID != null) {\n        this.pubID = this.stringify.dtdPubID(pubID);\n      }\n      if (sysID != null) {\n        this.sysID = this.stringify.dtdSysID(sysID);\n      }\n    }\n\n    Object.defineProperty(XMLDocType.prototype, 'entities', {\n      get: function() {\n        var child, i, len, nodes, ref;\n        nodes = {};\n        ref = this.children;\n        for (i = 0, len = ref.length; i < len; i++) {\n          child = ref[i];\n          if ((child.type === NodeType.EntityDeclaration) && !child.pe) {\n            nodes[child.name] = child;\n          }\n        }\n        return new XMLNamedNodeMap(nodes);\n      }\n    });\n\n    Object.defineProperty(XMLDocType.prototype, 'notations', {\n      get: function() {\n        var child, i, len, nodes, ref;\n        nodes = {};\n        ref = this.children;\n        for (i = 0, len = ref.length; i < len; i++) {\n          child = ref[i];\n          if (child.type === NodeType.NotationDeclaration) {\n            nodes[child.name] = child;\n          }\n        }\n        return new XMLNamedNodeMap(nodes);\n      }\n    });\n\n    Object.defineProperty(XMLDocType.prototype, 'publicId', {\n      get: function() {\n        return this.pubID;\n      }\n    });\n\n    Object.defineProperty(XMLDocType.prototype, 'systemId', {\n      get: function() {\n        return this.sysID;\n      }\n    });\n\n    Object.defineProperty(XMLDocType.prototype, 'internalSubset', {\n      get: function() {\n        throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n      }\n    });\n\n    XMLDocType.prototype.element = function(name, value) {\n      var child;\n      child = new XMLDTDElement(this, name, value);\n      this.children.push(child);\n      return this;\n    };\n\n    XMLDocType.prototype.attList = function(elementName, attributeName, attributeType, defaultValueType, defaultValue) {\n      var child;\n      child = new XMLDTDAttList(this, elementName, attributeName, attributeType, defaultValueType, defaultValue);\n      this.children.push(child);\n      return this;\n    };\n\n    XMLDocType.prototype.entity = function(name, value) {\n      var child;\n      child = new XMLDTDEntity(this, false, name, value);\n      this.children.push(child);\n      return this;\n    };\n\n    XMLDocType.prototype.pEntity = function(name, value) {\n      var child;\n      child = new XMLDTDEntity(this, true, name, value);\n      this.children.push(child);\n      return this;\n    };\n\n    XMLDocType.prototype.notation = function(name, value) {\n      var child;\n      child = new XMLDTDNotation(this, name, value);\n      this.children.push(child);\n      return this;\n    };\n\n    XMLDocType.prototype.toString = function(options) {\n      return this.options.writer.docType(this, this.options.writer.filterOptions(options));\n    };\n\n    XMLDocType.prototype.ele = function(name, value) {\n      return this.element(name, value);\n    };\n\n    XMLDocType.prototype.att = function(elementName, attributeName, attributeType, defaultValueType, defaultValue) {\n      return this.attList(elementName, attributeName, attributeType, defaultValueType, defaultValue);\n    };\n\n    XMLDocType.prototype.ent = function(name, value) {\n      return this.entity(name, value);\n    };\n\n    XMLDocType.prototype.pent = function(name, value) {\n      return this.pEntity(name, value);\n    };\n\n    XMLDocType.prototype.not = function(name, value) {\n      return this.notation(name, value);\n    };\n\n    XMLDocType.prototype.up = function() {\n      return this.root() || this.documentObject;\n    };\n\n    XMLDocType.prototype.isEqualNode = function(node) {\n      if (!XMLDocType.__super__.isEqualNode.apply(this, arguments).isEqualNode(node)) {\n        return false;\n      }\n      if (node.name !== this.name) {\n        return false;\n      }\n      if (node.publicId !== this.publicId) {\n        return false;\n      }\n      if (node.systemId !== this.systemId) {\n        return false;\n      }\n      return true;\n    };\n\n    return XMLDocType;\n\n  })(XMLNode);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLNode, XMLRaw,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  NodeType = require('./NodeType');\n\n  XMLNode = require('./XMLNode');\n\n  module.exports = XMLRaw = (function(superClass) {\n    extend(XMLRaw, superClass);\n\n    function XMLRaw(parent, text) {\n      XMLRaw.__super__.constructor.call(this, parent);\n      if (text == null) {\n        throw new Error(\"Missing raw text. \" + this.debugInfo());\n      }\n      this.type = NodeType.Raw;\n      this.value = this.stringify.raw(text);\n    }\n\n    XMLRaw.prototype.clone = function() {\n      return Object.create(this);\n    };\n\n    XMLRaw.prototype.toString = function(options) {\n      return this.options.writer.raw(this, this.options.writer.filterOptions(options));\n    };\n\n    return XMLRaw;\n\n  })(XMLNode);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLCharacterData, XMLText,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  NodeType = require('./NodeType');\n\n  XMLCharacterData = require('./XMLCharacterData');\n\n  module.exports = XMLText = (function(superClass) {\n    extend(XMLText, superClass);\n\n    function XMLText(parent, text) {\n      XMLText.__super__.constructor.call(this, parent);\n      if (text == null) {\n        throw new Error(\"Missing element text. \" + this.debugInfo());\n      }\n      this.name = \"#text\";\n      this.type = NodeType.Text;\n      this.value = this.stringify.text(text);\n    }\n\n    Object.defineProperty(XMLText.prototype, 'isElementContentWhitespace', {\n      get: function() {\n        throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n      }\n    });\n\n    Object.defineProperty(XMLText.prototype, 'wholeText', {\n      get: function() {\n        var next, prev, str;\n        str = '';\n        prev = this.previousSibling;\n        while (prev) {\n          str = prev.data + str;\n          prev = prev.previousSibling;\n        }\n        str += this.data;\n        next = this.nextSibling;\n        while (next) {\n          str = str + next.data;\n          next = next.nextSibling;\n        }\n        return str;\n      }\n    });\n\n    XMLText.prototype.clone = function() {\n      return Object.create(this);\n    };\n\n    XMLText.prototype.toString = function(options) {\n      return this.options.writer.text(this, this.options.writer.filterOptions(options));\n    };\n\n    XMLText.prototype.splitText = function(offset) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLText.prototype.replaceWholeText = function(content) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    return XMLText;\n\n  })(XMLCharacterData);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLCharacterData, XMLProcessingInstruction,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  NodeType = require('./NodeType');\n\n  XMLCharacterData = require('./XMLCharacterData');\n\n  module.exports = XMLProcessingInstruction = (function(superClass) {\n    extend(XMLProcessingInstruction, superClass);\n\n    function XMLProcessingInstruction(parent, target, value) {\n      XMLProcessingInstruction.__super__.constructor.call(this, parent);\n      if (target == null) {\n        throw new Error(\"Missing instruction target. \" + this.debugInfo());\n      }\n      this.type = NodeType.ProcessingInstruction;\n      this.target = this.stringify.insTarget(target);\n      this.name = this.target;\n      if (value) {\n        this.value = this.stringify.insValue(value);\n      }\n    }\n\n    XMLProcessingInstruction.prototype.clone = function() {\n      return Object.create(this);\n    };\n\n    XMLProcessingInstruction.prototype.toString = function(options) {\n      return this.options.writer.processingInstruction(this, this.options.writer.filterOptions(options));\n    };\n\n    XMLProcessingInstruction.prototype.isEqualNode = function(node) {\n      if (!XMLProcessingInstruction.__super__.isEqualNode.apply(this, arguments).isEqualNode(node)) {\n        return false;\n      }\n      if (node.target !== this.target) {\n        return false;\n      }\n      return true;\n    };\n\n    return XMLProcessingInstruction;\n\n  })(XMLCharacterData);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLDummy, XMLNode,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  XMLNode = require('./XMLNode');\n\n  NodeType = require('./NodeType');\n\n  module.exports = XMLDummy = (function(superClass) {\n    extend(XMLDummy, superClass);\n\n    function XMLDummy(parent) {\n      XMLDummy.__super__.constructor.call(this, parent);\n      this.type = NodeType.Dummy;\n    }\n\n    XMLDummy.prototype.clone = function() {\n      return Object.create(this);\n    };\n\n    XMLDummy.prototype.toString = function(options) {\n      return '';\n    };\n\n    return XMLDummy;\n\n  })(XMLNode);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var XMLNodeList;\n\n  module.exports = XMLNodeList = (function() {\n    function XMLNodeList(nodes) {\n      this.nodes = nodes;\n    }\n\n    Object.defineProperty(XMLNodeList.prototype, 'length', {\n      get: function() {\n        return this.nodes.length || 0;\n      }\n    });\n\n    XMLNodeList.prototype.clone = function() {\n      return this.nodes = null;\n    };\n\n    XMLNodeList.prototype.item = function(index) {\n      return this.nodes[index] || null;\n    };\n\n    return XMLNodeList;\n\n  })();\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  module.exports = {\n    Disconnected: 1,\n    Preceding: 2,\n    Following: 4,\n    Contains: 8,\n    ContainedBy: 16,\n    ImplementationSpecific: 32\n  };\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var DocumentPosition, NodeType, XMLCData, XMLComment, XMLDeclaration, XMLDocType, XMLDummy, XMLElement, XMLNamedNodeMap, XMLNode, XMLNodeList, XMLProcessingInstruction, XMLRaw, XMLText, getValue, isEmpty, isFunction, isObject, ref1,\n    hasProp = {}.hasOwnProperty;\n\n  ref1 = require('./Utility'), isObject = ref1.isObject, isFunction = ref1.isFunction, isEmpty = ref1.isEmpty, getValue = ref1.getValue;\n\n  XMLElement = null;\n\n  XMLCData = null;\n\n  XMLComment = null;\n\n  XMLDeclaration = null;\n\n  XMLDocType = null;\n\n  XMLRaw = null;\n\n  XMLText = null;\n\n  XMLProcessingInstruction = null;\n\n  XMLDummy = null;\n\n  NodeType = null;\n\n  XMLNodeList = null;\n\n  XMLNamedNodeMap = null;\n\n  DocumentPosition = null;\n\n  module.exports = XMLNode = (function() {\n    function XMLNode(parent1) {\n      this.parent = parent1;\n      if (this.parent) {\n        this.options = this.parent.options;\n        this.stringify = this.parent.stringify;\n      }\n      this.value = null;\n      this.children = [];\n      this.baseURI = null;\n      if (!XMLElement) {\n        XMLElement = require('./XMLElement');\n        XMLCData = require('./XMLCData');\n        XMLComment = require('./XMLComment');\n        XMLDeclaration = require('./XMLDeclaration');\n        XMLDocType = require('./XMLDocType');\n        XMLRaw = require('./XMLRaw');\n        XMLText = require('./XMLText');\n        XMLProcessingInstruction = require('./XMLProcessingInstruction');\n        XMLDummy = require('./XMLDummy');\n        NodeType = require('./NodeType');\n        XMLNodeList = require('./XMLNodeList');\n        XMLNamedNodeMap = require('./XMLNamedNodeMap');\n        DocumentPosition = require('./DocumentPosition');\n      }\n    }\n\n    Object.defineProperty(XMLNode.prototype, 'nodeName', {\n      get: function() {\n        return this.name;\n      }\n    });\n\n    Object.defineProperty(XMLNode.prototype, 'nodeType', {\n      get: function() {\n        return this.type;\n      }\n    });\n\n    Object.defineProperty(XMLNode.prototype, 'nodeValue', {\n      get: function() {\n        return this.value;\n      }\n    });\n\n    Object.defineProperty(XMLNode.prototype, 'parentNode', {\n      get: function() {\n        return this.parent;\n      }\n    });\n\n    Object.defineProperty(XMLNode.prototype, 'childNodes', {\n      get: function() {\n        if (!this.childNodeList || !this.childNodeList.nodes) {\n          this.childNodeList = new XMLNodeList(this.children);\n        }\n        return this.childNodeList;\n      }\n    });\n\n    Object.defineProperty(XMLNode.prototype, 'firstChild', {\n      get: function() {\n        return this.children[0] || null;\n      }\n    });\n\n    Object.defineProperty(XMLNode.prototype, 'lastChild', {\n      get: function() {\n        return this.children[this.children.length - 1] || null;\n      }\n    });\n\n    Object.defineProperty(XMLNode.prototype, 'previousSibling', {\n      get: function() {\n        var i;\n        i = this.parent.children.indexOf(this);\n        return this.parent.children[i - 1] || null;\n      }\n    });\n\n    Object.defineProperty(XMLNode.prototype, 'nextSibling', {\n      get: function() {\n        var i;\n        i = this.parent.children.indexOf(this);\n        return this.parent.children[i + 1] || null;\n      }\n    });\n\n    Object.defineProperty(XMLNode.prototype, 'ownerDocument', {\n      get: function() {\n        return this.document() || null;\n      }\n    });\n\n    Object.defineProperty(XMLNode.prototype, 'textContent', {\n      get: function() {\n        var child, j, len, ref2, str;\n        if (this.nodeType === NodeType.Element || this.nodeType === NodeType.DocumentFragment) {\n          str = '';\n          ref2 = this.children;\n          for (j = 0, len = ref2.length; j < len; j++) {\n            child = ref2[j];\n            if (child.textContent) {\n              str += child.textContent;\n            }\n          }\n          return str;\n        } else {\n          return null;\n        }\n      },\n      set: function(value) {\n        throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n      }\n    });\n\n    XMLNode.prototype.setParent = function(parent) {\n      var child, j, len, ref2, results;\n      this.parent = parent;\n      if (parent) {\n        this.options = parent.options;\n        this.stringify = parent.stringify;\n      }\n      ref2 = this.children;\n      results = [];\n      for (j = 0, len = ref2.length; j < len; j++) {\n        child = ref2[j];\n        results.push(child.setParent(this));\n      }\n      return results;\n    };\n\n    XMLNode.prototype.element = function(name, attributes, text) {\n      var childNode, item, j, k, key, lastChild, len, len1, ref2, ref3, val;\n      lastChild = null;\n      if (attributes === null && (text == null)) {\n        ref2 = [{}, null], attributes = ref2[0], text = ref2[1];\n      }\n      if (attributes == null) {\n        attributes = {};\n      }\n      attributes = getValue(attributes);\n      if (!isObject(attributes)) {\n        ref3 = [attributes, text], text = ref3[0], attributes = ref3[1];\n      }\n      if (name != null) {\n        name = getValue(name);\n      }\n      if (Array.isArray(name)) {\n        for (j = 0, len = name.length; j < len; j++) {\n          item = name[j];\n          lastChild = this.element(item);\n        }\n      } else if (isFunction(name)) {\n        lastChild = this.element(name.apply());\n      } else if (isObject(name)) {\n        for (key in name) {\n          if (!hasProp.call(name, key)) continue;\n          val = name[key];\n          if (isFunction(val)) {\n            val = val.apply();\n          }\n          if (!this.options.ignoreDecorators && this.stringify.convertAttKey && key.indexOf(this.stringify.convertAttKey) === 0) {\n            lastChild = this.attribute(key.substr(this.stringify.convertAttKey.length), val);\n          } else if (!this.options.separateArrayItems && Array.isArray(val) && isEmpty(val)) {\n            lastChild = this.dummy();\n          } else if (isObject(val) && isEmpty(val)) {\n            lastChild = this.element(key);\n          } else if (!this.options.keepNullNodes && (val == null)) {\n            lastChild = this.dummy();\n          } else if (!this.options.separateArrayItems && Array.isArray(val)) {\n            for (k = 0, len1 = val.length; k < len1; k++) {\n              item = val[k];\n              childNode = {};\n              childNode[key] = item;\n              lastChild = this.element(childNode);\n            }\n          } else if (isObject(val)) {\n            if (!this.options.ignoreDecorators && this.stringify.convertTextKey && key.indexOf(this.stringify.convertTextKey) === 0) {\n              lastChild = this.element(val);\n            } else {\n              lastChild = this.element(key);\n              lastChild.element(val);\n            }\n          } else {\n            lastChild = this.element(key, val);\n          }\n        }\n      } else if (!this.options.keepNullNodes && text === null) {\n        lastChild = this.dummy();\n      } else {\n        if (!this.options.ignoreDecorators && this.stringify.convertTextKey && name.indexOf(this.stringify.convertTextKey) === 0) {\n          lastChild = this.text(text);\n        } else if (!this.options.ignoreDecorators && this.stringify.convertCDataKey && name.indexOf(this.stringify.convertCDataKey) === 0) {\n          lastChild = this.cdata(text);\n        } else if (!this.options.ignoreDecorators && this.stringify.convertCommentKey && name.indexOf(this.stringify.convertCommentKey) === 0) {\n          lastChild = this.comment(text);\n        } else if (!this.options.ignoreDecorators && this.stringify.convertRawKey && name.indexOf(this.stringify.convertRawKey) === 0) {\n          lastChild = this.raw(text);\n        } else if (!this.options.ignoreDecorators && this.stringify.convertPIKey && name.indexOf(this.stringify.convertPIKey) === 0) {\n          lastChild = this.instruction(name.substr(this.stringify.convertPIKey.length), text);\n        } else {\n          lastChild = this.node(name, attributes, text);\n        }\n      }\n      if (lastChild == null) {\n        throw new Error(\"Could not create any elements with: \" + name + \". \" + this.debugInfo());\n      }\n      return lastChild;\n    };\n\n    XMLNode.prototype.insertBefore = function(name, attributes, text) {\n      var child, i, newChild, refChild, removed;\n      if (name != null ? name.type : void 0) {\n        newChild = name;\n        refChild = attributes;\n        newChild.setParent(this);\n        if (refChild) {\n          i = children.indexOf(refChild);\n          removed = children.splice(i);\n          children.push(newChild);\n          Array.prototype.push.apply(children, removed);\n        } else {\n          children.push(newChild);\n        }\n        return newChild;\n      } else {\n        if (this.isRoot) {\n          throw new Error(\"Cannot insert elements at root level. \" + this.debugInfo(name));\n        }\n        i = this.parent.children.indexOf(this);\n        removed = this.parent.children.splice(i);\n        child = this.parent.element(name, attributes, text);\n        Array.prototype.push.apply(this.parent.children, removed);\n        return child;\n      }\n    };\n\n    XMLNode.prototype.insertAfter = function(name, attributes, text) {\n      var child, i, removed;\n      if (this.isRoot) {\n        throw new Error(\"Cannot insert elements at root level. \" + this.debugInfo(name));\n      }\n      i = this.parent.children.indexOf(this);\n      removed = this.parent.children.splice(i + 1);\n      child = this.parent.element(name, attributes, text);\n      Array.prototype.push.apply(this.parent.children, removed);\n      return child;\n    };\n\n    XMLNode.prototype.remove = function() {\n      var i, ref2;\n      if (this.isRoot) {\n        throw new Error(\"Cannot remove the root element. \" + this.debugInfo());\n      }\n      i = this.parent.children.indexOf(this);\n      [].splice.apply(this.parent.children, [i, i - i + 1].concat(ref2 = [])), ref2;\n      return this.parent;\n    };\n\n    XMLNode.prototype.node = function(name, attributes, text) {\n      var child, ref2;\n      if (name != null) {\n        name = getValue(name);\n      }\n      attributes || (attributes = {});\n      attributes = getValue(attributes);\n      if (!isObject(attributes)) {\n        ref2 = [attributes, text], text = ref2[0], attributes = ref2[1];\n      }\n      child = new XMLElement(this, name, attributes);\n      if (text != null) {\n        child.text(text);\n      }\n      this.children.push(child);\n      return child;\n    };\n\n    XMLNode.prototype.text = function(value) {\n      var child;\n      if (isObject(value)) {\n        this.element(value);\n      }\n      child = new XMLText(this, value);\n      this.children.push(child);\n      return this;\n    };\n\n    XMLNode.prototype.cdata = function(value) {\n      var child;\n      child = new XMLCData(this, value);\n      this.children.push(child);\n      return this;\n    };\n\n    XMLNode.prototype.comment = function(value) {\n      var child;\n      child = new XMLComment(this, value);\n      this.children.push(child);\n      return this;\n    };\n\n    XMLNode.prototype.commentBefore = function(value) {\n      var child, i, removed;\n      i = this.parent.children.indexOf(this);\n      removed = this.parent.children.splice(i);\n      child = this.parent.comment(value);\n      Array.prototype.push.apply(this.parent.children, removed);\n      return this;\n    };\n\n    XMLNode.prototype.commentAfter = function(value) {\n      var child, i, removed;\n      i = this.parent.children.indexOf(this);\n      removed = this.parent.children.splice(i + 1);\n      child = this.parent.comment(value);\n      Array.prototype.push.apply(this.parent.children, removed);\n      return this;\n    };\n\n    XMLNode.prototype.raw = function(value) {\n      var child;\n      child = new XMLRaw(this, value);\n      this.children.push(child);\n      return this;\n    };\n\n    XMLNode.prototype.dummy = function() {\n      var child;\n      child = new XMLDummy(this);\n      return child;\n    };\n\n    XMLNode.prototype.instruction = function(target, value) {\n      var insTarget, insValue, instruction, j, len;\n      if (target != null) {\n        target = getValue(target);\n      }\n      if (value != null) {\n        value = getValue(value);\n      }\n      if (Array.isArray(target)) {\n        for (j = 0, len = target.length; j < len; j++) {\n          insTarget = target[j];\n          this.instruction(insTarget);\n        }\n      } else if (isObject(target)) {\n        for (insTarget in target) {\n          if (!hasProp.call(target, insTarget)) continue;\n          insValue = target[insTarget];\n          this.instruction(insTarget, insValue);\n        }\n      } else {\n        if (isFunction(value)) {\n          value = value.apply();\n        }\n        instruction = new XMLProcessingInstruction(this, target, value);\n        this.children.push(instruction);\n      }\n      return this;\n    };\n\n    XMLNode.prototype.instructionBefore = function(target, value) {\n      var child, i, removed;\n      i = this.parent.children.indexOf(this);\n      removed = this.parent.children.splice(i);\n      child = this.parent.instruction(target, value);\n      Array.prototype.push.apply(this.parent.children, removed);\n      return this;\n    };\n\n    XMLNode.prototype.instructionAfter = function(target, value) {\n      var child, i, removed;\n      i = this.parent.children.indexOf(this);\n      removed = this.parent.children.splice(i + 1);\n      child = this.parent.instruction(target, value);\n      Array.prototype.push.apply(this.parent.children, removed);\n      return this;\n    };\n\n    XMLNode.prototype.declaration = function(version, encoding, standalone) {\n      var doc, xmldec;\n      doc = this.document();\n      xmldec = new XMLDeclaration(doc, version, encoding, standalone);\n      if (doc.children.length === 0) {\n        doc.children.unshift(xmldec);\n      } else if (doc.children[0].type === NodeType.Declaration) {\n        doc.children[0] = xmldec;\n      } else {\n        doc.children.unshift(xmldec);\n      }\n      return doc.root() || doc;\n    };\n\n    XMLNode.prototype.dtd = function(pubID, sysID) {\n      var child, doc, doctype, i, j, k, len, len1, ref2, ref3;\n      doc = this.document();\n      doctype = new XMLDocType(doc, pubID, sysID);\n      ref2 = doc.children;\n      for (i = j = 0, len = ref2.length; j < len; i = ++j) {\n        child = ref2[i];\n        if (child.type === NodeType.DocType) {\n          doc.children[i] = doctype;\n          return doctype;\n        }\n      }\n      ref3 = doc.children;\n      for (i = k = 0, len1 = ref3.length; k < len1; i = ++k) {\n        child = ref3[i];\n        if (child.isRoot) {\n          doc.children.splice(i, 0, doctype);\n          return doctype;\n        }\n      }\n      doc.children.push(doctype);\n      return doctype;\n    };\n\n    XMLNode.prototype.up = function() {\n      if (this.isRoot) {\n        throw new Error(\"The root node has no parent. Use doc() if you need to get the document object.\");\n      }\n      return this.parent;\n    };\n\n    XMLNode.prototype.root = function() {\n      var node;\n      node = this;\n      while (node) {\n        if (node.type === NodeType.Document) {\n          return node.rootObject;\n        } else if (node.isRoot) {\n          return node;\n        } else {\n          node = node.parent;\n        }\n      }\n    };\n\n    XMLNode.prototype.document = function() {\n      var node;\n      node = this;\n      while (node) {\n        if (node.type === NodeType.Document) {\n          return node;\n        } else {\n          node = node.parent;\n        }\n      }\n    };\n\n    XMLNode.prototype.end = function(options) {\n      return this.document().end(options);\n    };\n\n    XMLNode.prototype.prev = function() {\n      var i;\n      i = this.parent.children.indexOf(this);\n      if (i < 1) {\n        throw new Error(\"Already at the first node. \" + this.debugInfo());\n      }\n      return this.parent.children[i - 1];\n    };\n\n    XMLNode.prototype.next = function() {\n      var i;\n      i = this.parent.children.indexOf(this);\n      if (i === -1 || i === this.parent.children.length - 1) {\n        throw new Error(\"Already at the last node. \" + this.debugInfo());\n      }\n      return this.parent.children[i + 1];\n    };\n\n    XMLNode.prototype.importDocument = function(doc) {\n      var clonedRoot;\n      clonedRoot = doc.root().clone();\n      clonedRoot.parent = this;\n      clonedRoot.isRoot = false;\n      this.children.push(clonedRoot);\n      return this;\n    };\n\n    XMLNode.prototype.debugInfo = function(name) {\n      var ref2, ref3;\n      name = name || this.name;\n      if ((name == null) && !((ref2 = this.parent) != null ? ref2.name : void 0)) {\n        return \"\";\n      } else if (name == null) {\n        return \"parent: <\" + this.parent.name + \">\";\n      } else if (!((ref3 = this.parent) != null ? ref3.name : void 0)) {\n        return \"node: <\" + name + \">\";\n      } else {\n        return \"node: <\" + name + \">, parent: <\" + this.parent.name + \">\";\n      }\n    };\n\n    XMLNode.prototype.ele = function(name, attributes, text) {\n      return this.element(name, attributes, text);\n    };\n\n    XMLNode.prototype.nod = function(name, attributes, text) {\n      return this.node(name, attributes, text);\n    };\n\n    XMLNode.prototype.txt = function(value) {\n      return this.text(value);\n    };\n\n    XMLNode.prototype.dat = function(value) {\n      return this.cdata(value);\n    };\n\n    XMLNode.prototype.com = function(value) {\n      return this.comment(value);\n    };\n\n    XMLNode.prototype.ins = function(target, value) {\n      return this.instruction(target, value);\n    };\n\n    XMLNode.prototype.doc = function() {\n      return this.document();\n    };\n\n    XMLNode.prototype.dec = function(version, encoding, standalone) {\n      return this.declaration(version, encoding, standalone);\n    };\n\n    XMLNode.prototype.e = function(name, attributes, text) {\n      return this.element(name, attributes, text);\n    };\n\n    XMLNode.prototype.n = function(name, attributes, text) {\n      return this.node(name, attributes, text);\n    };\n\n    XMLNode.prototype.t = function(value) {\n      return this.text(value);\n    };\n\n    XMLNode.prototype.d = function(value) {\n      return this.cdata(value);\n    };\n\n    XMLNode.prototype.c = function(value) {\n      return this.comment(value);\n    };\n\n    XMLNode.prototype.r = function(value) {\n      return this.raw(value);\n    };\n\n    XMLNode.prototype.i = function(target, value) {\n      return this.instruction(target, value);\n    };\n\n    XMLNode.prototype.u = function() {\n      return this.up();\n    };\n\n    XMLNode.prototype.importXMLBuilder = function(doc) {\n      return this.importDocument(doc);\n    };\n\n    XMLNode.prototype.replaceChild = function(newChild, oldChild) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLNode.prototype.removeChild = function(oldChild) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLNode.prototype.appendChild = function(newChild) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLNode.prototype.hasChildNodes = function() {\n      return this.children.length !== 0;\n    };\n\n    XMLNode.prototype.cloneNode = function(deep) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLNode.prototype.normalize = function() {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLNode.prototype.isSupported = function(feature, version) {\n      return true;\n    };\n\n    XMLNode.prototype.hasAttributes = function() {\n      return this.attribs.length !== 0;\n    };\n\n    XMLNode.prototype.compareDocumentPosition = function(other) {\n      var ref, res;\n      ref = this;\n      if (ref === other) {\n        return 0;\n      } else if (this.document() !== other.document()) {\n        res = DocumentPosition.Disconnected | DocumentPosition.ImplementationSpecific;\n        if (Math.random() < 0.5) {\n          res |= DocumentPosition.Preceding;\n        } else {\n          res |= DocumentPosition.Following;\n        }\n        return res;\n      } else if (ref.isAncestor(other)) {\n        return DocumentPosition.Contains | DocumentPosition.Preceding;\n      } else if (ref.isDescendant(other)) {\n        return DocumentPosition.Contains | DocumentPosition.Following;\n      } else if (ref.isPreceding(other)) {\n        return DocumentPosition.Preceding;\n      } else {\n        return DocumentPosition.Following;\n      }\n    };\n\n    XMLNode.prototype.isSameNode = function(other) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLNode.prototype.lookupPrefix = function(namespaceURI) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLNode.prototype.isDefaultNamespace = function(namespaceURI) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLNode.prototype.lookupNamespaceURI = function(prefix) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLNode.prototype.isEqualNode = function(node) {\n      var i, j, ref2;\n      if (node.nodeType !== this.nodeType) {\n        return false;\n      }\n      if (node.children.length !== this.children.length) {\n        return false;\n      }\n      for (i = j = 0, ref2 = this.children.length - 1; 0 <= ref2 ? j <= ref2 : j >= ref2; i = 0 <= ref2 ? ++j : --j) {\n        if (!this.children[i].isEqualNode(node.children[i])) {\n          return false;\n        }\n      }\n      return true;\n    };\n\n    XMLNode.prototype.getFeature = function(feature, version) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLNode.prototype.setUserData = function(key, data, handler) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLNode.prototype.getUserData = function(key) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLNode.prototype.contains = function(other) {\n      if (!other) {\n        return false;\n      }\n      return other === this || this.isDescendant(other);\n    };\n\n    XMLNode.prototype.isDescendant = function(node) {\n      var child, isDescendantChild, j, len, ref2;\n      ref2 = this.children;\n      for (j = 0, len = ref2.length; j < len; j++) {\n        child = ref2[j];\n        if (node === child) {\n          return true;\n        }\n        isDescendantChild = child.isDescendant(node);\n        if (isDescendantChild) {\n          return true;\n        }\n      }\n      return false;\n    };\n\n    XMLNode.prototype.isAncestor = function(node) {\n      return node.isDescendant(this);\n    };\n\n    XMLNode.prototype.isPreceding = function(node) {\n      var nodePos, thisPos;\n      nodePos = this.treePosition(node);\n      thisPos = this.treePosition(this);\n      if (nodePos === -1 || thisPos === -1) {\n        return false;\n      } else {\n        return nodePos < thisPos;\n      }\n    };\n\n    XMLNode.prototype.isFollowing = function(node) {\n      var nodePos, thisPos;\n      nodePos = this.treePosition(node);\n      thisPos = this.treePosition(this);\n      if (nodePos === -1 || thisPos === -1) {\n        return false;\n      } else {\n        return nodePos > thisPos;\n      }\n    };\n\n    XMLNode.prototype.treePosition = function(node) {\n      var found, pos;\n      pos = 0;\n      found = false;\n      this.foreachTreeNode(this.document(), function(childNode) {\n        pos++;\n        if (!found && childNode === node) {\n          return found = true;\n        }\n      });\n      if (found) {\n        return pos;\n      } else {\n        return -1;\n      }\n    };\n\n    XMLNode.prototype.foreachTreeNode = function(node, func) {\n      var child, j, len, ref2, res;\n      node || (node = this.document());\n      ref2 = node.children;\n      for (j = 0, len = ref2.length; j < len; j++) {\n        child = ref2[j];\n        if (res = func(child)) {\n          return res;\n        } else {\n          res = this.foreachTreeNode(child, func);\n          if (res) {\n            return res;\n          }\n        }\n      }\n    };\n\n    return XMLNode;\n\n  })();\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var XMLStringifier,\n    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n    hasProp = {}.hasOwnProperty;\n\n  module.exports = XMLStringifier = (function() {\n    function XMLStringifier(options) {\n      this.assertLegalName = bind(this.assertLegalName, this);\n      this.assertLegalChar = bind(this.assertLegalChar, this);\n      var key, ref, value;\n      options || (options = {});\n      this.options = options;\n      if (!this.options.version) {\n        this.options.version = '1.0';\n      }\n      ref = options.stringify || {};\n      for (key in ref) {\n        if (!hasProp.call(ref, key)) continue;\n        value = ref[key];\n        this[key] = value;\n      }\n    }\n\n    XMLStringifier.prototype.name = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      return this.assertLegalName('' + val || '');\n    };\n\n    XMLStringifier.prototype.text = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      return this.assertLegalChar(this.textEscape('' + val || ''));\n    };\n\n    XMLStringifier.prototype.cdata = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      val = '' + val || '';\n      val = val.replace(']]>', ']]]]><![CDATA[>');\n      return this.assertLegalChar(val);\n    };\n\n    XMLStringifier.prototype.comment = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      val = '' + val || '';\n      if (val.match(/--/)) {\n        throw new Error(\"Comment text cannot contain double-hypen: \" + val);\n      }\n      return this.assertLegalChar(val);\n    };\n\n    XMLStringifier.prototype.raw = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      return '' + val || '';\n    };\n\n    XMLStringifier.prototype.attValue = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      return this.assertLegalChar(this.attEscape(val = '' + val || ''));\n    };\n\n    XMLStringifier.prototype.insTarget = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      return this.assertLegalChar('' + val || '');\n    };\n\n    XMLStringifier.prototype.insValue = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      val = '' + val || '';\n      if (val.match(/\\?>/)) {\n        throw new Error(\"Invalid processing instruction value: \" + val);\n      }\n      return this.assertLegalChar(val);\n    };\n\n    XMLStringifier.prototype.xmlVersion = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      val = '' + val || '';\n      if (!val.match(/1\\.[0-9]+/)) {\n        throw new Error(\"Invalid version number: \" + val);\n      }\n      return val;\n    };\n\n    XMLStringifier.prototype.xmlEncoding = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      val = '' + val || '';\n      if (!val.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/)) {\n        throw new Error(\"Invalid encoding: \" + val);\n      }\n      return this.assertLegalChar(val);\n    };\n\n    XMLStringifier.prototype.xmlStandalone = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      if (val) {\n        return \"yes\";\n      } else {\n        return \"no\";\n      }\n    };\n\n    XMLStringifier.prototype.dtdPubID = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      return this.assertLegalChar('' + val || '');\n    };\n\n    XMLStringifier.prototype.dtdSysID = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      return this.assertLegalChar('' + val || '');\n    };\n\n    XMLStringifier.prototype.dtdElementValue = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      return this.assertLegalChar('' + val || '');\n    };\n\n    XMLStringifier.prototype.dtdAttType = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      return this.assertLegalChar('' + val || '');\n    };\n\n    XMLStringifier.prototype.dtdAttDefault = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      return this.assertLegalChar('' + val || '');\n    };\n\n    XMLStringifier.prototype.dtdEntityValue = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      return this.assertLegalChar('' + val || '');\n    };\n\n    XMLStringifier.prototype.dtdNData = function(val) {\n      if (this.options.noValidation) {\n        return val;\n      }\n      return this.assertLegalChar('' + val || '');\n    };\n\n    XMLStringifier.prototype.convertAttKey = '@';\n\n    XMLStringifier.prototype.convertPIKey = '?';\n\n    XMLStringifier.prototype.convertTextKey = '#text';\n\n    XMLStringifier.prototype.convertCDataKey = '#cdata';\n\n    XMLStringifier.prototype.convertCommentKey = '#comment';\n\n    XMLStringifier.prototype.convertRawKey = '#raw';\n\n    XMLStringifier.prototype.assertLegalChar = function(str) {\n      var regex, res;\n      if (this.options.noValidation) {\n        return str;\n      }\n      regex = '';\n      if (this.options.version === '1.0') {\n        regex = /[\\0-\\x08\\x0B\\f\\x0E-\\x1F\\uFFFE\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]/;\n        if (res = str.match(regex)) {\n          throw new Error(\"Invalid character in string: \" + str + \" at index \" + res.index);\n        }\n      } else if (this.options.version === '1.1') {\n        regex = /[\\0\\uFFFE\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]/;\n        if (res = str.match(regex)) {\n          throw new Error(\"Invalid character in string: \" + str + \" at index \" + res.index);\n        }\n      }\n      return str;\n    };\n\n    XMLStringifier.prototype.assertLegalName = function(str) {\n      var regex;\n      if (this.options.noValidation) {\n        return str;\n      }\n      this.assertLegalChar(str);\n      regex = /^([:A-Z_a-z\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]|[\\uD800-\\uDB7F][\\uDC00-\\uDFFF])([\\x2D\\.0-:A-Z_a-z\\xB7\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u037D\\u037F-\\u1FFF\\u200C\\u200D\\u203F\\u2040\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]|[\\uD800-\\uDB7F][\\uDC00-\\uDFFF])*$/;\n      if (!str.match(regex)) {\n        throw new Error(\"Invalid character in name\");\n      }\n      return str;\n    };\n\n    XMLStringifier.prototype.textEscape = function(str) {\n      var ampregex;\n      if (this.options.noValidation) {\n        return str;\n      }\n      ampregex = this.options.noDoubleEncoding ? /(?!&\\S+;)&/g : /&/g;\n      return str.replace(ampregex, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\\r/g, '&#xD;');\n    };\n\n    XMLStringifier.prototype.attEscape = function(str) {\n      var ampregex;\n      if (this.options.noValidation) {\n        return str;\n      }\n      ampregex = this.options.noDoubleEncoding ? /(?!&\\S+;)&/g : /&/g;\n      return str.replace(ampregex, '&amp;').replace(/</g, '&lt;').replace(/\"/g, '&quot;').replace(/\\t/g, '&#x9;').replace(/\\n/g, '&#xA;').replace(/\\r/g, '&#xD;');\n    };\n\n    return XMLStringifier;\n\n  })();\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  module.exports = {\n    None: 0,\n    OpenTag: 1,\n    InsideTag: 2,\n    CloseTag: 3\n  };\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, WriterState, XMLCData, XMLComment, XMLDTDAttList, XMLDTDElement, XMLDTDEntity, XMLDTDNotation, XMLDeclaration, XMLDocType, XMLDummy, XMLElement, XMLProcessingInstruction, XMLRaw, XMLText, XMLWriterBase, assign,\n    hasProp = {}.hasOwnProperty;\n\n  assign = require('./Utility').assign;\n\n  NodeType = require('./NodeType');\n\n  XMLDeclaration = require('./XMLDeclaration');\n\n  XMLDocType = require('./XMLDocType');\n\n  XMLCData = require('./XMLCData');\n\n  XMLComment = require('./XMLComment');\n\n  XMLElement = require('./XMLElement');\n\n  XMLRaw = require('./XMLRaw');\n\n  XMLText = require('./XMLText');\n\n  XMLProcessingInstruction = require('./XMLProcessingInstruction');\n\n  XMLDummy = require('./XMLDummy');\n\n  XMLDTDAttList = require('./XMLDTDAttList');\n\n  XMLDTDElement = require('./XMLDTDElement');\n\n  XMLDTDEntity = require('./XMLDTDEntity');\n\n  XMLDTDNotation = require('./XMLDTDNotation');\n\n  WriterState = require('./WriterState');\n\n  module.exports = XMLWriterBase = (function() {\n    function XMLWriterBase(options) {\n      var key, ref, value;\n      options || (options = {});\n      this.options = options;\n      ref = options.writer || {};\n      for (key in ref) {\n        if (!hasProp.call(ref, key)) continue;\n        value = ref[key];\n        this[\"_\" + key] = this[key];\n        this[key] = value;\n      }\n    }\n\n    XMLWriterBase.prototype.filterOptions = function(options) {\n      var filteredOptions, ref, ref1, ref2, ref3, ref4, ref5, ref6;\n      options || (options = {});\n      options = assign({}, this.options, options);\n      filteredOptions = {\n        writer: this\n      };\n      filteredOptions.pretty = options.pretty || false;\n      filteredOptions.allowEmpty = options.allowEmpty || false;\n      filteredOptions.indent = (ref = options.indent) != null ? ref : '  ';\n      filteredOptions.newline = (ref1 = options.newline) != null ? ref1 : '\\n';\n      filteredOptions.offset = (ref2 = options.offset) != null ? ref2 : 0;\n      filteredOptions.dontPrettyTextNodes = (ref3 = (ref4 = options.dontPrettyTextNodes) != null ? ref4 : options.dontprettytextnodes) != null ? ref3 : 0;\n      filteredOptions.spaceBeforeSlash = (ref5 = (ref6 = options.spaceBeforeSlash) != null ? ref6 : options.spacebeforeslash) != null ? ref5 : '';\n      if (filteredOptions.spaceBeforeSlash === true) {\n        filteredOptions.spaceBeforeSlash = ' ';\n      }\n      filteredOptions.suppressPrettyCount = 0;\n      filteredOptions.user = {};\n      filteredOptions.state = WriterState.None;\n      return filteredOptions;\n    };\n\n    XMLWriterBase.prototype.indent = function(node, options, level) {\n      var indentLevel;\n      if (!options.pretty || options.suppressPrettyCount) {\n        return '';\n      } else if (options.pretty) {\n        indentLevel = (level || 0) + options.offset + 1;\n        if (indentLevel > 0) {\n          return new Array(indentLevel).join(options.indent);\n        }\n      }\n      return '';\n    };\n\n    XMLWriterBase.prototype.endline = function(node, options, level) {\n      if (!options.pretty || options.suppressPrettyCount) {\n        return '';\n      } else {\n        return options.newline;\n      }\n    };\n\n    XMLWriterBase.prototype.attribute = function(att, options, level) {\n      var r;\n      this.openAttribute(att, options, level);\n      r = ' ' + att.name + '=\"' + att.value + '\"';\n      this.closeAttribute(att, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.cdata = function(node, options, level) {\n      var r;\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      r = this.indent(node, options, level) + '<![CDATA[';\n      options.state = WriterState.InsideTag;\n      r += node.value;\n      options.state = WriterState.CloseTag;\n      r += ']]>' + this.endline(node, options, level);\n      options.state = WriterState.None;\n      this.closeNode(node, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.comment = function(node, options, level) {\n      var r;\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      r = this.indent(node, options, level) + '<!-- ';\n      options.state = WriterState.InsideTag;\n      r += node.value;\n      options.state = WriterState.CloseTag;\n      r += ' -->' + this.endline(node, options, level);\n      options.state = WriterState.None;\n      this.closeNode(node, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.declaration = function(node, options, level) {\n      var r;\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      r = this.indent(node, options, level) + '<?xml';\n      options.state = WriterState.InsideTag;\n      r += ' version=\"' + node.version + '\"';\n      if (node.encoding != null) {\n        r += ' encoding=\"' + node.encoding + '\"';\n      }\n      if (node.standalone != null) {\n        r += ' standalone=\"' + node.standalone + '\"';\n      }\n      options.state = WriterState.CloseTag;\n      r += options.spaceBeforeSlash + '?>';\n      r += this.endline(node, options, level);\n      options.state = WriterState.None;\n      this.closeNode(node, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.docType = function(node, options, level) {\n      var child, i, len, r, ref;\n      level || (level = 0);\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      r = this.indent(node, options, level);\n      r += '<!DOCTYPE ' + node.root().name;\n      if (node.pubID && node.sysID) {\n        r += ' PUBLIC \"' + node.pubID + '\" \"' + node.sysID + '\"';\n      } else if (node.sysID) {\n        r += ' SYSTEM \"' + node.sysID + '\"';\n      }\n      if (node.children.length > 0) {\n        r += ' [';\n        r += this.endline(node, options, level);\n        options.state = WriterState.InsideTag;\n        ref = node.children;\n        for (i = 0, len = ref.length; i < len; i++) {\n          child = ref[i];\n          r += this.writeChildNode(child, options, level + 1);\n        }\n        options.state = WriterState.CloseTag;\n        r += ']';\n      }\n      options.state = WriterState.CloseTag;\n      r += options.spaceBeforeSlash + '>';\n      r += this.endline(node, options, level);\n      options.state = WriterState.None;\n      this.closeNode(node, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.element = function(node, options, level) {\n      var att, child, childNodeCount, firstChildNode, i, j, len, len1, name, prettySuppressed, r, ref, ref1, ref2;\n      level || (level = 0);\n      prettySuppressed = false;\n      r = '';\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      r += this.indent(node, options, level) + '<' + node.name;\n      ref = node.attribs;\n      for (name in ref) {\n        if (!hasProp.call(ref, name)) continue;\n        att = ref[name];\n        r += this.attribute(att, options, level);\n      }\n      childNodeCount = node.children.length;\n      firstChildNode = childNodeCount === 0 ? null : node.children[0];\n      if (childNodeCount === 0 || node.children.every(function(e) {\n        return (e.type === NodeType.Text || e.type === NodeType.Raw) && e.value === '';\n      })) {\n        if (options.allowEmpty) {\n          r += '>';\n          options.state = WriterState.CloseTag;\n          r += '</' + node.name + '>' + this.endline(node, options, level);\n        } else {\n          options.state = WriterState.CloseTag;\n          r += options.spaceBeforeSlash + '/>' + this.endline(node, options, level);\n        }\n      } else if (options.pretty && childNodeCount === 1 && (firstChildNode.type === NodeType.Text || firstChildNode.type === NodeType.Raw) && (firstChildNode.value != null)) {\n        r += '>';\n        options.state = WriterState.InsideTag;\n        options.suppressPrettyCount++;\n        prettySuppressed = true;\n        r += this.writeChildNode(firstChildNode, options, level + 1);\n        options.suppressPrettyCount--;\n        prettySuppressed = false;\n        options.state = WriterState.CloseTag;\n        r += '</' + node.name + '>' + this.endline(node, options, level);\n      } else {\n        if (options.dontPrettyTextNodes) {\n          ref1 = node.children;\n          for (i = 0, len = ref1.length; i < len; i++) {\n            child = ref1[i];\n            if ((child.type === NodeType.Text || child.type === NodeType.Raw) && (child.value != null)) {\n              options.suppressPrettyCount++;\n              prettySuppressed = true;\n              break;\n            }\n          }\n        }\n        r += '>' + this.endline(node, options, level);\n        options.state = WriterState.InsideTag;\n        ref2 = node.children;\n        for (j = 0, len1 = ref2.length; j < len1; j++) {\n          child = ref2[j];\n          r += this.writeChildNode(child, options, level + 1);\n        }\n        options.state = WriterState.CloseTag;\n        r += this.indent(node, options, level) + '</' + node.name + '>';\n        if (prettySuppressed) {\n          options.suppressPrettyCount--;\n        }\n        r += this.endline(node, options, level);\n        options.state = WriterState.None;\n      }\n      this.closeNode(node, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.writeChildNode = function(node, options, level) {\n      switch (node.type) {\n        case NodeType.CData:\n          return this.cdata(node, options, level);\n        case NodeType.Comment:\n          return this.comment(node, options, level);\n        case NodeType.Element:\n          return this.element(node, options, level);\n        case NodeType.Raw:\n          return this.raw(node, options, level);\n        case NodeType.Text:\n          return this.text(node, options, level);\n        case NodeType.ProcessingInstruction:\n          return this.processingInstruction(node, options, level);\n        case NodeType.Dummy:\n          return '';\n        case NodeType.Declaration:\n          return this.declaration(node, options, level);\n        case NodeType.DocType:\n          return this.docType(node, options, level);\n        case NodeType.AttributeDeclaration:\n          return this.dtdAttList(node, options, level);\n        case NodeType.ElementDeclaration:\n          return this.dtdElement(node, options, level);\n        case NodeType.EntityDeclaration:\n          return this.dtdEntity(node, options, level);\n        case NodeType.NotationDeclaration:\n          return this.dtdNotation(node, options, level);\n        default:\n          throw new Error(\"Unknown XML node type: \" + node.constructor.name);\n      }\n    };\n\n    XMLWriterBase.prototype.processingInstruction = function(node, options, level) {\n      var r;\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      r = this.indent(node, options, level) + '<?';\n      options.state = WriterState.InsideTag;\n      r += node.target;\n      if (node.value) {\n        r += ' ' + node.value;\n      }\n      options.state = WriterState.CloseTag;\n      r += options.spaceBeforeSlash + '?>';\n      r += this.endline(node, options, level);\n      options.state = WriterState.None;\n      this.closeNode(node, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.raw = function(node, options, level) {\n      var r;\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      r = this.indent(node, options, level);\n      options.state = WriterState.InsideTag;\n      r += node.value;\n      options.state = WriterState.CloseTag;\n      r += this.endline(node, options, level);\n      options.state = WriterState.None;\n      this.closeNode(node, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.text = function(node, options, level) {\n      var r;\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      r = this.indent(node, options, level);\n      options.state = WriterState.InsideTag;\n      r += node.value;\n      options.state = WriterState.CloseTag;\n      r += this.endline(node, options, level);\n      options.state = WriterState.None;\n      this.closeNode(node, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.dtdAttList = function(node, options, level) {\n      var r;\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      r = this.indent(node, options, level) + '<!ATTLIST';\n      options.state = WriterState.InsideTag;\n      r += ' ' + node.elementName + ' ' + node.attributeName + ' ' + node.attributeType;\n      if (node.defaultValueType !== '#DEFAULT') {\n        r += ' ' + node.defaultValueType;\n      }\n      if (node.defaultValue) {\n        r += ' \"' + node.defaultValue + '\"';\n      }\n      options.state = WriterState.CloseTag;\n      r += options.spaceBeforeSlash + '>' + this.endline(node, options, level);\n      options.state = WriterState.None;\n      this.closeNode(node, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.dtdElement = function(node, options, level) {\n      var r;\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      r = this.indent(node, options, level) + '<!ELEMENT';\n      options.state = WriterState.InsideTag;\n      r += ' ' + node.name + ' ' + node.value;\n      options.state = WriterState.CloseTag;\n      r += options.spaceBeforeSlash + '>' + this.endline(node, options, level);\n      options.state = WriterState.None;\n      this.closeNode(node, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.dtdEntity = function(node, options, level) {\n      var r;\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      r = this.indent(node, options, level) + '<!ENTITY';\n      options.state = WriterState.InsideTag;\n      if (node.pe) {\n        r += ' %';\n      }\n      r += ' ' + node.name;\n      if (node.value) {\n        r += ' \"' + node.value + '\"';\n      } else {\n        if (node.pubID && node.sysID) {\n          r += ' PUBLIC \"' + node.pubID + '\" \"' + node.sysID + '\"';\n        } else if (node.sysID) {\n          r += ' SYSTEM \"' + node.sysID + '\"';\n        }\n        if (node.nData) {\n          r += ' NDATA ' + node.nData;\n        }\n      }\n      options.state = WriterState.CloseTag;\n      r += options.spaceBeforeSlash + '>' + this.endline(node, options, level);\n      options.state = WriterState.None;\n      this.closeNode(node, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.dtdNotation = function(node, options, level) {\n      var r;\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      r = this.indent(node, options, level) + '<!NOTATION';\n      options.state = WriterState.InsideTag;\n      r += ' ' + node.name;\n      if (node.pubID && node.sysID) {\n        r += ' PUBLIC \"' + node.pubID + '\" \"' + node.sysID + '\"';\n      } else if (node.pubID) {\n        r += ' PUBLIC \"' + node.pubID + '\"';\n      } else if (node.sysID) {\n        r += ' SYSTEM \"' + node.sysID + '\"';\n      }\n      options.state = WriterState.CloseTag;\n      r += options.spaceBeforeSlash + '>' + this.endline(node, options, level);\n      options.state = WriterState.None;\n      this.closeNode(node, options, level);\n      return r;\n    };\n\n    XMLWriterBase.prototype.openNode = function(node, options, level) {};\n\n    XMLWriterBase.prototype.closeNode = function(node, options, level) {};\n\n    XMLWriterBase.prototype.openAttribute = function(att, options, level) {};\n\n    XMLWriterBase.prototype.closeAttribute = function(att, options, level) {};\n\n    return XMLWriterBase;\n\n  })();\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var XMLStringWriter, XMLWriterBase,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  XMLWriterBase = require('./XMLWriterBase');\n\n  module.exports = XMLStringWriter = (function(superClass) {\n    extend(XMLStringWriter, superClass);\n\n    function XMLStringWriter(options) {\n      XMLStringWriter.__super__.constructor.call(this, options);\n    }\n\n    XMLStringWriter.prototype.document = function(doc, options) {\n      var child, i, len, r, ref;\n      options = this.filterOptions(options);\n      r = '';\n      ref = doc.children;\n      for (i = 0, len = ref.length; i < len; i++) {\n        child = ref[i];\n        r += this.writeChildNode(child, options, 0);\n      }\n      if (options.pretty && r.slice(-options.newline.length) === options.newline) {\n        r = r.slice(0, -options.newline.length);\n      }\n      return r;\n    };\n\n    return XMLStringWriter;\n\n  })(XMLWriterBase);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, XMLDOMConfiguration, XMLDOMImplementation, XMLDocument, XMLNode, XMLStringWriter, XMLStringifier, isPlainObject,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  isPlainObject = require('./Utility').isPlainObject;\n\n  XMLDOMImplementation = require('./XMLDOMImplementation');\n\n  XMLDOMConfiguration = require('./XMLDOMConfiguration');\n\n  XMLNode = require('./XMLNode');\n\n  NodeType = require('./NodeType');\n\n  XMLStringifier = require('./XMLStringifier');\n\n  XMLStringWriter = require('./XMLStringWriter');\n\n  module.exports = XMLDocument = (function(superClass) {\n    extend(XMLDocument, superClass);\n\n    function XMLDocument(options) {\n      XMLDocument.__super__.constructor.call(this, null);\n      this.name = \"#document\";\n      this.type = NodeType.Document;\n      this.documentURI = null;\n      this.domConfig = new XMLDOMConfiguration();\n      options || (options = {});\n      if (!options.writer) {\n        options.writer = new XMLStringWriter();\n      }\n      this.options = options;\n      this.stringify = new XMLStringifier(options);\n    }\n\n    Object.defineProperty(XMLDocument.prototype, 'implementation', {\n      value: new XMLDOMImplementation()\n    });\n\n    Object.defineProperty(XMLDocument.prototype, 'doctype', {\n      get: function() {\n        var child, i, len, ref;\n        ref = this.children;\n        for (i = 0, len = ref.length; i < len; i++) {\n          child = ref[i];\n          if (child.type === NodeType.DocType) {\n            return child;\n          }\n        }\n        return null;\n      }\n    });\n\n    Object.defineProperty(XMLDocument.prototype, 'documentElement', {\n      get: function() {\n        return this.rootObject || null;\n      }\n    });\n\n    Object.defineProperty(XMLDocument.prototype, 'inputEncoding', {\n      get: function() {\n        return null;\n      }\n    });\n\n    Object.defineProperty(XMLDocument.prototype, 'strictErrorChecking', {\n      get: function() {\n        return false;\n      }\n    });\n\n    Object.defineProperty(XMLDocument.prototype, 'xmlEncoding', {\n      get: function() {\n        if (this.children.length !== 0 && this.children[0].type === NodeType.Declaration) {\n          return this.children[0].encoding;\n        } else {\n          return null;\n        }\n      }\n    });\n\n    Object.defineProperty(XMLDocument.prototype, 'xmlStandalone', {\n      get: function() {\n        if (this.children.length !== 0 && this.children[0].type === NodeType.Declaration) {\n          return this.children[0].standalone === 'yes';\n        } else {\n          return false;\n        }\n      }\n    });\n\n    Object.defineProperty(XMLDocument.prototype, 'xmlVersion', {\n      get: function() {\n        if (this.children.length !== 0 && this.children[0].type === NodeType.Declaration) {\n          return this.children[0].version;\n        } else {\n          return \"1.0\";\n        }\n      }\n    });\n\n    Object.defineProperty(XMLDocument.prototype, 'URL', {\n      get: function() {\n        return this.documentURI;\n      }\n    });\n\n    Object.defineProperty(XMLDocument.prototype, 'origin', {\n      get: function() {\n        return null;\n      }\n    });\n\n    Object.defineProperty(XMLDocument.prototype, 'compatMode', {\n      get: function() {\n        return null;\n      }\n    });\n\n    Object.defineProperty(XMLDocument.prototype, 'characterSet', {\n      get: function() {\n        return null;\n      }\n    });\n\n    Object.defineProperty(XMLDocument.prototype, 'contentType', {\n      get: function() {\n        return null;\n      }\n    });\n\n    XMLDocument.prototype.end = function(writer) {\n      var writerOptions;\n      writerOptions = {};\n      if (!writer) {\n        writer = this.options.writer;\n      } else if (isPlainObject(writer)) {\n        writerOptions = writer;\n        writer = this.options.writer;\n      }\n      return writer.document(this, writer.filterOptions(writerOptions));\n    };\n\n    XMLDocument.prototype.toString = function(options) {\n      return this.options.writer.document(this, this.options.writer.filterOptions(options));\n    };\n\n    XMLDocument.prototype.createElement = function(tagName) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createDocumentFragment = function() {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createTextNode = function(data) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createComment = function(data) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createCDATASection = function(data) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createProcessingInstruction = function(target, data) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createAttribute = function(name) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createEntityReference = function(name) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.getElementsByTagName = function(tagname) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.importNode = function(importedNode, deep) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createElementNS = function(namespaceURI, qualifiedName) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createAttributeNS = function(namespaceURI, qualifiedName) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.getElementsByTagNameNS = function(namespaceURI, localName) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.getElementById = function(elementId) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.adoptNode = function(source) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.normalizeDocument = function() {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.renameNode = function(node, namespaceURI, qualifiedName) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.getElementsByClassName = function(classNames) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createEvent = function(eventInterface) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createRange = function() {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createNodeIterator = function(root, whatToShow, filter) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    XMLDocument.prototype.createTreeWalker = function(root, whatToShow, filter) {\n      throw new Error(\"This DOM method is not implemented.\" + this.debugInfo());\n    };\n\n    return XMLDocument;\n\n  })(XMLNode);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, WriterState, XMLAttribute, XMLCData, XMLComment, XMLDTDAttList, XMLDTDElement, XMLDTDEntity, XMLDTDNotation, XMLDeclaration, XMLDocType, XMLDocument, XMLDocumentCB, XMLElement, XMLProcessingInstruction, XMLRaw, XMLStringWriter, XMLStringifier, XMLText, getValue, isFunction, isObject, isPlainObject, ref,\n    hasProp = {}.hasOwnProperty;\n\n  ref = require('./Utility'), isObject = ref.isObject, isFunction = ref.isFunction, isPlainObject = ref.isPlainObject, getValue = ref.getValue;\n\n  NodeType = require('./NodeType');\n\n  XMLDocument = require('./XMLDocument');\n\n  XMLElement = require('./XMLElement');\n\n  XMLCData = require('./XMLCData');\n\n  XMLComment = require('./XMLComment');\n\n  XMLRaw = require('./XMLRaw');\n\n  XMLText = require('./XMLText');\n\n  XMLProcessingInstruction = require('./XMLProcessingInstruction');\n\n  XMLDeclaration = require('./XMLDeclaration');\n\n  XMLDocType = require('./XMLDocType');\n\n  XMLDTDAttList = require('./XMLDTDAttList');\n\n  XMLDTDEntity = require('./XMLDTDEntity');\n\n  XMLDTDElement = require('./XMLDTDElement');\n\n  XMLDTDNotation = require('./XMLDTDNotation');\n\n  XMLAttribute = require('./XMLAttribute');\n\n  XMLStringifier = require('./XMLStringifier');\n\n  XMLStringWriter = require('./XMLStringWriter');\n\n  WriterState = require('./WriterState');\n\n  module.exports = XMLDocumentCB = (function() {\n    function XMLDocumentCB(options, onData, onEnd) {\n      var writerOptions;\n      this.name = \"?xml\";\n      this.type = NodeType.Document;\n      options || (options = {});\n      writerOptions = {};\n      if (!options.writer) {\n        options.writer = new XMLStringWriter();\n      } else if (isPlainObject(options.writer)) {\n        writerOptions = options.writer;\n        options.writer = new XMLStringWriter();\n      }\n      this.options = options;\n      this.writer = options.writer;\n      this.writerOptions = this.writer.filterOptions(writerOptions);\n      this.stringify = new XMLStringifier(options);\n      this.onDataCallback = onData || function() {};\n      this.onEndCallback = onEnd || function() {};\n      this.currentNode = null;\n      this.currentLevel = -1;\n      this.openTags = {};\n      this.documentStarted = false;\n      this.documentCompleted = false;\n      this.root = null;\n    }\n\n    XMLDocumentCB.prototype.createChildNode = function(node) {\n      var att, attName, attributes, child, i, len, ref1, ref2;\n      switch (node.type) {\n        case NodeType.CData:\n          this.cdata(node.value);\n          break;\n        case NodeType.Comment:\n          this.comment(node.value);\n          break;\n        case NodeType.Element:\n          attributes = {};\n          ref1 = node.attribs;\n          for (attName in ref1) {\n            if (!hasProp.call(ref1, attName)) continue;\n            att = ref1[attName];\n            attributes[attName] = att.value;\n          }\n          this.node(node.name, attributes);\n          break;\n        case NodeType.Dummy:\n          this.dummy();\n          break;\n        case NodeType.Raw:\n          this.raw(node.value);\n          break;\n        case NodeType.Text:\n          this.text(node.value);\n          break;\n        case NodeType.ProcessingInstruction:\n          this.instruction(node.target, node.value);\n          break;\n        default:\n          throw new Error(\"This XML node type is not supported in a JS object: \" + node.constructor.name);\n      }\n      ref2 = node.children;\n      for (i = 0, len = ref2.length; i < len; i++) {\n        child = ref2[i];\n        this.createChildNode(child);\n        if (child.type === NodeType.Element) {\n          this.up();\n        }\n      }\n      return this;\n    };\n\n    XMLDocumentCB.prototype.dummy = function() {\n      return this;\n    };\n\n    XMLDocumentCB.prototype.node = function(name, attributes, text) {\n      var ref1;\n      if (name == null) {\n        throw new Error(\"Missing node name.\");\n      }\n      if (this.root && this.currentLevel === -1) {\n        throw new Error(\"Document can only have one root node. \" + this.debugInfo(name));\n      }\n      this.openCurrent();\n      name = getValue(name);\n      if (attributes == null) {\n        attributes = {};\n      }\n      attributes = getValue(attributes);\n      if (!isObject(attributes)) {\n        ref1 = [attributes, text], text = ref1[0], attributes = ref1[1];\n      }\n      this.currentNode = new XMLElement(this, name, attributes);\n      this.currentNode.children = false;\n      this.currentLevel++;\n      this.openTags[this.currentLevel] = this.currentNode;\n      if (text != null) {\n        this.text(text);\n      }\n      return this;\n    };\n\n    XMLDocumentCB.prototype.element = function(name, attributes, text) {\n      var child, i, len, oldValidationFlag, ref1, root;\n      if (this.currentNode && this.currentNode.type === NodeType.DocType) {\n        this.dtdElement.apply(this, arguments);\n      } else {\n        if (Array.isArray(name) || isObject(name) || isFunction(name)) {\n          oldValidationFlag = this.options.noValidation;\n          this.options.noValidation = true;\n          root = new XMLDocument(this.options).element('TEMP_ROOT');\n          root.element(name);\n          this.options.noValidation = oldValidationFlag;\n          ref1 = root.children;\n          for (i = 0, len = ref1.length; i < len; i++) {\n            child = ref1[i];\n            this.createChildNode(child);\n            if (child.type === NodeType.Element) {\n              this.up();\n            }\n          }\n        } else {\n          this.node(name, attributes, text);\n        }\n      }\n      return this;\n    };\n\n    XMLDocumentCB.prototype.attribute = function(name, value) {\n      var attName, attValue;\n      if (!this.currentNode || this.currentNode.children) {\n        throw new Error(\"att() can only be used immediately after an ele() call in callback mode. \" + this.debugInfo(name));\n      }\n      if (name != null) {\n        name = getValue(name);\n      }\n      if (isObject(name)) {\n        for (attName in name) {\n          if (!hasProp.call(name, attName)) continue;\n          attValue = name[attName];\n          this.attribute(attName, attValue);\n        }\n      } else {\n        if (isFunction(value)) {\n          value = value.apply();\n        }\n        if (this.options.keepNullAttributes && (value == null)) {\n          this.currentNode.attribs[name] = new XMLAttribute(this, name, \"\");\n        } else if (value != null) {\n          this.currentNode.attribs[name] = new XMLAttribute(this, name, value);\n        }\n      }\n      return this;\n    };\n\n    XMLDocumentCB.prototype.text = function(value) {\n      var node;\n      this.openCurrent();\n      node = new XMLText(this, value);\n      this.onData(this.writer.text(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.cdata = function(value) {\n      var node;\n      this.openCurrent();\n      node = new XMLCData(this, value);\n      this.onData(this.writer.cdata(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.comment = function(value) {\n      var node;\n      this.openCurrent();\n      node = new XMLComment(this, value);\n      this.onData(this.writer.comment(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.raw = function(value) {\n      var node;\n      this.openCurrent();\n      node = new XMLRaw(this, value);\n      this.onData(this.writer.raw(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.instruction = function(target, value) {\n      var i, insTarget, insValue, len, node;\n      this.openCurrent();\n      if (target != null) {\n        target = getValue(target);\n      }\n      if (value != null) {\n        value = getValue(value);\n      }\n      if (Array.isArray(target)) {\n        for (i = 0, len = target.length; i < len; i++) {\n          insTarget = target[i];\n          this.instruction(insTarget);\n        }\n      } else if (isObject(target)) {\n        for (insTarget in target) {\n          if (!hasProp.call(target, insTarget)) continue;\n          insValue = target[insTarget];\n          this.instruction(insTarget, insValue);\n        }\n      } else {\n        if (isFunction(value)) {\n          value = value.apply();\n        }\n        node = new XMLProcessingInstruction(this, target, value);\n        this.onData(this.writer.processingInstruction(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      }\n      return this;\n    };\n\n    XMLDocumentCB.prototype.declaration = function(version, encoding, standalone) {\n      var node;\n      this.openCurrent();\n      if (this.documentStarted) {\n        throw new Error(\"declaration() must be the first node.\");\n      }\n      node = new XMLDeclaration(this, version, encoding, standalone);\n      this.onData(this.writer.declaration(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.doctype = function(root, pubID, sysID) {\n      this.openCurrent();\n      if (root == null) {\n        throw new Error(\"Missing root node name.\");\n      }\n      if (this.root) {\n        throw new Error(\"dtd() must come before the root node.\");\n      }\n      this.currentNode = new XMLDocType(this, pubID, sysID);\n      this.currentNode.rootNodeName = root;\n      this.currentNode.children = false;\n      this.currentLevel++;\n      this.openTags[this.currentLevel] = this.currentNode;\n      return this;\n    };\n\n    XMLDocumentCB.prototype.dtdElement = function(name, value) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDElement(this, name, value);\n      this.onData(this.writer.dtdElement(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.attList = function(elementName, attributeName, attributeType, defaultValueType, defaultValue) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDAttList(this, elementName, attributeName, attributeType, defaultValueType, defaultValue);\n      this.onData(this.writer.dtdAttList(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.entity = function(name, value) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDEntity(this, false, name, value);\n      this.onData(this.writer.dtdEntity(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.pEntity = function(name, value) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDEntity(this, true, name, value);\n      this.onData(this.writer.dtdEntity(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.notation = function(name, value) {\n      var node;\n      this.openCurrent();\n      node = new XMLDTDNotation(this, name, value);\n      this.onData(this.writer.dtdNotation(node, this.writerOptions, this.currentLevel + 1), this.currentLevel + 1);\n      return this;\n    };\n\n    XMLDocumentCB.prototype.up = function() {\n      if (this.currentLevel < 0) {\n        throw new Error(\"The document node has no parent.\");\n      }\n      if (this.currentNode) {\n        if (this.currentNode.children) {\n          this.closeNode(this.currentNode);\n        } else {\n          this.openNode(this.currentNode);\n        }\n        this.currentNode = null;\n      } else {\n        this.closeNode(this.openTags[this.currentLevel]);\n      }\n      delete this.openTags[this.currentLevel];\n      this.currentLevel--;\n      return this;\n    };\n\n    XMLDocumentCB.prototype.end = function() {\n      while (this.currentLevel >= 0) {\n        this.up();\n      }\n      return this.onEnd();\n    };\n\n    XMLDocumentCB.prototype.openCurrent = function() {\n      if (this.currentNode) {\n        this.currentNode.children = true;\n        return this.openNode(this.currentNode);\n      }\n    };\n\n    XMLDocumentCB.prototype.openNode = function(node) {\n      var att, chunk, name, ref1;\n      if (!node.isOpen) {\n        if (!this.root && this.currentLevel === 0 && node.type === NodeType.Element) {\n          this.root = node;\n        }\n        chunk = '';\n        if (node.type === NodeType.Element) {\n          this.writerOptions.state = WriterState.OpenTag;\n          chunk = this.writer.indent(node, this.writerOptions, this.currentLevel) + '<' + node.name;\n          ref1 = node.attribs;\n          for (name in ref1) {\n            if (!hasProp.call(ref1, name)) continue;\n            att = ref1[name];\n            chunk += this.writer.attribute(att, this.writerOptions, this.currentLevel);\n          }\n          chunk += (node.children ? '>' : '/>') + this.writer.endline(node, this.writerOptions, this.currentLevel);\n          this.writerOptions.state = WriterState.InsideTag;\n        } else {\n          this.writerOptions.state = WriterState.OpenTag;\n          chunk = this.writer.indent(node, this.writerOptions, this.currentLevel) + '<!DOCTYPE ' + node.rootNodeName;\n          if (node.pubID && node.sysID) {\n            chunk += ' PUBLIC \"' + node.pubID + '\" \"' + node.sysID + '\"';\n          } else if (node.sysID) {\n            chunk += ' SYSTEM \"' + node.sysID + '\"';\n          }\n          if (node.children) {\n            chunk += ' [';\n            this.writerOptions.state = WriterState.InsideTag;\n          } else {\n            this.writerOptions.state = WriterState.CloseTag;\n            chunk += '>';\n          }\n          chunk += this.writer.endline(node, this.writerOptions, this.currentLevel);\n        }\n        this.onData(chunk, this.currentLevel);\n        return node.isOpen = true;\n      }\n    };\n\n    XMLDocumentCB.prototype.closeNode = function(node) {\n      var chunk;\n      if (!node.isClosed) {\n        chunk = '';\n        this.writerOptions.state = WriterState.CloseTag;\n        if (node.type === NodeType.Element) {\n          chunk = this.writer.indent(node, this.writerOptions, this.currentLevel) + '</' + node.name + '>' + this.writer.endline(node, this.writerOptions, this.currentLevel);\n        } else {\n          chunk = this.writer.indent(node, this.writerOptions, this.currentLevel) + ']>' + this.writer.endline(node, this.writerOptions, this.currentLevel);\n        }\n        this.writerOptions.state = WriterState.None;\n        this.onData(chunk, this.currentLevel);\n        return node.isClosed = true;\n      }\n    };\n\n    XMLDocumentCB.prototype.onData = function(chunk, level) {\n      this.documentStarted = true;\n      return this.onDataCallback(chunk, level + 1);\n    };\n\n    XMLDocumentCB.prototype.onEnd = function() {\n      this.documentCompleted = true;\n      return this.onEndCallback();\n    };\n\n    XMLDocumentCB.prototype.debugInfo = function(name) {\n      if (name == null) {\n        return \"\";\n      } else {\n        return \"node: <\" + name + \">\";\n      }\n    };\n\n    XMLDocumentCB.prototype.ele = function() {\n      return this.element.apply(this, arguments);\n    };\n\n    XMLDocumentCB.prototype.nod = function(name, attributes, text) {\n      return this.node(name, attributes, text);\n    };\n\n    XMLDocumentCB.prototype.txt = function(value) {\n      return this.text(value);\n    };\n\n    XMLDocumentCB.prototype.dat = function(value) {\n      return this.cdata(value);\n    };\n\n    XMLDocumentCB.prototype.com = function(value) {\n      return this.comment(value);\n    };\n\n    XMLDocumentCB.prototype.ins = function(target, value) {\n      return this.instruction(target, value);\n    };\n\n    XMLDocumentCB.prototype.dec = function(version, encoding, standalone) {\n      return this.declaration(version, encoding, standalone);\n    };\n\n    XMLDocumentCB.prototype.dtd = function(root, pubID, sysID) {\n      return this.doctype(root, pubID, sysID);\n    };\n\n    XMLDocumentCB.prototype.e = function(name, attributes, text) {\n      return this.element(name, attributes, text);\n    };\n\n    XMLDocumentCB.prototype.n = function(name, attributes, text) {\n      return this.node(name, attributes, text);\n    };\n\n    XMLDocumentCB.prototype.t = function(value) {\n      return this.text(value);\n    };\n\n    XMLDocumentCB.prototype.d = function(value) {\n      return this.cdata(value);\n    };\n\n    XMLDocumentCB.prototype.c = function(value) {\n      return this.comment(value);\n    };\n\n    XMLDocumentCB.prototype.r = function(value) {\n      return this.raw(value);\n    };\n\n    XMLDocumentCB.prototype.i = function(target, value) {\n      return this.instruction(target, value);\n    };\n\n    XMLDocumentCB.prototype.att = function() {\n      if (this.currentNode && this.currentNode.type === NodeType.DocType) {\n        return this.attList.apply(this, arguments);\n      } else {\n        return this.attribute.apply(this, arguments);\n      }\n    };\n\n    XMLDocumentCB.prototype.a = function() {\n      if (this.currentNode && this.currentNode.type === NodeType.DocType) {\n        return this.attList.apply(this, arguments);\n      } else {\n        return this.attribute.apply(this, arguments);\n      }\n    };\n\n    XMLDocumentCB.prototype.ent = function(name, value) {\n      return this.entity(name, value);\n    };\n\n    XMLDocumentCB.prototype.pent = function(name, value) {\n      return this.pEntity(name, value);\n    };\n\n    XMLDocumentCB.prototype.not = function(name, value) {\n      return this.notation(name, value);\n    };\n\n    return XMLDocumentCB;\n\n  })();\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, WriterState, XMLStreamWriter, XMLWriterBase,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  NodeType = require('./NodeType');\n\n  XMLWriterBase = require('./XMLWriterBase');\n\n  WriterState = require('./WriterState');\n\n  module.exports = XMLStreamWriter = (function(superClass) {\n    extend(XMLStreamWriter, superClass);\n\n    function XMLStreamWriter(stream, options) {\n      this.stream = stream;\n      XMLStreamWriter.__super__.constructor.call(this, options);\n    }\n\n    XMLStreamWriter.prototype.endline = function(node, options, level) {\n      if (node.isLastRootNode && options.state === WriterState.CloseTag) {\n        return '';\n      } else {\n        return XMLStreamWriter.__super__.endline.call(this, node, options, level);\n      }\n    };\n\n    XMLStreamWriter.prototype.document = function(doc, options) {\n      var child, i, j, k, len, len1, ref, ref1, results;\n      ref = doc.children;\n      for (i = j = 0, len = ref.length; j < len; i = ++j) {\n        child = ref[i];\n        child.isLastRootNode = i === doc.children.length - 1;\n      }\n      options = this.filterOptions(options);\n      ref1 = doc.children;\n      results = [];\n      for (k = 0, len1 = ref1.length; k < len1; k++) {\n        child = ref1[k];\n        results.push(this.writeChildNode(child, options, 0));\n      }\n      return results;\n    };\n\n    XMLStreamWriter.prototype.attribute = function(att, options, level) {\n      return this.stream.write(XMLStreamWriter.__super__.attribute.call(this, att, options, level));\n    };\n\n    XMLStreamWriter.prototype.cdata = function(node, options, level) {\n      return this.stream.write(XMLStreamWriter.__super__.cdata.call(this, node, options, level));\n    };\n\n    XMLStreamWriter.prototype.comment = function(node, options, level) {\n      return this.stream.write(XMLStreamWriter.__super__.comment.call(this, node, options, level));\n    };\n\n    XMLStreamWriter.prototype.declaration = function(node, options, level) {\n      return this.stream.write(XMLStreamWriter.__super__.declaration.call(this, node, options, level));\n    };\n\n    XMLStreamWriter.prototype.docType = function(node, options, level) {\n      var child, j, len, ref;\n      level || (level = 0);\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      this.stream.write(this.indent(node, options, level));\n      this.stream.write('<!DOCTYPE ' + node.root().name);\n      if (node.pubID && node.sysID) {\n        this.stream.write(' PUBLIC \"' + node.pubID + '\" \"' + node.sysID + '\"');\n      } else if (node.sysID) {\n        this.stream.write(' SYSTEM \"' + node.sysID + '\"');\n      }\n      if (node.children.length > 0) {\n        this.stream.write(' [');\n        this.stream.write(this.endline(node, options, level));\n        options.state = WriterState.InsideTag;\n        ref = node.children;\n        for (j = 0, len = ref.length; j < len; j++) {\n          child = ref[j];\n          this.writeChildNode(child, options, level + 1);\n        }\n        options.state = WriterState.CloseTag;\n        this.stream.write(']');\n      }\n      options.state = WriterState.CloseTag;\n      this.stream.write(options.spaceBeforeSlash + '>');\n      this.stream.write(this.endline(node, options, level));\n      options.state = WriterState.None;\n      return this.closeNode(node, options, level);\n    };\n\n    XMLStreamWriter.prototype.element = function(node, options, level) {\n      var att, child, childNodeCount, firstChildNode, j, len, name, prettySuppressed, ref, ref1;\n      level || (level = 0);\n      this.openNode(node, options, level);\n      options.state = WriterState.OpenTag;\n      this.stream.write(this.indent(node, options, level) + '<' + node.name);\n      ref = node.attribs;\n      for (name in ref) {\n        if (!hasProp.call(ref, name)) continue;\n        att = ref[name];\n        this.attribute(att, options, level);\n      }\n      childNodeCount = node.children.length;\n      firstChildNode = childNodeCount === 0 ? null : node.children[0];\n      if (childNodeCount === 0 || node.children.every(function(e) {\n        return (e.type === NodeType.Text || e.type === NodeType.Raw) && e.value === '';\n      })) {\n        if (options.allowEmpty) {\n          this.stream.write('>');\n          options.state = WriterState.CloseTag;\n          this.stream.write('</' + node.name + '>');\n        } else {\n          options.state = WriterState.CloseTag;\n          this.stream.write(options.spaceBeforeSlash + '/>');\n        }\n      } else if (options.pretty && childNodeCount === 1 && (firstChildNode.type === NodeType.Text || firstChildNode.type === NodeType.Raw) && (firstChildNode.value != null)) {\n        this.stream.write('>');\n        options.state = WriterState.InsideTag;\n        options.suppressPrettyCount++;\n        prettySuppressed = true;\n        this.writeChildNode(firstChildNode, options, level + 1);\n        options.suppressPrettyCount--;\n        prettySuppressed = false;\n        options.state = WriterState.CloseTag;\n        this.stream.write('</' + node.name + '>');\n      } else {\n        this.stream.write('>' + this.endline(node, options, level));\n        options.state = WriterState.InsideTag;\n        ref1 = node.children;\n        for (j = 0, len = ref1.length; j < len; j++) {\n          child = ref1[j];\n          this.writeChildNode(child, options, level + 1);\n        }\n        options.state = WriterState.CloseTag;\n        this.stream.write(this.indent(node, options, level) + '</' + node.name + '>');\n      }\n      this.stream.write(this.endline(node, options, level));\n      options.state = WriterState.None;\n      return this.closeNode(node, options, level);\n    };\n\n    XMLStreamWriter.prototype.processingInstruction = function(node, options, level) {\n      return this.stream.write(XMLStreamWriter.__super__.processingInstruction.call(this, node, options, level));\n    };\n\n    XMLStreamWriter.prototype.raw = function(node, options, level) {\n      return this.stream.write(XMLStreamWriter.__super__.raw.call(this, node, options, level));\n    };\n\n    XMLStreamWriter.prototype.text = function(node, options, level) {\n      return this.stream.write(XMLStreamWriter.__super__.text.call(this, node, options, level));\n    };\n\n    XMLStreamWriter.prototype.dtdAttList = function(node, options, level) {\n      return this.stream.write(XMLStreamWriter.__super__.dtdAttList.call(this, node, options, level));\n    };\n\n    XMLStreamWriter.prototype.dtdElement = function(node, options, level) {\n      return this.stream.write(XMLStreamWriter.__super__.dtdElement.call(this, node, options, level));\n    };\n\n    XMLStreamWriter.prototype.dtdEntity = function(node, options, level) {\n      return this.stream.write(XMLStreamWriter.__super__.dtdEntity.call(this, node, options, level));\n    };\n\n    XMLStreamWriter.prototype.dtdNotation = function(node, options, level) {\n      return this.stream.write(XMLStreamWriter.__super__.dtdNotation.call(this, node, options, level));\n    };\n\n    return XMLStreamWriter;\n\n  })(XMLWriterBase);\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  var NodeType, WriterState, XMLDOMImplementation, XMLDocument, XMLDocumentCB, XMLStreamWriter, XMLStringWriter, assign, isFunction, ref;\n\n  ref = require('./Utility'), assign = ref.assign, isFunction = ref.isFunction;\n\n  XMLDOMImplementation = require('./XMLDOMImplementation');\n\n  XMLDocument = require('./XMLDocument');\n\n  XMLDocumentCB = require('./XMLDocumentCB');\n\n  XMLStringWriter = require('./XMLStringWriter');\n\n  XMLStreamWriter = require('./XMLStreamWriter');\n\n  NodeType = require('./NodeType');\n\n  WriterState = require('./WriterState');\n\n  module.exports.create = function(name, xmldec, doctype, options) {\n    var doc, root;\n    if (name == null) {\n      throw new Error(\"Root element needs a name.\");\n    }\n    options = assign({}, xmldec, doctype, options);\n    doc = new XMLDocument(options);\n    root = doc.element(name);\n    if (!options.headless) {\n      doc.declaration(options);\n      if ((options.pubID != null) || (options.sysID != null)) {\n        doc.dtd(options);\n      }\n    }\n    return root;\n  };\n\n  module.exports.begin = function(options, onData, onEnd) {\n    var ref1;\n    if (isFunction(options)) {\n      ref1 = [options, onData], onData = ref1[0], onEnd = ref1[1];\n      options = {};\n    }\n    if (onData) {\n      return new XMLDocumentCB(options, onData, onEnd);\n    } else {\n      return new XMLDocument(options);\n    }\n  };\n\n  module.exports.stringWriter = function(options) {\n    return new XMLStringWriter(options);\n  };\n\n  module.exports.streamWriter = function(stream, options) {\n    return new XMLStreamWriter(stream, options);\n  };\n\n  module.exports.implementation = new XMLDOMImplementation();\n\n  module.exports.nodeType = NodeType;\n\n  module.exports.writerState = WriterState;\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  \"use strict\";\n  var builder, defaults, escapeCDATA, requiresCDATA, wrapCDATA,\n    hasProp = {}.hasOwnProperty;\n\n  builder = require('xmlbuilder');\n\n  defaults = require('./defaults').defaults;\n\n  requiresCDATA = function(entry) {\n    return typeof entry === \"string\" && (entry.indexOf('&') >= 0 || entry.indexOf('>') >= 0 || entry.indexOf('<') >= 0);\n  };\n\n  wrapCDATA = function(entry) {\n    return \"<![CDATA[\" + (escapeCDATA(entry)) + \"]]>\";\n  };\n\n  escapeCDATA = function(entry) {\n    return entry.replace(']]>', ']]]]><![CDATA[>');\n  };\n\n  exports.Builder = (function() {\n    function Builder(opts) {\n      var key, ref, value;\n      this.options = {};\n      ref = defaults[\"0.2\"];\n      for (key in ref) {\n        if (!hasProp.call(ref, key)) continue;\n        value = ref[key];\n        this.options[key] = value;\n      }\n      for (key in opts) {\n        if (!hasProp.call(opts, key)) continue;\n        value = opts[key];\n        this.options[key] = value;\n      }\n    }\n\n    Builder.prototype.buildObject = function(rootObj) {\n      var attrkey, charkey, render, rootElement, rootName;\n      attrkey = this.options.attrkey;\n      charkey = this.options.charkey;\n      if ((Object.keys(rootObj).length === 1) && (this.options.rootName === defaults['0.2'].rootName)) {\n        rootName = Object.keys(rootObj)[0];\n        rootObj = rootObj[rootName];\n      } else {\n        rootName = this.options.rootName;\n      }\n      render = (function(_this) {\n        return function(element, obj) {\n          var attr, child, entry, index, key, value;\n          if (typeof obj !== 'object') {\n            if (_this.options.cdata && requiresCDATA(obj)) {\n              element.raw(wrapCDATA(obj));\n            } else {\n              element.txt(obj);\n            }\n          } else if (Array.isArray(obj)) {\n            for (index in obj) {\n              if (!hasProp.call(obj, index)) continue;\n              child = obj[index];\n              for (key in child) {\n                entry = child[key];\n                element = render(element.ele(key), entry).up();\n              }\n            }\n          } else {\n            for (key in obj) {\n              if (!hasProp.call(obj, key)) continue;\n              child = obj[key];\n              if (key === attrkey) {\n                if (typeof child === \"object\") {\n                  for (attr in child) {\n                    value = child[attr];\n                    element = element.att(attr, value);\n                  }\n                }\n              } else if (key === charkey) {\n                if (_this.options.cdata && requiresCDATA(child)) {\n                  element = element.raw(wrapCDATA(child));\n                } else {\n                  element = element.txt(child);\n                }\n              } else if (Array.isArray(child)) {\n                for (index in child) {\n                  if (!hasProp.call(child, index)) continue;\n                  entry = child[index];\n                  if (typeof entry === 'string') {\n                    if (_this.options.cdata && requiresCDATA(entry)) {\n                      element = element.ele(key).raw(wrapCDATA(entry)).up();\n                    } else {\n                      element = element.ele(key, entry).up();\n                    }\n                  } else {\n                    element = render(element.ele(key), entry).up();\n                  }\n                }\n              } else if (typeof child === \"object\") {\n                element = render(element.ele(key), child).up();\n              } else {\n                if (typeof child === 'string' && _this.options.cdata && requiresCDATA(child)) {\n                  element = element.ele(key).raw(wrapCDATA(child)).up();\n                } else {\n                  if (child == null) {\n                    child = '';\n                  }\n                  element = element.ele(key, child.toString()).up();\n                }\n              }\n            }\n          }\n          return element;\n        };\n      })(this);\n      rootElement = builder.create(rootName, this.options.xmldec, this.options.doctype, {\n        headless: this.options.headless,\n        allowSurrogateChars: this.options.allowSurrogateChars\n      });\n      return render(rootElement, rootObj).end(this.options.renderOpts);\n    };\n\n    return Builder;\n\n  })();\n\n}).call(this);\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","module.exports = require('events').EventEmitter;\n","'use strict';\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar _require = require('buffer'),\n  Buffer = _require.Buffer;\nvar _require2 = require('util'),\n  inspect = _require2.inspect;\nvar custom = inspect && inspect.custom || 'inspect';\nfunction copyBuffer(src, target, offset) {\n  Buffer.prototype.copy.call(src, target, offset);\n}\nmodule.exports = /*#__PURE__*/function () {\n  function BufferList() {\n    _classCallCheck(this, BufferList);\n    this.head = null;\n    this.tail = null;\n    this.length = 0;\n  }\n  _createClass(BufferList, [{\n    key: \"push\",\n    value: function push(v) {\n      var entry = {\n        data: v,\n        next: null\n      };\n      if (this.length > 0) this.tail.next = entry;else this.head = entry;\n      this.tail = entry;\n      ++this.length;\n    }\n  }, {\n    key: \"unshift\",\n    value: function unshift(v) {\n      var entry = {\n        data: v,\n        next: this.head\n      };\n      if (this.length === 0) this.tail = entry;\n      this.head = entry;\n      ++this.length;\n    }\n  }, {\n    key: \"shift\",\n    value: function shift() {\n      if (this.length === 0) return;\n      var ret = this.head.data;\n      if (this.length === 1) this.head = this.tail = null;else this.head = this.head.next;\n      --this.length;\n      return ret;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.head = this.tail = null;\n      this.length = 0;\n    }\n  }, {\n    key: \"join\",\n    value: function join(s) {\n      if (this.length === 0) return '';\n      var p = this.head;\n      var ret = '' + p.data;\n      while (p = p.next) ret += s + p.data;\n      return ret;\n    }\n  }, {\n    key: \"concat\",\n    value: function concat(n) {\n      if (this.length === 0) return Buffer.alloc(0);\n      var ret = Buffer.allocUnsafe(n >>> 0);\n      var p = this.head;\n      var i = 0;\n      while (p) {\n        copyBuffer(p.data, ret, i);\n        i += p.data.length;\n        p = p.next;\n      }\n      return ret;\n    }\n\n    // Consumes a specified amount of bytes or characters from the buffered data.\n  }, {\n    key: \"consume\",\n    value: function consume(n, hasStrings) {\n      var ret;\n      if (n < this.head.data.length) {\n        // `slice` is the same for buffers and strings.\n        ret = this.head.data.slice(0, n);\n        this.head.data = this.head.data.slice(n);\n      } else if (n === this.head.data.length) {\n        // First chunk is a perfect match.\n        ret = this.shift();\n      } else {\n        // Result spans more than one buffer.\n        ret = hasStrings ? this._getString(n) : this._getBuffer(n);\n      }\n      return ret;\n    }\n  }, {\n    key: \"first\",\n    value: function first() {\n      return this.head.data;\n    }\n\n    // Consumes a specified amount of characters from the buffered data.\n  }, {\n    key: \"_getString\",\n    value: function _getString(n) {\n      var p = this.head;\n      var c = 1;\n      var ret = p.data;\n      n -= ret.length;\n      while (p = p.next) {\n        var str = p.data;\n        var nb = n > str.length ? str.length : n;\n        if (nb === str.length) ret += str;else ret += str.slice(0, n);\n        n -= nb;\n        if (n === 0) {\n          if (nb === str.length) {\n            ++c;\n            if (p.next) this.head = p.next;else this.head = this.tail = null;\n          } else {\n            this.head = p;\n            p.data = str.slice(nb);\n          }\n          break;\n        }\n        ++c;\n      }\n      this.length -= c;\n      return ret;\n    }\n\n    // Consumes a specified amount of bytes from the buffered data.\n  }, {\n    key: \"_getBuffer\",\n    value: function _getBuffer(n) {\n      var ret = Buffer.allocUnsafe(n);\n      var p = this.head;\n      var c = 1;\n      p.data.copy(ret);\n      n -= p.data.length;\n      while (p = p.next) {\n        var buf = p.data;\n        var nb = n > buf.length ? buf.length : n;\n        buf.copy(ret, ret.length - n, 0, nb);\n        n -= nb;\n        if (n === 0) {\n          if (nb === buf.length) {\n            ++c;\n            if (p.next) this.head = p.next;else this.head = this.tail = null;\n          } else {\n            this.head = p;\n            p.data = buf.slice(nb);\n          }\n          break;\n        }\n        ++c;\n      }\n      this.length -= c;\n      return ret;\n    }\n\n    // Make sure the linked list only shows the minimal necessary information.\n  }, {\n    key: custom,\n    value: function value(_, options) {\n      return inspect(this, _objectSpread(_objectSpread({}, options), {}, {\n        // Only inspect one level.\n        depth: 0,\n        // It should not recurse.\n        customInspect: false\n      }));\n    }\n  }]);\n  return BufferList;\n}();","'use strict';\n\n// undocumented cb() API, needed for core, not for public API\nfunction destroy(err, cb) {\n  var _this = this;\n  var readableDestroyed = this._readableState && this._readableState.destroyed;\n  var writableDestroyed = this._writableState && this._writableState.destroyed;\n  if (readableDestroyed || writableDestroyed) {\n    if (cb) {\n      cb(err);\n    } else if (err) {\n      if (!this._writableState) {\n        process.nextTick(emitErrorNT, this, err);\n      } else if (!this._writableState.errorEmitted) {\n        this._writableState.errorEmitted = true;\n        process.nextTick(emitErrorNT, this, err);\n      }\n    }\n    return this;\n  }\n\n  // we set destroyed to true before firing error callbacks in order\n  // to make it re-entrance safe in case destroy() is called within callbacks\n\n  if (this._readableState) {\n    this._readableState.destroyed = true;\n  }\n\n  // if this is a duplex stream mark the writable part as destroyed as well\n  if (this._writableState) {\n    this._writableState.destroyed = true;\n  }\n  this._destroy(err || null, function (err) {\n    if (!cb && err) {\n      if (!_this._writableState) {\n        process.nextTick(emitErrorAndCloseNT, _this, err);\n      } else if (!_this._writableState.errorEmitted) {\n        _this._writableState.errorEmitted = true;\n        process.nextTick(emitErrorAndCloseNT, _this, err);\n      } else {\n        process.nextTick(emitCloseNT, _this);\n      }\n    } else if (cb) {\n      process.nextTick(emitCloseNT, _this);\n      cb(err);\n    } else {\n      process.nextTick(emitCloseNT, _this);\n    }\n  });\n  return this;\n}\nfunction emitErrorAndCloseNT(self, err) {\n  emitErrorNT(self, err);\n  emitCloseNT(self);\n}\nfunction emitCloseNT(self) {\n  if (self._writableState && !self._writableState.emitClose) return;\n  if (self._readableState && !self._readableState.emitClose) return;\n  self.emit('close');\n}\nfunction undestroy() {\n  if (this._readableState) {\n    this._readableState.destroyed = false;\n    this._readableState.reading = false;\n    this._readableState.ended = false;\n    this._readableState.endEmitted = false;\n  }\n  if (this._writableState) {\n    this._writableState.destroyed = false;\n    this._writableState.ended = false;\n    this._writableState.ending = false;\n    this._writableState.finalCalled = false;\n    this._writableState.prefinished = false;\n    this._writableState.finished = false;\n    this._writableState.errorEmitted = false;\n  }\n}\nfunction emitErrorNT(self, err) {\n  self.emit('error', err);\n}\nfunction errorOrDestroy(stream, err) {\n  // We have tests that rely on errors being emitted\n  // in the same tick, so changing this is semver major.\n  // For now when you opt-in to autoDestroy we allow\n  // the error to be emitted nextTick. In a future\n  // semver major update we should change the default to this.\n\n  var rState = stream._readableState;\n  var wState = stream._writableState;\n  if (rState && rState.autoDestroy || wState && wState.autoDestroy) stream.destroy(err);else stream.emit('error', err);\n}\nmodule.exports = {\n  destroy: destroy,\n  undestroy: undestroy,\n  errorOrDestroy: errorOrDestroy\n};","'use strict';\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nvar codes = {};\n\nfunction createErrorType(code, message, Base) {\n  if (!Base) {\n    Base = Error;\n  }\n\n  function getMessage(arg1, arg2, arg3) {\n    if (typeof message === 'string') {\n      return message;\n    } else {\n      return message(arg1, arg2, arg3);\n    }\n  }\n\n  var NodeError =\n  /*#__PURE__*/\n  function (_Base) {\n    _inheritsLoose(NodeError, _Base);\n\n    function NodeError(arg1, arg2, arg3) {\n      return _Base.call(this, getMessage(arg1, arg2, arg3)) || this;\n    }\n\n    return NodeError;\n  }(Base);\n\n  NodeError.prototype.name = Base.name;\n  NodeError.prototype.code = code;\n  codes[code] = NodeError;\n} // https://github.com/nodejs/node/blob/v10.8.0/lib/internal/errors.js\n\n\nfunction oneOf(expected, thing) {\n  if (Array.isArray(expected)) {\n    var len = expected.length;\n    expected = expected.map(function (i) {\n      return String(i);\n    });\n\n    if (len > 2) {\n      return \"one of \".concat(thing, \" \").concat(expected.slice(0, len - 1).join(', '), \", or \") + expected[len - 1];\n    } else if (len === 2) {\n      return \"one of \".concat(thing, \" \").concat(expected[0], \" or \").concat(expected[1]);\n    } else {\n      return \"of \".concat(thing, \" \").concat(expected[0]);\n    }\n  } else {\n    return \"of \".concat(thing, \" \").concat(String(expected));\n  }\n} // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith\n\n\nfunction startsWith(str, search, pos) {\n  return str.substr(!pos || pos < 0 ? 0 : +pos, search.length) === search;\n} // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith\n\n\nfunction endsWith(str, search, this_len) {\n  if (this_len === undefined || this_len > str.length) {\n    this_len = str.length;\n  }\n\n  return str.substring(this_len - search.length, this_len) === search;\n} // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/includes\n\n\nfunction includes(str, search, start) {\n  if (typeof start !== 'number') {\n    start = 0;\n  }\n\n  if (start + search.length > str.length) {\n    return false;\n  } else {\n    return str.indexOf(search, start) !== -1;\n  }\n}\n\ncreateErrorType('ERR_INVALID_OPT_VALUE', function (name, value) {\n  return 'The value \"' + value + '\" is invalid for option \"' + name + '\"';\n}, TypeError);\ncreateErrorType('ERR_INVALID_ARG_TYPE', function (name, expected, actual) {\n  // determiner: 'must be' or 'must not be'\n  var determiner;\n\n  if (typeof expected === 'string' && startsWith(expected, 'not ')) {\n    determiner = 'must not be';\n    expected = expected.replace(/^not /, '');\n  } else {\n    determiner = 'must be';\n  }\n\n  var msg;\n\n  if (endsWith(name, ' argument')) {\n    // For cases like 'first argument'\n    msg = \"The \".concat(name, \" \").concat(determiner, \" \").concat(oneOf(expected, 'type'));\n  } else {\n    var type = includes(name, '.') ? 'property' : 'argument';\n    msg = \"The \\\"\".concat(name, \"\\\" \").concat(type, \" \").concat(determiner, \" \").concat(oneOf(expected, 'type'));\n  }\n\n  msg += \". Received type \".concat(typeof actual);\n  return msg;\n}, TypeError);\ncreateErrorType('ERR_STREAM_PUSH_AFTER_EOF', 'stream.push() after EOF');\ncreateErrorType('ERR_METHOD_NOT_IMPLEMENTED', function (name) {\n  return 'The ' + name + ' method is not implemented';\n});\ncreateErrorType('ERR_STREAM_PREMATURE_CLOSE', 'Premature close');\ncreateErrorType('ERR_STREAM_DESTROYED', function (name) {\n  return 'Cannot call ' + name + ' after a stream was destroyed';\n});\ncreateErrorType('ERR_MULTIPLE_CALLBACK', 'Callback called multiple times');\ncreateErrorType('ERR_STREAM_CANNOT_PIPE', 'Cannot pipe, not readable');\ncreateErrorType('ERR_STREAM_WRITE_AFTER_END', 'write after end');\ncreateErrorType('ERR_STREAM_NULL_VALUES', 'May not write null values to stream', TypeError);\ncreateErrorType('ERR_UNKNOWN_ENCODING', function (arg) {\n  return 'Unknown encoding: ' + arg;\n}, TypeError);\ncreateErrorType('ERR_STREAM_UNSHIFT_AFTER_END_EVENT', 'stream.unshift() after end event');\nmodule.exports.codes = codes;\n","'use strict';\n\nvar ERR_INVALID_OPT_VALUE = require('../../../errors').codes.ERR_INVALID_OPT_VALUE;\nfunction highWaterMarkFrom(options, isDuplex, duplexKey) {\n  return options.highWaterMark != null ? options.highWaterMark : isDuplex ? options[duplexKey] : null;\n}\nfunction getHighWaterMark(state, options, duplexKey, isDuplex) {\n  var hwm = highWaterMarkFrom(options, isDuplex, duplexKey);\n  if (hwm != null) {\n    if (!(isFinite(hwm) && Math.floor(hwm) === hwm) || hwm < 0) {\n      var name = isDuplex ? duplexKey : 'highWaterMark';\n      throw new ERR_INVALID_OPT_VALUE(name, hwm);\n    }\n    return Math.floor(hwm);\n  }\n\n  // Default value\n  return state.objectMode ? 16 : 16 * 1024;\n}\nmodule.exports = {\n  getHighWaterMark: getHighWaterMark\n};","\n/**\n * Module exports.\n */\n\nmodule.exports = deprecate;\n\n/**\n * Mark that a method should not be used.\n * Returns a modified function which warns once by default.\n *\n * If `localStorage.noDeprecation = true` is set, then it is a no-op.\n *\n * If `localStorage.throwDeprecation = true` is set, then deprecated functions\n * will throw an Error when invoked.\n *\n * If `localStorage.traceDeprecation = true` is set, then deprecated functions\n * will invoke `console.trace()` instead of `console.error()`.\n *\n * @param {Function} fn - the function to deprecate\n * @param {String} msg - the string to print to the console when `fn` is invoked\n * @returns {Function} a new \"deprecated\" version of `fn`\n * @api public\n */\n\nfunction deprecate (fn, msg) {\n  if (config('noDeprecation')) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (config('throwDeprecation')) {\n        throw new Error(msg);\n      } else if (config('traceDeprecation')) {\n        console.trace(msg);\n      } else {\n        console.warn(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n}\n\n/**\n * Checks `localStorage` for boolean values for the given `name`.\n *\n * @param {String} name\n * @returns {Boolean}\n * @api private\n */\n\nfunction config (name) {\n  // accessing global.localStorage can trigger a DOMException in sandboxed iframes\n  try {\n    if (!global.localStorage) return false;\n  } catch (_) {\n    return false;\n  }\n  var val = global.localStorage[name];\n  if (null == val) return false;\n  return String(val).toLowerCase() === 'true';\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// A bit simpler than readable streams.\n// Implement an async ._write(chunk, encoding, cb), and it'll handle all\n// the drain event emission and buffering.\n\n'use strict';\n\nmodule.exports = Writable;\n\n/* <replacement> */\nfunction WriteReq(chunk, encoding, cb) {\n  this.chunk = chunk;\n  this.encoding = encoding;\n  this.callback = cb;\n  this.next = null;\n}\n\n// It seems a linked list but it is not\n// there will be only 2 of these for each stream\nfunction CorkedRequest(state) {\n  var _this = this;\n  this.next = null;\n  this.entry = null;\n  this.finish = function () {\n    onCorkedFinish(_this, state);\n  };\n}\n/* </replacement> */\n\n/*<replacement>*/\nvar Duplex;\n/*</replacement>*/\n\nWritable.WritableState = WritableState;\n\n/*<replacement>*/\nvar internalUtil = {\n  deprecate: require('util-deprecate')\n};\n/*</replacement>*/\n\n/*<replacement>*/\nvar Stream = require('./internal/streams/stream');\n/*</replacement>*/\n\nvar Buffer = require('buffer').Buffer;\nvar OurUint8Array = (typeof global !== 'undefined' ? global : typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : {}).Uint8Array || function () {};\nfunction _uint8ArrayToBuffer(chunk) {\n  return Buffer.from(chunk);\n}\nfunction _isUint8Array(obj) {\n  return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n}\nvar destroyImpl = require('./internal/streams/destroy');\nvar _require = require('./internal/streams/state'),\n  getHighWaterMark = _require.getHighWaterMark;\nvar _require$codes = require('../errors').codes,\n  ERR_INVALID_ARG_TYPE = _require$codes.ERR_INVALID_ARG_TYPE,\n  ERR_METHOD_NOT_IMPLEMENTED = _require$codes.ERR_METHOD_NOT_IMPLEMENTED,\n  ERR_MULTIPLE_CALLBACK = _require$codes.ERR_MULTIPLE_CALLBACK,\n  ERR_STREAM_CANNOT_PIPE = _require$codes.ERR_STREAM_CANNOT_PIPE,\n  ERR_STREAM_DESTROYED = _require$codes.ERR_STREAM_DESTROYED,\n  ERR_STREAM_NULL_VALUES = _require$codes.ERR_STREAM_NULL_VALUES,\n  ERR_STREAM_WRITE_AFTER_END = _require$codes.ERR_STREAM_WRITE_AFTER_END,\n  ERR_UNKNOWN_ENCODING = _require$codes.ERR_UNKNOWN_ENCODING;\nvar errorOrDestroy = destroyImpl.errorOrDestroy;\nrequire('inherits')(Writable, Stream);\nfunction nop() {}\nfunction WritableState(options, stream, isDuplex) {\n  Duplex = Duplex || require('./_stream_duplex');\n  options = options || {};\n\n  // Duplex streams are both readable and writable, but share\n  // the same options object.\n  // However, some cases require setting options to different\n  // values for the readable and the writable sides of the duplex stream,\n  // e.g. options.readableObjectMode vs. options.writableObjectMode, etc.\n  if (typeof isDuplex !== 'boolean') isDuplex = stream instanceof Duplex;\n\n  // object stream flag to indicate whether or not this stream\n  // contains buffers or objects.\n  this.objectMode = !!options.objectMode;\n  if (isDuplex) this.objectMode = this.objectMode || !!options.writableObjectMode;\n\n  // the point at which write() starts returning false\n  // Note: 0 is a valid value, means that we always return false if\n  // the entire buffer is not flushed immediately on write()\n  this.highWaterMark = getHighWaterMark(this, options, 'writableHighWaterMark', isDuplex);\n\n  // if _final has been called\n  this.finalCalled = false;\n\n  // drain event flag.\n  this.needDrain = false;\n  // at the start of calling end()\n  this.ending = false;\n  // when end() has been called, and returned\n  this.ended = false;\n  // when 'finish' is emitted\n  this.finished = false;\n\n  // has it been destroyed\n  this.destroyed = false;\n\n  // should we decode strings into buffers before passing to _write?\n  // this is here so that some node-core streams can optimize string\n  // handling at a lower level.\n  var noDecode = options.decodeStrings === false;\n  this.decodeStrings = !noDecode;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // not an actual buffer we keep track of, but a measurement\n  // of how much we're waiting to get pushed to some underlying\n  // socket or file.\n  this.length = 0;\n\n  // a flag to see when we're in the middle of a write.\n  this.writing = false;\n\n  // when true all writes will be buffered until .uncork() call\n  this.corked = 0;\n\n  // a flag to be able to tell if the onwrite cb is called immediately,\n  // or on a later tick.  We set this to true at first, because any\n  // actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first write call.\n  this.sync = true;\n\n  // a flag to know if we're processing previously buffered items, which\n  // may call the _write() callback in the same tick, so that we don't\n  // end up in an overlapped onwrite situation.\n  this.bufferProcessing = false;\n\n  // the callback that's passed to _write(chunk,cb)\n  this.onwrite = function (er) {\n    onwrite(stream, er);\n  };\n\n  // the callback that the user supplies to write(chunk,encoding,cb)\n  this.writecb = null;\n\n  // the amount that is being written when _write is called.\n  this.writelen = 0;\n  this.bufferedRequest = null;\n  this.lastBufferedRequest = null;\n\n  // number of pending user-supplied write callbacks\n  // this must be 0 before 'finish' can be emitted\n  this.pendingcb = 0;\n\n  // emit prefinish if the only thing we're waiting for is _write cbs\n  // This is relevant for synchronous Transform streams\n  this.prefinished = false;\n\n  // True if the error was already emitted and should not be thrown again\n  this.errorEmitted = false;\n\n  // Should close be emitted on destroy. Defaults to true.\n  this.emitClose = options.emitClose !== false;\n\n  // Should .destroy() be called after 'finish' (and potentially 'end')\n  this.autoDestroy = !!options.autoDestroy;\n\n  // count buffered requests\n  this.bufferedRequestCount = 0;\n\n  // allocate the first CorkedRequest, there is always\n  // one allocated and free to use, and we maintain at most two\n  this.corkedRequestsFree = new CorkedRequest(this);\n}\nWritableState.prototype.getBuffer = function getBuffer() {\n  var current = this.bufferedRequest;\n  var out = [];\n  while (current) {\n    out.push(current);\n    current = current.next;\n  }\n  return out;\n};\n(function () {\n  try {\n    Object.defineProperty(WritableState.prototype, 'buffer', {\n      get: internalUtil.deprecate(function writableStateBufferGetter() {\n        return this.getBuffer();\n      }, '_writableState.buffer is deprecated. Use _writableState.getBuffer ' + 'instead.', 'DEP0003')\n    });\n  } catch (_) {}\n})();\n\n// Test _writableState for inheritance to account for Duplex streams,\n// whose prototype chain only points to Readable.\nvar realHasInstance;\nif (typeof Symbol === 'function' && Symbol.hasInstance && typeof Function.prototype[Symbol.hasInstance] === 'function') {\n  realHasInstance = Function.prototype[Symbol.hasInstance];\n  Object.defineProperty(Writable, Symbol.hasInstance, {\n    value: function value(object) {\n      if (realHasInstance.call(this, object)) return true;\n      if (this !== Writable) return false;\n      return object && object._writableState instanceof WritableState;\n    }\n  });\n} else {\n  realHasInstance = function realHasInstance(object) {\n    return object instanceof this;\n  };\n}\nfunction Writable(options) {\n  Duplex = Duplex || require('./_stream_duplex');\n\n  // Writable ctor is applied to Duplexes, too.\n  // `realHasInstance` is necessary because using plain `instanceof`\n  // would return false, as no `_writableState` property is attached.\n\n  // Trying to use the custom `instanceof` for Writable here will also break the\n  // Node.js LazyTransform implementation, which has a non-trivial getter for\n  // `_writableState` that would lead to infinite recursion.\n\n  // Checking for a Stream.Duplex instance is faster here instead of inside\n  // the WritableState constructor, at least with V8 6.5\n  var isDuplex = this instanceof Duplex;\n  if (!isDuplex && !realHasInstance.call(Writable, this)) return new Writable(options);\n  this._writableState = new WritableState(options, this, isDuplex);\n\n  // legacy.\n  this.writable = true;\n  if (options) {\n    if (typeof options.write === 'function') this._write = options.write;\n    if (typeof options.writev === 'function') this._writev = options.writev;\n    if (typeof options.destroy === 'function') this._destroy = options.destroy;\n    if (typeof options.final === 'function') this._final = options.final;\n  }\n  Stream.call(this);\n}\n\n// Otherwise people can pipe Writable streams, which is just wrong.\nWritable.prototype.pipe = function () {\n  errorOrDestroy(this, new ERR_STREAM_CANNOT_PIPE());\n};\nfunction writeAfterEnd(stream, cb) {\n  var er = new ERR_STREAM_WRITE_AFTER_END();\n  // TODO: defer error events consistently everywhere, not just the cb\n  errorOrDestroy(stream, er);\n  process.nextTick(cb, er);\n}\n\n// Checks that a user-supplied chunk is valid, especially for the particular\n// mode the stream is in. Currently this means that `null` is never accepted\n// and undefined/non-string values are only allowed in object mode.\nfunction validChunk(stream, state, chunk, cb) {\n  var er;\n  if (chunk === null) {\n    er = new ERR_STREAM_NULL_VALUES();\n  } else if (typeof chunk !== 'string' && !state.objectMode) {\n    er = new ERR_INVALID_ARG_TYPE('chunk', ['string', 'Buffer'], chunk);\n  }\n  if (er) {\n    errorOrDestroy(stream, er);\n    process.nextTick(cb, er);\n    return false;\n  }\n  return true;\n}\nWritable.prototype.write = function (chunk, encoding, cb) {\n  var state = this._writableState;\n  var ret = false;\n  var isBuf = !state.objectMode && _isUint8Array(chunk);\n  if (isBuf && !Buffer.isBuffer(chunk)) {\n    chunk = _uint8ArrayToBuffer(chunk);\n  }\n  if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n  if (isBuf) encoding = 'buffer';else if (!encoding) encoding = state.defaultEncoding;\n  if (typeof cb !== 'function') cb = nop;\n  if (state.ending) writeAfterEnd(this, cb);else if (isBuf || validChunk(this, state, chunk, cb)) {\n    state.pendingcb++;\n    ret = writeOrBuffer(this, state, isBuf, chunk, encoding, cb);\n  }\n  return ret;\n};\nWritable.prototype.cork = function () {\n  this._writableState.corked++;\n};\nWritable.prototype.uncork = function () {\n  var state = this._writableState;\n  if (state.corked) {\n    state.corked--;\n    if (!state.writing && !state.corked && !state.bufferProcessing && state.bufferedRequest) clearBuffer(this, state);\n  }\n};\nWritable.prototype.setDefaultEncoding = function setDefaultEncoding(encoding) {\n  // node::ParseEncoding() requires lower case.\n  if (typeof encoding === 'string') encoding = encoding.toLowerCase();\n  if (!(['hex', 'utf8', 'utf-8', 'ascii', 'binary', 'base64', 'ucs2', 'ucs-2', 'utf16le', 'utf-16le', 'raw'].indexOf((encoding + '').toLowerCase()) > -1)) throw new ERR_UNKNOWN_ENCODING(encoding);\n  this._writableState.defaultEncoding = encoding;\n  return this;\n};\nObject.defineProperty(Writable.prototype, 'writableBuffer', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState && this._writableState.getBuffer();\n  }\n});\nfunction decodeChunk(state, chunk, encoding) {\n  if (!state.objectMode && state.decodeStrings !== false && typeof chunk === 'string') {\n    chunk = Buffer.from(chunk, encoding);\n  }\n  return chunk;\n}\nObject.defineProperty(Writable.prototype, 'writableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.highWaterMark;\n  }\n});\n\n// if we're already writing something, then just put this\n// in the queue, and wait our turn.  Otherwise, call _write\n// If we return false, then we need a drain event, so set that flag.\nfunction writeOrBuffer(stream, state, isBuf, chunk, encoding, cb) {\n  if (!isBuf) {\n    var newChunk = decodeChunk(state, chunk, encoding);\n    if (chunk !== newChunk) {\n      isBuf = true;\n      encoding = 'buffer';\n      chunk = newChunk;\n    }\n  }\n  var len = state.objectMode ? 1 : chunk.length;\n  state.length += len;\n  var ret = state.length < state.highWaterMark;\n  // we must ensure that previous needDrain will not be reset to false.\n  if (!ret) state.needDrain = true;\n  if (state.writing || state.corked) {\n    var last = state.lastBufferedRequest;\n    state.lastBufferedRequest = {\n      chunk: chunk,\n      encoding: encoding,\n      isBuf: isBuf,\n      callback: cb,\n      next: null\n    };\n    if (last) {\n      last.next = state.lastBufferedRequest;\n    } else {\n      state.bufferedRequest = state.lastBufferedRequest;\n    }\n    state.bufferedRequestCount += 1;\n  } else {\n    doWrite(stream, state, false, len, chunk, encoding, cb);\n  }\n  return ret;\n}\nfunction doWrite(stream, state, writev, len, chunk, encoding, cb) {\n  state.writelen = len;\n  state.writecb = cb;\n  state.writing = true;\n  state.sync = true;\n  if (state.destroyed) state.onwrite(new ERR_STREAM_DESTROYED('write'));else if (writev) stream._writev(chunk, state.onwrite);else stream._write(chunk, encoding, state.onwrite);\n  state.sync = false;\n}\nfunction onwriteError(stream, state, sync, er, cb) {\n  --state.pendingcb;\n  if (sync) {\n    // defer the callback if we are being called synchronously\n    // to avoid piling up things on the stack\n    process.nextTick(cb, er);\n    // this can emit finish, and it will always happen\n    // after error\n    process.nextTick(finishMaybe, stream, state);\n    stream._writableState.errorEmitted = true;\n    errorOrDestroy(stream, er);\n  } else {\n    // the caller expect this to happen before if\n    // it is async\n    cb(er);\n    stream._writableState.errorEmitted = true;\n    errorOrDestroy(stream, er);\n    // this can emit finish, but finish must\n    // always follow error\n    finishMaybe(stream, state);\n  }\n}\nfunction onwriteStateUpdate(state) {\n  state.writing = false;\n  state.writecb = null;\n  state.length -= state.writelen;\n  state.writelen = 0;\n}\nfunction onwrite(stream, er) {\n  var state = stream._writableState;\n  var sync = state.sync;\n  var cb = state.writecb;\n  if (typeof cb !== 'function') throw new ERR_MULTIPLE_CALLBACK();\n  onwriteStateUpdate(state);\n  if (er) onwriteError(stream, state, sync, er, cb);else {\n    // Check if we're actually ready to finish, but don't emit yet\n    var finished = needFinish(state) || stream.destroyed;\n    if (!finished && !state.corked && !state.bufferProcessing && state.bufferedRequest) {\n      clearBuffer(stream, state);\n    }\n    if (sync) {\n      process.nextTick(afterWrite, stream, state, finished, cb);\n    } else {\n      afterWrite(stream, state, finished, cb);\n    }\n  }\n}\nfunction afterWrite(stream, state, finished, cb) {\n  if (!finished) onwriteDrain(stream, state);\n  state.pendingcb--;\n  cb();\n  finishMaybe(stream, state);\n}\n\n// Must force callback to be called on nextTick, so that we don't\n// emit 'drain' before the write() consumer gets the 'false' return\n// value, and has a chance to attach a 'drain' listener.\nfunction onwriteDrain(stream, state) {\n  if (state.length === 0 && state.needDrain) {\n    state.needDrain = false;\n    stream.emit('drain');\n  }\n}\n\n// if there's something in the buffer waiting, then process it\nfunction clearBuffer(stream, state) {\n  state.bufferProcessing = true;\n  var entry = state.bufferedRequest;\n  if (stream._writev && entry && entry.next) {\n    // Fast case, write everything using _writev()\n    var l = state.bufferedRequestCount;\n    var buffer = new Array(l);\n    var holder = state.corkedRequestsFree;\n    holder.entry = entry;\n    var count = 0;\n    var allBuffers = true;\n    while (entry) {\n      buffer[count] = entry;\n      if (!entry.isBuf) allBuffers = false;\n      entry = entry.next;\n      count += 1;\n    }\n    buffer.allBuffers = allBuffers;\n    doWrite(stream, state, true, state.length, buffer, '', holder.finish);\n\n    // doWrite is almost always async, defer these to save a bit of time\n    // as the hot path ends with doWrite\n    state.pendingcb++;\n    state.lastBufferedRequest = null;\n    if (holder.next) {\n      state.corkedRequestsFree = holder.next;\n      holder.next = null;\n    } else {\n      state.corkedRequestsFree = new CorkedRequest(state);\n    }\n    state.bufferedRequestCount = 0;\n  } else {\n    // Slow case, write chunks one-by-one\n    while (entry) {\n      var chunk = entry.chunk;\n      var encoding = entry.encoding;\n      var cb = entry.callback;\n      var len = state.objectMode ? 1 : chunk.length;\n      doWrite(stream, state, false, len, chunk, encoding, cb);\n      entry = entry.next;\n      state.bufferedRequestCount--;\n      // if we didn't call the onwrite immediately, then\n      // it means that we need to wait until it does.\n      // also, that means that the chunk and cb are currently\n      // being processed, so move the buffer counter past them.\n      if (state.writing) {\n        break;\n      }\n    }\n    if (entry === null) state.lastBufferedRequest = null;\n  }\n  state.bufferedRequest = entry;\n  state.bufferProcessing = false;\n}\nWritable.prototype._write = function (chunk, encoding, cb) {\n  cb(new ERR_METHOD_NOT_IMPLEMENTED('_write()'));\n};\nWritable.prototype._writev = null;\nWritable.prototype.end = function (chunk, encoding, cb) {\n  var state = this._writableState;\n  if (typeof chunk === 'function') {\n    cb = chunk;\n    chunk = null;\n    encoding = null;\n  } else if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n  if (chunk !== null && chunk !== undefined) this.write(chunk, encoding);\n\n  // .end() fully uncorks\n  if (state.corked) {\n    state.corked = 1;\n    this.uncork();\n  }\n\n  // ignore unnecessary end() calls.\n  if (!state.ending) endWritable(this, state, cb);\n  return this;\n};\nObject.defineProperty(Writable.prototype, 'writableLength', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.length;\n  }\n});\nfunction needFinish(state) {\n  return state.ending && state.length === 0 && state.bufferedRequest === null && !state.finished && !state.writing;\n}\nfunction callFinal(stream, state) {\n  stream._final(function (err) {\n    state.pendingcb--;\n    if (err) {\n      errorOrDestroy(stream, err);\n    }\n    state.prefinished = true;\n    stream.emit('prefinish');\n    finishMaybe(stream, state);\n  });\n}\nfunction prefinish(stream, state) {\n  if (!state.prefinished && !state.finalCalled) {\n    if (typeof stream._final === 'function' && !state.destroyed) {\n      state.pendingcb++;\n      state.finalCalled = true;\n      process.nextTick(callFinal, stream, state);\n    } else {\n      state.prefinished = true;\n      stream.emit('prefinish');\n    }\n  }\n}\nfunction finishMaybe(stream, state) {\n  var need = needFinish(state);\n  if (need) {\n    prefinish(stream, state);\n    if (state.pendingcb === 0) {\n      state.finished = true;\n      stream.emit('finish');\n      if (state.autoDestroy) {\n        // In case of duplex streams we need a way to detect\n        // if the readable side is ready for autoDestroy as well\n        var rState = stream._readableState;\n        if (!rState || rState.autoDestroy && rState.endEmitted) {\n          stream.destroy();\n        }\n      }\n    }\n  }\n  return need;\n}\nfunction endWritable(stream, state, cb) {\n  state.ending = true;\n  finishMaybe(stream, state);\n  if (cb) {\n    if (state.finished) process.nextTick(cb);else stream.once('finish', cb);\n  }\n  state.ended = true;\n  stream.writable = false;\n}\nfunction onCorkedFinish(corkReq, state, err) {\n  var entry = corkReq.entry;\n  corkReq.entry = null;\n  while (entry) {\n    var cb = entry.callback;\n    state.pendingcb--;\n    cb(err);\n    entry = entry.next;\n  }\n\n  // reuse the free corkReq.\n  state.corkedRequestsFree.next = corkReq;\n}\nObject.defineProperty(Writable.prototype, 'destroyed', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    if (this._writableState === undefined) {\n      return false;\n    }\n    return this._writableState.destroyed;\n  },\n  set: function set(value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (!this._writableState) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._writableState.destroyed = value;\n  }\n});\nWritable.prototype.destroy = destroyImpl.destroy;\nWritable.prototype._undestroy = destroyImpl.undestroy;\nWritable.prototype._destroy = function (err, cb) {\n  cb(err);\n};","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a duplex stream is just a stream that is both readable and writable.\n// Since JS doesn't have multiple prototypal inheritance, this class\n// prototypally inherits from Readable, and then parasitically from\n// Writable.\n\n'use strict';\n\n/*<replacement>*/\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n};\n/*</replacement>*/\n\nmodule.exports = Duplex;\nvar Readable = require('./_stream_readable');\nvar Writable = require('./_stream_writable');\nrequire('inherits')(Duplex, Readable);\n{\n  // Allow the keys array to be GC'ed.\n  var keys = objectKeys(Writable.prototype);\n  for (var v = 0; v < keys.length; v++) {\n    var method = keys[v];\n    if (!Duplex.prototype[method]) Duplex.prototype[method] = Writable.prototype[method];\n  }\n}\nfunction Duplex(options) {\n  if (!(this instanceof Duplex)) return new Duplex(options);\n  Readable.call(this, options);\n  Writable.call(this, options);\n  this.allowHalfOpen = true;\n  if (options) {\n    if (options.readable === false) this.readable = false;\n    if (options.writable === false) this.writable = false;\n    if (options.allowHalfOpen === false) {\n      this.allowHalfOpen = false;\n      this.once('end', onend);\n    }\n  }\n}\nObject.defineProperty(Duplex.prototype, 'writableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.highWaterMark;\n  }\n});\nObject.defineProperty(Duplex.prototype, 'writableBuffer', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState && this._writableState.getBuffer();\n  }\n});\nObject.defineProperty(Duplex.prototype, 'writableLength', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.length;\n  }\n});\n\n// the no-half-open enforcer\nfunction onend() {\n  // If the writable side ended, then we're ok.\n  if (this._writableState.ended) return;\n\n  // no more data can be written.\n  // But allow more writes to happen in this tick.\n  process.nextTick(onEndNT, this);\n}\nfunction onEndNT(self) {\n  self.end();\n}\nObject.defineProperty(Duplex.prototype, 'destroyed', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    if (this._readableState === undefined || this._writableState === undefined) {\n      return false;\n    }\n    return this._readableState.destroyed && this._writableState.destroyed;\n  },\n  set: function set(value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (this._readableState === undefined || this._writableState === undefined) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._readableState.destroyed = value;\n    this._writableState.destroyed = value;\n  }\n});","/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */\n/* eslint-disable node/no-deprecated-api */\nvar buffer = require('buffer')\nvar Buffer = buffer.Buffer\n\n// alternative to using Object.keys for old browsers\nfunction copyProps (src, dst) {\n  for (var key in src) {\n    dst[key] = src[key]\n  }\n}\nif (Buffer.from && Buffer.alloc && Buffer.allocUnsafe && Buffer.allocUnsafeSlow) {\n  module.exports = buffer\n} else {\n  // Copy properties from require('buffer')\n  copyProps(buffer, exports)\n  exports.Buffer = SafeBuffer\n}\n\nfunction SafeBuffer (arg, encodingOrOffset, length) {\n  return Buffer(arg, encodingOrOffset, length)\n}\n\nSafeBuffer.prototype = Object.create(Buffer.prototype)\n\n// Copy static methods from Buffer\ncopyProps(Buffer, SafeBuffer)\n\nSafeBuffer.from = function (arg, encodingOrOffset, length) {\n  if (typeof arg === 'number') {\n    throw new TypeError('Argument must not be a number')\n  }\n  return Buffer(arg, encodingOrOffset, length)\n}\n\nSafeBuffer.alloc = function (size, fill, encoding) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  var buf = Buffer(size)\n  if (fill !== undefined) {\n    if (typeof encoding === 'string') {\n      buf.fill(fill, encoding)\n    } else {\n      buf.fill(fill)\n    }\n  } else {\n    buf.fill(0)\n  }\n  return buf\n}\n\nSafeBuffer.allocUnsafe = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return Buffer(size)\n}\n\nSafeBuffer.allocUnsafeSlow = function (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('Argument must be a number')\n  }\n  return buffer.SlowBuffer(size)\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n/*<replacement>*/\n\nvar Buffer = require('safe-buffer').Buffer;\n/*</replacement>*/\n\nvar isEncoding = Buffer.isEncoding || function (encoding) {\n  encoding = '' + encoding;\n  switch (encoding && encoding.toLowerCase()) {\n    case 'hex':case 'utf8':case 'utf-8':case 'ascii':case 'binary':case 'base64':case 'ucs2':case 'ucs-2':case 'utf16le':case 'utf-16le':case 'raw':\n      return true;\n    default:\n      return false;\n  }\n};\n\nfunction _normalizeEncoding(enc) {\n  if (!enc) return 'utf8';\n  var retried;\n  while (true) {\n    switch (enc) {\n      case 'utf8':\n      case 'utf-8':\n        return 'utf8';\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return 'utf16le';\n      case 'latin1':\n      case 'binary':\n        return 'latin1';\n      case 'base64':\n      case 'ascii':\n      case 'hex':\n        return enc;\n      default:\n        if (retried) return; // undefined\n        enc = ('' + enc).toLowerCase();\n        retried = true;\n    }\n  }\n};\n\n// Do not cache `Buffer.isEncoding` when checking encoding names as some\n// modules monkey-patch it to support additional encodings\nfunction normalizeEncoding(enc) {\n  var nenc = _normalizeEncoding(enc);\n  if (typeof nenc !== 'string' && (Buffer.isEncoding === isEncoding || !isEncoding(enc))) throw new Error('Unknown encoding: ' + enc);\n  return nenc || enc;\n}\n\n// StringDecoder provides an interface for efficiently splitting a series of\n// buffers into a series of JS strings without breaking apart multi-byte\n// characters.\nexports.StringDecoder = StringDecoder;\nfunction StringDecoder(encoding) {\n  this.encoding = normalizeEncoding(encoding);\n  var nb;\n  switch (this.encoding) {\n    case 'utf16le':\n      this.text = utf16Text;\n      this.end = utf16End;\n      nb = 4;\n      break;\n    case 'utf8':\n      this.fillLast = utf8FillLast;\n      nb = 4;\n      break;\n    case 'base64':\n      this.text = base64Text;\n      this.end = base64End;\n      nb = 3;\n      break;\n    default:\n      this.write = simpleWrite;\n      this.end = simpleEnd;\n      return;\n  }\n  this.lastNeed = 0;\n  this.lastTotal = 0;\n  this.lastChar = Buffer.allocUnsafe(nb);\n}\n\nStringDecoder.prototype.write = function (buf) {\n  if (buf.length === 0) return '';\n  var r;\n  var i;\n  if (this.lastNeed) {\n    r = this.fillLast(buf);\n    if (r === undefined) return '';\n    i = this.lastNeed;\n    this.lastNeed = 0;\n  } else {\n    i = 0;\n  }\n  if (i < buf.length) return r ? r + this.text(buf, i) : this.text(buf, i);\n  return r || '';\n};\n\nStringDecoder.prototype.end = utf8End;\n\n// Returns only complete characters in a Buffer\nStringDecoder.prototype.text = utf8Text;\n\n// Attempts to complete a partial non-UTF-8 character using bytes from a Buffer\nStringDecoder.prototype.fillLast = function (buf) {\n  if (this.lastNeed <= buf.length) {\n    buf.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, this.lastNeed);\n    return this.lastChar.toString(this.encoding, 0, this.lastTotal);\n  }\n  buf.copy(this.lastChar, this.lastTotal - this.lastNeed, 0, buf.length);\n  this.lastNeed -= buf.length;\n};\n\n// Checks the type of a UTF-8 byte, whether it's ASCII, a leading byte, or a\n// continuation byte. If an invalid byte is detected, -2 is returned.\nfunction utf8CheckByte(byte) {\n  if (byte <= 0x7F) return 0;else if (byte >> 5 === 0x06) return 2;else if (byte >> 4 === 0x0E) return 3;else if (byte >> 3 === 0x1E) return 4;\n  return byte >> 6 === 0x02 ? -1 : -2;\n}\n\n// Checks at most 3 bytes at the end of a Buffer in order to detect an\n// incomplete multi-byte UTF-8 character. The total number of bytes (2, 3, or 4)\n// needed to complete the UTF-8 character (if applicable) are returned.\nfunction utf8CheckIncomplete(self, buf, i) {\n  var j = buf.length - 1;\n  if (j < i) return 0;\n  var nb = utf8CheckByte(buf[j]);\n  if (nb >= 0) {\n    if (nb > 0) self.lastNeed = nb - 1;\n    return nb;\n  }\n  if (--j < i || nb === -2) return 0;\n  nb = utf8CheckByte(buf[j]);\n  if (nb >= 0) {\n    if (nb > 0) self.lastNeed = nb - 2;\n    return nb;\n  }\n  if (--j < i || nb === -2) return 0;\n  nb = utf8CheckByte(buf[j]);\n  if (nb >= 0) {\n    if (nb > 0) {\n      if (nb === 2) nb = 0;else self.lastNeed = nb - 3;\n    }\n    return nb;\n  }\n  return 0;\n}\n\n// Validates as many continuation bytes for a multi-byte UTF-8 character as\n// needed or are available. If we see a non-continuation byte where we expect\n// one, we \"replace\" the validated continuation bytes we've seen so far with\n// a single UTF-8 replacement character ('\\ufffd'), to match v8's UTF-8 decoding\n// behavior. The continuation byte check is included three times in the case\n// where all of the continuation bytes for a character exist in the same buffer.\n// It is also done this way as a slight performance increase instead of using a\n// loop.\nfunction utf8CheckExtraBytes(self, buf, p) {\n  if ((buf[0] & 0xC0) !== 0x80) {\n    self.lastNeed = 0;\n    return '\\ufffd';\n  }\n  if (self.lastNeed > 1 && buf.length > 1) {\n    if ((buf[1] & 0xC0) !== 0x80) {\n      self.lastNeed = 1;\n      return '\\ufffd';\n    }\n    if (self.lastNeed > 2 && buf.length > 2) {\n      if ((buf[2] & 0xC0) !== 0x80) {\n        self.lastNeed = 2;\n        return '\\ufffd';\n      }\n    }\n  }\n}\n\n// Attempts to complete a multi-byte UTF-8 character using bytes from a Buffer.\nfunction utf8FillLast(buf) {\n  var p = this.lastTotal - this.lastNeed;\n  var r = utf8CheckExtraBytes(this, buf, p);\n  if (r !== undefined) return r;\n  if (this.lastNeed <= buf.length) {\n    buf.copy(this.lastChar, p, 0, this.lastNeed);\n    return this.lastChar.toString(this.encoding, 0, this.lastTotal);\n  }\n  buf.copy(this.lastChar, p, 0, buf.length);\n  this.lastNeed -= buf.length;\n}\n\n// Returns all complete UTF-8 characters in a Buffer. If the Buffer ended on a\n// partial character, the character's bytes are buffered until the required\n// number of bytes are available.\nfunction utf8Text(buf, i) {\n  var total = utf8CheckIncomplete(this, buf, i);\n  if (!this.lastNeed) return buf.toString('utf8', i);\n  this.lastTotal = total;\n  var end = buf.length - (total - this.lastNeed);\n  buf.copy(this.lastChar, 0, end);\n  return buf.toString('utf8', i, end);\n}\n\n// For UTF-8, a replacement character is added when ending on a partial\n// character.\nfunction utf8End(buf) {\n  var r = buf && buf.length ? this.write(buf) : '';\n  if (this.lastNeed) return r + '\\ufffd';\n  return r;\n}\n\n// UTF-16LE typically needs two bytes per character, but even if we have an even\n// number of bytes available, we need to check if we end on a leading/high\n// surrogate. In that case, we need to wait for the next two bytes in order to\n// decode the last character properly.\nfunction utf16Text(buf, i) {\n  if ((buf.length - i) % 2 === 0) {\n    var r = buf.toString('utf16le', i);\n    if (r) {\n      var c = r.charCodeAt(r.length - 1);\n      if (c >= 0xD800 && c <= 0xDBFF) {\n        this.lastNeed = 2;\n        this.lastTotal = 4;\n        this.lastChar[0] = buf[buf.length - 2];\n        this.lastChar[1] = buf[buf.length - 1];\n        return r.slice(0, -1);\n      }\n    }\n    return r;\n  }\n  this.lastNeed = 1;\n  this.lastTotal = 2;\n  this.lastChar[0] = buf[buf.length - 1];\n  return buf.toString('utf16le', i, buf.length - 1);\n}\n\n// For UTF-16LE we do not explicitly append special replacement characters if we\n// end on a partial character, we simply let v8 handle that.\nfunction utf16End(buf) {\n  var r = buf && buf.length ? this.write(buf) : '';\n  if (this.lastNeed) {\n    var end = this.lastTotal - this.lastNeed;\n    return r + this.lastChar.toString('utf16le', 0, end);\n  }\n  return r;\n}\n\nfunction base64Text(buf, i) {\n  var n = (buf.length - i) % 3;\n  if (n === 0) return buf.toString('base64', i);\n  this.lastNeed = 3 - n;\n  this.lastTotal = 3;\n  if (n === 1) {\n    this.lastChar[0] = buf[buf.length - 1];\n  } else {\n    this.lastChar[0] = buf[buf.length - 2];\n    this.lastChar[1] = buf[buf.length - 1];\n  }\n  return buf.toString('base64', i, buf.length - n);\n}\n\nfunction base64End(buf) {\n  var r = buf && buf.length ? this.write(buf) : '';\n  if (this.lastNeed) return r + this.lastChar.toString('base64', 0, 3 - this.lastNeed);\n  return r;\n}\n\n// Pass bytes on through for single-byte encodings (e.g. ascii, latin1, hex)\nfunction simpleWrite(buf) {\n  return buf.toString(this.encoding);\n}\n\nfunction simpleEnd(buf) {\n  return buf && buf.length ? this.write(buf) : '';\n}","// Ported from https://github.com/mafintosh/end-of-stream with\n// permission from the author, Mathias Buus (@mafintosh).\n\n'use strict';\n\nvar ERR_STREAM_PREMATURE_CLOSE = require('../../../errors').codes.ERR_STREAM_PREMATURE_CLOSE;\nfunction once(callback) {\n  var called = false;\n  return function () {\n    if (called) return;\n    called = true;\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    callback.apply(this, args);\n  };\n}\nfunction noop() {}\nfunction isRequest(stream) {\n  return stream.setHeader && typeof stream.abort === 'function';\n}\nfunction eos(stream, opts, callback) {\n  if (typeof opts === 'function') return eos(stream, null, opts);\n  if (!opts) opts = {};\n  callback = once(callback || noop);\n  var readable = opts.readable || opts.readable !== false && stream.readable;\n  var writable = opts.writable || opts.writable !== false && stream.writable;\n  var onlegacyfinish = function onlegacyfinish() {\n    if (!stream.writable) onfinish();\n  };\n  var writableEnded = stream._writableState && stream._writableState.finished;\n  var onfinish = function onfinish() {\n    writable = false;\n    writableEnded = true;\n    if (!readable) callback.call(stream);\n  };\n  var readableEnded = stream._readableState && stream._readableState.endEmitted;\n  var onend = function onend() {\n    readable = false;\n    readableEnded = true;\n    if (!writable) callback.call(stream);\n  };\n  var onerror = function onerror(err) {\n    callback.call(stream, err);\n  };\n  var onclose = function onclose() {\n    var err;\n    if (readable && !readableEnded) {\n      if (!stream._readableState || !stream._readableState.ended) err = new ERR_STREAM_PREMATURE_CLOSE();\n      return callback.call(stream, err);\n    }\n    if (writable && !writableEnded) {\n      if (!stream._writableState || !stream._writableState.ended) err = new ERR_STREAM_PREMATURE_CLOSE();\n      return callback.call(stream, err);\n    }\n  };\n  var onrequest = function onrequest() {\n    stream.req.on('finish', onfinish);\n  };\n  if (isRequest(stream)) {\n    stream.on('complete', onfinish);\n    stream.on('abort', onclose);\n    if (stream.req) onrequest();else stream.on('request', onrequest);\n  } else if (writable && !stream._writableState) {\n    // legacy streams\n    stream.on('end', onlegacyfinish);\n    stream.on('close', onlegacyfinish);\n  }\n  stream.on('end', onend);\n  stream.on('finish', onfinish);\n  if (opts.error !== false) stream.on('error', onerror);\n  stream.on('close', onclose);\n  return function () {\n    stream.removeListener('complete', onfinish);\n    stream.removeListener('abort', onclose);\n    stream.removeListener('request', onrequest);\n    if (stream.req) stream.req.removeListener('finish', onfinish);\n    stream.removeListener('end', onlegacyfinish);\n    stream.removeListener('close', onlegacyfinish);\n    stream.removeListener('finish', onfinish);\n    stream.removeListener('end', onend);\n    stream.removeListener('error', onerror);\n    stream.removeListener('close', onclose);\n  };\n}\nmodule.exports = eos;","'use strict';\n\nvar _Object$setPrototypeO;\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar finished = require('./end-of-stream');\nvar kLastResolve = Symbol('lastResolve');\nvar kLastReject = Symbol('lastReject');\nvar kError = Symbol('error');\nvar kEnded = Symbol('ended');\nvar kLastPromise = Symbol('lastPromise');\nvar kHandlePromise = Symbol('handlePromise');\nvar kStream = Symbol('stream');\nfunction createIterResult(value, done) {\n  return {\n    value: value,\n    done: done\n  };\n}\nfunction readAndResolve(iter) {\n  var resolve = iter[kLastResolve];\n  if (resolve !== null) {\n    var data = iter[kStream].read();\n    // we defer if data is null\n    // we can be expecting either 'end' or\n    // 'error'\n    if (data !== null) {\n      iter[kLastPromise] = null;\n      iter[kLastResolve] = null;\n      iter[kLastReject] = null;\n      resolve(createIterResult(data, false));\n    }\n  }\n}\nfunction onReadable(iter) {\n  // we wait for the next tick, because it might\n  // emit an error with process.nextTick\n  process.nextTick(readAndResolve, iter);\n}\nfunction wrapForNext(lastPromise, iter) {\n  return function (resolve, reject) {\n    lastPromise.then(function () {\n      if (iter[kEnded]) {\n        resolve(createIterResult(undefined, true));\n        return;\n      }\n      iter[kHandlePromise](resolve, reject);\n    }, reject);\n  };\n}\nvar AsyncIteratorPrototype = Object.getPrototypeOf(function () {});\nvar ReadableStreamAsyncIteratorPrototype = Object.setPrototypeOf((_Object$setPrototypeO = {\n  get stream() {\n    return this[kStream];\n  },\n  next: function next() {\n    var _this = this;\n    // if we have detected an error in the meanwhile\n    // reject straight away\n    var error = this[kError];\n    if (error !== null) {\n      return Promise.reject(error);\n    }\n    if (this[kEnded]) {\n      return Promise.resolve(createIterResult(undefined, true));\n    }\n    if (this[kStream].destroyed) {\n      // We need to defer via nextTick because if .destroy(err) is\n      // called, the error will be emitted via nextTick, and\n      // we cannot guarantee that there is no error lingering around\n      // waiting to be emitted.\n      return new Promise(function (resolve, reject) {\n        process.nextTick(function () {\n          if (_this[kError]) {\n            reject(_this[kError]);\n          } else {\n            resolve(createIterResult(undefined, true));\n          }\n        });\n      });\n    }\n\n    // if we have multiple next() calls\n    // we will wait for the previous Promise to finish\n    // this logic is optimized to support for await loops,\n    // where next() is only called once at a time\n    var lastPromise = this[kLastPromise];\n    var promise;\n    if (lastPromise) {\n      promise = new Promise(wrapForNext(lastPromise, this));\n    } else {\n      // fast path needed to support multiple this.push()\n      // without triggering the next() queue\n      var data = this[kStream].read();\n      if (data !== null) {\n        return Promise.resolve(createIterResult(data, false));\n      }\n      promise = new Promise(this[kHandlePromise]);\n    }\n    this[kLastPromise] = promise;\n    return promise;\n  }\n}, _defineProperty(_Object$setPrototypeO, Symbol.asyncIterator, function () {\n  return this;\n}), _defineProperty(_Object$setPrototypeO, \"return\", function _return() {\n  var _this2 = this;\n  // destroy(err, cb) is a private API\n  // we can guarantee we have that here, because we control the\n  // Readable class this is attached to\n  return new Promise(function (resolve, reject) {\n    _this2[kStream].destroy(null, function (err) {\n      if (err) {\n        reject(err);\n        return;\n      }\n      resolve(createIterResult(undefined, true));\n    });\n  });\n}), _Object$setPrototypeO), AsyncIteratorPrototype);\nvar createReadableStreamAsyncIterator = function createReadableStreamAsyncIterator(stream) {\n  var _Object$create;\n  var iterator = Object.create(ReadableStreamAsyncIteratorPrototype, (_Object$create = {}, _defineProperty(_Object$create, kStream, {\n    value: stream,\n    writable: true\n  }), _defineProperty(_Object$create, kLastResolve, {\n    value: null,\n    writable: true\n  }), _defineProperty(_Object$create, kLastReject, {\n    value: null,\n    writable: true\n  }), _defineProperty(_Object$create, kError, {\n    value: null,\n    writable: true\n  }), _defineProperty(_Object$create, kEnded, {\n    value: stream._readableState.endEmitted,\n    writable: true\n  }), _defineProperty(_Object$create, kHandlePromise, {\n    value: function value(resolve, reject) {\n      var data = iterator[kStream].read();\n      if (data) {\n        iterator[kLastPromise] = null;\n        iterator[kLastResolve] = null;\n        iterator[kLastReject] = null;\n        resolve(createIterResult(data, false));\n      } else {\n        iterator[kLastResolve] = resolve;\n        iterator[kLastReject] = reject;\n      }\n    },\n    writable: true\n  }), _Object$create));\n  iterator[kLastPromise] = null;\n  finished(stream, function (err) {\n    if (err && err.code !== 'ERR_STREAM_PREMATURE_CLOSE') {\n      var reject = iterator[kLastReject];\n      // reject if we are waiting for data in the Promise\n      // returned by next() and store the error\n      if (reject !== null) {\n        iterator[kLastPromise] = null;\n        iterator[kLastResolve] = null;\n        iterator[kLastReject] = null;\n        reject(err);\n      }\n      iterator[kError] = err;\n      return;\n    }\n    var resolve = iterator[kLastResolve];\n    if (resolve !== null) {\n      iterator[kLastPromise] = null;\n      iterator[kLastResolve] = null;\n      iterator[kLastReject] = null;\n      resolve(createIterResult(undefined, true));\n    }\n    iterator[kEnded] = true;\n  });\n  stream.on('readable', onReadable.bind(null, iterator));\n  return iterator;\n};\nmodule.exports = createReadableStreamAsyncIterator;","module.exports = function () {\n  throw new Error('Readable.from is not available in the browser')\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nmodule.exports = Readable;\n\n/*<replacement>*/\nvar Duplex;\n/*</replacement>*/\n\nReadable.ReadableState = ReadableState;\n\n/*<replacement>*/\nvar EE = require('events').EventEmitter;\nvar EElistenerCount = function EElistenerCount(emitter, type) {\n  return emitter.listeners(type).length;\n};\n/*</replacement>*/\n\n/*<replacement>*/\nvar Stream = require('./internal/streams/stream');\n/*</replacement>*/\n\nvar Buffer = require('buffer').Buffer;\nvar OurUint8Array = (typeof global !== 'undefined' ? global : typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : {}).Uint8Array || function () {};\nfunction _uint8ArrayToBuffer(chunk) {\n  return Buffer.from(chunk);\n}\nfunction _isUint8Array(obj) {\n  return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n}\n\n/*<replacement>*/\nvar debugUtil = require('util');\nvar debug;\nif (debugUtil && debugUtil.debuglog) {\n  debug = debugUtil.debuglog('stream');\n} else {\n  debug = function debug() {};\n}\n/*</replacement>*/\n\nvar BufferList = require('./internal/streams/buffer_list');\nvar destroyImpl = require('./internal/streams/destroy');\nvar _require = require('./internal/streams/state'),\n  getHighWaterMark = _require.getHighWaterMark;\nvar _require$codes = require('../errors').codes,\n  ERR_INVALID_ARG_TYPE = _require$codes.ERR_INVALID_ARG_TYPE,\n  ERR_STREAM_PUSH_AFTER_EOF = _require$codes.ERR_STREAM_PUSH_AFTER_EOF,\n  ERR_METHOD_NOT_IMPLEMENTED = _require$codes.ERR_METHOD_NOT_IMPLEMENTED,\n  ERR_STREAM_UNSHIFT_AFTER_END_EVENT = _require$codes.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;\n\n// Lazy loaded to improve the startup performance.\nvar StringDecoder;\nvar createReadableStreamAsyncIterator;\nvar from;\nrequire('inherits')(Readable, Stream);\nvar errorOrDestroy = destroyImpl.errorOrDestroy;\nvar kProxyEvents = ['error', 'close', 'destroy', 'pause', 'resume'];\nfunction prependListener(emitter, event, fn) {\n  // Sadly this is not cacheable as some libraries bundle their own\n  // event emitter implementation with them.\n  if (typeof emitter.prependListener === 'function') return emitter.prependListener(event, fn);\n\n  // This is a hack to make sure that our error handler is attached before any\n  // userland ones.  NEVER DO THIS. This is here only because this code needs\n  // to continue to work with older versions of Node.js that do not include\n  // the prependListener() method. The goal is to eventually remove this hack.\n  if (!emitter._events || !emitter._events[event]) emitter.on(event, fn);else if (Array.isArray(emitter._events[event])) emitter._events[event].unshift(fn);else emitter._events[event] = [fn, emitter._events[event]];\n}\nfunction ReadableState(options, stream, isDuplex) {\n  Duplex = Duplex || require('./_stream_duplex');\n  options = options || {};\n\n  // Duplex streams are both readable and writable, but share\n  // the same options object.\n  // However, some cases require setting options to different\n  // values for the readable and the writable sides of the duplex stream.\n  // These options can be provided separately as readableXXX and writableXXX.\n  if (typeof isDuplex !== 'boolean') isDuplex = stream instanceof Duplex;\n\n  // object stream flag. Used to make read(n) ignore n and to\n  // make all the buffer merging and length checks go away\n  this.objectMode = !!options.objectMode;\n  if (isDuplex) this.objectMode = this.objectMode || !!options.readableObjectMode;\n\n  // the point at which it stops calling _read() to fill the buffer\n  // Note: 0 is a valid value, means \"don't call _read preemptively ever\"\n  this.highWaterMark = getHighWaterMark(this, options, 'readableHighWaterMark', isDuplex);\n\n  // A linked list is used to store data chunks instead of an array because the\n  // linked list can remove elements from the beginning faster than\n  // array.shift()\n  this.buffer = new BufferList();\n  this.length = 0;\n  this.pipes = null;\n  this.pipesCount = 0;\n  this.flowing = null;\n  this.ended = false;\n  this.endEmitted = false;\n  this.reading = false;\n\n  // a flag to be able to tell if the event 'readable'/'data' is emitted\n  // immediately, or on a later tick.  We set this to true at first, because\n  // any actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first read call.\n  this.sync = true;\n\n  // whenever we return null, then we set a flag to say\n  // that we're awaiting a 'readable' event emission.\n  this.needReadable = false;\n  this.emittedReadable = false;\n  this.readableListening = false;\n  this.resumeScheduled = false;\n  this.paused = true;\n\n  // Should close be emitted on destroy. Defaults to true.\n  this.emitClose = options.emitClose !== false;\n\n  // Should .destroy() be called after 'end' (and potentially 'finish')\n  this.autoDestroy = !!options.autoDestroy;\n\n  // has it been destroyed\n  this.destroyed = false;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // the number of writers that are awaiting a drain event in .pipe()s\n  this.awaitDrain = 0;\n\n  // if true, a maybeReadMore has been scheduled\n  this.readingMore = false;\n  this.decoder = null;\n  this.encoding = null;\n  if (options.encoding) {\n    if (!StringDecoder) StringDecoder = require('string_decoder/').StringDecoder;\n    this.decoder = new StringDecoder(options.encoding);\n    this.encoding = options.encoding;\n  }\n}\nfunction Readable(options) {\n  Duplex = Duplex || require('./_stream_duplex');\n  if (!(this instanceof Readable)) return new Readable(options);\n\n  // Checking for a Stream.Duplex instance is faster here instead of inside\n  // the ReadableState constructor, at least with V8 6.5\n  var isDuplex = this instanceof Duplex;\n  this._readableState = new ReadableState(options, this, isDuplex);\n\n  // legacy\n  this.readable = true;\n  if (options) {\n    if (typeof options.read === 'function') this._read = options.read;\n    if (typeof options.destroy === 'function') this._destroy = options.destroy;\n  }\n  Stream.call(this);\n}\nObject.defineProperty(Readable.prototype, 'destroyed', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    if (this._readableState === undefined) {\n      return false;\n    }\n    return this._readableState.destroyed;\n  },\n  set: function set(value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (!this._readableState) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._readableState.destroyed = value;\n  }\n});\nReadable.prototype.destroy = destroyImpl.destroy;\nReadable.prototype._undestroy = destroyImpl.undestroy;\nReadable.prototype._destroy = function (err, cb) {\n  cb(err);\n};\n\n// Manually shove something into the read() buffer.\n// This returns true if the highWaterMark has not been hit yet,\n// similar to how Writable.write() returns true if you should\n// write() some more.\nReadable.prototype.push = function (chunk, encoding) {\n  var state = this._readableState;\n  var skipChunkCheck;\n  if (!state.objectMode) {\n    if (typeof chunk === 'string') {\n      encoding = encoding || state.defaultEncoding;\n      if (encoding !== state.encoding) {\n        chunk = Buffer.from(chunk, encoding);\n        encoding = '';\n      }\n      skipChunkCheck = true;\n    }\n  } else {\n    skipChunkCheck = true;\n  }\n  return readableAddChunk(this, chunk, encoding, false, skipChunkCheck);\n};\n\n// Unshift should *always* be something directly out of read()\nReadable.prototype.unshift = function (chunk) {\n  return readableAddChunk(this, chunk, null, true, false);\n};\nfunction readableAddChunk(stream, chunk, encoding, addToFront, skipChunkCheck) {\n  debug('readableAddChunk', chunk);\n  var state = stream._readableState;\n  if (chunk === null) {\n    state.reading = false;\n    onEofChunk(stream, state);\n  } else {\n    var er;\n    if (!skipChunkCheck) er = chunkInvalid(state, chunk);\n    if (er) {\n      errorOrDestroy(stream, er);\n    } else if (state.objectMode || chunk && chunk.length > 0) {\n      if (typeof chunk !== 'string' && !state.objectMode && Object.getPrototypeOf(chunk) !== Buffer.prototype) {\n        chunk = _uint8ArrayToBuffer(chunk);\n      }\n      if (addToFront) {\n        if (state.endEmitted) errorOrDestroy(stream, new ERR_STREAM_UNSHIFT_AFTER_END_EVENT());else addChunk(stream, state, chunk, true);\n      } else if (state.ended) {\n        errorOrDestroy(stream, new ERR_STREAM_PUSH_AFTER_EOF());\n      } else if (state.destroyed) {\n        return false;\n      } else {\n        state.reading = false;\n        if (state.decoder && !encoding) {\n          chunk = state.decoder.write(chunk);\n          if (state.objectMode || chunk.length !== 0) addChunk(stream, state, chunk, false);else maybeReadMore(stream, state);\n        } else {\n          addChunk(stream, state, chunk, false);\n        }\n      }\n    } else if (!addToFront) {\n      state.reading = false;\n      maybeReadMore(stream, state);\n    }\n  }\n\n  // We can push more data if we are below the highWaterMark.\n  // Also, if we have no data yet, we can stand some more bytes.\n  // This is to work around cases where hwm=0, such as the repl.\n  return !state.ended && (state.length < state.highWaterMark || state.length === 0);\n}\nfunction addChunk(stream, state, chunk, addToFront) {\n  if (state.flowing && state.length === 0 && !state.sync) {\n    state.awaitDrain = 0;\n    stream.emit('data', chunk);\n  } else {\n    // update the buffer info.\n    state.length += state.objectMode ? 1 : chunk.length;\n    if (addToFront) state.buffer.unshift(chunk);else state.buffer.push(chunk);\n    if (state.needReadable) emitReadable(stream);\n  }\n  maybeReadMore(stream, state);\n}\nfunction chunkInvalid(state, chunk) {\n  var er;\n  if (!_isUint8Array(chunk) && typeof chunk !== 'string' && chunk !== undefined && !state.objectMode) {\n    er = new ERR_INVALID_ARG_TYPE('chunk', ['string', 'Buffer', 'Uint8Array'], chunk);\n  }\n  return er;\n}\nReadable.prototype.isPaused = function () {\n  return this._readableState.flowing === false;\n};\n\n// backwards compatibility.\nReadable.prototype.setEncoding = function (enc) {\n  if (!StringDecoder) StringDecoder = require('string_decoder/').StringDecoder;\n  var decoder = new StringDecoder(enc);\n  this._readableState.decoder = decoder;\n  // If setEncoding(null), decoder.encoding equals utf8\n  this._readableState.encoding = this._readableState.decoder.encoding;\n\n  // Iterate over current buffer to convert already stored Buffers:\n  var p = this._readableState.buffer.head;\n  var content = '';\n  while (p !== null) {\n    content += decoder.write(p.data);\n    p = p.next;\n  }\n  this._readableState.buffer.clear();\n  if (content !== '') this._readableState.buffer.push(content);\n  this._readableState.length = content.length;\n  return this;\n};\n\n// Don't raise the hwm > 1GB\nvar MAX_HWM = 0x40000000;\nfunction computeNewHighWaterMark(n) {\n  if (n >= MAX_HWM) {\n    // TODO(ronag): Throw ERR_VALUE_OUT_OF_RANGE.\n    n = MAX_HWM;\n  } else {\n    // Get the next highest power of 2 to prevent increasing hwm excessively in\n    // tiny amounts\n    n--;\n    n |= n >>> 1;\n    n |= n >>> 2;\n    n |= n >>> 4;\n    n |= n >>> 8;\n    n |= n >>> 16;\n    n++;\n  }\n  return n;\n}\n\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction howMuchToRead(n, state) {\n  if (n <= 0 || state.length === 0 && state.ended) return 0;\n  if (state.objectMode) return 1;\n  if (n !== n) {\n    // Only flow one buffer at a time\n    if (state.flowing && state.length) return state.buffer.head.data.length;else return state.length;\n  }\n  // If we're asking for more than the current hwm, then raise the hwm.\n  if (n > state.highWaterMark) state.highWaterMark = computeNewHighWaterMark(n);\n  if (n <= state.length) return n;\n  // Don't have enough\n  if (!state.ended) {\n    state.needReadable = true;\n    return 0;\n  }\n  return state.length;\n}\n\n// you can override either this method, or the async _read(n) below.\nReadable.prototype.read = function (n) {\n  debug('read', n);\n  n = parseInt(n, 10);\n  var state = this._readableState;\n  var nOrig = n;\n  if (n !== 0) state.emittedReadable = false;\n\n  // if we're doing read(0) to trigger a readable event, but we\n  // already have a bunch of data in the buffer, then just trigger\n  // the 'readable' event and move on.\n  if (n === 0 && state.needReadable && ((state.highWaterMark !== 0 ? state.length >= state.highWaterMark : state.length > 0) || state.ended)) {\n    debug('read: emitReadable', state.length, state.ended);\n    if (state.length === 0 && state.ended) endReadable(this);else emitReadable(this);\n    return null;\n  }\n  n = howMuchToRead(n, state);\n\n  // if we've ended, and we're now clear, then finish it up.\n  if (n === 0 && state.ended) {\n    if (state.length === 0) endReadable(this);\n    return null;\n  }\n\n  // All the actual chunk generation logic needs to be\n  // *below* the call to _read.  The reason is that in certain\n  // synthetic stream cases, such as passthrough streams, _read\n  // may be a completely synchronous operation which may change\n  // the state of the read buffer, providing enough data when\n  // before there was *not* enough.\n  //\n  // So, the steps are:\n  // 1. Figure out what the state of things will be after we do\n  // a read from the buffer.\n  //\n  // 2. If that resulting state will trigger a _read, then call _read.\n  // Note that this may be asynchronous, or synchronous.  Yes, it is\n  // deeply ugly to write APIs this way, but that still doesn't mean\n  // that the Readable class should behave improperly, as streams are\n  // designed to be sync/async agnostic.\n  // Take note if the _read call is sync or async (ie, if the read call\n  // has returned yet), so that we know whether or not it's safe to emit\n  // 'readable' etc.\n  //\n  // 3. Actually pull the requested chunks out of the buffer and return.\n\n  // if we need a readable event, then we need to do some reading.\n  var doRead = state.needReadable;\n  debug('need readable', doRead);\n\n  // if we currently have less than the highWaterMark, then also read some\n  if (state.length === 0 || state.length - n < state.highWaterMark) {\n    doRead = true;\n    debug('length less than watermark', doRead);\n  }\n\n  // however, if we've ended, then there's no point, and if we're already\n  // reading, then it's unnecessary.\n  if (state.ended || state.reading) {\n    doRead = false;\n    debug('reading or ended', doRead);\n  } else if (doRead) {\n    debug('do read');\n    state.reading = true;\n    state.sync = true;\n    // if the length is currently zero, then we *need* a readable event.\n    if (state.length === 0) state.needReadable = true;\n    // call internal read method\n    this._read(state.highWaterMark);\n    state.sync = false;\n    // If _read pushed data synchronously, then `reading` will be false,\n    // and we need to re-evaluate how much data we can return to the user.\n    if (!state.reading) n = howMuchToRead(nOrig, state);\n  }\n  var ret;\n  if (n > 0) ret = fromList(n, state);else ret = null;\n  if (ret === null) {\n    state.needReadable = state.length <= state.highWaterMark;\n    n = 0;\n  } else {\n    state.length -= n;\n    state.awaitDrain = 0;\n  }\n  if (state.length === 0) {\n    // If we have nothing in the buffer, then we want to know\n    // as soon as we *do* get something into the buffer.\n    if (!state.ended) state.needReadable = true;\n\n    // If we tried to read() past the EOF, then emit end on the next tick.\n    if (nOrig !== n && state.ended) endReadable(this);\n  }\n  if (ret !== null) this.emit('data', ret);\n  return ret;\n};\nfunction onEofChunk(stream, state) {\n  debug('onEofChunk');\n  if (state.ended) return;\n  if (state.decoder) {\n    var chunk = state.decoder.end();\n    if (chunk && chunk.length) {\n      state.buffer.push(chunk);\n      state.length += state.objectMode ? 1 : chunk.length;\n    }\n  }\n  state.ended = true;\n  if (state.sync) {\n    // if we are sync, wait until next tick to emit the data.\n    // Otherwise we risk emitting data in the flow()\n    // the readable code triggers during a read() call\n    emitReadable(stream);\n  } else {\n    // emit 'readable' now to make sure it gets picked up.\n    state.needReadable = false;\n    if (!state.emittedReadable) {\n      state.emittedReadable = true;\n      emitReadable_(stream);\n    }\n  }\n}\n\n// Don't emit readable right away in sync mode, because this can trigger\n// another read() call => stack overflow.  This way, it might trigger\n// a nextTick recursion warning, but that's not so bad.\nfunction emitReadable(stream) {\n  var state = stream._readableState;\n  debug('emitReadable', state.needReadable, state.emittedReadable);\n  state.needReadable = false;\n  if (!state.emittedReadable) {\n    debug('emitReadable', state.flowing);\n    state.emittedReadable = true;\n    process.nextTick(emitReadable_, stream);\n  }\n}\nfunction emitReadable_(stream) {\n  var state = stream._readableState;\n  debug('emitReadable_', state.destroyed, state.length, state.ended);\n  if (!state.destroyed && (state.length || state.ended)) {\n    stream.emit('readable');\n    state.emittedReadable = false;\n  }\n\n  // The stream needs another readable event if\n  // 1. It is not flowing, as the flow mechanism will take\n  //    care of it.\n  // 2. It is not ended.\n  // 3. It is below the highWaterMark, so we can schedule\n  //    another readable later.\n  state.needReadable = !state.flowing && !state.ended && state.length <= state.highWaterMark;\n  flow(stream);\n}\n\n// at this point, the user has presumably seen the 'readable' event,\n// and called read() to consume some data.  that may have triggered\n// in turn another _read(n) call, in which case reading = true if\n// it's in progress.\n// However, if we're not ended, or reading, and the length < hwm,\n// then go ahead and try to read some more preemptively.\nfunction maybeReadMore(stream, state) {\n  if (!state.readingMore) {\n    state.readingMore = true;\n    process.nextTick(maybeReadMore_, stream, state);\n  }\n}\nfunction maybeReadMore_(stream, state) {\n  // Attempt to read more data if we should.\n  //\n  // The conditions for reading more data are (one of):\n  // - Not enough data buffered (state.length < state.highWaterMark). The loop\n  //   is responsible for filling the buffer with enough data if such data\n  //   is available. If highWaterMark is 0 and we are not in the flowing mode\n  //   we should _not_ attempt to buffer any extra data. We'll get more data\n  //   when the stream consumer calls read() instead.\n  // - No data in the buffer, and the stream is in flowing mode. In this mode\n  //   the loop below is responsible for ensuring read() is called. Failing to\n  //   call read here would abort the flow and there's no other mechanism for\n  //   continuing the flow if the stream consumer has just subscribed to the\n  //   'data' event.\n  //\n  // In addition to the above conditions to keep reading data, the following\n  // conditions prevent the data from being read:\n  // - The stream has ended (state.ended).\n  // - There is already a pending 'read' operation (state.reading). This is a\n  //   case where the the stream has called the implementation defined _read()\n  //   method, but they are processing the call asynchronously and have _not_\n  //   called push() with new data. In this case we skip performing more\n  //   read()s. The execution ends in this method again after the _read() ends\n  //   up calling push() with more data.\n  while (!state.reading && !state.ended && (state.length < state.highWaterMark || state.flowing && state.length === 0)) {\n    var len = state.length;\n    debug('maybeReadMore read 0');\n    stream.read(0);\n    if (len === state.length)\n      // didn't get any data, stop spinning.\n      break;\n  }\n  state.readingMore = false;\n}\n\n// abstract method.  to be overridden in specific implementation classes.\n// call cb(er, data) where data is <= n in length.\n// for virtual (non-string, non-buffer) streams, \"length\" is somewhat\n// arbitrary, and perhaps not very meaningful.\nReadable.prototype._read = function (n) {\n  errorOrDestroy(this, new ERR_METHOD_NOT_IMPLEMENTED('_read()'));\n};\nReadable.prototype.pipe = function (dest, pipeOpts) {\n  var src = this;\n  var state = this._readableState;\n  switch (state.pipesCount) {\n    case 0:\n      state.pipes = dest;\n      break;\n    case 1:\n      state.pipes = [state.pipes, dest];\n      break;\n    default:\n      state.pipes.push(dest);\n      break;\n  }\n  state.pipesCount += 1;\n  debug('pipe count=%d opts=%j', state.pipesCount, pipeOpts);\n  var doEnd = (!pipeOpts || pipeOpts.end !== false) && dest !== process.stdout && dest !== process.stderr;\n  var endFn = doEnd ? onend : unpipe;\n  if (state.endEmitted) process.nextTick(endFn);else src.once('end', endFn);\n  dest.on('unpipe', onunpipe);\n  function onunpipe(readable, unpipeInfo) {\n    debug('onunpipe');\n    if (readable === src) {\n      if (unpipeInfo && unpipeInfo.hasUnpiped === false) {\n        unpipeInfo.hasUnpiped = true;\n        cleanup();\n      }\n    }\n  }\n  function onend() {\n    debug('onend');\n    dest.end();\n  }\n\n  // when the dest drains, it reduces the awaitDrain counter\n  // on the source.  This would be more elegant with a .once()\n  // handler in flow(), but adding and removing repeatedly is\n  // too slow.\n  var ondrain = pipeOnDrain(src);\n  dest.on('drain', ondrain);\n  var cleanedUp = false;\n  function cleanup() {\n    debug('cleanup');\n    // cleanup event handlers once the pipe is broken\n    dest.removeListener('close', onclose);\n    dest.removeListener('finish', onfinish);\n    dest.removeListener('drain', ondrain);\n    dest.removeListener('error', onerror);\n    dest.removeListener('unpipe', onunpipe);\n    src.removeListener('end', onend);\n    src.removeListener('end', unpipe);\n    src.removeListener('data', ondata);\n    cleanedUp = true;\n\n    // if the reader is waiting for a drain event from this\n    // specific writer, then it would cause it to never start\n    // flowing again.\n    // So, if this is awaiting a drain, then we just call it now.\n    // If we don't know, then assume that we are waiting for one.\n    if (state.awaitDrain && (!dest._writableState || dest._writableState.needDrain)) ondrain();\n  }\n  src.on('data', ondata);\n  function ondata(chunk) {\n    debug('ondata');\n    var ret = dest.write(chunk);\n    debug('dest.write', ret);\n    if (ret === false) {\n      // If the user unpiped during `dest.write()`, it is possible\n      // to get stuck in a permanently paused state if that write\n      // also returned false.\n      // => Check whether `dest` is still a piping destination.\n      if ((state.pipesCount === 1 && state.pipes === dest || state.pipesCount > 1 && indexOf(state.pipes, dest) !== -1) && !cleanedUp) {\n        debug('false write response, pause', state.awaitDrain);\n        state.awaitDrain++;\n      }\n      src.pause();\n    }\n  }\n\n  // if the dest has an error, then stop piping into it.\n  // however, don't suppress the throwing behavior for this.\n  function onerror(er) {\n    debug('onerror', er);\n    unpipe();\n    dest.removeListener('error', onerror);\n    if (EElistenerCount(dest, 'error') === 0) errorOrDestroy(dest, er);\n  }\n\n  // Make sure our error handler is attached before userland ones.\n  prependListener(dest, 'error', onerror);\n\n  // Both close and finish should trigger unpipe, but only once.\n  function onclose() {\n    dest.removeListener('finish', onfinish);\n    unpipe();\n  }\n  dest.once('close', onclose);\n  function onfinish() {\n    debug('onfinish');\n    dest.removeListener('close', onclose);\n    unpipe();\n  }\n  dest.once('finish', onfinish);\n  function unpipe() {\n    debug('unpipe');\n    src.unpipe(dest);\n  }\n\n  // tell the dest that it's being piped to\n  dest.emit('pipe', src);\n\n  // start the flow if it hasn't been started already.\n  if (!state.flowing) {\n    debug('pipe resume');\n    src.resume();\n  }\n  return dest;\n};\nfunction pipeOnDrain(src) {\n  return function pipeOnDrainFunctionResult() {\n    var state = src._readableState;\n    debug('pipeOnDrain', state.awaitDrain);\n    if (state.awaitDrain) state.awaitDrain--;\n    if (state.awaitDrain === 0 && EElistenerCount(src, 'data')) {\n      state.flowing = true;\n      flow(src);\n    }\n  };\n}\nReadable.prototype.unpipe = function (dest) {\n  var state = this._readableState;\n  var unpipeInfo = {\n    hasUnpiped: false\n  };\n\n  // if we're not piping anywhere, then do nothing.\n  if (state.pipesCount === 0) return this;\n\n  // just one destination.  most common case.\n  if (state.pipesCount === 1) {\n    // passed in one, but it's not the right one.\n    if (dest && dest !== state.pipes) return this;\n    if (!dest) dest = state.pipes;\n\n    // got a match.\n    state.pipes = null;\n    state.pipesCount = 0;\n    state.flowing = false;\n    if (dest) dest.emit('unpipe', this, unpipeInfo);\n    return this;\n  }\n\n  // slow case. multiple pipe destinations.\n\n  if (!dest) {\n    // remove all.\n    var dests = state.pipes;\n    var len = state.pipesCount;\n    state.pipes = null;\n    state.pipesCount = 0;\n    state.flowing = false;\n    for (var i = 0; i < len; i++) dests[i].emit('unpipe', this, {\n      hasUnpiped: false\n    });\n    return this;\n  }\n\n  // try to find the right one.\n  var index = indexOf(state.pipes, dest);\n  if (index === -1) return this;\n  state.pipes.splice(index, 1);\n  state.pipesCount -= 1;\n  if (state.pipesCount === 1) state.pipes = state.pipes[0];\n  dest.emit('unpipe', this, unpipeInfo);\n  return this;\n};\n\n// set up data events if they are asked for\n// Ensure readable listeners eventually get something\nReadable.prototype.on = function (ev, fn) {\n  var res = Stream.prototype.on.call(this, ev, fn);\n  var state = this._readableState;\n  if (ev === 'data') {\n    // update readableListening so that resume() may be a no-op\n    // a few lines down. This is needed to support once('readable').\n    state.readableListening = this.listenerCount('readable') > 0;\n\n    // Try start flowing on next tick if stream isn't explicitly paused\n    if (state.flowing !== false) this.resume();\n  } else if (ev === 'readable') {\n    if (!state.endEmitted && !state.readableListening) {\n      state.readableListening = state.needReadable = true;\n      state.flowing = false;\n      state.emittedReadable = false;\n      debug('on readable', state.length, state.reading);\n      if (state.length) {\n        emitReadable(this);\n      } else if (!state.reading) {\n        process.nextTick(nReadingNextTick, this);\n      }\n    }\n  }\n  return res;\n};\nReadable.prototype.addListener = Readable.prototype.on;\nReadable.prototype.removeListener = function (ev, fn) {\n  var res = Stream.prototype.removeListener.call(this, ev, fn);\n  if (ev === 'readable') {\n    // We need to check if there is someone still listening to\n    // readable and reset the state. However this needs to happen\n    // after readable has been emitted but before I/O (nextTick) to\n    // support once('readable', fn) cycles. This means that calling\n    // resume within the same tick will have no\n    // effect.\n    process.nextTick(updateReadableListening, this);\n  }\n  return res;\n};\nReadable.prototype.removeAllListeners = function (ev) {\n  var res = Stream.prototype.removeAllListeners.apply(this, arguments);\n  if (ev === 'readable' || ev === undefined) {\n    // We need to check if there is someone still listening to\n    // readable and reset the state. However this needs to happen\n    // after readable has been emitted but before I/O (nextTick) to\n    // support once('readable', fn) cycles. This means that calling\n    // resume within the same tick will have no\n    // effect.\n    process.nextTick(updateReadableListening, this);\n  }\n  return res;\n};\nfunction updateReadableListening(self) {\n  var state = self._readableState;\n  state.readableListening = self.listenerCount('readable') > 0;\n  if (state.resumeScheduled && !state.paused) {\n    // flowing needs to be set to true now, otherwise\n    // the upcoming resume will not flow.\n    state.flowing = true;\n\n    // crude way to check if we should resume\n  } else if (self.listenerCount('data') > 0) {\n    self.resume();\n  }\n}\nfunction nReadingNextTick(self) {\n  debug('readable nexttick read 0');\n  self.read(0);\n}\n\n// pause() and resume() are remnants of the legacy readable stream API\n// If the user uses them, then switch into old mode.\nReadable.prototype.resume = function () {\n  var state = this._readableState;\n  if (!state.flowing) {\n    debug('resume');\n    // we flow only if there is no one listening\n    // for readable, but we still have to call\n    // resume()\n    state.flowing = !state.readableListening;\n    resume(this, state);\n  }\n  state.paused = false;\n  return this;\n};\nfunction resume(stream, state) {\n  if (!state.resumeScheduled) {\n    state.resumeScheduled = true;\n    process.nextTick(resume_, stream, state);\n  }\n}\nfunction resume_(stream, state) {\n  debug('resume', state.reading);\n  if (!state.reading) {\n    stream.read(0);\n  }\n  state.resumeScheduled = false;\n  stream.emit('resume');\n  flow(stream);\n  if (state.flowing && !state.reading) stream.read(0);\n}\nReadable.prototype.pause = function () {\n  debug('call pause flowing=%j', this._readableState.flowing);\n  if (this._readableState.flowing !== false) {\n    debug('pause');\n    this._readableState.flowing = false;\n    this.emit('pause');\n  }\n  this._readableState.paused = true;\n  return this;\n};\nfunction flow(stream) {\n  var state = stream._readableState;\n  debug('flow', state.flowing);\n  while (state.flowing && stream.read() !== null);\n}\n\n// wrap an old-style stream as the async data source.\n// This is *not* part of the readable stream interface.\n// It is an ugly unfortunate mess of history.\nReadable.prototype.wrap = function (stream) {\n  var _this = this;\n  var state = this._readableState;\n  var paused = false;\n  stream.on('end', function () {\n    debug('wrapped end');\n    if (state.decoder && !state.ended) {\n      var chunk = state.decoder.end();\n      if (chunk && chunk.length) _this.push(chunk);\n    }\n    _this.push(null);\n  });\n  stream.on('data', function (chunk) {\n    debug('wrapped data');\n    if (state.decoder) chunk = state.decoder.write(chunk);\n\n    // don't skip over falsy values in objectMode\n    if (state.objectMode && (chunk === null || chunk === undefined)) return;else if (!state.objectMode && (!chunk || !chunk.length)) return;\n    var ret = _this.push(chunk);\n    if (!ret) {\n      paused = true;\n      stream.pause();\n    }\n  });\n\n  // proxy all the other methods.\n  // important when wrapping filters and duplexes.\n  for (var i in stream) {\n    if (this[i] === undefined && typeof stream[i] === 'function') {\n      this[i] = function methodWrap(method) {\n        return function methodWrapReturnFunction() {\n          return stream[method].apply(stream, arguments);\n        };\n      }(i);\n    }\n  }\n\n  // proxy certain important events.\n  for (var n = 0; n < kProxyEvents.length; n++) {\n    stream.on(kProxyEvents[n], this.emit.bind(this, kProxyEvents[n]));\n  }\n\n  // when we try to consume some more bytes, simply unpause the\n  // underlying stream.\n  this._read = function (n) {\n    debug('wrapped _read', n);\n    if (paused) {\n      paused = false;\n      stream.resume();\n    }\n  };\n  return this;\n};\nif (typeof Symbol === 'function') {\n  Readable.prototype[Symbol.asyncIterator] = function () {\n    if (createReadableStreamAsyncIterator === undefined) {\n      createReadableStreamAsyncIterator = require('./internal/streams/async_iterator');\n    }\n    return createReadableStreamAsyncIterator(this);\n  };\n}\nObject.defineProperty(Readable.prototype, 'readableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState.highWaterMark;\n  }\n});\nObject.defineProperty(Readable.prototype, 'readableBuffer', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState && this._readableState.buffer;\n  }\n});\nObject.defineProperty(Readable.prototype, 'readableFlowing', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState.flowing;\n  },\n  set: function set(state) {\n    if (this._readableState) {\n      this._readableState.flowing = state;\n    }\n  }\n});\n\n// exposed for testing purposes only.\nReadable._fromList = fromList;\nObject.defineProperty(Readable.prototype, 'readableLength', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState.length;\n  }\n});\n\n// Pluck off n bytes from an array of buffers.\n// Length is the combined lengths of all the buffers in the list.\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction fromList(n, state) {\n  // nothing buffered\n  if (state.length === 0) return null;\n  var ret;\n  if (state.objectMode) ret = state.buffer.shift();else if (!n || n >= state.length) {\n    // read it all, truncate the list\n    if (state.decoder) ret = state.buffer.join('');else if (state.buffer.length === 1) ret = state.buffer.first();else ret = state.buffer.concat(state.length);\n    state.buffer.clear();\n  } else {\n    // read part of list\n    ret = state.buffer.consume(n, state.decoder);\n  }\n  return ret;\n}\nfunction endReadable(stream) {\n  var state = stream._readableState;\n  debug('endReadable', state.endEmitted);\n  if (!state.endEmitted) {\n    state.ended = true;\n    process.nextTick(endReadableNT, state, stream);\n  }\n}\nfunction endReadableNT(state, stream) {\n  debug('endReadableNT', state.endEmitted, state.length);\n\n  // Check that we didn't get one last unshift.\n  if (!state.endEmitted && state.length === 0) {\n    state.endEmitted = true;\n    stream.readable = false;\n    stream.emit('end');\n    if (state.autoDestroy) {\n      // In case of duplex streams we need a way to detect\n      // if the writable side is ready for autoDestroy as well\n      var wState = stream._writableState;\n      if (!wState || wState.autoDestroy && wState.finished) {\n        stream.destroy();\n      }\n    }\n  }\n}\nif (typeof Symbol === 'function') {\n  Readable.from = function (iterable, opts) {\n    if (from === undefined) {\n      from = require('./internal/streams/from');\n    }\n    return from(Readable, iterable, opts);\n  };\n}\nfunction indexOf(xs, x) {\n  for (var i = 0, l = xs.length; i < l; i++) {\n    if (xs[i] === x) return i;\n  }\n  return -1;\n}","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a transform stream is a readable/writable stream where you do\n// something with the data.  Sometimes it's called a \"filter\",\n// but that's not a great name for it, since that implies a thing where\n// some bits pass through, and others are simply ignored.  (That would\n// be a valid example of a transform, of course.)\n//\n// While the output is causally related to the input, it's not a\n// necessarily symmetric or synchronous transformation.  For example,\n// a zlib stream might take multiple plain-text writes(), and then\n// emit a single compressed chunk some time in the future.\n//\n// Here's how this works:\n//\n// The Transform stream has all the aspects of the readable and writable\n// stream classes.  When you write(chunk), that calls _write(chunk,cb)\n// internally, and returns false if there's a lot of pending writes\n// buffered up.  When you call read(), that calls _read(n) until\n// there's enough pending readable data buffered up.\n//\n// In a transform stream, the written data is placed in a buffer.  When\n// _read(n) is called, it transforms the queued up data, calling the\n// buffered _write cb's as it consumes chunks.  If consuming a single\n// written chunk would result in multiple output chunks, then the first\n// outputted bit calls the readcb, and subsequent chunks just go into\n// the read buffer, and will cause it to emit 'readable' if necessary.\n//\n// This way, back-pressure is actually determined by the reading side,\n// since _read has to be called to start processing a new chunk.  However,\n// a pathological inflate type of transform can cause excessive buffering\n// here.  For example, imagine a stream where every byte of input is\n// interpreted as an integer from 0-255, and then results in that many\n// bytes of output.  Writing the 4 bytes {ff,ff,ff,ff} would result in\n// 1kb of data being output.  In this case, you could write a very small\n// amount of input, and end up with a very large amount of output.  In\n// such a pathological inflating mechanism, there'd be no way to tell\n// the system to stop doing the transform.  A single 4MB write could\n// cause the system to run out of memory.\n//\n// However, even in such a pathological case, only a single written chunk\n// would be consumed, and then the rest would wait (un-transformed) until\n// the results of the previous transformed chunk were consumed.\n\n'use strict';\n\nmodule.exports = Transform;\nvar _require$codes = require('../errors').codes,\n  ERR_METHOD_NOT_IMPLEMENTED = _require$codes.ERR_METHOD_NOT_IMPLEMENTED,\n  ERR_MULTIPLE_CALLBACK = _require$codes.ERR_MULTIPLE_CALLBACK,\n  ERR_TRANSFORM_ALREADY_TRANSFORMING = _require$codes.ERR_TRANSFORM_ALREADY_TRANSFORMING,\n  ERR_TRANSFORM_WITH_LENGTH_0 = _require$codes.ERR_TRANSFORM_WITH_LENGTH_0;\nvar Duplex = require('./_stream_duplex');\nrequire('inherits')(Transform, Duplex);\nfunction afterTransform(er, data) {\n  var ts = this._transformState;\n  ts.transforming = false;\n  var cb = ts.writecb;\n  if (cb === null) {\n    return this.emit('error', new ERR_MULTIPLE_CALLBACK());\n  }\n  ts.writechunk = null;\n  ts.writecb = null;\n  if (data != null)\n    // single equals check for both `null` and `undefined`\n    this.push(data);\n  cb(er);\n  var rs = this._readableState;\n  rs.reading = false;\n  if (rs.needReadable || rs.length < rs.highWaterMark) {\n    this._read(rs.highWaterMark);\n  }\n}\nfunction Transform(options) {\n  if (!(this instanceof Transform)) return new Transform(options);\n  Duplex.call(this, options);\n  this._transformState = {\n    afterTransform: afterTransform.bind(this),\n    needTransform: false,\n    transforming: false,\n    writecb: null,\n    writechunk: null,\n    writeencoding: null\n  };\n\n  // start out asking for a readable event once data is transformed.\n  this._readableState.needReadable = true;\n\n  // we have implemented the _read method, and done the other things\n  // that Readable wants before the first _read call, so unset the\n  // sync guard flag.\n  this._readableState.sync = false;\n  if (options) {\n    if (typeof options.transform === 'function') this._transform = options.transform;\n    if (typeof options.flush === 'function') this._flush = options.flush;\n  }\n\n  // When the writable side finishes, then flush out anything remaining.\n  this.on('prefinish', prefinish);\n}\nfunction prefinish() {\n  var _this = this;\n  if (typeof this._flush === 'function' && !this._readableState.destroyed) {\n    this._flush(function (er, data) {\n      done(_this, er, data);\n    });\n  } else {\n    done(this, null, null);\n  }\n}\nTransform.prototype.push = function (chunk, encoding) {\n  this._transformState.needTransform = false;\n  return Duplex.prototype.push.call(this, chunk, encoding);\n};\n\n// This is the part where you do stuff!\n// override this function in implementation classes.\n// 'chunk' is an input chunk.\n//\n// Call `push(newChunk)` to pass along transformed output\n// to the readable side.  You may call 'push' zero or more times.\n//\n// Call `cb(err)` when you are done with this chunk.  If you pass\n// an error, then that'll put the hurt on the whole operation.  If you\n// never call cb(), then you'll never get another chunk.\nTransform.prototype._transform = function (chunk, encoding, cb) {\n  cb(new ERR_METHOD_NOT_IMPLEMENTED('_transform()'));\n};\nTransform.prototype._write = function (chunk, encoding, cb) {\n  var ts = this._transformState;\n  ts.writecb = cb;\n  ts.writechunk = chunk;\n  ts.writeencoding = encoding;\n  if (!ts.transforming) {\n    var rs = this._readableState;\n    if (ts.needTransform || rs.needReadable || rs.length < rs.highWaterMark) this._read(rs.highWaterMark);\n  }\n};\n\n// Doesn't matter what the args are here.\n// _transform does all the work.\n// That we got here means that the readable side wants more data.\nTransform.prototype._read = function (n) {\n  var ts = this._transformState;\n  if (ts.writechunk !== null && !ts.transforming) {\n    ts.transforming = true;\n    this._transform(ts.writechunk, ts.writeencoding, ts.afterTransform);\n  } else {\n    // mark that we need a transform, so that any data that comes in\n    // will get processed, now that we've asked for it.\n    ts.needTransform = true;\n  }\n};\nTransform.prototype._destroy = function (err, cb) {\n  Duplex.prototype._destroy.call(this, err, function (err2) {\n    cb(err2);\n  });\n};\nfunction done(stream, er, data) {\n  if (er) return stream.emit('error', er);\n  if (data != null)\n    // single equals check for both `null` and `undefined`\n    stream.push(data);\n\n  // TODO(BridgeAR): Write a test for these two error cases\n  // if there's nothing in the write buffer, then that means\n  // that nothing more will ever be provided\n  if (stream._writableState.length) throw new ERR_TRANSFORM_WITH_LENGTH_0();\n  if (stream._transformState.transforming) throw new ERR_TRANSFORM_ALREADY_TRANSFORMING();\n  return stream.push(null);\n}","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a passthrough stream.\n// basically just the most minimal sort of Transform stream.\n// Every written chunk gets output as-is.\n\n'use strict';\n\nmodule.exports = PassThrough;\nvar Transform = require('./_stream_transform');\nrequire('inherits')(PassThrough, Transform);\nfunction PassThrough(options) {\n  if (!(this instanceof PassThrough)) return new PassThrough(options);\n  Transform.call(this, options);\n}\nPassThrough.prototype._transform = function (chunk, encoding, cb) {\n  cb(null, chunk);\n};","// Ported from https://github.com/mafintosh/pump with\n// permission from the author, Mathias Buus (@mafintosh).\n\n'use strict';\n\nvar eos;\nfunction once(callback) {\n  var called = false;\n  return function () {\n    if (called) return;\n    called = true;\n    callback.apply(void 0, arguments);\n  };\n}\nvar _require$codes = require('../../../errors').codes,\n  ERR_MISSING_ARGS = _require$codes.ERR_MISSING_ARGS,\n  ERR_STREAM_DESTROYED = _require$codes.ERR_STREAM_DESTROYED;\nfunction noop(err) {\n  // Rethrow the error if it exists to avoid swallowing it\n  if (err) throw err;\n}\nfunction isRequest(stream) {\n  return stream.setHeader && typeof stream.abort === 'function';\n}\nfunction destroyer(stream, reading, writing, callback) {\n  callback = once(callback);\n  var closed = false;\n  stream.on('close', function () {\n    closed = true;\n  });\n  if (eos === undefined) eos = require('./end-of-stream');\n  eos(stream, {\n    readable: reading,\n    writable: writing\n  }, function (err) {\n    if (err) return callback(err);\n    closed = true;\n    callback();\n  });\n  var destroyed = false;\n  return function (err) {\n    if (closed) return;\n    if (destroyed) return;\n    destroyed = true;\n\n    // request.destroy just do .end - .abort is what we want\n    if (isRequest(stream)) return stream.abort();\n    if (typeof stream.destroy === 'function') return stream.destroy();\n    callback(err || new ERR_STREAM_DESTROYED('pipe'));\n  };\n}\nfunction call(fn) {\n  fn();\n}\nfunction pipe(from, to) {\n  return from.pipe(to);\n}\nfunction popCallback(streams) {\n  if (!streams.length) return noop;\n  if (typeof streams[streams.length - 1] !== 'function') return noop;\n  return streams.pop();\n}\nfunction pipeline() {\n  for (var _len = arguments.length, streams = new Array(_len), _key = 0; _key < _len; _key++) {\n    streams[_key] = arguments[_key];\n  }\n  var callback = popCallback(streams);\n  if (Array.isArray(streams[0])) streams = streams[0];\n  if (streams.length < 2) {\n    throw new ERR_MISSING_ARGS('streams');\n  }\n  var error;\n  var destroys = streams.map(function (stream, i) {\n    var reading = i < streams.length - 1;\n    var writing = i > 0;\n    return destroyer(stream, reading, writing, function (err) {\n      if (!error) error = err;\n      if (err) destroys.forEach(call);\n      if (reading) return;\n      destroys.forEach(call);\n      callback(error);\n    });\n  });\n  return streams.reduce(pipe);\n}\nmodule.exports = pipeline;","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nmodule.exports = Stream;\n\nvar EE = require('events').EventEmitter;\nvar inherits = require('inherits');\n\ninherits(Stream, EE);\nStream.Readable = require('readable-stream/lib/_stream_readable.js');\nStream.Writable = require('readable-stream/lib/_stream_writable.js');\nStream.Duplex = require('readable-stream/lib/_stream_duplex.js');\nStream.Transform = require('readable-stream/lib/_stream_transform.js');\nStream.PassThrough = require('readable-stream/lib/_stream_passthrough.js');\nStream.finished = require('readable-stream/lib/internal/streams/end-of-stream.js')\nStream.pipeline = require('readable-stream/lib/internal/streams/pipeline.js')\n\n// Backwards-compat with node 0.4.x\nStream.Stream = Stream;\n\n\n\n// old-style streams.  Note that the pipe method (the only relevant\n// part of this class) is overridden in the Readable class.\n\nfunction Stream() {\n  EE.call(this);\n}\n\nStream.prototype.pipe = function(dest, options) {\n  var source = this;\n\n  function ondata(chunk) {\n    if (dest.writable) {\n      if (false === dest.write(chunk) && source.pause) {\n        source.pause();\n      }\n    }\n  }\n\n  source.on('data', ondata);\n\n  function ondrain() {\n    if (source.readable && source.resume) {\n      source.resume();\n    }\n  }\n\n  dest.on('drain', ondrain);\n\n  // If the 'end' option is not supplied, dest.end() will be called when\n  // source gets the 'end' or 'close' events.  Only dest.end() once.\n  if (!dest._isStdio && (!options || options.end !== false)) {\n    source.on('end', onend);\n    source.on('close', onclose);\n  }\n\n  var didOnEnd = false;\n  function onend() {\n    if (didOnEnd) return;\n    didOnEnd = true;\n\n    dest.end();\n  }\n\n\n  function onclose() {\n    if (didOnEnd) return;\n    didOnEnd = true;\n\n    if (typeof dest.destroy === 'function') dest.destroy();\n  }\n\n  // don't leave dangling pipes when there are errors.\n  function onerror(er) {\n    cleanup();\n    if (EE.listenerCount(this, 'error') === 0) {\n      throw er; // Unhandled stream error in pipe.\n    }\n  }\n\n  source.on('error', onerror);\n  dest.on('error', onerror);\n\n  // remove all the event listeners that were added.\n  function cleanup() {\n    source.removeListener('data', ondata);\n    dest.removeListener('drain', ondrain);\n\n    source.removeListener('end', onend);\n    source.removeListener('close', onclose);\n\n    source.removeListener('error', onerror);\n    dest.removeListener('error', onerror);\n\n    source.removeListener('end', cleanup);\n    source.removeListener('close', cleanup);\n\n    dest.removeListener('close', cleanup);\n  }\n\n  source.on('end', cleanup);\n  source.on('close', cleanup);\n\n  dest.on('close', cleanup);\n\n  dest.emit('pipe', source);\n\n  // Allow for unix-like usage: A.pipe(B).pipe(C)\n  return dest;\n};\n",";(function (sax) { // wrapper for non-node envs\n  sax.parser = function (strict, opt) { return new SAXParser(strict, opt) }\n  sax.SAXParser = SAXParser\n  sax.SAXStream = SAXStream\n  sax.createStream = createStream\n\n  // When we pass the MAX_BUFFER_LENGTH position, start checking for buffer overruns.\n  // When we check, schedule the next check for MAX_BUFFER_LENGTH - (max(buffer lengths)),\n  // since that's the earliest that a buffer overrun could occur.  This way, checks are\n  // as rare as required, but as often as necessary to ensure never crossing this bound.\n  // Furthermore, buffers are only tested at most once per write(), so passing a very\n  // large string into write() might have undesirable effects, but this is manageable by\n  // the caller, so it is assumed to be safe.  Thus, a call to write() may, in the extreme\n  // edge case, result in creating at most one complete copy of the string passed in.\n  // Set to Infinity to have unlimited buffers.\n  sax.MAX_BUFFER_LENGTH = 64 * 1024\n\n  var buffers = [\n    'comment', 'sgmlDecl', 'textNode', 'tagName', 'doctype',\n    'procInstName', 'procInstBody', 'entity', 'attribName',\n    'attribValue', 'cdata', 'script'\n  ]\n\n  sax.EVENTS = [\n    'text',\n    'processinginstruction',\n    'sgmldeclaration',\n    'doctype',\n    'comment',\n    'opentagstart',\n    'attribute',\n    'opentag',\n    'closetag',\n    'opencdata',\n    'cdata',\n    'closecdata',\n    'error',\n    'end',\n    'ready',\n    'script',\n    'opennamespace',\n    'closenamespace'\n  ]\n\n  function SAXParser (strict, opt) {\n    if (!(this instanceof SAXParser)) {\n      return new SAXParser(strict, opt)\n    }\n\n    var parser = this\n    clearBuffers(parser)\n    parser.q = parser.c = ''\n    parser.bufferCheckPosition = sax.MAX_BUFFER_LENGTH\n    parser.opt = opt || {}\n    parser.opt.lowercase = parser.opt.lowercase || parser.opt.lowercasetags\n    parser.looseCase = parser.opt.lowercase ? 'toLowerCase' : 'toUpperCase'\n    parser.tags = []\n    parser.closed = parser.closedRoot = parser.sawRoot = false\n    parser.tag = parser.error = null\n    parser.strict = !!strict\n    parser.noscript = !!(strict || parser.opt.noscript)\n    parser.state = S.BEGIN\n    parser.strictEntities = parser.opt.strictEntities\n    parser.ENTITIES = parser.strictEntities ? Object.create(sax.XML_ENTITIES) : Object.create(sax.ENTITIES)\n    parser.attribList = []\n\n    // namespaces form a prototype chain.\n    // it always points at the current tag,\n    // which protos to its parent tag.\n    if (parser.opt.xmlns) {\n      parser.ns = Object.create(rootNS)\n    }\n\n    // mostly just for error reporting\n    parser.trackPosition = parser.opt.position !== false\n    if (parser.trackPosition) {\n      parser.position = parser.line = parser.column = 0\n    }\n    emit(parser, 'onready')\n  }\n\n  if (!Object.create) {\n    Object.create = function (o) {\n      function F () {}\n      F.prototype = o\n      var newf = new F()\n      return newf\n    }\n  }\n\n  if (!Object.keys) {\n    Object.keys = function (o) {\n      var a = []\n      for (var i in o) if (o.hasOwnProperty(i)) a.push(i)\n      return a\n    }\n  }\n\n  function checkBufferLength (parser) {\n    var maxAllowed = Math.max(sax.MAX_BUFFER_LENGTH, 10)\n    var maxActual = 0\n    for (var i = 0, l = buffers.length; i < l; i++) {\n      var len = parser[buffers[i]].length\n      if (len > maxAllowed) {\n        // Text/cdata nodes can get big, and since they're buffered,\n        // we can get here under normal conditions.\n        // Avoid issues by emitting the text node now,\n        // so at least it won't get any bigger.\n        switch (buffers[i]) {\n          case 'textNode':\n            closeText(parser)\n            break\n\n          case 'cdata':\n            emitNode(parser, 'oncdata', parser.cdata)\n            parser.cdata = ''\n            break\n\n          case 'script':\n            emitNode(parser, 'onscript', parser.script)\n            parser.script = ''\n            break\n\n          default:\n            error(parser, 'Max buffer length exceeded: ' + buffers[i])\n        }\n      }\n      maxActual = Math.max(maxActual, len)\n    }\n    // schedule the next check for the earliest possible buffer overrun.\n    var m = sax.MAX_BUFFER_LENGTH - maxActual\n    parser.bufferCheckPosition = m + parser.position\n  }\n\n  function clearBuffers (parser) {\n    for (var i = 0, l = buffers.length; i < l; i++) {\n      parser[buffers[i]] = ''\n    }\n  }\n\n  function flushBuffers (parser) {\n    closeText(parser)\n    if (parser.cdata !== '') {\n      emitNode(parser, 'oncdata', parser.cdata)\n      parser.cdata = ''\n    }\n    if (parser.script !== '') {\n      emitNode(parser, 'onscript', parser.script)\n      parser.script = ''\n    }\n  }\n\n  SAXParser.prototype = {\n    end: function () { end(this) },\n    write: write,\n    resume: function () { this.error = null; return this },\n    close: function () { return this.write(null) },\n    flush: function () { flushBuffers(this) }\n  }\n\n  var Stream\n  try {\n    Stream = require('stream').Stream\n  } catch (ex) {\n    Stream = function () {}\n  }\n  if (!Stream) Stream = function () {}\n\n  var streamWraps = sax.EVENTS.filter(function (ev) {\n    return ev !== 'error' && ev !== 'end'\n  })\n\n  function createStream (strict, opt) {\n    return new SAXStream(strict, opt)\n  }\n\n  function SAXStream (strict, opt) {\n    if (!(this instanceof SAXStream)) {\n      return new SAXStream(strict, opt)\n    }\n\n    Stream.apply(this)\n\n    this._parser = new SAXParser(strict, opt)\n    this.writable = true\n    this.readable = true\n\n    var me = this\n\n    this._parser.onend = function () {\n      me.emit('end')\n    }\n\n    this._parser.onerror = function (er) {\n      me.emit('error', er)\n\n      // if didn't throw, then means error was handled.\n      // go ahead and clear error, so we can write again.\n      me._parser.error = null\n    }\n\n    this._decoder = null\n\n    streamWraps.forEach(function (ev) {\n      Object.defineProperty(me, 'on' + ev, {\n        get: function () {\n          return me._parser['on' + ev]\n        },\n        set: function (h) {\n          if (!h) {\n            me.removeAllListeners(ev)\n            me._parser['on' + ev] = h\n            return h\n          }\n          me.on(ev, h)\n        },\n        enumerable: true,\n        configurable: false\n      })\n    })\n  }\n\n  SAXStream.prototype = Object.create(Stream.prototype, {\n    constructor: {\n      value: SAXStream\n    }\n  })\n\n  SAXStream.prototype.write = function (data) {\n    if (typeof Buffer === 'function' &&\n      typeof Buffer.isBuffer === 'function' &&\n      Buffer.isBuffer(data)) {\n      if (!this._decoder) {\n        var SD = require('string_decoder').StringDecoder\n        this._decoder = new SD('utf8')\n      }\n      data = this._decoder.write(data)\n    }\n\n    this._parser.write(data.toString())\n    this.emit('data', data)\n    return true\n  }\n\n  SAXStream.prototype.end = function (chunk) {\n    if (chunk && chunk.length) {\n      this.write(chunk)\n    }\n    this._parser.end()\n    return true\n  }\n\n  SAXStream.prototype.on = function (ev, handler) {\n    var me = this\n    if (!me._parser['on' + ev] && streamWraps.indexOf(ev) !== -1) {\n      me._parser['on' + ev] = function () {\n        var args = arguments.length === 1 ? [arguments[0]] : Array.apply(null, arguments)\n        args.splice(0, 0, ev)\n        me.emit.apply(me, args)\n      }\n    }\n\n    return Stream.prototype.on.call(me, ev, handler)\n  }\n\n  // this really needs to be replaced with character classes.\n  // XML allows all manner of ridiculous numbers and digits.\n  var CDATA = '[CDATA['\n  var DOCTYPE = 'DOCTYPE'\n  var XML_NAMESPACE = 'http://www.w3.org/XML/1998/namespace'\n  var XMLNS_NAMESPACE = 'http://www.w3.org/2000/xmlns/'\n  var rootNS = { xml: XML_NAMESPACE, xmlns: XMLNS_NAMESPACE }\n\n  // http://www.w3.org/TR/REC-xml/#NT-NameStartChar\n  // This implementation works on strings, a single character at a time\n  // as such, it cannot ever support astral-plane characters (10000-EFFFF)\n  // without a significant breaking change to either this  parser, or the\n  // JavaScript language.  Implementation of an emoji-capable xml parser\n  // is left as an exercise for the reader.\n  var nameStart = /[:_A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]/\n\n  var nameBody = /[:_A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\u00B7\\u0300-\\u036F\\u203F-\\u2040.\\d-]/\n\n  var entityStart = /[#:_A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD]/\n  var entityBody = /[#:_A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\u00B7\\u0300-\\u036F\\u203F-\\u2040.\\d-]/\n\n  function isWhitespace (c) {\n    return c === ' ' || c === '\\n' || c === '\\r' || c === '\\t'\n  }\n\n  function isQuote (c) {\n    return c === '\"' || c === '\\''\n  }\n\n  function isAttribEnd (c) {\n    return c === '>' || isWhitespace(c)\n  }\n\n  function isMatch (regex, c) {\n    return regex.test(c)\n  }\n\n  function notMatch (regex, c) {\n    return !isMatch(regex, c)\n  }\n\n  var S = 0\n  sax.STATE = {\n    BEGIN: S++, // leading byte order mark or whitespace\n    BEGIN_WHITESPACE: S++, // leading whitespace\n    TEXT: S++, // general stuff\n    TEXT_ENTITY: S++, // &amp and such.\n    OPEN_WAKA: S++, // <\n    SGML_DECL: S++, // <!BLARG\n    SGML_DECL_QUOTED: S++, // <!BLARG foo \"bar\n    DOCTYPE: S++, // <!DOCTYPE\n    DOCTYPE_QUOTED: S++, // <!DOCTYPE \"//blah\n    DOCTYPE_DTD: S++, // <!DOCTYPE \"//blah\" [ ...\n    DOCTYPE_DTD_QUOTED: S++, // <!DOCTYPE \"//blah\" [ \"foo\n    COMMENT_STARTING: S++, // <!-\n    COMMENT: S++, // <!--\n    COMMENT_ENDING: S++, // <!-- blah -\n    COMMENT_ENDED: S++, // <!-- blah --\n    CDATA: S++, // <![CDATA[ something\n    CDATA_ENDING: S++, // ]\n    CDATA_ENDING_2: S++, // ]]\n    PROC_INST: S++, // <?hi\n    PROC_INST_BODY: S++, // <?hi there\n    PROC_INST_ENDING: S++, // <?hi \"there\" ?\n    OPEN_TAG: S++, // <strong\n    OPEN_TAG_SLASH: S++, // <strong /\n    ATTRIB: S++, // <a\n    ATTRIB_NAME: S++, // <a foo\n    ATTRIB_NAME_SAW_WHITE: S++, // <a foo _\n    ATTRIB_VALUE: S++, // <a foo=\n    ATTRIB_VALUE_QUOTED: S++, // <a foo=\"bar\n    ATTRIB_VALUE_CLOSED: S++, // <a foo=\"bar\"\n    ATTRIB_VALUE_UNQUOTED: S++, // <a foo=bar\n    ATTRIB_VALUE_ENTITY_Q: S++, // <foo bar=\"&quot;\"\n    ATTRIB_VALUE_ENTITY_U: S++, // <foo bar=&quot\n    CLOSE_TAG: S++, // </a\n    CLOSE_TAG_SAW_WHITE: S++, // </a   >\n    SCRIPT: S++, // <script> ...\n    SCRIPT_ENDING: S++ // <script> ... <\n  }\n\n  sax.XML_ENTITIES = {\n    'amp': '&',\n    'gt': '>',\n    'lt': '<',\n    'quot': '\"',\n    'apos': \"'\"\n  }\n\n  sax.ENTITIES = {\n    'amp': '&',\n    'gt': '>',\n    'lt': '<',\n    'quot': '\"',\n    'apos': \"'\",\n    'AElig': 198,\n    'Aacute': 193,\n    'Acirc': 194,\n    'Agrave': 192,\n    'Aring': 197,\n    'Atilde': 195,\n    'Auml': 196,\n    'Ccedil': 199,\n    'ETH': 208,\n    'Eacute': 201,\n    'Ecirc': 202,\n    'Egrave': 200,\n    'Euml': 203,\n    'Iacute': 205,\n    'Icirc': 206,\n    'Igrave': 204,\n    'Iuml': 207,\n    'Ntilde': 209,\n    'Oacute': 211,\n    'Ocirc': 212,\n    'Ograve': 210,\n    'Oslash': 216,\n    'Otilde': 213,\n    'Ouml': 214,\n    'THORN': 222,\n    'Uacute': 218,\n    'Ucirc': 219,\n    'Ugrave': 217,\n    'Uuml': 220,\n    'Yacute': 221,\n    'aacute': 225,\n    'acirc': 226,\n    'aelig': 230,\n    'agrave': 224,\n    'aring': 229,\n    'atilde': 227,\n    'auml': 228,\n    'ccedil': 231,\n    'eacute': 233,\n    'ecirc': 234,\n    'egrave': 232,\n    'eth': 240,\n    'euml': 235,\n    'iacute': 237,\n    'icirc': 238,\n    'igrave': 236,\n    'iuml': 239,\n    'ntilde': 241,\n    'oacute': 243,\n    'ocirc': 244,\n    'ograve': 242,\n    'oslash': 248,\n    'otilde': 245,\n    'ouml': 246,\n    'szlig': 223,\n    'thorn': 254,\n    'uacute': 250,\n    'ucirc': 251,\n    'ugrave': 249,\n    'uuml': 252,\n    'yacute': 253,\n    'yuml': 255,\n    'copy': 169,\n    'reg': 174,\n    'nbsp': 160,\n    'iexcl': 161,\n    'cent': 162,\n    'pound': 163,\n    'curren': 164,\n    'yen': 165,\n    'brvbar': 166,\n    'sect': 167,\n    'uml': 168,\n    'ordf': 170,\n    'laquo': 171,\n    'not': 172,\n    'shy': 173,\n    'macr': 175,\n    'deg': 176,\n    'plusmn': 177,\n    'sup1': 185,\n    'sup2': 178,\n    'sup3': 179,\n    'acute': 180,\n    'micro': 181,\n    'para': 182,\n    'middot': 183,\n    'cedil': 184,\n    'ordm': 186,\n    'raquo': 187,\n    'frac14': 188,\n    'frac12': 189,\n    'frac34': 190,\n    'iquest': 191,\n    'times': 215,\n    'divide': 247,\n    'OElig': 338,\n    'oelig': 339,\n    'Scaron': 352,\n    'scaron': 353,\n    'Yuml': 376,\n    'fnof': 402,\n    'circ': 710,\n    'tilde': 732,\n    'Alpha': 913,\n    'Beta': 914,\n    'Gamma': 915,\n    'Delta': 916,\n    'Epsilon': 917,\n    'Zeta': 918,\n    'Eta': 919,\n    'Theta': 920,\n    'Iota': 921,\n    'Kappa': 922,\n    'Lambda': 923,\n    'Mu': 924,\n    'Nu': 925,\n    'Xi': 926,\n    'Omicron': 927,\n    'Pi': 928,\n    'Rho': 929,\n    'Sigma': 931,\n    'Tau': 932,\n    'Upsilon': 933,\n    'Phi': 934,\n    'Chi': 935,\n    'Psi': 936,\n    'Omega': 937,\n    'alpha': 945,\n    'beta': 946,\n    'gamma': 947,\n    'delta': 948,\n    'epsilon': 949,\n    'zeta': 950,\n    'eta': 951,\n    'theta': 952,\n    'iota': 953,\n    'kappa': 954,\n    'lambda': 955,\n    'mu': 956,\n    'nu': 957,\n    'xi': 958,\n    'omicron': 959,\n    'pi': 960,\n    'rho': 961,\n    'sigmaf': 962,\n    'sigma': 963,\n    'tau': 964,\n    'upsilon': 965,\n    'phi': 966,\n    'chi': 967,\n    'psi': 968,\n    'omega': 969,\n    'thetasym': 977,\n    'upsih': 978,\n    'piv': 982,\n    'ensp': 8194,\n    'emsp': 8195,\n    'thinsp': 8201,\n    'zwnj': 8204,\n    'zwj': 8205,\n    'lrm': 8206,\n    'rlm': 8207,\n    'ndash': 8211,\n    'mdash': 8212,\n    'lsquo': 8216,\n    'rsquo': 8217,\n    'sbquo': 8218,\n    'ldquo': 8220,\n    'rdquo': 8221,\n    'bdquo': 8222,\n    'dagger': 8224,\n    'Dagger': 8225,\n    'bull': 8226,\n    'hellip': 8230,\n    'permil': 8240,\n    'prime': 8242,\n    'Prime': 8243,\n    'lsaquo': 8249,\n    'rsaquo': 8250,\n    'oline': 8254,\n    'frasl': 8260,\n    'euro': 8364,\n    'image': 8465,\n    'weierp': 8472,\n    'real': 8476,\n    'trade': 8482,\n    'alefsym': 8501,\n    'larr': 8592,\n    'uarr': 8593,\n    'rarr': 8594,\n    'darr': 8595,\n    'harr': 8596,\n    'crarr': 8629,\n    'lArr': 8656,\n    'uArr': 8657,\n    'rArr': 8658,\n    'dArr': 8659,\n    'hArr': 8660,\n    'forall': 8704,\n    'part': 8706,\n    'exist': 8707,\n    'empty': 8709,\n    'nabla': 8711,\n    'isin': 8712,\n    'notin': 8713,\n    'ni': 8715,\n    'prod': 8719,\n    'sum': 8721,\n    'minus': 8722,\n    'lowast': 8727,\n    'radic': 8730,\n    'prop': 8733,\n    'infin': 8734,\n    'ang': 8736,\n    'and': 8743,\n    'or': 8744,\n    'cap': 8745,\n    'cup': 8746,\n    'int': 8747,\n    'there4': 8756,\n    'sim': 8764,\n    'cong': 8773,\n    'asymp': 8776,\n    'ne': 8800,\n    'equiv': 8801,\n    'le': 8804,\n    'ge': 8805,\n    'sub': 8834,\n    'sup': 8835,\n    'nsub': 8836,\n    'sube': 8838,\n    'supe': 8839,\n    'oplus': 8853,\n    'otimes': 8855,\n    'perp': 8869,\n    'sdot': 8901,\n    'lceil': 8968,\n    'rceil': 8969,\n    'lfloor': 8970,\n    'rfloor': 8971,\n    'lang': 9001,\n    'rang': 9002,\n    'loz': 9674,\n    'spades': 9824,\n    'clubs': 9827,\n    'hearts': 9829,\n    'diams': 9830\n  }\n\n  Object.keys(sax.ENTITIES).forEach(function (key) {\n    var e = sax.ENTITIES[key]\n    var s = typeof e === 'number' ? String.fromCharCode(e) : e\n    sax.ENTITIES[key] = s\n  })\n\n  for (var s in sax.STATE) {\n    sax.STATE[sax.STATE[s]] = s\n  }\n\n  // shorthand\n  S = sax.STATE\n\n  function emit (parser, event, data) {\n    parser[event] && parser[event](data)\n  }\n\n  function emitNode (parser, nodeType, data) {\n    if (parser.textNode) closeText(parser)\n    emit(parser, nodeType, data)\n  }\n\n  function closeText (parser) {\n    parser.textNode = textopts(parser.opt, parser.textNode)\n    if (parser.textNode) emit(parser, 'ontext', parser.textNode)\n    parser.textNode = ''\n  }\n\n  function textopts (opt, text) {\n    if (opt.trim) text = text.trim()\n    if (opt.normalize) text = text.replace(/\\s+/g, ' ')\n    return text\n  }\n\n  function error (parser, er) {\n    closeText(parser)\n    if (parser.trackPosition) {\n      er += '\\nLine: ' + parser.line +\n        '\\nColumn: ' + parser.column +\n        '\\nChar: ' + parser.c\n    }\n    er = new Error(er)\n    parser.error = er\n    emit(parser, 'onerror', er)\n    return parser\n  }\n\n  function end (parser) {\n    if (parser.sawRoot && !parser.closedRoot) strictFail(parser, 'Unclosed root tag')\n    if ((parser.state !== S.BEGIN) &&\n      (parser.state !== S.BEGIN_WHITESPACE) &&\n      (parser.state !== S.TEXT)) {\n      error(parser, 'Unexpected end')\n    }\n    closeText(parser)\n    parser.c = ''\n    parser.closed = true\n    emit(parser, 'onend')\n    SAXParser.call(parser, parser.strict, parser.opt)\n    return parser\n  }\n\n  function strictFail (parser, message) {\n    if (typeof parser !== 'object' || !(parser instanceof SAXParser)) {\n      throw new Error('bad call to strictFail')\n    }\n    if (parser.strict) {\n      error(parser, message)\n    }\n  }\n\n  function newTag (parser) {\n    if (!parser.strict) parser.tagName = parser.tagName[parser.looseCase]()\n    var parent = parser.tags[parser.tags.length - 1] || parser\n    var tag = parser.tag = { name: parser.tagName, attributes: {} }\n\n    // will be overridden if tag contails an xmlns=\"foo\" or xmlns:foo=\"bar\"\n    if (parser.opt.xmlns) {\n      tag.ns = parent.ns\n    }\n    parser.attribList.length = 0\n    emitNode(parser, 'onopentagstart', tag)\n  }\n\n  function qname (name, attribute) {\n    var i = name.indexOf(':')\n    var qualName = i < 0 ? [ '', name ] : name.split(':')\n    var prefix = qualName[0]\n    var local = qualName[1]\n\n    // <x \"xmlns\"=\"http://foo\">\n    if (attribute && name === 'xmlns') {\n      prefix = 'xmlns'\n      local = ''\n    }\n\n    return { prefix: prefix, local: local }\n  }\n\n  function attrib (parser) {\n    if (!parser.strict) {\n      parser.attribName = parser.attribName[parser.looseCase]()\n    }\n\n    if (parser.attribList.indexOf(parser.attribName) !== -1 ||\n      parser.tag.attributes.hasOwnProperty(parser.attribName)) {\n      parser.attribName = parser.attribValue = ''\n      return\n    }\n\n    if (parser.opt.xmlns) {\n      var qn = qname(parser.attribName, true)\n      var prefix = qn.prefix\n      var local = qn.local\n\n      if (prefix === 'xmlns') {\n        // namespace binding attribute. push the binding into scope\n        if (local === 'xml' && parser.attribValue !== XML_NAMESPACE) {\n          strictFail(parser,\n            'xml: prefix must be bound to ' + XML_NAMESPACE + '\\n' +\n            'Actual: ' + parser.attribValue)\n        } else if (local === 'xmlns' && parser.attribValue !== XMLNS_NAMESPACE) {\n          strictFail(parser,\n            'xmlns: prefix must be bound to ' + XMLNS_NAMESPACE + '\\n' +\n            'Actual: ' + parser.attribValue)\n        } else {\n          var tag = parser.tag\n          var parent = parser.tags[parser.tags.length - 1] || parser\n          if (tag.ns === parent.ns) {\n            tag.ns = Object.create(parent.ns)\n          }\n          tag.ns[local] = parser.attribValue\n        }\n      }\n\n      // defer onattribute events until all attributes have been seen\n      // so any new bindings can take effect. preserve attribute order\n      // so deferred events can be emitted in document order\n      parser.attribList.push([parser.attribName, parser.attribValue])\n    } else {\n      // in non-xmlns mode, we can emit the event right away\n      parser.tag.attributes[parser.attribName] = parser.attribValue\n      emitNode(parser, 'onattribute', {\n        name: parser.attribName,\n        value: parser.attribValue\n      })\n    }\n\n    parser.attribName = parser.attribValue = ''\n  }\n\n  function openTag (parser, selfClosing) {\n    if (parser.opt.xmlns) {\n      // emit namespace binding events\n      var tag = parser.tag\n\n      // add namespace info to tag\n      var qn = qname(parser.tagName)\n      tag.prefix = qn.prefix\n      tag.local = qn.local\n      tag.uri = tag.ns[qn.prefix] || ''\n\n      if (tag.prefix && !tag.uri) {\n        strictFail(parser, 'Unbound namespace prefix: ' +\n          JSON.stringify(parser.tagName))\n        tag.uri = qn.prefix\n      }\n\n      var parent = parser.tags[parser.tags.length - 1] || parser\n      if (tag.ns && parent.ns !== tag.ns) {\n        Object.keys(tag.ns).forEach(function (p) {\n          emitNode(parser, 'onopennamespace', {\n            prefix: p,\n            uri: tag.ns[p]\n          })\n        })\n      }\n\n      // handle deferred onattribute events\n      // Note: do not apply default ns to attributes:\n      //   http://www.w3.org/TR/REC-xml-names/#defaulting\n      for (var i = 0, l = parser.attribList.length; i < l; i++) {\n        var nv = parser.attribList[i]\n        var name = nv[0]\n        var value = nv[1]\n        var qualName = qname(name, true)\n        var prefix = qualName.prefix\n        var local = qualName.local\n        var uri = prefix === '' ? '' : (tag.ns[prefix] || '')\n        var a = {\n          name: name,\n          value: value,\n          prefix: prefix,\n          local: local,\n          uri: uri\n        }\n\n        // if there's any attributes with an undefined namespace,\n        // then fail on them now.\n        if (prefix && prefix !== 'xmlns' && !uri) {\n          strictFail(parser, 'Unbound namespace prefix: ' +\n            JSON.stringify(prefix))\n          a.uri = prefix\n        }\n        parser.tag.attributes[name] = a\n        emitNode(parser, 'onattribute', a)\n      }\n      parser.attribList.length = 0\n    }\n\n    parser.tag.isSelfClosing = !!selfClosing\n\n    // process the tag\n    parser.sawRoot = true\n    parser.tags.push(parser.tag)\n    emitNode(parser, 'onopentag', parser.tag)\n    if (!selfClosing) {\n      // special case for <script> in non-strict mode.\n      if (!parser.noscript && parser.tagName.toLowerCase() === 'script') {\n        parser.state = S.SCRIPT\n      } else {\n        parser.state = S.TEXT\n      }\n      parser.tag = null\n      parser.tagName = ''\n    }\n    parser.attribName = parser.attribValue = ''\n    parser.attribList.length = 0\n  }\n\n  function closeTag (parser) {\n    if (!parser.tagName) {\n      strictFail(parser, 'Weird empty close tag.')\n      parser.textNode += '</>'\n      parser.state = S.TEXT\n      return\n    }\n\n    if (parser.script) {\n      if (parser.tagName !== 'script') {\n        parser.script += '</' + parser.tagName + '>'\n        parser.tagName = ''\n        parser.state = S.SCRIPT\n        return\n      }\n      emitNode(parser, 'onscript', parser.script)\n      parser.script = ''\n    }\n\n    // first make sure that the closing tag actually exists.\n    // <a><b></c></b></a> will close everything, otherwise.\n    var t = parser.tags.length\n    var tagName = parser.tagName\n    if (!parser.strict) {\n      tagName = tagName[parser.looseCase]()\n    }\n    var closeTo = tagName\n    while (t--) {\n      var close = parser.tags[t]\n      if (close.name !== closeTo) {\n        // fail the first time in strict mode\n        strictFail(parser, 'Unexpected close tag')\n      } else {\n        break\n      }\n    }\n\n    // didn't find it.  we already failed for strict, so just abort.\n    if (t < 0) {\n      strictFail(parser, 'Unmatched closing tag: ' + parser.tagName)\n      parser.textNode += '</' + parser.tagName + '>'\n      parser.state = S.TEXT\n      return\n    }\n    parser.tagName = tagName\n    var s = parser.tags.length\n    while (s-- > t) {\n      var tag = parser.tag = parser.tags.pop()\n      parser.tagName = parser.tag.name\n      emitNode(parser, 'onclosetag', parser.tagName)\n\n      var x = {}\n      for (var i in tag.ns) {\n        x[i] = tag.ns[i]\n      }\n\n      var parent = parser.tags[parser.tags.length - 1] || parser\n      if (parser.opt.xmlns && tag.ns !== parent.ns) {\n        // remove namespace bindings introduced by tag\n        Object.keys(tag.ns).forEach(function (p) {\n          var n = tag.ns[p]\n          emitNode(parser, 'onclosenamespace', { prefix: p, uri: n })\n        })\n      }\n    }\n    if (t === 0) parser.closedRoot = true\n    parser.tagName = parser.attribValue = parser.attribName = ''\n    parser.attribList.length = 0\n    parser.state = S.TEXT\n  }\n\n  function parseEntity (parser) {\n    var entity = parser.entity\n    var entityLC = entity.toLowerCase()\n    var num\n    var numStr = ''\n\n    if (parser.ENTITIES[entity]) {\n      return parser.ENTITIES[entity]\n    }\n    if (parser.ENTITIES[entityLC]) {\n      return parser.ENTITIES[entityLC]\n    }\n    entity = entityLC\n    if (entity.charAt(0) === '#') {\n      if (entity.charAt(1) === 'x') {\n        entity = entity.slice(2)\n        num = parseInt(entity, 16)\n        numStr = num.toString(16)\n      } else {\n        entity = entity.slice(1)\n        num = parseInt(entity, 10)\n        numStr = num.toString(10)\n      }\n    }\n    entity = entity.replace(/^0+/, '')\n    if (isNaN(num) || numStr.toLowerCase() !== entity) {\n      strictFail(parser, 'Invalid character entity')\n      return '&' + parser.entity + ';'\n    }\n\n    return String.fromCodePoint(num)\n  }\n\n  function beginWhiteSpace (parser, c) {\n    if (c === '<') {\n      parser.state = S.OPEN_WAKA\n      parser.startTagPosition = parser.position\n    } else if (!isWhitespace(c)) {\n      // have to process this as a text node.\n      // weird, but happens.\n      strictFail(parser, 'Non-whitespace before first tag.')\n      parser.textNode = c\n      parser.state = S.TEXT\n    }\n  }\n\n  function charAt (chunk, i) {\n    var result = ''\n    if (i < chunk.length) {\n      result = chunk.charAt(i)\n    }\n    return result\n  }\n\n  function write (chunk) {\n    var parser = this\n    if (this.error) {\n      throw this.error\n    }\n    if (parser.closed) {\n      return error(parser,\n        'Cannot write after close. Assign an onready handler.')\n    }\n    if (chunk === null) {\n      return end(parser)\n    }\n    if (typeof chunk === 'object') {\n      chunk = chunk.toString()\n    }\n    var i = 0\n    var c = ''\n    while (true) {\n      c = charAt(chunk, i++)\n      parser.c = c\n\n      if (!c) {\n        break\n      }\n\n      if (parser.trackPosition) {\n        parser.position++\n        if (c === '\\n') {\n          parser.line++\n          parser.column = 0\n        } else {\n          parser.column++\n        }\n      }\n\n      switch (parser.state) {\n        case S.BEGIN:\n          parser.state = S.BEGIN_WHITESPACE\n          if (c === '\\uFEFF') {\n            continue\n          }\n          beginWhiteSpace(parser, c)\n          continue\n\n        case S.BEGIN_WHITESPACE:\n          beginWhiteSpace(parser, c)\n          continue\n\n        case S.TEXT:\n          if (parser.sawRoot && !parser.closedRoot) {\n            var starti = i - 1\n            while (c && c !== '<' && c !== '&') {\n              c = charAt(chunk, i++)\n              if (c && parser.trackPosition) {\n                parser.position++\n                if (c === '\\n') {\n                  parser.line++\n                  parser.column = 0\n                } else {\n                  parser.column++\n                }\n              }\n            }\n            parser.textNode += chunk.substring(starti, i - 1)\n          }\n          if (c === '<' && !(parser.sawRoot && parser.closedRoot && !parser.strict)) {\n            parser.state = S.OPEN_WAKA\n            parser.startTagPosition = parser.position\n          } else {\n            if (!isWhitespace(c) && (!parser.sawRoot || parser.closedRoot)) {\n              strictFail(parser, 'Text data outside of root node.')\n            }\n            if (c === '&') {\n              parser.state = S.TEXT_ENTITY\n            } else {\n              parser.textNode += c\n            }\n          }\n          continue\n\n        case S.SCRIPT:\n          // only non-strict\n          if (c === '<') {\n            parser.state = S.SCRIPT_ENDING\n          } else {\n            parser.script += c\n          }\n          continue\n\n        case S.SCRIPT_ENDING:\n          if (c === '/') {\n            parser.state = S.CLOSE_TAG\n          } else {\n            parser.script += '<' + c\n            parser.state = S.SCRIPT\n          }\n          continue\n\n        case S.OPEN_WAKA:\n          // either a /, ?, !, or text is coming next.\n          if (c === '!') {\n            parser.state = S.SGML_DECL\n            parser.sgmlDecl = ''\n          } else if (isWhitespace(c)) {\n            // wait for it...\n          } else if (isMatch(nameStart, c)) {\n            parser.state = S.OPEN_TAG\n            parser.tagName = c\n          } else if (c === '/') {\n            parser.state = S.CLOSE_TAG\n            parser.tagName = ''\n          } else if (c === '?') {\n            parser.state = S.PROC_INST\n            parser.procInstName = parser.procInstBody = ''\n          } else {\n            strictFail(parser, 'Unencoded <')\n            // if there was some whitespace, then add that in.\n            if (parser.startTagPosition + 1 < parser.position) {\n              var pad = parser.position - parser.startTagPosition\n              c = new Array(pad).join(' ') + c\n            }\n            parser.textNode += '<' + c\n            parser.state = S.TEXT\n          }\n          continue\n\n        case S.SGML_DECL:\n          if ((parser.sgmlDecl + c).toUpperCase() === CDATA) {\n            emitNode(parser, 'onopencdata')\n            parser.state = S.CDATA\n            parser.sgmlDecl = ''\n            parser.cdata = ''\n          } else if (parser.sgmlDecl + c === '--') {\n            parser.state = S.COMMENT\n            parser.comment = ''\n            parser.sgmlDecl = ''\n          } else if ((parser.sgmlDecl + c).toUpperCase() === DOCTYPE) {\n            parser.state = S.DOCTYPE\n            if (parser.doctype || parser.sawRoot) {\n              strictFail(parser,\n                'Inappropriately located doctype declaration')\n            }\n            parser.doctype = ''\n            parser.sgmlDecl = ''\n          } else if (c === '>') {\n            emitNode(parser, 'onsgmldeclaration', parser.sgmlDecl)\n            parser.sgmlDecl = ''\n            parser.state = S.TEXT\n          } else if (isQuote(c)) {\n            parser.state = S.SGML_DECL_QUOTED\n            parser.sgmlDecl += c\n          } else {\n            parser.sgmlDecl += c\n          }\n          continue\n\n        case S.SGML_DECL_QUOTED:\n          if (c === parser.q) {\n            parser.state = S.SGML_DECL\n            parser.q = ''\n          }\n          parser.sgmlDecl += c\n          continue\n\n        case S.DOCTYPE:\n          if (c === '>') {\n            parser.state = S.TEXT\n            emitNode(parser, 'ondoctype', parser.doctype)\n            parser.doctype = true // just remember that we saw it.\n          } else {\n            parser.doctype += c\n            if (c === '[') {\n              parser.state = S.DOCTYPE_DTD\n            } else if (isQuote(c)) {\n              parser.state = S.DOCTYPE_QUOTED\n              parser.q = c\n            }\n          }\n          continue\n\n        case S.DOCTYPE_QUOTED:\n          parser.doctype += c\n          if (c === parser.q) {\n            parser.q = ''\n            parser.state = S.DOCTYPE\n          }\n          continue\n\n        case S.DOCTYPE_DTD:\n          parser.doctype += c\n          if (c === ']') {\n            parser.state = S.DOCTYPE\n          } else if (isQuote(c)) {\n            parser.state = S.DOCTYPE_DTD_QUOTED\n            parser.q = c\n          }\n          continue\n\n        case S.DOCTYPE_DTD_QUOTED:\n          parser.doctype += c\n          if (c === parser.q) {\n            parser.state = S.DOCTYPE_DTD\n            parser.q = ''\n          }\n          continue\n\n        case S.COMMENT:\n          if (c === '-') {\n            parser.state = S.COMMENT_ENDING\n          } else {\n            parser.comment += c\n          }\n          continue\n\n        case S.COMMENT_ENDING:\n          if (c === '-') {\n            parser.state = S.COMMENT_ENDED\n            parser.comment = textopts(parser.opt, parser.comment)\n            if (parser.comment) {\n              emitNode(parser, 'oncomment', parser.comment)\n            }\n            parser.comment = ''\n          } else {\n            parser.comment += '-' + c\n            parser.state = S.COMMENT\n          }\n          continue\n\n        case S.COMMENT_ENDED:\n          if (c !== '>') {\n            strictFail(parser, 'Malformed comment')\n            // allow <!-- blah -- bloo --> in non-strict mode,\n            // which is a comment of \" blah -- bloo \"\n            parser.comment += '--' + c\n            parser.state = S.COMMENT\n          } else {\n            parser.state = S.TEXT\n          }\n          continue\n\n        case S.CDATA:\n          if (c === ']') {\n            parser.state = S.CDATA_ENDING\n          } else {\n            parser.cdata += c\n          }\n          continue\n\n        case S.CDATA_ENDING:\n          if (c === ']') {\n            parser.state = S.CDATA_ENDING_2\n          } else {\n            parser.cdata += ']' + c\n            parser.state = S.CDATA\n          }\n          continue\n\n        case S.CDATA_ENDING_2:\n          if (c === '>') {\n            if (parser.cdata) {\n              emitNode(parser, 'oncdata', parser.cdata)\n            }\n            emitNode(parser, 'onclosecdata')\n            parser.cdata = ''\n            parser.state = S.TEXT\n          } else if (c === ']') {\n            parser.cdata += ']'\n          } else {\n            parser.cdata += ']]' + c\n            parser.state = S.CDATA\n          }\n          continue\n\n        case S.PROC_INST:\n          if (c === '?') {\n            parser.state = S.PROC_INST_ENDING\n          } else if (isWhitespace(c)) {\n            parser.state = S.PROC_INST_BODY\n          } else {\n            parser.procInstName += c\n          }\n          continue\n\n        case S.PROC_INST_BODY:\n          if (!parser.procInstBody && isWhitespace(c)) {\n            continue\n          } else if (c === '?') {\n            parser.state = S.PROC_INST_ENDING\n          } else {\n            parser.procInstBody += c\n          }\n          continue\n\n        case S.PROC_INST_ENDING:\n          if (c === '>') {\n            emitNode(parser, 'onprocessinginstruction', {\n              name: parser.procInstName,\n              body: parser.procInstBody\n            })\n            parser.procInstName = parser.procInstBody = ''\n            parser.state = S.TEXT\n          } else {\n            parser.procInstBody += '?' + c\n            parser.state = S.PROC_INST_BODY\n          }\n          continue\n\n        case S.OPEN_TAG:\n          if (isMatch(nameBody, c)) {\n            parser.tagName += c\n          } else {\n            newTag(parser)\n            if (c === '>') {\n              openTag(parser)\n            } else if (c === '/') {\n              parser.state = S.OPEN_TAG_SLASH\n            } else {\n              if (!isWhitespace(c)) {\n                strictFail(parser, 'Invalid character in tag name')\n              }\n              parser.state = S.ATTRIB\n            }\n          }\n          continue\n\n        case S.OPEN_TAG_SLASH:\n          if (c === '>') {\n            openTag(parser, true)\n            closeTag(parser)\n          } else {\n            strictFail(parser, 'Forward-slash in opening tag not followed by >')\n            parser.state = S.ATTRIB\n          }\n          continue\n\n        case S.ATTRIB:\n          // haven't read the attribute name yet.\n          if (isWhitespace(c)) {\n            continue\n          } else if (c === '>') {\n            openTag(parser)\n          } else if (c === '/') {\n            parser.state = S.OPEN_TAG_SLASH\n          } else if (isMatch(nameStart, c)) {\n            parser.attribName = c\n            parser.attribValue = ''\n            parser.state = S.ATTRIB_NAME\n          } else {\n            strictFail(parser, 'Invalid attribute name')\n          }\n          continue\n\n        case S.ATTRIB_NAME:\n          if (c === '=') {\n            parser.state = S.ATTRIB_VALUE\n          } else if (c === '>') {\n            strictFail(parser, 'Attribute without value')\n            parser.attribValue = parser.attribName\n            attrib(parser)\n            openTag(parser)\n          } else if (isWhitespace(c)) {\n            parser.state = S.ATTRIB_NAME_SAW_WHITE\n          } else if (isMatch(nameBody, c)) {\n            parser.attribName += c\n          } else {\n            strictFail(parser, 'Invalid attribute name')\n          }\n          continue\n\n        case S.ATTRIB_NAME_SAW_WHITE:\n          if (c === '=') {\n            parser.state = S.ATTRIB_VALUE\n          } else if (isWhitespace(c)) {\n            continue\n          } else {\n            strictFail(parser, 'Attribute without value')\n            parser.tag.attributes[parser.attribName] = ''\n            parser.attribValue = ''\n            emitNode(parser, 'onattribute', {\n              name: parser.attribName,\n              value: ''\n            })\n            parser.attribName = ''\n            if (c === '>') {\n              openTag(parser)\n            } else if (isMatch(nameStart, c)) {\n              parser.attribName = c\n              parser.state = S.ATTRIB_NAME\n            } else {\n              strictFail(parser, 'Invalid attribute name')\n              parser.state = S.ATTRIB\n            }\n          }\n          continue\n\n        case S.ATTRIB_VALUE:\n          if (isWhitespace(c)) {\n            continue\n          } else if (isQuote(c)) {\n            parser.q = c\n            parser.state = S.ATTRIB_VALUE_QUOTED\n          } else {\n            strictFail(parser, 'Unquoted attribute value')\n            parser.state = S.ATTRIB_VALUE_UNQUOTED\n            parser.attribValue = c\n          }\n          continue\n\n        case S.ATTRIB_VALUE_QUOTED:\n          if (c !== parser.q) {\n            if (c === '&') {\n              parser.state = S.ATTRIB_VALUE_ENTITY_Q\n            } else {\n              parser.attribValue += c\n            }\n            continue\n          }\n          attrib(parser)\n          parser.q = ''\n          parser.state = S.ATTRIB_VALUE_CLOSED\n          continue\n\n        case S.ATTRIB_VALUE_CLOSED:\n          if (isWhitespace(c)) {\n            parser.state = S.ATTRIB\n          } else if (c === '>') {\n            openTag(parser)\n          } else if (c === '/') {\n            parser.state = S.OPEN_TAG_SLASH\n          } else if (isMatch(nameStart, c)) {\n            strictFail(parser, 'No whitespace between attributes')\n            parser.attribName = c\n            parser.attribValue = ''\n            parser.state = S.ATTRIB_NAME\n          } else {\n            strictFail(parser, 'Invalid attribute name')\n          }\n          continue\n\n        case S.ATTRIB_VALUE_UNQUOTED:\n          if (!isAttribEnd(c)) {\n            if (c === '&') {\n              parser.state = S.ATTRIB_VALUE_ENTITY_U\n            } else {\n              parser.attribValue += c\n            }\n            continue\n          }\n          attrib(parser)\n          if (c === '>') {\n            openTag(parser)\n          } else {\n            parser.state = S.ATTRIB\n          }\n          continue\n\n        case S.CLOSE_TAG:\n          if (!parser.tagName) {\n            if (isWhitespace(c)) {\n              continue\n            } else if (notMatch(nameStart, c)) {\n              if (parser.script) {\n                parser.script += '</' + c\n                parser.state = S.SCRIPT\n              } else {\n                strictFail(parser, 'Invalid tagname in closing tag.')\n              }\n            } else {\n              parser.tagName = c\n            }\n          } else if (c === '>') {\n            closeTag(parser)\n          } else if (isMatch(nameBody, c)) {\n            parser.tagName += c\n          } else if (parser.script) {\n            parser.script += '</' + parser.tagName\n            parser.tagName = ''\n            parser.state = S.SCRIPT\n          } else {\n            if (!isWhitespace(c)) {\n              strictFail(parser, 'Invalid tagname in closing tag')\n            }\n            parser.state = S.CLOSE_TAG_SAW_WHITE\n          }\n          continue\n\n        case S.CLOSE_TAG_SAW_WHITE:\n          if (isWhitespace(c)) {\n            continue\n          }\n          if (c === '>') {\n            closeTag(parser)\n          } else {\n            strictFail(parser, 'Invalid characters in closing tag')\n          }\n          continue\n\n        case S.TEXT_ENTITY:\n        case S.ATTRIB_VALUE_ENTITY_Q:\n        case S.ATTRIB_VALUE_ENTITY_U:\n          var returnState\n          var buffer\n          switch (parser.state) {\n            case S.TEXT_ENTITY:\n              returnState = S.TEXT\n              buffer = 'textNode'\n              break\n\n            case S.ATTRIB_VALUE_ENTITY_Q:\n              returnState = S.ATTRIB_VALUE_QUOTED\n              buffer = 'attribValue'\n              break\n\n            case S.ATTRIB_VALUE_ENTITY_U:\n              returnState = S.ATTRIB_VALUE_UNQUOTED\n              buffer = 'attribValue'\n              break\n          }\n\n          if (c === ';') {\n            if (parser.opt.unparsedEntities) {\n              var parsedEntity = parseEntity(parser)\n              parser.entity = ''\n              parser.state = returnState\n              parser.write(parsedEntity)\n            } else {\n              parser[buffer] += parseEntity(parser)\n              parser.entity = ''\n              parser.state = returnState\n            }\n          } else if (isMatch(parser.entity.length ? entityBody : entityStart, c)) {\n            parser.entity += c\n          } else {\n            strictFail(parser, 'Invalid character in entity name')\n            parser[buffer] += '&' + parser.entity + c\n            parser.entity = ''\n            parser.state = returnState\n          }\n\n          continue\n\n        default: /* istanbul ignore next */ {\n          throw new Error(parser, 'Unknown state: ' + parser.state)\n        }\n      }\n    } // while\n\n    if (parser.position >= parser.bufferCheckPosition) {\n      checkBufferLength(parser)\n    }\n    return parser\n  }\n\n  /*! http://mths.be/fromcodepoint v0.1.0 by @mathias */\n  /* istanbul ignore next */\n  if (!String.fromCodePoint) {\n    (function () {\n      var stringFromCharCode = String.fromCharCode\n      var floor = Math.floor\n      var fromCodePoint = function () {\n        var MAX_SIZE = 0x4000\n        var codeUnits = []\n        var highSurrogate\n        var lowSurrogate\n        var index = -1\n        var length = arguments.length\n        if (!length) {\n          return ''\n        }\n        var result = ''\n        while (++index < length) {\n          var codePoint = Number(arguments[index])\n          if (\n            !isFinite(codePoint) || // `NaN`, `+Infinity`, or `-Infinity`\n            codePoint < 0 || // not a valid Unicode code point\n            codePoint > 0x10FFFF || // not a valid Unicode code point\n            floor(codePoint) !== codePoint // not an integer\n          ) {\n            throw RangeError('Invalid code point: ' + codePoint)\n          }\n          if (codePoint <= 0xFFFF) { // BMP code point\n            codeUnits.push(codePoint)\n          } else { // Astral code point; split in surrogate halves\n            // http://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\n            codePoint -= 0x10000\n            highSurrogate = (codePoint >> 10) + 0xD800\n            lowSurrogate = (codePoint % 0x400) + 0xDC00\n            codeUnits.push(highSurrogate, lowSurrogate)\n          }\n          if (index + 1 === length || codeUnits.length > MAX_SIZE) {\n            result += stringFromCharCode.apply(null, codeUnits)\n            codeUnits.length = 0\n          }\n        }\n        return result\n      }\n      /* istanbul ignore next */\n      if (Object.defineProperty) {\n        Object.defineProperty(String, 'fromCodePoint', {\n          value: fromCodePoint,\n          configurable: true,\n          writable: true\n        })\n      } else {\n        String.fromCodePoint = fromCodePoint\n      }\n    }())\n  }\n})(typeof exports === 'undefined' ? this.sax = {} : exports)\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  \"use strict\";\n  exports.stripBOM = function(str) {\n    if (str[0] === '\\uFEFF') {\n      return str.substring(1);\n    } else {\n      return str;\n    }\n  };\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  \"use strict\";\n  var prefixMatch;\n\n  prefixMatch = new RegExp(/(?!xmlns)^.*:/);\n\n  exports.normalize = function(str) {\n    return str.toLowerCase();\n  };\n\n  exports.firstCharLowerCase = function(str) {\n    return str.charAt(0).toLowerCase() + str.slice(1);\n  };\n\n  exports.stripPrefix = function(str) {\n    return str.replace(prefixMatch, '');\n  };\n\n  exports.parseNumbers = function(str) {\n    if (!isNaN(str)) {\n      str = str % 1 === 0 ? parseInt(str, 10) : parseFloat(str);\n    }\n    return str;\n  };\n\n  exports.parseBooleans = function(str) {\n    if (/^(?:true|false)$/i.test(str)) {\n      str = str.toLowerCase() === 'true';\n    }\n    return str;\n  };\n\n}).call(this);\n","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 6–8\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  \"use strict\";\n  var bom, defaults, defineProperty, events, isEmpty, processItem, processors, sax, setImmediate,\n    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  sax = require('sax');\n\n  events = require('events');\n\n  bom = require('./bom');\n\n  processors = require('./processors');\n\n  setImmediate = require('timers').setImmediate;\n\n  defaults = require('./defaults').defaults;\n\n  isEmpty = function(thing) {\n    return typeof thing === \"object\" && (thing != null) && Object.keys(thing).length === 0;\n  };\n\n  processItem = function(processors, item, key) {\n    var i, len, process;\n    for (i = 0, len = processors.length; i < len; i++) {\n      process = processors[i];\n      item = process(item, key);\n    }\n    return item;\n  };\n\n  defineProperty = function(obj, key, value) {\n    var descriptor;\n    descriptor = Object.create(null);\n    descriptor.value = value;\n    descriptor.writable = true;\n    descriptor.enumerable = true;\n    descriptor.configurable = true;\n    return Object.defineProperty(obj, key, descriptor);\n  };\n\n  exports.Parser = (function(superClass) {\n    extend(Parser, superClass);\n\n    function Parser(opts) {\n      this.parseStringPromise = bind(this.parseStringPromise, this);\n      this.parseString = bind(this.parseString, this);\n      this.reset = bind(this.reset, this);\n      this.assignOrPush = bind(this.assignOrPush, this);\n      this.processAsync = bind(this.processAsync, this);\n      var key, ref, value;\n      if (!(this instanceof exports.Parser)) {\n        return new exports.Parser(opts);\n      }\n      this.options = {};\n      ref = defaults[\"0.2\"];\n      for (key in ref) {\n        if (!hasProp.call(ref, key)) continue;\n        value = ref[key];\n        this.options[key] = value;\n      }\n      for (key in opts) {\n        if (!hasProp.call(opts, key)) continue;\n        value = opts[key];\n        this.options[key] = value;\n      }\n      if (this.options.xmlns) {\n        this.options.xmlnskey = this.options.attrkey + \"ns\";\n      }\n      if (this.options.normalizeTags) {\n        if (!this.options.tagNameProcessors) {\n          this.options.tagNameProcessors = [];\n        }\n        this.options.tagNameProcessors.unshift(processors.normalize);\n      }\n      this.reset();\n    }\n\n    Parser.prototype.processAsync = function() {\n      var chunk, err;\n      try {\n        if (this.remaining.length <= this.options.chunkSize) {\n          chunk = this.remaining;\n          this.remaining = '';\n          this.saxParser = this.saxParser.write(chunk);\n          return this.saxParser.close();\n        } else {\n          chunk = this.remaining.substr(0, this.options.chunkSize);\n          this.remaining = this.remaining.substr(this.options.chunkSize, this.remaining.length);\n          this.saxParser = this.saxParser.write(chunk);\n          return setImmediate(this.processAsync);\n        }\n      } catch (error1) {\n        err = error1;\n        if (!this.saxParser.errThrown) {\n          this.saxParser.errThrown = true;\n          return this.emit(err);\n        }\n      }\n    };\n\n    Parser.prototype.assignOrPush = function(obj, key, newValue) {\n      if (!(key in obj)) {\n        if (!this.options.explicitArray) {\n          return defineProperty(obj, key, newValue);\n        } else {\n          return defineProperty(obj, key, [newValue]);\n        }\n      } else {\n        if (!(obj[key] instanceof Array)) {\n          defineProperty(obj, key, [obj[key]]);\n        }\n        return obj[key].push(newValue);\n      }\n    };\n\n    Parser.prototype.reset = function() {\n      var attrkey, charkey, ontext, stack;\n      this.removeAllListeners();\n      this.saxParser = sax.parser(this.options.strict, {\n        trim: false,\n        normalize: false,\n        xmlns: this.options.xmlns\n      });\n      this.saxParser.errThrown = false;\n      this.saxParser.onerror = (function(_this) {\n        return function(error) {\n          _this.saxParser.resume();\n          if (!_this.saxParser.errThrown) {\n            _this.saxParser.errThrown = true;\n            return _this.emit(\"error\", error);\n          }\n        };\n      })(this);\n      this.saxParser.onend = (function(_this) {\n        return function() {\n          if (!_this.saxParser.ended) {\n            _this.saxParser.ended = true;\n            return _this.emit(\"end\", _this.resultObject);\n          }\n        };\n      })(this);\n      this.saxParser.ended = false;\n      this.EXPLICIT_CHARKEY = this.options.explicitCharkey;\n      this.resultObject = null;\n      stack = [];\n      attrkey = this.options.attrkey;\n      charkey = this.options.charkey;\n      this.saxParser.onopentag = (function(_this) {\n        return function(node) {\n          var key, newValue, obj, processedKey, ref;\n          obj = {};\n          obj[charkey] = \"\";\n          if (!_this.options.ignoreAttrs) {\n            ref = node.attributes;\n            for (key in ref) {\n              if (!hasProp.call(ref, key)) continue;\n              if (!(attrkey in obj) && !_this.options.mergeAttrs) {\n                obj[attrkey] = {};\n              }\n              newValue = _this.options.attrValueProcessors ? processItem(_this.options.attrValueProcessors, node.attributes[key], key) : node.attributes[key];\n              processedKey = _this.options.attrNameProcessors ? processItem(_this.options.attrNameProcessors, key) : key;\n              if (_this.options.mergeAttrs) {\n                _this.assignOrPush(obj, processedKey, newValue);\n              } else {\n                defineProperty(obj[attrkey], processedKey, newValue);\n              }\n            }\n          }\n          obj[\"#name\"] = _this.options.tagNameProcessors ? processItem(_this.options.tagNameProcessors, node.name) : node.name;\n          if (_this.options.xmlns) {\n            obj[_this.options.xmlnskey] = {\n              uri: node.uri,\n              local: node.local\n            };\n          }\n          return stack.push(obj);\n        };\n      })(this);\n      this.saxParser.onclosetag = (function(_this) {\n        return function() {\n          var cdata, emptyStr, key, node, nodeName, obj, objClone, old, s, xpath;\n          obj = stack.pop();\n          nodeName = obj[\"#name\"];\n          if (!_this.options.explicitChildren || !_this.options.preserveChildrenOrder) {\n            delete obj[\"#name\"];\n          }\n          if (obj.cdata === true) {\n            cdata = obj.cdata;\n            delete obj.cdata;\n          }\n          s = stack[stack.length - 1];\n          if (obj[charkey].match(/^\\s*$/) && !cdata) {\n            emptyStr = obj[charkey];\n            delete obj[charkey];\n          } else {\n            if (_this.options.trim) {\n              obj[charkey] = obj[charkey].trim();\n            }\n            if (_this.options.normalize) {\n              obj[charkey] = obj[charkey].replace(/\\s{2,}/g, \" \").trim();\n            }\n            obj[charkey] = _this.options.valueProcessors ? processItem(_this.options.valueProcessors, obj[charkey], nodeName) : obj[charkey];\n            if (Object.keys(obj).length === 1 && charkey in obj && !_this.EXPLICIT_CHARKEY) {\n              obj = obj[charkey];\n            }\n          }\n          if (isEmpty(obj)) {\n            if (typeof _this.options.emptyTag === 'function') {\n              obj = _this.options.emptyTag();\n            } else {\n              obj = _this.options.emptyTag !== '' ? _this.options.emptyTag : emptyStr;\n            }\n          }\n          if (_this.options.validator != null) {\n            xpath = \"/\" + ((function() {\n              var i, len, results;\n              results = [];\n              for (i = 0, len = stack.length; i < len; i++) {\n                node = stack[i];\n                results.push(node[\"#name\"]);\n              }\n              return results;\n            })()).concat(nodeName).join(\"/\");\n            (function() {\n              var err;\n              try {\n                return obj = _this.options.validator(xpath, s && s[nodeName], obj);\n              } catch (error1) {\n                err = error1;\n                return _this.emit(\"error\", err);\n              }\n            })();\n          }\n          if (_this.options.explicitChildren && !_this.options.mergeAttrs && typeof obj === 'object') {\n            if (!_this.options.preserveChildrenOrder) {\n              node = {};\n              if (_this.options.attrkey in obj) {\n                node[_this.options.attrkey] = obj[_this.options.attrkey];\n                delete obj[_this.options.attrkey];\n              }\n              if (!_this.options.charsAsChildren && _this.options.charkey in obj) {\n                node[_this.options.charkey] = obj[_this.options.charkey];\n                delete obj[_this.options.charkey];\n              }\n              if (Object.getOwnPropertyNames(obj).length > 0) {\n                node[_this.options.childkey] = obj;\n              }\n              obj = node;\n            } else if (s) {\n              s[_this.options.childkey] = s[_this.options.childkey] || [];\n              objClone = {};\n              for (key in obj) {\n                if (!hasProp.call(obj, key)) continue;\n                defineProperty(objClone, key, obj[key]);\n              }\n              s[_this.options.childkey].push(objClone);\n              delete obj[\"#name\"];\n              if (Object.keys(obj).length === 1 && charkey in obj && !_this.EXPLICIT_CHARKEY) {\n                obj = obj[charkey];\n              }\n            }\n          }\n          if (stack.length > 0) {\n            return _this.assignOrPush(s, nodeName, obj);\n          } else {\n            if (_this.options.explicitRoot) {\n              old = obj;\n              obj = {};\n              defineProperty(obj, nodeName, old);\n            }\n            _this.resultObject = obj;\n            _this.saxParser.ended = true;\n            return _this.emit(\"end\", _this.resultObject);\n          }\n        };\n      })(this);\n      ontext = (function(_this) {\n        return function(text) {\n          var charChild, s;\n          s = stack[stack.length - 1];\n          if (s) {\n            s[charkey] += text;\n            if (_this.options.explicitChildren && _this.options.preserveChildrenOrder && _this.options.charsAsChildren && (_this.options.includeWhiteChars || text.replace(/\\\\n/g, '').trim() !== '')) {\n              s[_this.options.childkey] = s[_this.options.childkey] || [];\n              charChild = {\n                '#name': '__text__'\n              };\n              charChild[charkey] = text;\n              if (_this.options.normalize) {\n                charChild[charkey] = charChild[charkey].replace(/\\s{2,}/g, \" \").trim();\n              }\n              s[_this.options.childkey].push(charChild);\n            }\n            return s;\n          }\n        };\n      })(this);\n      this.saxParser.ontext = ontext;\n      return this.saxParser.oncdata = (function(_this) {\n        return function(text) {\n          var s;\n          s = ontext(text);\n          if (s) {\n            return s.cdata = true;\n          }\n        };\n      })(this);\n    };\n\n    Parser.prototype.parseString = function(str, cb) {\n      var err;\n      if ((cb != null) && typeof cb === \"function\") {\n        this.on(\"end\", function(result) {\n          this.reset();\n          return cb(null, result);\n        });\n        this.on(\"error\", function(err) {\n          this.reset();\n          return cb(err);\n        });\n      }\n      try {\n        str = str.toString();\n        if (str.trim() === '') {\n          this.emit(\"end\", null);\n          return true;\n        }\n        str = bom.stripBOM(str);\n        if (this.options.async) {\n          this.remaining = str;\n          setImmediate(this.processAsync);\n          return this.saxParser;\n        }\n        return this.saxParser.write(str).close();\n      } catch (error1) {\n        err = error1;\n        if (!(this.saxParser.errThrown || this.saxParser.ended)) {\n          this.emit('error', err);\n          return this.saxParser.errThrown = true;\n        } else if (this.saxParser.ended) {\n          throw err;\n        }\n      }\n    };\n\n    Parser.prototype.parseStringPromise = function(str) {\n      return new Promise((function(_this) {\n        return function(resolve, reject) {\n          return _this.parseString(str, function(err, value) {\n            if (err) {\n              return reject(err);\n            } else {\n              return resolve(value);\n            }\n          });\n        };\n      })(this));\n    };\n\n    return Parser;\n\n  })(events);\n\n  exports.parseString = function(str, a, b) {\n    var cb, options, parser;\n    if (b != null) {\n      if (typeof b === 'function') {\n        cb = b;\n      }\n      if (typeof a === 'object') {\n        options = a;\n      }\n    } else {\n      if (typeof a === 'function') {\n        cb = a;\n      }\n      options = {};\n    }\n    parser = new exports.Parser(options);\n    return parser.parseString(str, cb);\n  };\n\n  exports.parseStringPromise = function(str, a) {\n    var options, parser;\n    if (typeof a === 'object') {\n      options = a;\n    }\n    parser = new exports.Parser(options);\n    return parser.parseStringPromise(str);\n  };\n\n}).call(this);\n","// Generated by CoffeeScript 1.12.7\n(function() {\n  \"use strict\";\n  var builder, defaults, parser, processors,\n    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    hasProp = {}.hasOwnProperty;\n\n  defaults = require('./defaults');\n\n  builder = require('./builder');\n\n  parser = require('./parser');\n\n  processors = require('./processors');\n\n  exports.defaults = defaults.defaults;\n\n  exports.processors = processors;\n\n  exports.ValidationError = (function(superClass) {\n    extend(ValidationError, superClass);\n\n    function ValidationError(message) {\n      this.message = message;\n    }\n\n    return ValidationError;\n\n  })(Error);\n\n  exports.Builder = builder.Builder;\n\n  exports.Parser = parser.Parser;\n\n  exports.parseString = parser.parseString;\n\n  exports.parseStringPromise = parser.parseStringPromise;\n\n}).call(this);\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport type { Folder, Node } from '@nextcloud/files'\nimport type { FilesStore, RootsStore, RootOptions, Service, FilesState, FileId } from '../types'\n\nimport { defineStore } from 'pinia'\nimport { subscribe } from '@nextcloud/event-bus'\nimport logger from '../logger'\nimport Vue from 'vue'\n\nexport const useFilesStore = function(...args) {\n\tconst store = defineStore('files', {\n\t\tstate: (): FilesState => ({\n\t\t\tfiles: {} as FilesStore,\n\t\t\troots: {} as RootsStore,\n\t\t}),\n\n\t\tgetters: {\n\t\t\t/**\n\t\t\t * Get a file or folder by id\n\t\t\t */\n\t\t\tgetNode: (state) => (id: FileId): Node|undefined => state.files[id],\n\n\t\t\t/**\n\t\t\t * Get a list of files or folders by their IDs\n\t\t\t * Does not return undefined values\n\t\t\t */\n\t\t\tgetNodes: (state) => (ids: FileId[]): Node[] => ids\n\t\t\t\t.map(id => state.files[id])\n\t\t\t\t.filter(Boolean),\n\t\t\t/**\n\t\t\t * Get a file or folder by id\n\t\t\t */\n\t\t\tgetRoot: (state) => (service: Service): Folder|undefined => state.roots[service],\n\t\t},\n\n\t\tactions: {\n\t\t\tupdateNodes(nodes: Node[]) {\n\t\t\t\t// Update the store all at once\n\t\t\t\tconst files = nodes.reduce((acc, node) => {\n\t\t\t\t\tif (!node.fileid) {\n\t\t\t\t\t\tlogger.error('Trying to update/set a node without fileid', node)\n\t\t\t\t\t\treturn acc\n\t\t\t\t\t}\n\t\t\t\t\tacc[node.fileid] = node\n\t\t\t\t\treturn acc\n\t\t\t\t}, {} as FilesStore)\n\n\t\t\t\tVue.set(this, 'files', { ...this.files, ...files })\n\t\t\t},\n\n\t\t\tdeleteNodes(nodes: Node[]) {\n\t\t\t\tnodes.forEach(node => {\n\t\t\t\t\tif (node.fileid) {\n\t\t\t\t\t\tVue.delete(this.files, node.fileid)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\n\t\t\tsetRoot({ service, root }: RootOptions) {\n\t\t\t\tVue.set(this.roots, service, root)\n\t\t\t},\n\n\t\t\tonDeletedNode(node: Node) {\n\t\t\t\tthis.deleteNodes([node])\n\t\t\t},\n\n\t\t\tonCreatedNode(node: Node) {\n\t\t\t\tthis.updateNodes([node])\n\t\t\t},\n\n\t\t\tonUpdatedNode(node: Node) {\n\t\t\t\tthis.updateNodes([node])\n\t\t\t},\n\t\t},\n\t})\n\n\tconst fileStore = store(...args)\n\t// Make sure we only register the listeners once\n\tif (!fileStore._initialized) {\n\t\tsubscribe('files:node:created', fileStore.onCreatedNode)\n\t\tsubscribe('files:node:deleted', fileStore.onDeletedNode)\n\t\tsubscribe('files:node:updated', fileStore.onUpdatedNode)\n\n\t\tfileStore._initialized = true\n\t}\n\n\treturn fileStore\n}\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport type { FileId, PathsStore, PathOptions, ServicesState } from '../types'\nimport { defineStore } from 'pinia'\nimport { FileType, Folder, Node, getNavigation } from '@nextcloud/files'\nimport { subscribe } from '@nextcloud/event-bus'\nimport Vue from 'vue'\nimport logger from '../logger'\n\nimport { useFilesStore } from './files'\n\nexport const usePathsStore = function(...args) {\n\tconst files = useFilesStore()\n\n\tconst store = defineStore('paths', {\n\t\tstate: () => ({\n\t\t\tpaths: {} as ServicesState,\n\t\t} as PathsStore),\n\n\t\tgetters: {\n\t\t\tgetPath: (state) => {\n\t\t\t\treturn (service: string, path: string): FileId|undefined => {\n\t\t\t\t\tif (!state.paths[service]) {\n\t\t\t\t\t\treturn undefined\n\t\t\t\t\t}\n\t\t\t\t\treturn state.paths[service][path]\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\n\t\tactions: {\n\t\t\taddPath(payload: PathOptions) {\n\t\t\t\t// If it doesn't exists, init the service state\n\t\t\t\tif (!this.paths[payload.service]) {\n\t\t\t\t\tVue.set(this.paths, payload.service, {})\n\t\t\t\t}\n\n\t\t\t\t// Now we can set the provided path\n\t\t\t\tVue.set(this.paths[payload.service], payload.path, payload.fileid)\n\t\t\t},\n\n\t\t\tonCreatedNode(node: Node) {\n\t\t\t\tconst service = getNavigation()?.active?.id || 'files'\n\t\t\t\tif (!node.fileid) {\n\t\t\t\t\tlogger.error('Node has no fileid', { node })\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\t// Only add path if it's a folder\n\t\t\t\tif (node.type === FileType.Folder) {\n\t\t\t\t\tthis.addPath({\n\t\t\t\t\t\tservice,\n\t\t\t\t\t\tpath: node.path,\n\t\t\t\t\t\tfileid: node.fileid,\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t// Update parent folder children if exists\n\t\t\t\t// If the folder is the root, get it and update it\n\t\t\t\tif (node.dirname === '/') {\n\t\t\t\t\tconst root = files.getRoot(service)\n\t\t\t\t\tif (!root._children) {\n\t\t\t\t\t\tVue.set(root, '_children', [])\n\t\t\t\t\t}\n\t\t\t\t\troot._children.push(node.fileid)\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\t// If the folder doesn't exists yet, it will be\n\t\t\t\t// fetched later and its children updated anyway.\n\t\t\t\tif (this.paths[service][node.dirname]) {\n\t\t\t\t\tconst parentId = this.paths[service][node.dirname]\n\t\t\t\t\tconst parentFolder = files.getNode(parentId) as Folder\n\t\t\t\t\tlogger.debug('Path already exists, updating children', { parentFolder, node })\n\n\t\t\t\t\tif (!parentFolder) {\n\t\t\t\t\t\tlogger.error('Parent folder not found', { parentId })\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!parentFolder._children) {\n\t\t\t\t\t\tVue.set(parentFolder, '_children', [])\n\t\t\t\t\t}\n\t\t\t\t\tparentFolder._children.push(node.fileid)\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tlogger.debug('Parent path does not exists, skipping children update', { node })\n\t\t\t},\n\t\t},\n\t})\n\n\tconst pathsStore = store(...args)\n\t// Make sure we only register the listeners once\n\tif (!pathsStore._initialized) {\n\t\t// TODO: watch folders to update paths?\n\t\tsubscribe('files:node:created', pathsStore.onCreatedNode)\n\t\t// subscribe('files:node:deleted', pathsStore.onDeletedNode)\n\t\t// subscribe('files:node:moved', pathsStore.onMovedNode)\n\n\t\tpathsStore._initialized = true\n\t}\n\n\treturn pathsStore\n}\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport type { FileId, SelectionStore } from '../types'\nimport { defineStore } from 'pinia'\nimport Vue from 'vue'\n\nexport const useSelectionStore = defineStore('selection', {\n\tstate: () => ({\n\t\tselected: [],\n\t\tlastSelection: [],\n\t\tlastSelectedIndex: null,\n\t} as SelectionStore),\n\n\tactions: {\n\t\t/**\n\t\t * Set the selection of fileIds\n\t\t */\n\t\tset(selection = [] as FileId[]) {\n\t\t\tVue.set(this, 'selected', [...new Set(selection)])\n\t\t},\n\n\t\t/**\n\t\t * Set the last selected index\n\t\t */\n\t\tsetLastIndex(lastSelectedIndex = null as FileId | null) {\n\t\t\t// Update the last selection if we provided a new selection starting point\n\t\t\tVue.set(this, 'lastSelection', lastSelectedIndex ? this.selected : [])\n\t\t\tVue.set(this, 'lastSelectedIndex', lastSelectedIndex)\n\t\t},\n\n\t\t/**\n\t\t * Reset the selection\n\t\t */\n\t\treset() {\n\t\t\tVue.set(this, 'selected', [])\n\t\t\tVue.set(this, 'lastSelection', [])\n\t\t\tVue.set(this, 'lastSelectedIndex', null)\n\t\t},\n\t},\n})\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport type { Uploader } from '@nextcloud/upload'\nimport type { UploaderStore } from '../types'\n\nimport { defineStore } from 'pinia'\nimport { getUploader } from '@nextcloud/upload'\n\nlet uploader: Uploader\n\nexport const useUploaderStore = function(...args) {\n\t// Only init on runtime\n\tuploader = getUploader()\n\n\tconst store = defineStore('uploader', {\n\t\tstate: () => ({\n\t\t\tqueue: uploader.queue,\n\t\t} as UploaderStore),\n\t})\n\n\treturn store(...args)\n}\n","/**\n * @copyright Copyright (c) 2024 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport type { FileStat, ResponseDataDetailed } from 'webdav'\n\nimport { emit } from '@nextcloud/event-bus'\nimport { Folder, Node, davGetClient, davGetDefaultPropfind, davResultToNode } from '@nextcloud/files'\nimport { openConflictPicker } from '@nextcloud/upload'\nimport { showError, showInfo } from '@nextcloud/dialogs'\nimport { translate as t } from '@nextcloud/l10n'\n\nimport logger from '../logger.js'\n\n/**\n * This represents a Directory in the file tree\n * We extend the File class to better handling uploading\n * and stay as close as possible as the Filesystem API.\n * This also allow us to hijack the size or lastModified\n * properties to compute them dynamically.\n */\nexport class Directory extends File {\n\n\t/* eslint-disable no-use-before-define */\n\t_contents: (Directory|File)[]\n\n\tconstructor(name, contents: (Directory|File)[] = []) {\n\t\tsuper([], name, { type: 'httpd/unix-directory' })\n\t\tthis._contents = contents\n\t}\n\n\tset contents(contents: (Directory|File)[]) {\n\t\tthis._contents = contents\n\t}\n\n\tget contents(): (Directory|File)[] {\n\t\treturn this._contents\n\t}\n\n\tget size() {\n\t\treturn this._computeDirectorySize(this)\n\t}\n\n\tget lastModified() {\n\t\tif (this._contents.length === 0) {\n\t\t\treturn Date.now()\n\t\t}\n\t\treturn this._computeDirectoryMtime(this)\n\t}\n\n\t/**\n\t * Get the last modification time of a file tree\n\t * This is not perfect, but will get us a pretty good approximation\n\t * @param directory the directory to traverse\n\t */\n\t_computeDirectoryMtime(directory: Directory): number {\n\t\treturn directory.contents.reduce((acc, file) => {\n\t\t\treturn file.lastModified > acc\n\t\t\t\t// If the file is a directory, the lastModified will\n\t\t\t\t// also return the results of its _computeDirectoryMtime method\n\t\t\t\t// Fancy recursion, huh?\n\t\t\t\t? file.lastModified\n\t\t\t\t: acc\n\t\t}, 0)\n\t}\n\n\t/**\n\t * Get the size of a file tree\n\t * @param directory the directory to traverse\n\t */\n\t_computeDirectorySize(directory: Directory): number {\n\t\treturn directory.contents.reduce((acc: number, entry: Directory|File) => {\n\t\t\t// If the file is a directory, the size will\n\t\t\t// also return the results of its _computeDirectorySize method\n\t\t\t// Fancy recursion, huh?\n\t\t\treturn acc + entry.size\n\t\t}, 0)\n\t}\n\n}\n\nexport type RootDirectory = Directory & {\n\tname: 'root'\n}\n\n/**\n * Traverse a file tree using the Filesystem API\n * @param entry the entry to traverse\n */\nexport const traverseTree = async (entry: FileSystemEntry): Promise<Directory|File> => {\n\t// Handle file\n\tif (entry.isFile) {\n\t\treturn new Promise<File>((resolve, reject) => {\n\t\t\t(entry as FileSystemFileEntry).file(resolve, reject)\n\t\t})\n\t}\n\n\t// Handle directory\n\tlogger.debug('Handling recursive file tree', { entry: entry.name })\n\tconst directory = entry as FileSystemDirectoryEntry\n\tconst entries = await readDirectory(directory)\n\tconst contents = (await Promise.all(entries.map(traverseTree))).flat()\n\treturn new Directory(directory.name, contents)\n}\n\n/**\n * Read a directory using Filesystem API\n * @param directory the directory to read\n */\nconst readDirectory = (directory: FileSystemDirectoryEntry): Promise<FileSystemEntry[]> => {\n\tconst dirReader = directory.createReader()\n\n\treturn new Promise<FileSystemEntry[]>((resolve, reject) => {\n\t\tconst entries = [] as FileSystemEntry[]\n\t\tconst getEntries = () => {\n\t\t\tdirReader.readEntries((results) => {\n\t\t\t\tif (results.length) {\n\t\t\t\t\tentries.push(...results)\n\t\t\t\t\tgetEntries()\n\t\t\t\t} else {\n\t\t\t\t\tresolve(entries)\n\t\t\t\t}\n\t\t\t}, (error) => {\n\t\t\t\treject(error)\n\t\t\t})\n\t\t}\n\n\t\tgetEntries()\n\t})\n}\n\nexport const createDirectoryIfNotExists = async (absolutePath: string) => {\n\tconst davClient = davGetClient()\n\tconst dirExists = await davClient.exists(absolutePath)\n\tif (!dirExists) {\n\t\tlogger.debug('Directory does not exist, creating it', { absolutePath })\n\t\tawait davClient.createDirectory(absolutePath, { recursive: true })\n\t\tconst stat = await davClient.stat(absolutePath, { details: true, data: davGetDefaultPropfind() }) as ResponseDataDetailed<FileStat>\n\t\temit('files:node:created', davResultToNode(stat.data))\n\t}\n}\n\nexport const resolveConflict = async <T extends ((Directory|File)|Node)>(files: Array<T>, destination: Folder, contents: Node[]): Promise<T[]> => {\n\ttry {\n\t\t// List all conflicting files\n\t\tconst conflicts = files.filter((file: File|Node) => {\n\t\t\treturn contents.find((node: Node) => node.basename === (file instanceof File ? file.name : file.basename))\n\t\t}).filter(Boolean) as (File|Node)[]\n\n\t\t// List of incoming files that are NOT in conflict\n\t\tconst uploads = files.filter((file: File|Node) => {\n\t\t\treturn !conflicts.includes(file)\n\t\t})\n\n\t\t// Let the user choose what to do with the conflicting files\n\t\tconst { selected, renamed } = await openConflictPicker(destination.path, conflicts, contents)\n\n\t\tlogger.debug('Conflict resolution', { uploads, selected, renamed })\n\n\t\t// If the user selected nothing, we cancel the upload\n\t\tif (selected.length === 0 && renamed.length === 0) {\n\t\t\t// User skipped\n\t\t\tshowInfo(t('files', 'Conflicts resolution skipped'))\n\t\t\tlogger.info('User skipped the conflict resolution')\n\t\t\treturn []\n\t\t}\n\n\t\t// Update the list of files to upload\n\t\treturn [...uploads, ...selected, ...renamed] as (typeof files)\n\t} catch (error) {\n\t\tconsole.error(error)\n\t\t// User cancelled\n\t\tshowError(t('files', 'Upload cancelled'))\n\t\tlogger.error('User cancelled the upload')\n\t}\n\n\treturn []\n}\n","/**\n * @copyright Copyright (c) 2023 Ferdinand Thiessen <opensource@fthiessen.de>\n *\n * @author Ferdinand Thiessen <opensource@fthiessen.de>\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport type { Upload } from '@nextcloud/upload'\nimport type { RootDirectory } from './DropServiceUtils'\n\nimport { Folder, Node, NodeStatus, davRootPath } from '@nextcloud/files'\nimport { getUploader, hasConflict } from '@nextcloud/upload'\nimport { join } from 'path'\nimport { joinPaths } from '@nextcloud/paths'\nimport { showError, showInfo, showSuccess, showWarning } from '@nextcloud/dialogs'\nimport { translate as t } from '@nextcloud/l10n'\nimport Vue from 'vue'\n\nimport { Directory, traverseTree, resolveConflict, createDirectoryIfNotExists } from './DropServiceUtils'\nimport { handleCopyMoveNodeTo } from '../actions/moveOrCopyAction'\nimport { MoveCopyAction } from '../actions/moveOrCopyActionUtils'\nimport logger from '../logger.js'\n\n/**\n * This function converts a list of DataTransferItems to a file tree.\n * It uses the Filesystem API if available, otherwise it falls back to the File API.\n * The File API will NOT be available if the browser is not in a secure context (e.g. HTTP).\n * ⚠️ When using this method, you need to use it as fast as possible, as the DataTransferItems\n * will be cleared after the first access to the props of one of the entries.\n *\n * @param items the list of DataTransferItems\n */\nexport const dataTransferToFileTree = async (items: DataTransferItem[]): Promise<RootDirectory> => {\n\t// Check if the browser supports the Filesystem API\n\t// We need to cache the entries to prevent Blink engine bug that clears\n\t// the list (`data.items`) after first access props of one of the entries\n\tconst entries = items\n\t\t.filter((item) => {\n\t\t\tif (item.kind !== 'file') {\n\t\t\t\tlogger.debug('Skipping dropped item', { kind: item.kind, type: item.type })\n\t\t\t\treturn false\n\t\t\t}\n\t\t\treturn true\n\t\t}).map((item) => {\n\t\t\t// MDN recommends to try both, as it might be renamed in the future\n\t\t\treturn (item as unknown as { getAsEntry?: () => FileSystemEntry|undefined })?.getAsEntry?.()\n\t\t\t\t?? item?.webkitGetAsEntry?.()\n\t\t\t\t?? item\n\t\t}) as (FileSystemEntry | DataTransferItem)[]\n\n\tlet warned = false\n\tconst fileTree = new Directory('root') as RootDirectory\n\n\t// Traverse the file tree\n\tfor (const entry of entries) {\n\t\t// Handle browser issues if Filesystem API is not available. Fallback to File API\n\t\tif (entry instanceof DataTransferItem) {\n\t\t\tlogger.warn('Could not get FilesystemEntry of item, falling back to file')\n\n\t\t\tconst file = entry.getAsFile()\n\t\t\tif (file === null) {\n\t\t\t\tlogger.warn('Could not process DataTransferItem', { type: entry.type, kind: entry.kind })\n\t\t\t\tshowError(t('files', 'One of the dropped files could not be processed'))\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// Warn the user that the browser does not support the Filesystem API\n\t\t\t// we therefore cannot upload directories recursively.\n\t\t\tif (file.type === 'httpd/unix-directory' || !file.type) {\n\t\t\t\tif (!warned) {\n\t\t\t\t\tlogger.warn('Browser does not support Filesystem API. Directories will not be uploaded')\n\t\t\t\t\tshowWarning(t('files', 'Your browser does not support the Filesystem API. Directories will not be uploaded'))\n\t\t\t\t\twarned = true\n\t\t\t\t}\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\tfileTree.contents.push(file)\n\t\t\tcontinue\n\t\t}\n\n\t\t// Use Filesystem API\n\t\ttry {\n\t\t\tfileTree.contents.push(await traverseTree(entry))\n\t\t} catch (error) {\n\t\t\t// Do not throw, as we want to continue with the other files\n\t\t\tlogger.error('Error while traversing file tree', { error })\n\t\t}\n\t}\n\n\treturn fileTree\n}\n\nexport const onDropExternalFiles = async (root: RootDirectory, destination: Folder, contents: Node[]): Promise<Upload[]> => {\n\tconst uploader = getUploader()\n\n\t// Check for conflicts on root elements\n\tif (await hasConflict(root.contents, contents)) {\n\t\troot.contents = await resolveConflict(root.contents, destination, contents)\n\t}\n\n\tif (root.contents.length === 0) {\n\t\tlogger.info('No files to upload', { root })\n\t\tshowInfo(t('files', 'No files to upload'))\n\t\treturn []\n\t}\n\n\t// Let's process the files\n\tlogger.debug(`Uploading files to ${destination.path}`, { root, contents: root.contents })\n\tconst queue = [] as Promise<Upload>[]\n\n\tconst uploadDirectoryContents = async (directory: Directory, path: string) => {\n\t\tfor (const file of directory.contents) {\n\t\t\t// This is the relative path to the resource\n\t\t\t// from the current uploader destination\n\t\t\tconst relativePath = join(path, file.name)\n\n\t\t\t// If the file is a directory, we need to create it first\n\t\t\t// then browse its tree and upload its contents.\n\t\t\tif (file instanceof Directory) {\n\t\t\t\tconst absolutePath = joinPaths(davRootPath, destination.path, relativePath)\n\t\t\t\ttry {\n\t\t\t\t\tconsole.debug('Processing directory', { relativePath })\n\t\t\t\t\tawait createDirectoryIfNotExists(absolutePath)\n\t\t\t\t\tawait uploadDirectoryContents(file, relativePath)\n\t\t\t\t} catch (error) {\n\t\t\t\t\tshowError(t('files', 'Unable to create the directory {directory}', { directory: file.name }))\n\t\t\t\t\tlogger.error('', { error, absolutePath, directory: file })\n\t\t\t\t}\n\t\t\t\tcontinue\n\t\t\t}\n\n\t\t\t// If we've reached a file, we can upload it\n\t\t\tlogger.debug('Uploading file to ' + join(destination.path, relativePath), { file })\n\n\t\t\t// Overriding the root to avoid changing the current uploader context\n\t\t\tqueue.push(uploader.upload(relativePath, file, destination.source))\n\t\t}\n\t}\n\n\t// Pause the uploader to prevent it from starting\n\t// while we compute the queue\n\tuploader.pause()\n\n\t// Upload the files. Using '/' as the starting point\n\t// as we already adjusted the uploader destination\n\tawait uploadDirectoryContents(root, '/')\n\tuploader.start()\n\n\t// Wait for all promises to settle\n\tconst results = await Promise.allSettled(queue)\n\n\t// Check for errors\n\tconst errors = results.filter(result => result.status === 'rejected')\n\tif (errors.length > 0) {\n\t\tlogger.error('Error while uploading files', { errors })\n\t\tshowError(t('files', 'Some files could not be uploaded'))\n\t\treturn []\n\t}\n\n\tlogger.debug('Files uploaded successfully')\n\tshowSuccess(t('files', 'Files uploaded successfully'))\n\n\treturn Promise.all(queue)\n}\n\nexport const onDropInternalFiles = async (nodes: Node[], destination: Folder, contents: Node[], isCopy = false) => {\n\tconst queue = [] as Promise<void>[]\n\n\t// Check for conflicts on root elements\n\tif (await hasConflict(nodes, contents)) {\n\t\tnodes = await resolveConflict(nodes, destination, contents)\n\t}\n\n\tif (nodes.length === 0) {\n\t\tlogger.info('No files to process', { nodes })\n\t\tshowInfo(t('files', 'No files to process'))\n\t\treturn\n\t}\n\n\tfor (const node of nodes) {\n\t\tVue.set(node, 'status', NodeStatus.LOADING)\n\t\t// TODO: resolve potential conflicts prior and force overwrite\n\t\tqueue.push(handleCopyMoveNodeTo(node, destination, isCopy ? MoveCopyAction.COPY : MoveCopyAction.MOVE))\n\t}\n\n\t// Wait for all promises to settle\n\tconst results = await Promise.allSettled(queue)\n\tnodes.forEach(node => Vue.set(node, 'status', undefined))\n\n\t// Check for errors\n\tconst errors = results.filter(result => result.status === 'rejected')\n\tif (errors.length > 0) {\n\t\tlogger.error('Error while copying or moving files', { errors })\n\t\tshowError(isCopy ? t('files', 'Some files could not be copied') : t('files', 'Some files could not be moved'))\n\t\treturn\n\t}\n\n\tlogger.debug('Files copy/move successful')\n\tshowSuccess(isCopy ? t('files', 'Files copied successfully') : t('files', 'Files moved successfully'))\n}\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { defineStore } from 'pinia'\nimport Vue from 'vue'\nimport type { FileId, DragAndDropStore } from '../types'\n\nexport const useDragAndDropStore = defineStore('dragging', {\n\tstate: () => ({\n\t\tdragging: [],\n\t} as DragAndDropStore),\n\n\tactions: {\n\t\t/**\n\t\t * Set the selection of fileIds\n\t\t */\n\t\tset(selection = [] as FileId[]) {\n\t\t\tVue.set(this, 'dragging', selection)\n\t\t},\n\n\t\t/**\n\t\t * Reset the selection\n\t\t */\n\t\treset() {\n\t\t\tVue.set(this, 'dragging', [])\n\t\t},\n\t},\n})\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport Vue from 'vue'\n\nexport default Vue.extend({\n\tdata() {\n\t\treturn {\n\t\t\tfilesListWidth: null as number | null,\n\t\t}\n\t},\n\tmounted() {\n\t\tconst fileListEl = document.querySelector('#app-content-vue')\n\t\tthis.filesListWidth = fileListEl?.clientWidth ?? null\n\n\t\tthis.$resizeObserver = new ResizeObserver((entries) => {\n\t\t\tif (entries.length > 0 && entries[0].target === fileListEl) {\n\t\t\t\tthis.filesListWidth = entries[0].contentRect.width\n\t\t\t}\n\t\t})\n\t\tthis.$resizeObserver.observe(fileListEl as Element)\n\t},\n\tbeforeDestroy() {\n\t\tthis.$resizeObserver.disconnect()\n\t},\n})\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license AGPL-3.0-or-later\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<NcBreadcrumbs data-cy-files-content-breadcrumbs\n\t\t:aria-label=\"t('files', 'Current directory path')\"\n\t\tclass=\"files-list__breadcrumbs\"\n\t\t:class=\"{ 'files-list__breadcrumbs--with-progress': wrapUploadProgressBar }\">\n\t\t<!-- Current path sections -->\n\t\t<NcBreadcrumb v-for=\"(section, index) in sections\"\n\t\t\t:key=\"section.dir\"\n\t\t\tv-bind=\"section\"\n\t\t\tdir=\"auto\"\n\t\t\t:to=\"section.to\"\n\t\t\t:force-icon-text=\"index === 0 && filesListWidth >= 486\"\n\t\t\t:title=\"titleForSection(index, section)\"\n\t\t\t:aria-description=\"ariaForSection(section)\"\n\t\t\t@click.native=\"onClick(section.to)\"\n\t\t\t@dragover.native=\"onDragOver($event, section.dir)\"\n\t\t\t@drop=\"onDrop($event, section.dir)\">\n\t\t\t<template v-if=\"index === 0\" #icon>\n\t\t\t\t<NcIconSvgWrapper :size=\"20\"\n\t\t\t\t\t:svg=\"viewIcon\" />\n\t\t\t</template>\n\t\t</NcBreadcrumb>\n\n\t\t<!-- Forward the actions slot -->\n\t\t<template #actions>\n\t\t\t<slot name=\"actions\" />\n\t\t</template>\n\t</NcBreadcrumbs>\n</template>\n\n<script lang=\"ts\">\nimport type { Node } from '@nextcloud/files'\n\nimport { basename } from 'path'\nimport { defineComponent } from 'vue'\nimport { Permission } from '@nextcloud/files'\nimport { translate as t } from '@nextcloud/l10n'\nimport HomeSvg from '@mdi/svg/svg/home.svg?raw'\nimport NcBreadcrumb from '@nextcloud/vue/dist/Components/NcBreadcrumb.js'\nimport NcBreadcrumbs from '@nextcloud/vue/dist/Components/NcBreadcrumbs.js'\nimport NcIconSvgWrapper from '@nextcloud/vue/dist/Components/NcIconSvgWrapper.js'\n\nimport { onDropInternalFiles, dataTransferToFileTree, onDropExternalFiles } from '../services/DropService'\nimport { showError } from '@nextcloud/dialogs'\nimport { useDragAndDropStore } from '../store/dragging.ts'\nimport { useFilesStore } from '../store/files.ts'\nimport { usePathsStore } from '../store/paths.ts'\nimport { useSelectionStore } from '../store/selection.ts'\nimport { useUploaderStore } from '../store/uploader.ts'\nimport filesListWidthMixin from '../mixins/filesListWidth.ts'\nimport logger from '../logger'\n\nexport default defineComponent({\n\tname: 'BreadCrumbs',\n\n\tcomponents: {\n\t\tNcBreadcrumbs,\n\t\tNcBreadcrumb,\n\t\tNcIconSvgWrapper,\n\t},\n\n\tmixins: [\n\t\tfilesListWidthMixin,\n\t],\n\n\tprops: {\n\t\tpath: {\n\t\t\ttype: String,\n\t\t\tdefault: '/',\n\t\t},\n\t},\n\n\tsetup() {\n\t\tconst draggingStore = useDragAndDropStore()\n\t\tconst filesStore = useFilesStore()\n\t\tconst pathsStore = usePathsStore()\n\t\tconst selectionStore = useSelectionStore()\n\t\tconst uploaderStore = useUploaderStore()\n\n\t\treturn {\n\t\t\tdraggingStore,\n\t\t\tfilesStore,\n\t\t\tpathsStore,\n\t\t\tselectionStore,\n\t\t\tuploaderStore,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tcurrentView() {\n\t\t\treturn this.$navigation.active\n\t\t},\n\n\t\tdirs(): string[] {\n\t\t\tconst cumulativePath = (acc: string) => (value: string) => (acc += `${value}/`)\n\t\t\t// Generate a cumulative path for each path segment: ['/', '/foo', '/foo/bar', ...] etc\n\t\t\tconst paths: string[] = this.path.split('/').filter(Boolean).map(cumulativePath('/'))\n\t\t\t// Strip away trailing slash\n\t\t\treturn ['/', ...paths.map((path: string) => path.replace(/^(.+)\\/$/, '$1'))]\n\t\t},\n\n\t\tsections() {\n\t\t\treturn this.dirs.map((dir: string, index: number) => {\n\t\t\t\tconst fileid = this.getFileIdFromPath(dir)\n\t\t\t\tconst to = { ...this.$route, params: { fileid }, query: { dir } }\n\t\t\t\treturn {\n\t\t\t\t\tdir,\n\t\t\t\t\texact: true,\n\t\t\t\t\tname: this.getDirDisplayName(dir),\n\t\t\t\t\tto,\n\t\t\t\t\t// disable drop on current directory\n\t\t\t\t\tdisableDrop: index === this.dirs.length - 1,\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\n\t\tisUploadInProgress(): boolean {\n\t\t\treturn this.uploaderStore.queue.length !== 0\n\t\t},\n\n\t\t// Hide breadcrumbs if an upload is ongoing\n\t\twrapUploadProgressBar(): boolean {\n\t\t\t// if an upload is ongoing, and on small screens / mobile, then\n\t\t\t// show the progress bar for the upload below breadcrumbs\n\t\t\treturn this.isUploadInProgress && this.filesListWidth < 512\n\t\t},\n\n\t\t// used to show the views icon for the first breadcrumb\n\t\tviewIcon(): string {\n\t\t\treturn this.currentView?.icon ?? HomeSvg\n\t\t},\n\n\t\tselectedFiles() {\n\t\t\treturn this.selectionStore.selected\n\t\t},\n\n\t\tdraggingFiles() {\n\t\t\treturn this.draggingStore.dragging\n\t\t},\n\t},\n\n\tmethods: {\n\t\tgetNodeFromId(id: number): Node | undefined {\n\t\t\treturn this.filesStore.getNode(id)\n\t\t},\n\t\tgetFileIdFromPath(path: string): number | undefined {\n\t\t\treturn this.pathsStore.getPath(this.currentView?.id, path)\n\t\t},\n\t\tgetDirDisplayName(path: string): string {\n\t\t\tif (path === '/') {\n\t\t\t\treturn this.$navigation?.active?.name || t('files', 'Home')\n\t\t\t}\n\n\t\t\tconst fileId: number | undefined = this.getFileIdFromPath(path)\n\t\t\tconst node: Node | undefined = (fileId) ? this.getNodeFromId(fileId) : undefined\n\t\t\treturn node?.attributes?.displayName || basename(path)\n\t\t},\n\n\t\tonClick(to) {\n\t\t\tif (to?.query?.dir === this.$route.query.dir) {\n\t\t\t\tthis.$emit('reload')\n\t\t\t}\n\t\t},\n\n\t\tonDragOver(event: DragEvent, path: string) {\n\t\t\t// Cannot drop on the current directory\n\t\t\tif (path === this.dirs[this.dirs.length - 1]) {\n\t\t\t\tevent.dataTransfer.dropEffect = 'none'\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Handle copy/move drag and drop\n\t\t\tif (event.ctrlKey) {\n\t\t\t\tevent.dataTransfer.dropEffect = 'copy'\n\t\t\t} else {\n\t\t\t\tevent.dataTransfer.dropEffect = 'move'\n\t\t\t}\n\t\t},\n\n\t\tasync onDrop(event: DragEvent, path: string) {\n\t\t\t// skip if native drop like text drag and drop from files names\n\t\t\tif (!this.draggingFiles && !event.dataTransfer?.items?.length) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Do not stop propagation, so the main content\n\t\t\t// drop event can be triggered too and clear the\n\t\t\t// dragover state on the DragAndDropNotice component.\n\t\t\tevent.preventDefault()\n\n\t\t\t// Caching the selection\n\t\t\tconst selection = this.draggingFiles\n\t\t\tconst items = [...event.dataTransfer?.items || []] as DataTransferItem[]\n\n\t\t\t// We need to process the dataTransfer ASAP before the\n\t\t\t// browser clears it. This is why we cache the items too.\n\t\t\tconst fileTree = await dataTransferToFileTree(items)\n\n\t\t\t// We might not have the target directory fetched yet\n\t\t\tconst contents = await this.currentView?.getContents(path)\n\t\t\tconst folder = contents?.folder\n\t\t\tif (!folder) {\n\t\t\t\tshowError(this.t('files', 'Target folder does not exist any more'))\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst canDrop = (folder.permissions & Permission.CREATE) !== 0\n\t\t\tconst isCopy = event.ctrlKey\n\n\t\t\t// If another button is pressed, cancel it. This\n\t\t\t// allows cancelling the drag with the right click.\n\t\t\tif (!canDrop || event.button !== 0) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tlogger.debug('Dropped', { event, folder, selection, fileTree })\n\n\t\t\t// Check whether we're uploading files\n\t\t\tif (fileTree.contents.length > 0) {\n\t\t\t\tawait onDropExternalFiles(fileTree, folder, contents.contents)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Else we're moving/copying files\n\t\t\tconst nodes = selection.map(fileid => this.filesStore.getNode(fileid)) as Node[]\n\t\t\tawait onDropInternalFiles(nodes, folder, contents.contents, isCopy)\n\n\t\t\t// Reset selection after we dropped the files\n\t\t\t// if the dropped files are within the selection\n\t\t\tif (selection.some(fileid => this.selectedFiles.includes(fileid))) {\n\t\t\t\tlogger.debug('Dropped selection, resetting select store...')\n\t\t\t\tthis.selectionStore.reset()\n\t\t\t}\n\t\t},\n\n\t\ttitleForSection(index, section) {\n\t\t\tif (section?.to?.query?.dir === this.$route.query.dir) {\n\t\t\t\treturn t('files', 'Reload current directory')\n\t\t\t} else if (index === 0) {\n\t\t\t\treturn t('files', 'Go to the \"{dir}\" directory', section)\n\t\t\t}\n\t\t\treturn null\n\t\t},\n\n\t\tariaForSection(section) {\n\t\t\tif (section?.to?.query?.dir === this.$route.query.dir) {\n\t\t\t\treturn t('files', 'Reload current directory')\n\t\t\t}\n\t\t\treturn null\n\t\t},\n\n\t\tt,\n\t},\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.files-list__breadcrumbs {\n\t// Take as much space as possible\n\tflex: 1 1 100% !important;\n\twidth: 100%;\n\theight: 100%;\n\tmargin-block: 0;\n\tmargin-inline: 10px;\n\n\t:deep() {\n\t\ta {\n\t\t\tcursor: pointer !important;\n\t\t}\n\t}\n\n\t&--with-progress {\n\t\tflex-direction: column !important;\n\t\talign-items: flex-start !important;\n\t}\n}\n</style>\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { defineStore } from 'pinia'\nimport type { ActionsMenuStore } from '../types'\n\nexport const useActionsMenuStore = defineStore('actionsmenu', {\n\tstate: () => ({\n\t\topened: null,\n\t} as ActionsMenuStore),\n})\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { defineStore } from 'pinia'\nimport { subscribe } from '@nextcloud/event-bus'\nimport type { Node } from '@nextcloud/files'\nimport type { RenamingStore } from '../types'\n\nexport const useRenamingStore = function(...args) {\n\tconst store = defineStore('renaming', {\n\t\tstate: () => ({\n\t\t\trenamingNode: undefined,\n\t\t\tnewName: '',\n\t\t} as RenamingStore),\n\t})\n\n\tconst renamingStore = store(...args)\n\n\t// Make sure we only register the listeners once\n\tif (!renamingStore._initialized) {\n\t\tsubscribe('files:node:rename', function(node: Node) {\n\t\t\trenamingStore.renamingNode = node\n\t\t\trenamingStore.newName = node.basename\n\t\t})\n\t\trenamingStore._initialized = true\n\t}\n\n\treturn renamingStore\n}\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<div class=\"files-list-drag-image\">\n\t\t<span class=\"files-list-drag-image__icon\">\n\t\t\t<span ref=\"previewImg\" />\n\t\t\t<FolderIcon v-if=\"isSingleFolder\" />\n\t\t\t<FileMultipleIcon v-else />\n\t\t</span>\n\t\t<span class=\"files-list-drag-image__name\">{{ name }}</span>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport { FileType, Node, formatFileSize } from '@nextcloud/files'\nimport Vue from 'vue'\n\nimport FileMultipleIcon from 'vue-material-design-icons/FileMultiple.vue'\nimport FolderIcon from 'vue-material-design-icons/Folder.vue'\n\nimport { getSummaryFor } from '../utils/fileUtils.ts'\n\nexport default Vue.extend({\n\tname: 'DragAndDropPreview',\n\n\tcomponents: {\n\t\tFileMultipleIcon,\n\t\tFolderIcon,\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tnodes: [] as Node[],\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tisSingleNode() {\n\t\t\treturn this.nodes.length === 1\n\t\t},\n\t\tisSingleFolder() {\n\t\t\treturn this.isSingleNode\n\t\t\t\t&& this.nodes[0].type === FileType.Folder\n\t\t},\n\n\t\tname() {\n\t\t\tif (!this.size) {\n\t\t\t\treturn this.summary\n\t\t\t}\n\t\t\treturn `${this.summary} – ${this.size}`\n\t\t},\n\t\tsize() {\n\t\t\tconst totalSize = this.nodes.reduce((total, node) => total + node.size || 0, 0)\n\t\t\tconst size = parseInt(totalSize, 10) || 0\n\t\t\tif (typeof size !== 'number' || size < 0) {\n\t\t\t\treturn null\n\t\t\t}\n\t\t\treturn formatFileSize(size, true)\n\t\t},\n\t\tsummary(): string {\n\t\t\tif (this.isSingleNode) {\n\t\t\t\tconst node = this.nodes[0]\n\t\t\t\treturn node.attributes?.displayName || node.basename\n\t\t\t}\n\n\t\t\treturn getSummaryFor(this.nodes)\n\t\t},\n\t},\n\n\tmethods: {\n\t\tupdate(nodes: Node[]) {\n\t\t\tthis.nodes = nodes\n\t\t\tthis.$refs.previewImg.replaceChildren()\n\n\t\t\t// Clone icon node from the list\n\t\t\tnodes.slice(0, 3).forEach(node => {\n\t\t\t\tconst preview = document.querySelector(`[data-cy-files-list-row-fileid=\"${node.fileid}\"] .files-list__row-icon img`)\n\t\t\t\tif (preview) {\n\t\t\t\t\tconst previewElmt = this.$refs.previewImg as HTMLElement\n\t\t\t\t\tpreviewElmt.appendChild(preview.parentNode.cloneNode(true))\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.$emit('loaded', this.$el)\n\t\t\t})\n\t\t},\n\t},\n})\n</script>\n\n<style lang=\"scss\">\n$size: 32px;\n$stack-shift: 6px;\n\n.files-list-drag-image {\n\tposition: absolute;\n\ttop: -9999px;\n\tleft: -9999px;\n\tdisplay: flex;\n\toverflow: hidden;\n\talign-items: center;\n\theight: 44px;\n\tpadding: 6px 12px;\n\tbackground: var(--color-main-background);\n\n\t&__icon,\n\t.files-list__row-icon {\n\t\tdisplay: flex;\n\t\toverflow: hidden;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tborder-radius: var(--border-radius);\n\t}\n\n\t&__icon {\n\t\toverflow: visible;\n\t\tmargin-right: 12px;\n\n\t\timg {\n\t\t\tmax-width: 100%;\n\t\t\tmax-height: 100%;\n\t\t}\n\n\t\t.material-design-icon {\n\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t\t&.folder-icon {\n\t\t\t\tcolor: var(--color-primary-element);\n\t\t\t}\n\t\t}\n\n\t\t// Previews container\n\t\t> span {\n\t\t\tdisplay: flex;\n\n\t\t\t// Stack effect if more than one element\n\t\t\t.files-list__row-icon + .files-list__row-icon {\n\t\t\t\tmargin-top: $stack-shift;\n\t\t\t\tmargin-left: $stack-shift - $size;\n\t\t\t\t& + .files-list__row-icon {\n\t\t\t\t\tmargin-top: $stack-shift * 2;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If we have manually clone the preview,\n\t\t\t// let's hide any fallback icons\n\t\t\t&:not(:empty) + * {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t}\n\t}\n\n\t&__name {\n\t\toverflow: hidden;\n\t\twhite-space: nowrap;\n\t\ttext-overflow: ellipsis;\n\t}\n}\n\n</style>\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport type { Node } from '@nextcloud/files'\nimport DragAndDropPreview from '../components/DragAndDropPreview.vue'\nimport Vue from 'vue'\n\nconst Preview = Vue.extend(DragAndDropPreview)\nlet preview: Vue\n\nexport const getDragAndDropPreview = async (nodes: Node[]): Promise<Element> => {\n\treturn new Promise((resolve) => {\n\t\tif (!preview) {\n\t\t\tpreview = new Preview().$mount()\n\t\t\tdocument.body.appendChild(preview.$el)\n\t\t}\n\n\t\tpreview.update(nodes)\n\t\tpreview.$on('loaded', () => {\n\t\t\tresolve(preview.$el)\n\t\t\tpreview.$off('loaded')\n\t\t})\n\t})\n}\n","/**\n * @copyright Copyright (c) 2024 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport type { PropType } from 'vue'\n\nimport { extname } from 'path'\nimport { FileType, Permission, Folder, File as NcFile, NodeStatus, Node, View } from '@nextcloud/files'\nimport { generateUrl } from '@nextcloud/router'\nimport { translate as t } from '@nextcloud/l10n'\nimport { vOnClickOutside } from '@vueuse/components'\nimport Vue, { defineComponent } from 'vue'\n\nimport { action as sidebarAction } from '../actions/sidebarAction.ts'\nimport { getDragAndDropPreview } from '../utils/dragUtils.ts'\nimport { hashCode } from '../utils/hashUtils.ts'\nimport { dataTransferToFileTree, onDropExternalFiles, onDropInternalFiles } from '../services/DropService.ts'\nimport logger from '../logger.js'\nimport { showError } from '@nextcloud/dialogs'\n\nVue.directive('onClickOutside', vOnClickOutside)\n\nexport default defineComponent({\n\tprops: {\n\t\tsource: {\n\t\t\ttype: [Folder, NcFile, Node] as PropType<Node>,\n\t\t\trequired: true,\n\t\t},\n\t\tnodes: {\n\t\t\ttype: Array as PropType<Node[]>,\n\t\t\trequired: true,\n\t\t},\n\t\tfilesListWidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tloading: '',\n\t\t\tdragover: false,\n\t\t\tgridMode: false,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tcurrentView(): View {\n\t\t\treturn this.$navigation.active as View\n\t\t},\n\n\t\tcurrentDir() {\n\t\t\t// Remove any trailing slash but leave root slash\n\t\t\treturn (this.$route?.query?.dir?.toString() || '/').replace(/^(.+)\\/$/, '$1')\n\t\t},\n\t\tcurrentFileId() {\n\t\t\treturn this.$route.params?.fileid || this.$route.query?.fileid || null\n\t\t},\n\n\t\tfileid() {\n\t\t\treturn this.source?.fileid\n\t\t},\n\t\tuniqueId() {\n\t\t\treturn hashCode(this.source.source)\n\t\t},\n\t\tisLoading() {\n\t\t\treturn this.source.status === NodeStatus.LOADING\n\t\t},\n\n\t\textension() {\n\t\t\tif (this.source.attributes?.displayName) {\n\t\t\t\treturn extname(this.source.attributes.displayName)\n\t\t\t}\n\t\t\treturn this.source.extension || ''\n\t\t},\n\t\tdisplayName() {\n\t\t\tconst ext = this.extension\n\t\t\tconst name = String(this.source.attributes.displayName\n\t\t\t\t|| this.source.basename)\n\n\t\t\t// Strip extension from name if defined\n\t\t\treturn !ext ? name : name.slice(0, 0 - ext.length)\n\t\t},\n\n\t\tdraggingFiles() {\n\t\t\treturn this.draggingStore.dragging\n\t\t},\n\t\tselectedFiles() {\n\t\t\treturn this.selectionStore.selected\n\t\t},\n\t\tisSelected() {\n\t\t\treturn this.fileid && this.selectedFiles.includes(this.fileid)\n\t\t},\n\n\t\tisRenaming() {\n\t\t\treturn this.renamingStore.renamingNode === this.source\n\t\t},\n\t\tisRenamingSmallScreen() {\n\t\t\treturn this.isRenaming && this.filesListWidth < 512\n\t\t},\n\n\t\tisActive() {\n\t\t\treturn this.fileid?.toString?.() === this.currentFileId?.toString?.()\n\t\t},\n\n\t\tcanDrag() {\n\t\t\tif (this.isRenaming) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tconst canDrag = (node: Node): boolean => {\n\t\t\t\treturn (node?.permissions & Permission.UPDATE) !== 0\n\t\t\t}\n\n\t\t\t// If we're dragging a selection, we need to check all files\n\t\t\tif (this.selectedFiles.length > 0) {\n\t\t\t\tconst nodes = this.selectedFiles.map(fileid => this.filesStore.getNode(fileid)) as Node[]\n\t\t\t\treturn nodes.every(canDrag)\n\t\t\t}\n\t\t\treturn canDrag(this.source)\n\t\t},\n\n\t\tcanDrop() {\n\t\t\tif (this.source.type !== FileType.Folder) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\t// If the current folder is also being dragged, we can't drop it on itself\n\t\t\tif (this.fileid && this.draggingFiles.includes(this.fileid)) {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\treturn (this.source.permissions & Permission.CREATE) !== 0\n\t\t},\n\n\t\topenedMenu: {\n\t\t\tget() {\n\t\t\t\treturn this.actionsMenuStore.opened === this.uniqueId.toString()\n\t\t\t},\n\t\t\tset(opened) {\n\t\t\t\t// Only reset when opening a new menu\n\t\t\t\tif (opened) {\n\t\t\t\t\t// Reset any right click position override on close\n\t\t\t\t\t// Wait for css animation to be done\n\t\t\t\t\tconst root = this.$el?.closest('main.app-content') as HTMLElement\n\t\t\t\t\troot.style.removeProperty('--mouse-pos-x')\n\t\t\t\t\troot.style.removeProperty('--mouse-pos-y')\n\t\t\t\t}\n\n\t\t\t\tthis.actionsMenuStore.opened = opened ? this.uniqueId.toString() : null\n\t\t\t},\n\t\t},\n\t},\n\n\twatch: {\n\t\t/**\n\t\t * When the source changes, reset the preview\n\t\t * and fetch the new one.\n\t\t */\n\t\tsource(a: Node, b: Node) {\n\t\t\tif (a.source !== b.source) {\n\t\t\t\tthis.resetState()\n\t\t\t}\n\t\t},\n\t},\n\n\tbeforeDestroy() {\n\t\tthis.resetState()\n\t},\n\n\tmethods: {\n\t\tresetState() {\n\t\t\t// Reset loading state\n\t\t\tthis.loading = ''\n\n\t\t\t// Reset the preview state\n\t\t\tthis.$refs?.preview?.reset?.()\n\n\t\t\t// Close menu\n\t\t\tthis.openedMenu = false\n\t\t},\n\n\t\t// Open the actions menu on right click\n\t\tonRightClick(event) {\n\t\t\t// If already opened, fallback to default browser\n\t\t\tif (this.openedMenu) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// The grid mode is compact enough to not care about\n\t\t\t// the actions menu mouse position\n\t\t\tif (!this.gridMode) {\n\t\t\t\t// Actions menu is contained within the app content\n\t\t\t\tconst root = this.$el?.closest('main.app-content') as HTMLElement\n\t\t\t\tconst contentRect = root.getBoundingClientRect()\n\t\t\t\t// Using Math.min/max to prevent the menu from going out of the AppContent\n\t\t\t\t// 200 = max width of the menu\n\t\t\t\troot.style.setProperty('--mouse-pos-x', Math.max(0, event.clientX - contentRect.left - 200) + 'px')\n\t\t\t\troot.style.setProperty('--mouse-pos-y', Math.max(0, event.clientY - contentRect.top) + 'px')\n\t\t\t}\n\n\t\t\t// If the clicked row is in the selection, open global menu\n\t\t\tconst isMoreThanOneSelected = this.selectedFiles.length > 1\n\t\t\tthis.actionsMenuStore.opened = this.isSelected && isMoreThanOneSelected ? 'global' : this.uniqueId.toString()\n\n\t\t\t// Prevent any browser defaults\n\t\t\tevent.preventDefault()\n\t\t\tevent.stopPropagation()\n\t\t},\n\n\t\texecDefaultAction(event) {\n\t\t\tif (event.ctrlKey || event.metaKey) {\n\t\t\t\tevent.preventDefault()\n\t\t\t\twindow.open(generateUrl('/f/{fileId}', { fileId: this.fileid }))\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tthis.$refs.actions.execDefaultAction(event)\n\t\t},\n\n\t\topenDetailsIfAvailable(event) {\n\t\t\tevent.preventDefault()\n\t\t\tevent.stopPropagation()\n\t\t\tif (sidebarAction?.enabled?.([this.source], this.currentView)) {\n\t\t\t\tsidebarAction.exec(this.source, this.currentView, this.currentDir)\n\t\t\t}\n\t\t},\n\n\t\tonDragOver(event: DragEvent) {\n\t\t\tthis.dragover = this.canDrop\n\t\t\tif (!this.canDrop) {\n\t\t\t\tevent.dataTransfer.dropEffect = 'none'\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Handle copy/move drag and drop\n\t\t\tif (event.ctrlKey) {\n\t\t\t\tevent.dataTransfer.dropEffect = 'copy'\n\t\t\t} else {\n\t\t\t\tevent.dataTransfer.dropEffect = 'move'\n\t\t\t}\n\t\t},\n\t\tonDragLeave(event: DragEvent) {\n\t\t\t// Counter bubbling, make sure we're ending the drag\n\t\t\t// only when we're leaving the current element\n\t\t\tconst currentTarget = event.currentTarget as HTMLElement\n\t\t\tif (currentTarget?.contains(event.relatedTarget as HTMLElement)) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tthis.dragover = false\n\t\t},\n\n\t\tasync onDragStart(event: DragEvent) {\n\t\t\tevent.stopPropagation()\n\t\t\tif (!this.canDrag || !this.fileid) {\n\t\t\t\tevent.preventDefault()\n\t\t\t\tevent.stopPropagation()\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tlogger.debug('Drag started', { event })\n\n\t\t\t// Make sure that we're not dragging a file like the preview\n\t\t\tevent.dataTransfer?.clearData?.()\n\n\t\t\t// Reset any renaming\n\t\t\tthis.renamingStore.$reset()\n\n\t\t\t// Dragging set of files, if we're dragging a file\n\t\t\t// that is already selected, we use the entire selection\n\t\t\tif (this.selectedFiles.includes(this.fileid)) {\n\t\t\t\tthis.draggingStore.set(this.selectedFiles)\n\t\t\t} else {\n\t\t\t\tthis.draggingStore.set([this.fileid])\n\t\t\t}\n\n\t\t\tconst nodes = this.draggingStore.dragging\n\t\t\t\t.map(fileid => this.filesStore.getNode(fileid)) as Node[]\n\n\t\t\tconst image = await getDragAndDropPreview(nodes)\n\t\t\tevent.dataTransfer?.setDragImage(image, -10, -10)\n\t\t},\n\t\tonDragEnd() {\n\t\t\tthis.draggingStore.reset()\n\t\t\tthis.dragover = false\n\t\t\tlogger.debug('Drag ended')\n\t\t},\n\n\t\tasync onDrop(event: DragEvent) {\n\t\t\t// skip if native drop like text drag and drop from files names\n\t\t\tif (!this.draggingFiles && !event.dataTransfer?.items?.length) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tevent.preventDefault()\n\t\t\tevent.stopPropagation()\n\n\t\t\t// Caching the selection\n\t\t\tconst selection = this.draggingFiles\n\t\t\tconst items = [...event.dataTransfer?.items || []] as DataTransferItem[]\n\n\t\t\t// We need to process the dataTransfer ASAP before the\n\t\t\t// browser clears it. This is why we cache the items too.\n\t\t\tconst fileTree = await dataTransferToFileTree(items)\n\n\t\t\t// We might not have the target directory fetched yet\n\t\t\tconst contents = await this.currentView?.getContents(this.source.path)\n\t\t\tconst folder = contents?.folder\n\t\t\tif (!folder) {\n\t\t\t\tshowError(this.t('files', 'Target folder does not exist any more'))\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// If another button is pressed, cancel it. This\n\t\t\t// allows cancelling the drag with the right click.\n\t\t\tif (!this.canDrop || event.button) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst isCopy = event.ctrlKey\n\t\t\tthis.dragover = false\n\n\t\t\tlogger.debug('Dropped', { event, folder, selection, fileTree })\n\n\t\t\t// Check whether we're uploading files\n\t\t\tif (fileTree.contents.length > 0) {\n\t\t\t\tawait onDropExternalFiles(fileTree, folder, contents.contents)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Else we're moving/copying files\n\t\t\tconst nodes = selection.map(fileid => this.filesStore.getNode(fileid)) as Node[]\n\t\t\tawait onDropInternalFiles(nodes, folder, contents.contents, isCopy)\n\n\t\t\t// Reset selection after we dropped the files\n\t\t\t// if the dropped files are within the selection\n\t\t\tif (selection.some(fileid => this.selectedFiles.includes(fileid))) {\n\t\t\t\tlogger.debug('Dropped selection, resetting select store...')\n\t\t\t\tthis.selectionStore.reset()\n\t\t\t}\n\t\t},\n\n\t\tt,\n\t},\n})\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<span />\n</template>\n\n<script lang=\"ts\">\n/**\n * This component is used to render custom\n * elements provided by an API. Vue doesn't allow\n * to directly render an HTMLElement, so we can do\n * this magic here.\n */\nexport default {\n\tname: 'CustomElementRender',\n\tprops: {\n\t\tsource: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentView: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\trender: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\twatch: {\n\t\tsource() {\n\t\t\tthis.updateRootElement()\n\t\t},\n\t\tcurrentView() {\n\t\t\tthis.updateRootElement()\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.updateRootElement()\n\t},\n\tmethods: {\n\t\tasync updateRootElement() {\n\t\t\tconst element = await this.render(this.source, this.currentView)\n\t\t\tif (element) {\n\t\t\t\tthis.$el.replaceChildren(element)\n\t\t\t} else {\n\t\t\t\tthis.$el.replaceChildren()\n\t\t\t}\n\t\t},\n\t},\n}\n</script>\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<td class=\"files-list__row-actions\"\n\t\tdata-cy-files-list-row-actions>\n\t\t<!-- Render actions -->\n\t\t<CustomElementRender v-for=\"action in enabledRenderActions\"\n\t\t\t:key=\"action.id\"\n\t\t\t:class=\"'files-list__row-action-' + action.id\"\n\t\t\t:current-view=\"currentView\"\n\t\t\t:render=\"action.renderInline\"\n\t\t\t:source=\"source\"\n\t\t\tclass=\"files-list__row-action--inline\" />\n\n\t\t<!-- Menu actions -->\n\t\t<NcActions ref=\"actionsMenu\"\n\t\t\t:boundaries-element=\"getBoundariesElement\"\n\t\t\t:container=\"getBoundariesElement\"\n\t\t\t:force-name=\"true\"\n\t\t\ttype=\"tertiary\"\n\t\t\t:force-menu=\"enabledInlineActions.length === 0 /* forceMenu only if no inline actions */\"\n\t\t\t:inline=\"enabledInlineActions.length\"\n\t\t\t:open.sync=\"openedMenu\"\n\t\t\t@close=\"openedSubmenu = null\">\n\t\t\t<!-- Default actions list-->\n\t\t\t<NcActionButton v-for=\"action in enabledMenuActions\"\n\t\t\t\t:key=\"action.id\"\n\t\t\t\t:ref=\"`action-${action.id}`\"\n\t\t\t\t:class=\"{\n\t\t\t\t\t[`files-list__row-action-${action.id}`]: true,\n\t\t\t\t\t[`files-list__row-action--menu`]: isMenu(action.id)\n\t\t\t\t}\"\n\t\t\t\t:close-after-click=\"!isMenu(action.id)\"\n\t\t\t\t:data-cy-files-list-row-action=\"action.id\"\n\t\t\t\t:is-menu=\"isMenu(action.id)\"\n\t\t\t\t:title=\"action.title?.([source], currentView)\"\n\t\t\t\t@click=\"onActionClick(action)\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<NcLoadingIcon v-if=\"loading === action.id\" :size=\"18\" />\n\t\t\t\t\t<NcIconSvgWrapper v-else :svg=\"action.iconSvgInline([source], currentView)\" />\n\t\t\t\t</template>\n\t\t\t\t{{ mountType === 'shared' && action.id === 'sharing-status' ? '' : actionDisplayName(action) }}\n\t\t\t</NcActionButton>\n\n\t\t\t<!-- Submenu actions list-->\n\t\t\t<template v-if=\"openedSubmenu && enabledSubmenuActions[openedSubmenu?.id]\">\n\t\t\t\t<!-- Back to top-level button -->\n\t\t\t\t<NcActionButton class=\"files-list__row-action-back\" @click=\"onBackToMenuClick(openedSubmenu)\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<ArrowLeftIcon />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ actionDisplayName(openedSubmenu) }}\n\t\t\t\t</NcActionButton>\n\t\t\t\t<NcActionSeparator />\n\n\t\t\t\t<!-- Submenu actions -->\n\t\t\t\t<NcActionButton v-for=\"action in enabledSubmenuActions[openedSubmenu?.id]\"\n\t\t\t\t\t:key=\"action.id\"\n\t\t\t\t\t:class=\"`files-list__row-action-${action.id}`\"\n\t\t\t\t\tclass=\"files-list__row-action--submenu\"\n\t\t\t\t\tclose-after-click\n\t\t\t\t\t:data-cy-files-list-row-action=\"action.id\"\n\t\t\t\t\t:title=\"action.title?.([source], currentView)\"\n\t\t\t\t\t@click=\"onActionClick(action)\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<NcLoadingIcon v-if=\"loading === action.id\" :size=\"18\" />\n\t\t\t\t\t\t<NcIconSvgWrapper v-else :svg=\"action.iconSvgInline([source], currentView)\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ actionDisplayName(action) }}\n\t\t\t\t</NcActionButton>\n\t\t\t</template>\n\t\t</NcActions>\n\t</td>\n</template>\n\n<script lang=\"ts\">\nimport type { PropType } from 'vue'\n\nimport { DefaultType, FileAction, Node, NodeStatus, View, getFileActions } from '@nextcloud/files'\nimport { showError, showSuccess } from '@nextcloud/dialogs'\nimport { translate as t } from '@nextcloud/l10n'\n\nimport NcActionButton from '@nextcloud/vue/dist/Components/NcActionButton.js'\nimport NcActions from '@nextcloud/vue/dist/Components/NcActions.js'\nimport NcActionSeparator from '@nextcloud/vue/dist/Components/NcActionSeparator.js'\nimport NcIconSvgWrapper from '@nextcloud/vue/dist/Components/NcIconSvgWrapper.js'\nimport NcLoadingIcon from '@nextcloud/vue/dist/Components/NcLoadingIcon.js'\nimport ArrowLeftIcon from 'vue-material-design-icons/ArrowLeft.vue'\nimport Vue, { defineComponent } from 'vue'\n\nimport CustomElementRender from '../CustomElementRender.vue'\nimport logger from '../../logger.js'\n\n// The registered actions list\nconst actions = getFileActions()\n\nexport default defineComponent({\n\tname: 'FileEntryActions',\n\n\tcomponents: {\n\t\tArrowLeftIcon,\n\t\tCustomElementRender,\n\t\tNcActionButton,\n\t\tNcActions,\n\t\tNcActionSeparator,\n\t\tNcIconSvgWrapper,\n\t\tNcLoadingIcon,\n\t},\n\n\tprops: {\n\t\tfilesListWidth: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tloading: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\topened: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tsource: {\n\t\t\ttype: Object as PropType<Node>,\n\t\t\trequired: true,\n\t\t},\n\t\tgridMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\topenedSubmenu: null as FileAction | null,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tcurrentDir() {\n\t\t\t// Remove any trailing slash but leave root slash\n\t\t\treturn (this.$route?.query?.dir?.toString() || '/').replace(/^(.+)\\/$/, '$1')\n\t\t},\n\t\tcurrentView(): View {\n\t\t\treturn this.$navigation.active as View\n\t\t},\n\t\tisLoading() {\n\t\t\treturn this.source.status === NodeStatus.LOADING\n\t\t},\n\n\t\t// Sorted actions that are enabled for this node\n\t\tenabledActions() {\n\t\t\tif (this.source.attributes.failed) {\n\t\t\t\treturn []\n\t\t\t}\n\n\t\t\treturn actions\n\t\t\t\t.filter(action => !action.enabled || action.enabled([this.source], this.currentView))\n\t\t\t\t.sort((a, b) => (a.order || 0) - (b.order || 0))\n\t\t},\n\n\t\t// Enabled action that are displayed inline\n\t\tenabledInlineActions() {\n\t\t\tif (this.filesListWidth < 768 || this.gridMode) {\n\t\t\t\treturn []\n\t\t\t}\n\t\t\treturn this.enabledActions.filter(action => action?.inline?.(this.source, this.currentView))\n\t\t},\n\n\t\t// Enabled action that are displayed inline with a custom render function\n\t\tenabledRenderActions() {\n\t\t\tif (this.gridMode) {\n\t\t\t\treturn []\n\t\t\t}\n\t\t\treturn this.enabledActions.filter(action => typeof action.renderInline === 'function')\n\t\t},\n\n\t\t// Default actions\n\t\tenabledDefaultActions() {\n\t\t\treturn this.enabledActions.filter(action => !!action?.default)\n\t\t},\n\n\t\t// Actions shown in the menu\n\t\tenabledMenuActions() {\n\t\t\t// If we're in a submenu, only render the inline\n\t\t\t// actions before the filtered submenu\n\t\t\tif (this.openedSubmenu) {\n\t\t\t\treturn this.enabledInlineActions\n\t\t\t}\n\n\t\t\tconst actions = [\n\t\t\t\t// Showing inline first for the NcActions inline prop\n\t\t\t\t...this.enabledInlineActions,\n\t\t\t\t// Then the rest\n\t\t\t\t...this.enabledActions.filter(action => action.default !== DefaultType.HIDDEN && typeof action.renderInline !== 'function'),\n\t\t\t].filter((value, index, self) => {\n\t\t\t\t// Then we filter duplicates to prevent inline actions to be shown twice\n\t\t\t\treturn index === self.findIndex(action => action.id === value.id)\n\t\t\t})\n\n\t\t\t// Generate list of all top-level actions ids\n\t\t\tconst topActionsIds = actions.filter(action => !action.parent).map(action => action.id) as string[]\n\n\t\t\t// Filter actions that are not top-level AND have a valid parent\n\t\t\treturn actions.filter(action => !(action.parent && topActionsIds.includes(action.parent)))\n\t\t},\n\n\t\tenabledSubmenuActions() {\n\t\t\treturn this.enabledActions\n\t\t\t\t.filter(action => action.parent)\n\t\t\t\t.reduce((arr, action) => {\n\t\t\t\t\tif (!arr[action.parent]) {\n\t\t\t\t\t\tarr[action.parent] = []\n\t\t\t\t\t}\n\t\t\t\t\tarr[action.parent].push(action)\n\t\t\t\t\treturn arr\n\t\t\t\t}, {} as Record<string, FileAction>)\n\t\t},\n\n\t\topenedMenu: {\n\t\t\tget() {\n\t\t\t\treturn this.opened\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tthis.$emit('update:opened', value)\n\t\t\t},\n\t\t},\n\n\t\t/**\n\t\t * Making this a function in case the files-list\n\t\t * reference changes in the future. That way we're\n\t\t * sure there is one at the time we call it.\n\t\t */\n\t\tgetBoundariesElement() {\n\t\t\treturn document.querySelector('.app-content > .files-list')\n\t\t},\n\n\t\tmountType() {\n\t\t\treturn this.source._attributes['mount-type']\n\t\t},\n\t},\n\n\tmethods: {\n\t\tactionDisplayName(action: FileAction) {\n\t\t\tif ((this.gridMode || (this.filesListWidth < 768 && action.inline)) && typeof action.title === 'function') {\n\t\t\t\t// if an inline action is rendered in the menu for\n\t\t\t\t// lack of space we use the title first if defined\n\t\t\t\tconst title = action.title([this.source], this.currentView)\n\t\t\t\tif (title) return title\n\t\t\t}\n\t\t\treturn action.displayName([this.source], this.currentView)\n\t\t},\n\n\t\tasync onActionClick(action, isSubmenu = false) {\n\t\t\t// Skip click on loading\n\t\t\tif (this.isLoading || this.loading !== '') {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// If the action is a submenu, we open it\n\t\t\tif (this.enabledSubmenuActions[action.id]) {\n\t\t\t\tthis.openedSubmenu = action\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst displayName = action.displayName([this.source], this.currentView)\n\t\t\ttry {\n\t\t\t\t// Set the loading marker\n\t\t\t\tthis.$emit('update:loading', action.id)\n\t\t\t\tVue.set(this.source, 'status', NodeStatus.LOADING)\n\n\t\t\t\tconst success = await action.exec(this.source, this.currentView, this.currentDir)\n\n\t\t\t\t// If the action returns null, we stay silent\n\t\t\t\tif (success === null || success === undefined) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tif (success) {\n\t\t\t\t\tshowSuccess(t('files', '\"{displayName}\" action executed successfully', { displayName }))\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tshowError(t('files', '\"{displayName}\" action failed', { displayName }))\n\t\t\t} catch (e) {\n\t\t\t\tlogger.error('Error while executing action', { action, e })\n\t\t\t\tshowError(t('files', '\"{displayName}\" action failed', { displayName }))\n\t\t\t} finally {\n\t\t\t\t// Reset the loading marker\n\t\t\t\tthis.$emit('update:loading', '')\n\t\t\t\tVue.set(this.source, 'status', undefined)\n\n\t\t\t\t// If that was a submenu, we just go back after the action\n\t\t\t\tif (isSubmenu) {\n\t\t\t\t\tthis.openedSubmenu = null\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\texecDefaultAction(event) {\n\t\t\tif (this.enabledDefaultActions.length > 0) {\n\t\t\t\tevent.preventDefault()\n\t\t\t\tevent.stopPropagation()\n\t\t\t\t// Execute the first default action if any\n\t\t\t\tthis.enabledDefaultActions[0].exec(this.source, this.currentView, this.currentDir)\n\t\t\t}\n\t\t},\n\n\t\tisMenu(id: string) {\n\t\t\treturn this.enabledSubmenuActions[id]?.length > 0\n\t\t},\n\n\t\tasync onBackToMenuClick(action: FileAction) {\n\t\t\tthis.openedSubmenu = null\n\t\t\t// Wait for first render\n\t\t\tawait this.$nextTick()\n\n\t\t\t// Focus the previous menu action button\n\t\t\tthis.$nextTick(() => {\n\t\t\t\t// Focus the action button\n\t\t\t\tconst menuAction = this.$refs[`action-${action.id}`]?.[0]\n\t\t\t\tif (menuAction) {\n\t\t\t\t\tmenuAction.$el.querySelector('button')?.focus()\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\n\t\tt,\n\t},\n})\n</script>\n\n<style lang=\"scss\">\n// Allow right click to define the position of the menu\n// only if defined\nmain.app-content[style*=\"mouse-pos-x\"] .v-popper__popper {\n\ttransform: translate3d(var(--mouse-pos-x), var(--mouse-pos-y), 0px) !important;\n\n\t// If the menu is too close to the bottom, we move it up\n\t&[data-popper-placement=\"top\"] {\n\t\t// 34px added to align with the top of the cursor\n\t\ttransform: translate3d(var(--mouse-pos-x), calc(var(--mouse-pos-y) - 50vh + 34px), 0px) !important;\n\t}\n\t// Hide arrow if floating\n\t.v-popper__arrow-container {\n\t\tdisplay: none;\n\t}\n}\n</style>\n\n<style lang=\"scss\" scoped>\n:deep(.button-vue--icon-and-text, .files-list__row-action-sharing-status) {\n\t.button-vue__text {\n\t\tcolor: var(--color-primary-element);\n\t}\n\t.button-vue__icon {\n\t\tcolor: var(--color-primary-element);\n\t}\n}\n</style>\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { defineStore } from 'pinia'\nimport Vue from 'vue'\n\n/**\n * Observe various events and save the current\n * special keys states. Useful for checking the\n * current status of a key when executing a method.\n */\nexport const useKeyboardStore = function(...args) {\n\tconst store = defineStore('keyboard', {\n\t\tstate: () => ({\n\t\t\taltKey: false,\n\t\t\tctrlKey: false,\n\t\t\tmetaKey: false,\n\t\t\tshiftKey: false,\n\t\t}),\n\n\t\tactions: {\n\t\t\tonEvent(event: MouseEvent | KeyboardEvent) {\n\t\t\t\tif (!event) {\n\t\t\t\t\tevent = window.event as MouseEvent | KeyboardEvent\n\t\t\t\t}\n\t\t\t\tVue.set(this, 'altKey', !!event.altKey)\n\t\t\t\tVue.set(this, 'ctrlKey', !!event.ctrlKey)\n\t\t\t\tVue.set(this, 'metaKey', !!event.metaKey)\n\t\t\t\tVue.set(this, 'shiftKey', !!event.shiftKey)\n\t\t\t},\n\t\t},\n\t})\n\n\tconst keyboardStore = store(...args)\n\t// Make sure we only register the listeners once\n\tif (!keyboardStore._initialized) {\n\t\twindow.addEventListener('keydown', keyboardStore.onEvent)\n\t\twindow.addEventListener('keyup', keyboardStore.onEvent)\n\t\twindow.addEventListener('mousemove', keyboardStore.onEvent)\n\n\t\tkeyboardStore._initialized = true\n\t}\n\n\treturn keyboardStore\n}\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<td class=\"files-list__row-checkbox\"\n\t\t@keyup.esc.exact=\"resetSelection\">\n\t\t<NcLoadingIcon v-if=\"isLoading\" />\n\t\t<NcCheckboxRadioSwitch v-else\n\t\t\t:aria-label=\"ariaLabel\"\n\t\t\t:checked=\"isSelected\"\n\t\t\t@update:checked=\"onSelectionChange\" />\n\t</td>\n</template>\n\n<script lang=\"ts\">\nimport { Node, FileType } from '@nextcloud/files'\nimport { translate as t } from '@nextcloud/l10n'\nimport { type PropType, defineComponent } from 'vue'\n\nimport NcCheckboxRadioSwitch from '@nextcloud/vue/dist/Components/NcCheckboxRadioSwitch.js'\nimport NcLoadingIcon from '@nextcloud/vue/dist/Components/NcLoadingIcon.js'\n\nimport { useKeyboardStore } from '../../store/keyboard.ts'\nimport { useSelectionStore } from '../../store/selection.ts'\nimport logger from '../../logger.js'\n\nexport default defineComponent({\n\tname: 'FileEntryCheckbox',\n\n\tcomponents: {\n\t\tNcCheckboxRadioSwitch,\n\t\tNcLoadingIcon,\n\t},\n\n\tprops: {\n\t\tfileid: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tnodes: {\n\t\t\ttype: Array as PropType<Node[]>,\n\t\t\trequired: true,\n\t\t},\n\t\tsource: {\n\t\t\ttype: Object as PropType<Node>,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tsetup() {\n\t\tconst selectionStore = useSelectionStore()\n\t\tconst keyboardStore = useKeyboardStore()\n\t\treturn {\n\t\t\tkeyboardStore,\n\t\t\tselectionStore,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tselectedFiles() {\n\t\t\treturn this.selectionStore.selected\n\t\t},\n\t\tisSelected() {\n\t\t\treturn this.selectedFiles.includes(this.fileid)\n\t\t},\n\t\tindex() {\n\t\t\treturn this.nodes.findIndex((node: Node) => node.fileid === this.fileid)\n\t\t},\n\t\tisFile() {\n\t\t\treturn this.source.type === FileType.File\n\t\t},\n\t\tariaLabel() {\n\t\t\treturn this.isFile\n\t\t\t\t? t('files', 'Toggle selection for file \"{displayName}\"', { displayName: this.source.basename })\n\t\t\t\t: t('files', 'Toggle selection for folder \"{displayName}\"', { displayName: this.source.basename })\n\t\t},\n\t},\n\n\tmethods: {\n\t\tonSelectionChange(selected: boolean) {\n\t\t\tconst newSelectedIndex = this.index\n\t\t\tconst lastSelectedIndex = this.selectionStore.lastSelectedIndex\n\n\t\t\t// Get the last selected and select all files in between\n\t\t\tif (this.keyboardStore?.shiftKey && lastSelectedIndex !== null) {\n\t\t\t\tconst isAlreadySelected = this.selectedFiles.includes(this.fileid)\n\n\t\t\t\tconst start = Math.min(newSelectedIndex, lastSelectedIndex)\n\t\t\t\tconst end = Math.max(lastSelectedIndex, newSelectedIndex)\n\n\t\t\t\tconst lastSelection = this.selectionStore.lastSelection\n\t\t\t\tconst filesToSelect = this.nodes\n\t\t\t\t\t.map(file => file.fileid)\n\t\t\t\t\t.slice(start, end + 1)\n\t\t\t\t\t.filter(Boolean) as number[]\n\n\t\t\t\t// If already selected, update the new selection _without_ the current file\n\t\t\t\tconst selection = [...lastSelection, ...filesToSelect]\n\t\t\t\t\t.filter(fileid => !isAlreadySelected || fileid !== this.fileid)\n\n\t\t\t\tlogger.debug('Shift key pressed, selecting all files in between', { start, end, filesToSelect, isAlreadySelected })\n\t\t\t\t// Keep previous lastSelectedIndex to be use for further shift selections\n\t\t\t\tthis.selectionStore.set(selection)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst selection = selected\n\t\t\t\t? [...this.selectedFiles, this.fileid]\n\t\t\t\t: this.selectedFiles.filter(fileid => fileid !== this.fileid)\n\n\t\t\tlogger.debug('Updating selection', { selection })\n\t\t\tthis.selectionStore.set(selection)\n\t\t\tthis.selectionStore.setLastIndex(newSelectedIndex)\n\t\t},\n\n\t\tresetSelection() {\n\t\t\tthis.selectionStore.reset()\n\t\t},\n\n\t\tt,\n\t},\n})\n</script>\n","<!--\n\t- @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n\t-\n\t- @author John Molakvoæ <skjnldsv@protonmail.com>\n\t-\n\t- @license GNU AGPL version 3 or any later version\n\t-\n\t- This program is free software: you can redistribute it and/or modify\n\t- it under the terms of the GNU Affero General Public License as\n\t- published by the Free Software Foundation, either version 3 of the\n\t- License, or (at your option) any later version.\n\t-\n\t- This program is distributed in the hope that it will be useful,\n\t- but WITHOUT ANY WARRANTY; without even the implied warranty of\n\t- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n\t- GNU Affero General Public License for more details.\n\t-\n\t- You should have received a copy of the GNU Affero General Public License\n\t- along with this program. If not, see <http://www.gnu.org/licenses/>.\n\t-\n\t-->\n<template>\n\t<!-- Rename input -->\n\t<form v-if=\"isRenaming\"\n\t\tv-on-click-outside=\"onRename\"\n\t\t:aria-label=\"t('files', 'Rename file')\"\n\t\tclass=\"files-list__row-rename\"\n\t\t@submit.prevent.stop=\"onRename\">\n\t\t<NcTextField ref=\"renameInput\"\n\t\t\t:label=\"renameLabel\"\n\t\t\t:autofocus=\"true\"\n\t\t\t:minlength=\"1\"\n\t\t\t:required=\"true\"\n\t\t\t:value.sync=\"newName\"\n\t\t\tenterkeyhint=\"done\"\n\t\t\t@keyup=\"checkInputValidity\"\n\t\t\t@keyup.esc=\"stopRenaming\" />\n\t</form>\n\n\t<component :is=\"linkTo.is\"\n\t\tv-else\n\t\tref=\"basename\"\n\t\t:aria-hidden=\"isRenaming\"\n\t\tclass=\"files-list__row-name-link\"\n\t\tdata-cy-files-list-row-name-link\n\t\tv-bind=\"linkTo.params\"\n\t\t@click=\"$emit('click', $event)\">\n\t\t<!-- File name -->\n\t\t<span class=\"files-list__row-name-text\">\n\t\t\t<!-- Keep the displayName stuck to the extension to avoid whitespace rendering issues-->\n\t\t\t<span class=\"files-list__row-name-\" v-text=\"displayName\" />\n\t\t\t<span class=\"files-list__row-name-ext\" v-text=\"extension\" />\n\t\t</span>\n\t</component>\n</template>\n\n<script lang=\"ts\">\nimport type { Node, View } from '@nextcloud/files'\nimport type { PropType } from 'vue'\n\nimport { showError, showSuccess } from '@nextcloud/dialogs'\nimport { emit } from '@nextcloud/event-bus'\nimport { FileType, NodeStatus, Permission } from '@nextcloud/files'\nimport { loadState } from '@nextcloud/initial-state'\nimport { translate as t } from '@nextcloud/l10n'\nimport axios from '@nextcloud/axios'\nimport { isAxiosError } from 'axios'\nimport Vue, { defineComponent } from 'vue'\n\nimport NcTextField from '@nextcloud/vue/dist/Components/NcTextField.js'\n\nimport { useRenamingStore } from '../../store/renaming.ts'\nimport logger from '../../logger.js'\n\nconst forbiddenCharacters = loadState<string[]>('files', 'forbiddenCharacters', [])\n\nexport default defineComponent({\n\tname: 'FileEntryName',\n\n\tcomponents: {\n\t\tNcTextField,\n\t},\n\n\tprops: {\n\t\tdisplayName: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\textension: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tfilesListWidth: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tnodes: {\n\t\t\ttype: Array as PropType<Node[]>,\n\t\t\trequired: true,\n\t\t},\n\t\tsource: {\n\t\t\ttype: Object as PropType<Node>,\n\t\t\trequired: true,\n\t\t},\n\t\tgridMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tsetup() {\n\t\tconst renamingStore = useRenamingStore()\n\t\treturn {\n\t\t\trenamingStore,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tcurrentView(): View {\n\t\t\treturn this.$navigation.active as View\n\t\t},\n\n\t\tisRenaming() {\n\t\t\treturn this.renamingStore.renamingNode === this.source\n\t\t},\n\t\tisRenamingSmallScreen() {\n\t\t\treturn this.isRenaming && this.filesListWidth < 512\n\t\t},\n\t\tnewName: {\n\t\t\tget() {\n\t\t\t\treturn this.renamingStore.newName\n\t\t\t},\n\t\t\tset(newName) {\n\t\t\t\tthis.renamingStore.newName = newName\n\t\t\t},\n\t\t},\n\n\t\trenameLabel() {\n\t\t\tconst matchLabel: Record<FileType, string> = {\n\t\t\t\t[FileType.File]: t('files', 'File name'),\n\t\t\t\t[FileType.Folder]: t('files', 'Folder name'),\n\t\t\t}\n\t\t\treturn matchLabel[this.source.type]\n\t\t},\n\n\t\tlinkTo() {\n\t\t\tif (this.source.attributes.failed) {\n\t\t\t\treturn {\n\t\t\t\t\tis: 'span',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\ttitle: t('files', 'This node is unavailable'),\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst enabledDefaultActions = this.$parent?.$refs?.actions?.enabledDefaultActions\n\t\t\tif (enabledDefaultActions?.length > 0) {\n\t\t\t\tconst action = enabledDefaultActions[0]\n\t\t\t\tconst displayName = action.displayName([this.source], this.currentView)\n\t\t\t\treturn {\n\t\t\t\t\tis: 'a',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\ttitle: displayName,\n\t\t\t\t\t\trole: 'button',\n\t\t\t\t\t\ttabindex: '0',\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.source?.permissions & Permission.READ) {\n\t\t\t\treturn {\n\t\t\t\t\tis: 'a',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tdownload: this.source.basename,\n\t\t\t\t\t\thref: this.source.source,\n\t\t\t\t\t\ttitle: t('files', 'Download file {name}', { name: this.displayName }),\n\t\t\t\t\t\ttabindex: '0',\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tis: 'span',\n\t\t\t}\n\t\t},\n\t},\n\n\twatch: {\n\t\t/**\n\t\t * If renaming starts, select the file name\n\t\t * in the input, without the extension.\n\t\t * @param renaming\n\t\t */\n\t\tisRenaming: {\n\t\t\timmediate: true,\n\t\t\thandler(renaming: boolean) {\n\t\t\t\tif (renaming) {\n\t\t\t\t\tthis.startRenaming()\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * Check if the file name is valid and update the\n\t\t * input validity using browser's native validation.\n\t\t * @param event the keyup event\n\t\t */\n\t\tcheckInputValidity(event: KeyboardEvent) {\n\t\t\tconst input = event.target as HTMLInputElement\n\t\t\tconst newName = this.newName.trim?.() || ''\n\t\t\tlogger.debug('Checking input validity', { newName })\n\t\t\ttry {\n\t\t\t\tthis.isFileNameValid(newName)\n\t\t\t\tinput.setCustomValidity('')\n\t\t\t\tinput.title = ''\n\t\t\t} catch (e) {\n\t\t\t\tif (e instanceof Error) {\n\t\t\t\t\tinput.setCustomValidity(e.message)\n\t\t\t\t\tinput.title = e.message\n\t\t\t\t} else {\n\t\t\t\t\tinput.setCustomValidity(t('files', 'Invalid file name'))\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tinput.reportValidity()\n\t\t\t}\n\t\t},\n\n\t\tisFileNameValid(name: string) {\n\t\t\tconst trimmedName = name.trim()\n\t\t\tif (trimmedName === '.' || trimmedName === '..') {\n\t\t\t\tthrow new Error(t('files', '\"{name}\" is an invalid file name.', { name }))\n\t\t\t} else if (trimmedName.length === 0) {\n\t\t\t\tthrow new Error(t('files', 'File name cannot be empty.'))\n\t\t\t} else if (trimmedName.indexOf('/') !== -1) {\n\t\t\t\tthrow new Error(t('files', '\"/\" is not allowed inside a file name.'))\n\t\t\t} else if (trimmedName.match(window.OC.config.blacklist_files_regex)) {\n\t\t\t\tthrow new Error(t('files', '\"{name}\" is not an allowed filetype.', { name }))\n\t\t\t} else if (this.checkIfNodeExists(name)) {\n\t\t\t\tthrow new Error(t('files', '{newName} already exists.', { newName: name }))\n\t\t\t}\n\n\t\t\tconst char = forbiddenCharacters.find((char) => trimmedName.includes(char))\n\t\t\tif (char) {\n\t\t\t\tthrow new Error(t('files', '\"{char}\" is not allowed inside a file name.', { char }))\n\t\t\t}\n\n\t\t\treturn true\n\t\t},\n\n\t\tcheckIfNodeExists(name: string) {\n\t\t\treturn this.nodes.find(node => node.basename === name && node !== this.source)\n\t\t},\n\n\t\tstartRenaming() {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\t// Using split to get the true string length\n\t\t\t\tconst extLength = (this.source.extension || '').split('').length\n\t\t\t\tconst length = this.source.basename.split('').length - extLength\n\t\t\t\tconst input = this.$refs.renameInput?.$refs?.inputField?.$refs?.input\n\t\t\t\tif (!input) {\n\t\t\t\t\tlogger.error('Could not find the rename input')\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tinput.setSelectionRange(0, length)\n\t\t\t\tinput.focus()\n\n\t\t\t\t// Trigger a keyup event to update the input validity\n\t\t\t\tinput.dispatchEvent(new Event('keyup'))\n\t\t\t})\n\t\t},\n\t\tstopRenaming() {\n\t\t\tif (!this.isRenaming) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Reset the renaming store\n\t\t\tthis.renamingStore.$reset()\n\t\t},\n\n\t\t// Rename and move the file\n\t\tasync onRename() {\n\t\t\tconst oldName = this.source.basename\n\t\t\tconst oldEncodedSource = this.source.encodedSource\n\t\t\tconst newName = this.newName.trim?.() || ''\n\t\t\tif (newName === '') {\n\t\t\t\tshowError(t('files', 'Name cannot be empty'))\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (oldName === newName) {\n\t\t\t\tthis.stopRenaming()\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Checking if already exists\n\t\t\tif (this.checkIfNodeExists(newName)) {\n\t\t\t\tshowError(t('files', 'Another entry with the same name already exists'))\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Set loading state\n\t\t\tVue.set(this.source, 'status', NodeStatus.LOADING)\n\n\t\t\t// Update node\n\t\t\tthis.source.rename(newName)\n\n\t\t\tlogger.debug('Moving file to', { destination: this.source.encodedSource, oldEncodedSource })\n\t\t\ttry {\n\t\t\t\tawait axios({\n\t\t\t\t\tmethod: 'MOVE',\n\t\t\t\t\turl: oldEncodedSource,\n\t\t\t\t\theaders: {\n\t\t\t\t\t\tDestination: this.source.encodedSource,\n\t\t\t\t\t\tOverwrite: 'F',\n\t\t\t\t\t},\n\t\t\t\t})\n\n\t\t\t\t// Success 🎉\n\t\t\t\temit('files:node:updated', this.source)\n\t\t\t\temit('files:node:renamed', this.source)\n\t\t\t\tshowSuccess(t('files', 'Renamed \"{oldName}\" to \"{newName}\"', { oldName, newName }))\n\n\t\t\t\t// Reset the renaming store\n\t\t\t\tthis.stopRenaming()\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.$refs.basename?.focus()\n\t\t\t\t})\n\t\t\t} catch (error) {\n\t\t\t\tlogger.error('Error while renaming file', { error })\n\t\t\t\tthis.source.rename(oldName)\n\t\t\t\tthis.$refs.renameInput?.focus()\n\n\t\t\t\tif (isAxiosError(error)) {\n\t\t\t\t\t// TODO: 409 means current folder does not exist, redirect ?\n\t\t\t\t\tif (error?.response?.status === 404) {\n\t\t\t\t\t\tshowError(t('files', 'Could not rename \"{oldName}\", it does not exist any more', { oldName }))\n\t\t\t\t\t\treturn\n\t\t\t\t\t} else if (error?.response?.status === 412) {\n\t\t\t\t\t\tshowError(t('files', 'The name \"{newName}\" is already used in the folder \"{dir}\". Please choose a different name.', { newName, dir: this.currentDir }))\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Unknown error\n\t\t\t\tshowError(t('files', 'Could not rename \"{oldName}\"', { oldName }))\n\t\t\t} finally {\n\t\t\t\tVue.set(this.source, 'status', undefined)\n\t\t\t}\n\t\t},\n\n\t\tt,\n\t},\n})\n</script>\n","<template>\n\t<span :aria-hidden=\"!title\"\n\t\t:aria-label=\"title\"\n\t\tclass=\"material-design-icon collectives-icon\"\n\t\trole=\"img\"\n\t\tv-bind=\"$attrs\"\n\t\t@click=\"$emit('click', $event)\">\n\t\t<svg :fill=\"fillColor\"\n\t\t\tclass=\"material-design-icon__svg\"\n\t\t\t:width=\"size\"\n\t\t\t:height=\"size\"\n\t\t\tviewBox=\"0 0 16 16\">\n\t\t\t<path d=\"M2.9,8.8c0-1.2,0.4-2.4,1.2-3.3L0.3,6c-0.2,0-0.3,0.3-0.1,0.4l2.7,2.6C2.9,9,2.9,8.9,2.9,8.8z\" />\n\t\t\t<path d=\"M8,3.7c0.7,0,1.3,0.1,1.9,0.4L8.2,0.6c-0.1-0.2-0.3-0.2-0.4,0L6.1,4C6.7,3.8,7.3,3.7,8,3.7z\" />\n\t\t\t<path d=\"M3.7,11.5L3,15.2c0,0.2,0.2,0.4,0.4,0.3l3.3-1.7C5.4,13.4,4.4,12.6,3.7,11.5z\" />\n\t\t\t<path d=\"M15.7,6l-3.7-0.5c0.7,0.9,1.2,2,1.2,3.3c0,0.1,0,0.2,0,0.3l2.7-2.6C15.9,6.3,15.9,6.1,15.7,6z\" />\n\t\t\t<path d=\"M12.3,11.5c-0.7,1.1-1.8,1.9-3,2.2l3.3,1.7c0.2,0.1,0.4-0.1,0.4-0.3L12.3,11.5z\" />\n\t\t\t<path d=\"M9.6,10.1c-0.4,0.5-1,0.8-1.6,0.8c-1.1,0-2-0.9-2.1-2C5.9,7.7,6.8,6.7,8,6.7c0.6,0,1.1,0.3,1.5,0.7 c0.1,0.1,0.1,0.1,0.2,0.1h1.4c0.2,0,0.4-0.2,0.3-0.5c-0.7-1.3-2.1-2.2-3.8-2.1C5.8,5,4.3,6.6,4.1,8.5C4,10.8,5.8,12.7,8,12.7 c1.6,0,2.9-0.9,3.5-2.3c0.1-0.2-0.1-0.4-0.3-0.4H9.9C9.8,10,9.7,10,9.6,10.1z\" />\n\t\t</svg>\n\t</span>\n</template>\n\n<script>\nexport default {\n\tname: 'CollectivesIcon',\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tfillColor: {\n\t\t\ttype: String,\n\t\t\tdefault: 'currentColor',\n\t\t},\n\t\tsize: {\n\t\t\ttype: Number,\n\t\t\tdefault: 24,\n\t\t},\n\t},\n}\n</script>\n","<!--\n  - @copyright Copyright (c) 2023 Ferdinand Thiessen <opensource@fthiessen.de>\n  -\n  - @author Ferdinand Thiessen <opensource@fthiessen.de>\n  -\n  - @license AGPL-3.0-or-later\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<NcIconSvgWrapper class=\"favorite-marker-icon\" :name=\"t('files', 'Favorite')\" :svg=\"StarSvg\" />\n</template>\n\n<script lang=\"ts\">\nimport { translate as t } from '@nextcloud/l10n'\nimport { defineComponent } from 'vue'\n\nimport StarSvg from '@mdi/svg/svg/star.svg?raw'\nimport NcIconSvgWrapper from '@nextcloud/vue/dist/Components/NcIconSvgWrapper.js'\n\n/**\n * A favorite icon to be used for overlaying favorite entries like the file preview / icon\n * It has a stroke around the star icon to ensure enough contrast for accessibility.\n *\n * If the background has a hover state you might want to also apply it to the stroke like this:\n * ```scss\n * .parent:hover :deep(.favorite-marker-icon svg path) {\n *      stroke: var(--color-background-hover);\n * }\n * ```\n */\nexport default defineComponent({\n\tname: 'FavoriteIcon',\n\tcomponents: {\n\t\tNcIconSvgWrapper,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tStarSvg,\n\t\t}\n\t},\n\tasync mounted() {\n\t\tawait this.$nextTick()\n\t\t// MDI default viewBox is \"0 0 24 24\" but we add a stroke of 10px so we must adjust it\n\t\tconst el = this.$el.querySelector('svg')\n\t\tel?.setAttribute?.('viewBox', '-4 -4 30 30')\n\t},\n\tmethods: {\n\t\tt,\n\t},\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.favorite-marker-icon {\n\tcolor: var(--color-favorite);\n\t// Override NcIconSvgWrapper defaults (clickable area)\n\tmin-width: unset !important;\n    min-height: unset !important;\n\n\t:deep() {\n\t\tsvg {\n\t\t\t// We added a stroke for a11y so we must increase the size to include the stroke\n\t\t\twidth: 26px !important;\n\t\t\theight: 26px !important;\n\n\t\t\t// Override NcIconSvgWrapper defaults of 20px\n\t\t\tmax-width: unset !important;\n\t\t\tmax-height: unset !important;\n\n\t\t\t// Sow a border around the icon for better contrast\n\t\t\tpath {\n\t\t\t\tstroke: var(--color-main-background);\n\t\t\t\tstroke-width: 8px;\n\t\t\t\tstroke-linejoin: round;\n\t\t\t\tpaint-order: stroke;\n\t\t\t}\n\t\t}\n\t}\n}\n</style>\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<span class=\"files-list__row-icon\">\n\t\t<template v-if=\"source.type === 'folder'\">\n\t\t\t<FolderOpenIcon v-if=\"dragover\" v-once />\n\t\t\t<template v-else>\n\t\t\t\t<FolderIcon v-once />\n\t\t\t\t<OverlayIcon :is=\"folderOverlay\"\n\t\t\t\t\tv-if=\"folderOverlay\"\n\t\t\t\t\tclass=\"files-list__row-icon-overlay\" />\n\t\t\t</template>\n\t\t</template>\n\n\t\t<!-- Decorative image, should not be aria documented -->\n\t\t<img v-else-if=\"previewUrl && backgroundFailed !== true\"\n\t\t\tref=\"previewImg\"\n\t\t\talt=\"\"\n\t\t\tclass=\"files-list__row-icon-preview\"\n\t\t\t:class=\"{'files-list__row-icon-preview--loaded': backgroundFailed === false}\"\n\t\t\tloading=\"lazy\"\n\t\t\t:src=\"previewUrl\"\n\t\t\t@error=\"onBackgroundError\"\n\t\t\t@load=\"backgroundFailed = false\">\n\n\t\t<FileIcon v-else v-once />\n\n\t\t<!-- Favorite icon -->\n\t\t<span v-if=\"isFavorite\" class=\"files-list__row-icon-favorite\">\n\t\t\t<FavoriteIcon v-once />\n\t\t</span>\n\n\t\t<OverlayIcon :is=\"fileOverlay\"\n\t\t\tv-if=\"fileOverlay\"\n\t\t\tclass=\"files-list__row-icon-overlay files-list__row-icon-overlay--file\" />\n\t</span>\n</template>\n\n<script lang=\"ts\">\nimport type { PropType } from 'vue'\nimport type { UserConfig } from '../../types.ts'\n\nimport { Node, FileType } from '@nextcloud/files'\nimport { generateUrl } from '@nextcloud/router'\nimport { translate as t } from '@nextcloud/l10n'\nimport { Type as ShareType } from '@nextcloud/sharing'\n\nimport Vue from 'vue'\nimport AccountGroupIcon from 'vue-material-design-icons/AccountGroup.vue'\nimport AccountPlusIcon from 'vue-material-design-icons/AccountPlus.vue'\nimport FileIcon from 'vue-material-design-icons/File.vue'\nimport FolderIcon from 'vue-material-design-icons/Folder.vue'\nimport FolderOpenIcon from 'vue-material-design-icons/FolderOpen.vue'\nimport KeyIcon from 'vue-material-design-icons/Key.vue'\nimport LinkIcon from 'vue-material-design-icons/Link.vue'\nimport NetworkIcon from 'vue-material-design-icons/Network.vue'\nimport TagIcon from 'vue-material-design-icons/Tag.vue'\nimport PlayCircleIcon from 'vue-material-design-icons/PlayCircle.vue'\n\nimport { useUserConfigStore } from '../../store/userconfig.ts'\nimport CollectivesIcon from './CollectivesIcon.vue'\nimport FavoriteIcon from './FavoriteIcon.vue'\nimport { isLivePhoto } from '../../services/LivePhotos'\n\nexport default Vue.extend({\n\tname: 'FileEntryPreview',\n\n\tcomponents: {\n\t\tAccountGroupIcon,\n\t\tAccountPlusIcon,\n\t\tCollectivesIcon,\n\t\tFavoriteIcon,\n\t\tFileIcon,\n\t\tFolderIcon,\n\t\tFolderOpenIcon,\n\t\tKeyIcon,\n\t\tLinkIcon,\n\t\tNetworkIcon,\n\t\tTagIcon,\n\t},\n\n\tprops: {\n\t\tsource: {\n\t\t\ttype: Object as PropType<Node>,\n\t\t\trequired: true,\n\t\t},\n\t\tdragover: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tgridMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tsetup() {\n\t\tconst userConfigStore = useUserConfigStore()\n\t\treturn {\n\t\t\tuserConfigStore,\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tbackgroundFailed: undefined as boolean | undefined,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tfileid() {\n\t\t\treturn this.source?.fileid?.toString?.()\n\t\t},\n\t\tisFavorite(): boolean {\n\t\t\treturn this.source.attributes.favorite === 1\n\t\t},\n\n\t\tuserConfig(): UserConfig {\n\t\t\treturn this.userConfigStore.userConfig\n\t\t},\n\t\tcropPreviews(): boolean {\n\t\t\treturn this.userConfig.crop_image_previews === true\n\t\t},\n\n\t\tpreviewUrl() {\n\t\t\tif (this.source.type === FileType.Folder) {\n\t\t\t\treturn null\n\t\t\t}\n\n\t\t\tif (this.backgroundFailed === true) {\n\t\t\t\treturn null\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst previewUrl = this.source.attributes.previewUrl\n\t\t\t\t\t|| generateUrl('/core/preview?fileId={fileid}', {\n\t\t\t\t\t\tfileid: this.fileid,\n\t\t\t\t\t})\n\t\t\t\tconst url = new URL(window.location.origin + previewUrl)\n\n\t\t\t\t// Request tiny previews\n\t\t\t\turl.searchParams.set('x', this.gridMode ? '128' : '32')\n\t\t\t\turl.searchParams.set('y', this.gridMode ? '128' : '32')\n\t\t\t\turl.searchParams.set('mimeFallback', 'true')\n\n\t\t\t\t// Handle cropping\n\t\t\t\turl.searchParams.set('a', this.cropPreviews === true ? '0' : '1')\n\t\t\t\treturn url.href\n\t\t\t} catch (e) {\n\t\t\t\treturn null\n\t\t\t}\n\t\t},\n\n\t\tfileOverlay() {\n\t\t\tif (isLivePhoto(this.source)) {\n\t\t\t\treturn PlayCircleIcon\n\t\t\t}\n\n\t\t\treturn null\n\t\t},\n\n\t\tfolderOverlay() {\n\t\t\tif (this.source.type !== FileType.Folder) {\n\t\t\t\treturn null\n\t\t\t}\n\n\t\t\t// Encrypted folders\n\t\t\tif (this.source?.attributes?.['is-encrypted'] === 1) {\n\t\t\t\treturn KeyIcon\n\t\t\t}\n\n\t\t\t// System tags\n\t\t\tif (this.source?.attributes?.['is-tag']) {\n\t\t\t\treturn TagIcon\n\t\t\t}\n\n\t\t\t// Link and mail shared folders\n\t\t\tconst shareTypes = Object.values(this.source?.attributes?.['share-types'] || {}).flat() as number[]\n\t\t\tif (shareTypes.some(type => type === ShareType.SHARE_TYPE_LINK || type === ShareType.SHARE_TYPE_EMAIL)) {\n\t\t\t\treturn LinkIcon\n\t\t\t}\n\n\t\t\t// Shared folders\n\t\t\tif (shareTypes.length > 0) {\n\t\t\t\treturn AccountPlusIcon\n\t\t\t}\n\n\t\t\tswitch (this.source?.attributes?.['mount-type']) {\n\t\t\tcase 'external':\n\t\t\tcase 'external-session':\n\t\t\t\treturn NetworkIcon\n\t\t\tcase 'group':\n\t\t\t\treturn AccountGroupIcon\n\t\t\tcase 'collective':\n\t\t\t\treturn CollectivesIcon\n\t\t\t}\n\n\t\t\treturn null\n\t\t},\n\t},\n\n\tmethods: {\n\t\t// Called from FileEntry\n\t\treset() {\n\t\t\t// Reset background state to cancel any ongoing requests\n\t\t\tthis.backgroundFailed = undefined\n\t\t\tif (this.$refs.previewImg) {\n\t\t\t\tthis.$refs.previewImg.src = ''\n\t\t\t}\n\t\t},\n\n\t\tonBackgroundError(event) {\n\t\t\t// Do not fail if we just reset the background\n\t\t\tif (event.target?.src === '') {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.backgroundFailed = true\n\t\t},\n\n\t\tt,\n\t},\n})\n</script>\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license AGPL-3.0-or-later\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<tr :class=\"{\n\t\t\t'files-list__row--dragover': dragover,\n\t\t\t'files-list__row--loading': isLoading,\n\t\t\t'files-list__row--active': isActive,\n\t\t}\"\n\t\tdata-cy-files-list-row\n\t\t:data-cy-files-list-row-fileid=\"fileid\"\n\t\t:data-cy-files-list-row-name=\"source.basename\"\n\t\t:draggable=\"canDrag\"\n\t\tclass=\"files-list__row\"\n\t\tv-on=\"rowListeners\">\n\t\t<!-- Failed indicator -->\n\t\t<span v-if=\"source.attributes.failed\" class=\"files-list__row--failed\" />\n\n\t\t<!-- Checkbox -->\n\t\t<FileEntryCheckbox :fileid=\"fileid\"\n\t\t\t:is-loading=\"isLoading\"\n\t\t\t:nodes=\"nodes\"\n\t\t\t:source=\"source\" />\n\n\t\t<!-- Link to file -->\n\t\t<td class=\"files-list__row-name\" data-cy-files-list-row-name>\n\t\t\t<!-- Icon or preview -->\n\t\t\t<FileEntryPreview ref=\"preview\"\n\t\t\t\t:source=\"source\"\n\t\t\t\t:dragover=\"dragover\"\n\t\t\t\t@click.native=\"execDefaultAction\" />\n\n\t\t\t<FileEntryName ref=\"name\"\n\t\t\t\t:display-name=\"displayName\"\n\t\t\t\t:extension=\"extension\"\n\t\t\t\t:files-list-width=\"filesListWidth\"\n\t\t\t\t:nodes=\"nodes\"\n\t\t\t\t:source=\"source\"\n\t\t\t\t@click=\"execDefaultAction\" />\n\t\t</td>\n\n\t\t<!-- Actions -->\n\t\t<FileEntryActions v-show=\"!isRenamingSmallScreen\"\n\t\t\tref=\"actions\"\n\t\t\t:class=\"`files-list__row-actions-${uniqueId}`\"\n\t\t\t:files-list-width=\"filesListWidth\"\n\t\t\t:loading.sync=\"loading\"\n\t\t\t:opened.sync=\"openedMenu\"\n\t\t\t:source=\"source\" />\n\n\t\t<!-- Size -->\n\t\t<td v-if=\"!compact && isSizeAvailable\"\n\t\t\t:style=\"sizeOpacity\"\n\t\t\tclass=\"files-list__row-size\"\n\t\t\tdata-cy-files-list-row-size\n\t\t\t@click=\"openDetailsIfAvailable\">\n\t\t\t<span>{{ size }}</span>\n\t\t</td>\n\n\t\t<!-- Mtime -->\n\t\t<td v-if=\"!compact && isMtimeAvailable\"\n\t\t\t:style=\"mtimeOpacity\"\n\t\t\tclass=\"files-list__row-mtime\"\n\t\t\tdata-cy-files-list-row-mtime\n\t\t\t@click=\"openDetailsIfAvailable\">\n\t\t\t<NcDateTime :timestamp=\"source.mtime\" :ignore-seconds=\"true\" />\n\t\t</td>\n\n\t\t<!-- View columns -->\n\t\t<td v-for=\"column in columns\"\n\t\t\t:key=\"column.id\"\n\t\t\t:class=\"`files-list__row-${currentView?.id}-${column.id}`\"\n\t\t\tclass=\"files-list__row-column-custom\"\n\t\t\t:data-cy-files-list-row-column-custom=\"column.id\"\n\t\t\t@click=\"openDetailsIfAvailable\">\n\t\t\t<CustomElementRender :current-view=\"currentView\"\n\t\t\t\t:render=\"column.render\"\n\t\t\t\t:source=\"source\" />\n\t\t</td>\n\t</tr>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport { Permission, formatFileSize } from '@nextcloud/files'\nimport moment from '@nextcloud/moment'\n\nimport { useActionsMenuStore } from '../store/actionsmenu.ts'\nimport { useDragAndDropStore } from '../store/dragging.ts'\nimport { useFilesStore } from '../store/files.ts'\nimport { useRenamingStore } from '../store/renaming.ts'\nimport { useSelectionStore } from '../store/selection.ts'\n\nimport FileEntryMixin from './FileEntryMixin.ts'\nimport NcDateTime from '@nextcloud/vue/dist/Components/NcDateTime.js'\nimport CustomElementRender from './CustomElementRender.vue'\nimport FileEntryActions from './FileEntry/FileEntryActions.vue'\nimport FileEntryCheckbox from './FileEntry/FileEntryCheckbox.vue'\nimport FileEntryName from './FileEntry/FileEntryName.vue'\nimport FileEntryPreview from './FileEntry/FileEntryPreview.vue'\n\nexport default defineComponent({\n\tname: 'FileEntry',\n\n\tcomponents: {\n\t\tCustomElementRender,\n\t\tFileEntryActions,\n\t\tFileEntryCheckbox,\n\t\tFileEntryName,\n\t\tFileEntryPreview,\n\t\tNcDateTime,\n\t},\n\n\tmixins: [\n\t\tFileEntryMixin,\n\t],\n\n\tprops: {\n\t\tisMtimeAvailable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisSizeAvailable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tcompact: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tsetup() {\n\t\tconst actionsMenuStore = useActionsMenuStore()\n\t\tconst draggingStore = useDragAndDropStore()\n\t\tconst filesStore = useFilesStore()\n\t\tconst renamingStore = useRenamingStore()\n\t\tconst selectionStore = useSelectionStore()\n\t\treturn {\n\t\t\tactionsMenuStore,\n\t\t\tdraggingStore,\n\t\t\tfilesStore,\n\t\t\trenamingStore,\n\t\t\tselectionStore,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t/**\n\t\t * Conditionally add drag and drop listeners\n\t\t * Do not add drag start and over listeners on renaming to allow to drag and drop text\n\t\t */\n\t\trowListeners() {\n\t\t\tconst conditionals = this.isRenaming\n\t\t\t\t? {}\n\t\t\t\t: {\n\t\t\t\t\tdragstart: this.onDragStart,\n\t\t\t\t\tdragover: this.onDragOver,\n\t\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t...conditionals,\n\t\t\t\tcontextmenu: this.onRightClick,\n\t\t\t\tdragleave: this.onDragLeave,\n\t\t\t\tdragend: this.onDragEnd,\n\t\t\t\tdrop: this.onDrop,\n\t\t\t}\n\t\t},\n\t\tcolumns() {\n\t\t\t// Hide columns if the list is too small\n\t\t\tif (this.filesListWidth < 512 || this.compact) {\n\t\t\t\treturn []\n\t\t\t}\n\t\t\treturn this.currentView?.columns || []\n\t\t},\n\n\t\tsize() {\n\t\t\tconst size = parseInt(this.source.size, 10) || 0\n\t\t\tif (typeof size !== 'number' || size < 0) {\n\t\t\t\treturn this.t('files', 'Pending')\n\t\t\t}\n\t\t\treturn formatFileSize(size, true)\n\t\t},\n\t\tsizeOpacity() {\n\t\t\tconst maxOpacitySize = 10 * 1024 * 1024\n\n\t\t\tconst size = parseInt(this.source.size, 10) || 0\n\t\t\tif (!size || size < 0) {\n\t\t\t\treturn {}\n\t\t\t}\n\n\t\t\tconst ratio = Math.round(Math.min(100, 100 * Math.pow((this.source.size / maxOpacitySize), 2)))\n\t\t\treturn {\n\t\t\t\tcolor: `color-mix(in srgb, var(--color-main-text) ${ratio}%, var(--color-text-maxcontrast))`,\n\t\t\t}\n\t\t},\n\t\tmtimeOpacity() {\n\t\t\tconst maxOpacityTime = 31 * 24 * 60 * 60 * 1000 // 31 days\n\n\t\t\tconst mtime = this.source.mtime?.getTime?.()\n\t\t\tif (!mtime) {\n\t\t\t\treturn {}\n\t\t\t}\n\n\t\t\t// 1 = today, 0 = 31 days ago\n\t\t\tconst ratio = Math.round(Math.min(100, 100 * (maxOpacityTime - (Date.now() - mtime)) / maxOpacityTime))\n\t\t\tif (ratio < 0) {\n\t\t\t\treturn {}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tcolor: `color-mix(in srgb, var(--color-main-text) ${ratio}%, var(--color-text-maxcontrast))`,\n\t\t\t}\n\t\t},\n\t\tmtimeTitle() {\n\t\t\tif (this.source.mtime) {\n\t\t\t\treturn moment(this.source.mtime).format('LLL')\n\t\t\t}\n\t\t\treturn ''\n\t\t},\n\n\t\t/**\n\t\t * This entry is the current active node\n\t\t */\n\t\tisActive() {\n\t\t\treturn this.fileid === this.currentFileId?.toString?.()\n\t\t},\n\t},\n\n\tmethods: {\n\t\tformatFileSize,\n\t},\n})\n</script>\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license AGPL-3.0-or-later\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n\n<template>\n\t<tr :class=\"{'files-list__row--active': isActive, 'files-list__row--dragover': dragover, 'files-list__row--loading': isLoading}\"\n\t\tdata-cy-files-list-row\n\t\t:data-cy-files-list-row-fileid=\"fileid\"\n\t\t:data-cy-files-list-row-name=\"source.basename\"\n\t\t:draggable=\"canDrag\"\n\t\tclass=\"files-list__row\"\n\t\t@contextmenu=\"onRightClick\"\n\t\t@dragover=\"onDragOver\"\n\t\t@dragleave=\"onDragLeave\"\n\t\t@dragstart=\"onDragStart\"\n\t\t@dragend=\"onDragEnd\"\n\t\t@drop=\"onDrop\">\n\t\t<!-- Failed indicator -->\n\t\t<span v-if=\"source.attributes.failed\" class=\"files-list__row--failed\" />\n\n\t\t<!-- Checkbox -->\n\t\t<FileEntryCheckbox :fileid=\"fileid\"\n\t\t\t:is-loading=\"isLoading\"\n\t\t\t:nodes=\"nodes\"\n\t\t\t:source=\"source\" />\n\n\t\t<!-- Link to file -->\n\t\t<td class=\"files-list__row-name\" data-cy-files-list-row-name>\n\t\t\t<!-- Icon or preview -->\n\t\t\t<FileEntryPreview ref=\"preview\"\n\t\t\t\t:dragover=\"dragover\"\n\t\t\t\t:grid-mode=\"true\"\n\t\t\t\t:source=\"source\"\n\t\t\t\t@click.native=\"execDefaultAction\" />\n\n\t\t\t<FileEntryName ref=\"name\"\n\t\t\t\t:display-name=\"displayName\"\n\t\t\t\t:extension=\"extension\"\n\t\t\t\t:files-list-width=\"filesListWidth\"\n\t\t\t\t:grid-mode=\"true\"\n\t\t\t\t:nodes=\"nodes\"\n\t\t\t\t:source=\"source\"\n\t\t\t\t@click=\"execDefaultAction\" />\n\t\t</td>\n\n\t\t<!-- Actions -->\n\t\t<FileEntryActions ref=\"actions\"\n\t\t\t:class=\"`files-list__row-actions-${uniqueId}`\"\n\t\t\t:files-list-width=\"filesListWidth\"\n\t\t\t:grid-mode=\"true\"\n\t\t\t:loading.sync=\"loading\"\n\t\t\t:opened.sync=\"openedMenu\"\n\t\t\t:source=\"source\" />\n\t</tr>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\n\nimport { useActionsMenuStore } from '../store/actionsmenu.ts'\nimport { useDragAndDropStore } from '../store/dragging.ts'\nimport { useFilesStore } from '../store/files.ts'\nimport { useRenamingStore } from '../store/renaming.ts'\nimport { useSelectionStore } from '../store/selection.ts'\nimport FileEntryMixin from './FileEntryMixin.ts'\nimport FileEntryActions from './FileEntry/FileEntryActions.vue'\nimport FileEntryCheckbox from './FileEntry/FileEntryCheckbox.vue'\nimport FileEntryName from './FileEntry/FileEntryName.vue'\nimport FileEntryPreview from './FileEntry/FileEntryPreview.vue'\n\nexport default defineComponent({\n\tname: 'FileEntryGrid',\n\n\tcomponents: {\n\t\tFileEntryActions,\n\t\tFileEntryCheckbox,\n\t\tFileEntryName,\n\t\tFileEntryPreview,\n\t},\n\n\tmixins: [\n\t\tFileEntryMixin,\n\t],\n\n\tinheritAttrs: false,\n\n\tsetup() {\n\t\tconst actionsMenuStore = useActionsMenuStore()\n\t\tconst draggingStore = useDragAndDropStore()\n\t\tconst filesStore = useFilesStore()\n\t\tconst renamingStore = useRenamingStore()\n\t\tconst selectionStore = useSelectionStore()\n\t\treturn {\n\t\t\tactionsMenuStore,\n\t\t\tdraggingStore,\n\t\t\tfilesStore,\n\t\t\trenamingStore,\n\t\t\tselectionStore,\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tgridMode: true,\n\t\t}\n\t},\n})\n</script>\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<div v-show=\"enabled\" :class=\"`files-list__header-${header.id}`\">\n\t\t<span ref=\"mount\" />\n\t</div>\n</template>\n\n<script lang=\"ts\">\n/**\n * This component is used to render custom\n * elements provided by an API. Vue doesn't allow\n * to directly render an HTMLElement, so we can do\n * this magic here.\n */\nexport default {\n\tname: 'FilesListHeader',\n\tprops: {\n\t\theader: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentFolder: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentView: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tenabled() {\n\t\t\treturn this.header.enabled(this.currentFolder, this.currentView)\n\t\t},\n\t},\n\twatch: {\n\t\tenabled(enabled) {\n\t\t\tif (!enabled) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.header.updated(this.currentFolder, this.currentView)\n\t\t},\n\t\tcurrentFolder() {\n\t\t\tthis.header.updated(this.currentFolder, this.currentView)\n\t\t},\n\t},\n\tmounted() {\n\t\tconsole.debug('Mounted', this.header.id)\n\t\tthis.header.render(this.$refs.mount, this.currentFolder, this.currentView)\n\t},\n}\n</script>\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<tr>\n\t\t<th class=\"files-list__row-checkbox\">\n\t\t\t<!-- TRANSLATORS Label for a table footer which summarizes the columns of the table -->\n\t\t\t<span class=\"hidden-visually\">{{ t('files', 'Total rows summary') }}</span>\n\t\t</th>\n\n\t\t<!-- Link to file -->\n\t\t<td class=\"files-list__row-name\">\n\t\t\t<!-- Icon or preview -->\n\t\t\t<span class=\"files-list__row-icon\" />\n\n\t\t\t<!-- Summary -->\n\t\t\t<span>{{ summary }}</span>\n\t\t</td>\n\n\t\t<!-- Actions -->\n\t\t<td class=\"files-list__row-actions\" />\n\n\t\t<!-- Size -->\n\t\t<td v-if=\"isSizeAvailable\"\n\t\t\tclass=\"files-list__column files-list__row-size\">\n\t\t\t<span>{{ totalSize }}</span>\n\t\t</td>\n\n\t\t<!-- Mtime -->\n\t\t<td v-if=\"isMtimeAvailable\"\n\t\t\tclass=\"files-list__column files-list__row-mtime\" />\n\n\t\t<!-- Custom views columns -->\n\t\t<th v-for=\"column in columns\"\n\t\t\t:key=\"column.id\"\n\t\t\t:class=\"classForColumn(column)\">\n\t\t\t<span>{{ column.summary?.(nodes, currentView) }}</span>\n\t\t</th>\n\t</tr>\n</template>\n\n<script lang=\"ts\">\nimport { formatFileSize } from '@nextcloud/files'\nimport { translate } from '@nextcloud/l10n'\nimport Vue from 'vue'\n\nimport { useFilesStore } from '../store/files.ts'\nimport { usePathsStore } from '../store/paths.ts'\n\nexport default Vue.extend({\n\tname: 'FilesListTableFooter',\n\n\tcomponents: {\n\t},\n\n\tprops: {\n\t\tisMtimeAvailable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisSizeAvailable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tnodes: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tsummary: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tfilesListWidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\n\tsetup() {\n\t\tconst pathsStore = usePathsStore()\n\t\tconst filesStore = useFilesStore()\n\t\treturn {\n\t\t\tfilesStore,\n\t\t\tpathsStore,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tcurrentView() {\n\t\t\treturn this.$navigation.active\n\t\t},\n\n\t\tdir() {\n\t\t\t// Remove any trailing slash but leave root slash\n\t\t\treturn (this.$route?.query?.dir || '/').replace(/^(.+)\\/$/, '$1')\n\t\t},\n\n\t\tcurrentFolder() {\n\t\t\tif (!this.currentView?.id) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (this.dir === '/') {\n\t\t\t\treturn this.filesStore.getRoot(this.currentView.id)\n\t\t\t}\n\t\t\tconst fileId = this.pathsStore.getPath(this.currentView.id, this.dir)\n\t\t\treturn this.filesStore.getNode(fileId)\n\t\t},\n\n\t\tcolumns() {\n\t\t\t// Hide columns if the list is too small\n\t\t\tif (this.filesListWidth < 512) {\n\t\t\t\treturn []\n\t\t\t}\n\t\t\treturn this.currentView?.columns || []\n\t\t},\n\n\t\ttotalSize() {\n\t\t\t// If we have the size already, let's use it\n\t\t\tif (this.currentFolder?.size) {\n\t\t\t\treturn formatFileSize(this.currentFolder.size, true)\n\t\t\t}\n\n\t\t\t// Otherwise let's compute it\n\t\t\treturn formatFileSize(this.nodes.reduce((total, node) => total + node.size || 0, 0), true)\n\t\t},\n\t},\n\n\tmethods: {\n\t\tclassForColumn(column) {\n\t\t\treturn {\n\t\t\t\t'files-list__row-column-custom': true,\n\t\t\t\t[`files-list__row-${this.currentView.id}-${column.id}`]: true,\n\t\t\t}\n\t\t},\n\n\t\tt: translate,\n\t},\n})\n</script>\n\n<style scoped lang=\"scss\">\n// Scoped row\ntr {\n\tmargin-bottom: 300px;\n\tborder-top: 1px solid var(--color-border);\n\t// Prevent hover effect on the whole row\n\tbackground-color: transparent !important;\n\tborder-bottom: none !important;\n\n\ttd {\n\t\tuser-select: none;\n\t\t// Make sure the cell colors don't apply to column headers\n\t\tcolor: var(--color-text-maxcontrast) !important;\n\t}\n}\n</style>\n","/**\n * @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @author John Molakvoæ <skjnldsv@protonmail.com>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Vue from 'vue'\n\nimport { mapState } from 'pinia'\nimport { useViewConfigStore } from '../store/viewConfig'\nimport { Navigation, View } from '@nextcloud/files'\n\nexport default Vue.extend({\n\tcomputed: {\n\t\t...mapState(useViewConfigStore, ['getConfig', 'setSortingBy', 'toggleSortingDirection']),\n\n\t\tcurrentView(): View {\n\t\t\treturn (this.$navigation as Navigation).active as View\n\t\t},\n\n\t\t/**\n\t\t * Get the sorting mode for the current view\n\t\t */\n\t\tsortingMode(): string {\n\t\t\treturn this.getConfig(this.currentView.id)?.sorting_mode as string\n\t\t\t\t|| this.currentView?.defaultSortKey\n\t\t\t\t|| 'basename'\n\t\t},\n\n\t\t/**\n\t\t * Get the sorting direction for the current view\n\t\t */\n\t\tisAscSorting(): boolean {\n\t\t\tconst sortingDirection = this.getConfig(this.currentView.id)?.sorting_direction\n\t\t\treturn sortingDirection !== 'desc'\n\t\t},\n\t},\n\n\tmethods: {\n\t\ttoggleSortBy(key: string) {\n\t\t\t// If we're already sorting by this key, flip the direction\n\t\t\tif (this.sortingMode === key) {\n\t\t\t\tthis.toggleSortingDirection(this.currentView.id)\n\t\t\t\treturn\n\t\t\t}\n\t\t\t// else sort ASC by this new key\n\t\t\tthis.setSortingBy(key, this.currentView.id)\n\t\t},\n\t},\n})\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  - @author Ferdinand Thiessen <opensource@fthiessen.de>\n  -\n  - @license AGPL-3.0-or-later\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<NcButton :class=\"['files-list__column-sort-button', {\n\t\t\t'files-list__column-sort-button--active': sortingMode === mode,\n\t\t\t'files-list__column-sort-button--size': sortingMode === 'size',\n\t\t}]\"\n\t\t:alignment=\"mode === 'size' ? 'end' : 'start-reverse'\"\n\t\ttype=\"tertiary\"\n\t\t@click=\"toggleSortBy(mode)\">\n\t\t<template #icon>\n\t\t\t<MenuUp v-if=\"sortingMode !== mode || isAscSorting\" class=\"files-list__column-sort-button-icon\" />\n\t\t\t<MenuDown v-else class=\"files-list__column-sort-button-icon\" />\n\t\t</template>\n\t\t<span class=\"files-list__column-sort-button-text\">{{ name }}</span>\n\t</NcButton>\n</template>\n\n<script lang=\"ts\">\nimport { translate } from '@nextcloud/l10n'\nimport { defineComponent } from 'vue'\n\nimport MenuDown from 'vue-material-design-icons/MenuDown.vue'\nimport MenuUp from 'vue-material-design-icons/MenuUp.vue'\nimport NcButton from '@nextcloud/vue/dist/Components/NcButton.js'\n\nimport filesSortingMixin from '../mixins/filesSorting.ts'\n\nexport default defineComponent({\n\tname: 'FilesListTableHeaderButton',\n\n\tcomponents: {\n\t\tMenuDown,\n\t\tMenuUp,\n\t\tNcButton,\n\t},\n\n\tmixins: [\n\t\tfilesSortingMixin,\n\t],\n\n\tprops: {\n\t\tname: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tmode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tmethods: {\n\t\tt: translate,\n\t},\n})\n</script>\n\n<style scoped lang=\"scss\">\n.files-list__column-sort-button {\n\t// Compensate for cells margin\n\tmargin: 0 calc(var(--cell-margin) * -1);\n\tmin-width: calc(100% - 3 * var(--cell-margin))!important;\n\n\t&-text {\n\t\tcolor: var(--color-text-maxcontrast);\n\t\tfont-weight: normal;\n\t}\n\n\t&-icon {\n\t\tcolor: var(--color-text-maxcontrast);\n\t\topacity: 0;\n\t\ttransition: opacity var(--animation-quick);\n\t\tinset-inline-start: -10px;\n\t}\n\n\t&--size &-icon {\n\t\tinset-inline-start: 10px;\n\t}\n\n\t&--active &-icon,\n\t&:hover &-icon,\n\t&:focus &-icon,\n\t&:active &-icon {\n\t\topacity: 1;\n\t}\n}\n</style>\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license AGPL-3.0-or-later\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<tr class=\"files-list__row-head\">\n\t\t<th class=\"files-list__column files-list__row-checkbox\"\n\t\t\t@keyup.esc.exact=\"resetSelection\">\n\t\t\t<NcCheckboxRadioSwitch v-bind=\"selectAllBind\" @update:checked=\"onToggleAll\" />\n\t\t</th>\n\n\t\t<!-- Columns display -->\n\n\t\t<!-- Link to file -->\n\t\t<th class=\"files-list__column files-list__row-name files-list__column--sortable\"\n\t\t\t:aria-sort=\"ariaSortForMode('basename')\">\n\t\t\t<!-- Icon or preview -->\n\t\t\t<span class=\"files-list__row-icon\" />\n\n\t\t\t<!-- Name -->\n\t\t\t<FilesListTableHeaderButton :name=\"t('files', 'Name')\" mode=\"basename\" />\n\t\t</th>\n\n\t\t<!-- Actions -->\n\t\t<th class=\"files-list__row-actions\" />\n\n\t\t<!-- Size -->\n\t\t<th v-if=\"isSizeAvailable\"\n\t\t\tclass=\"files-list__column files-list__row-size\"\n\t\t\t:class=\"{ 'files-list__column--sortable': isSizeAvailable }\"\n\t\t\t:aria-sort=\"ariaSortForMode('size')\">\n\t\t\t<FilesListTableHeaderButton :name=\"t('files', 'Size')\" mode=\"size\" />\n\t\t</th>\n\n\t\t<!-- Mtime -->\n\t\t<th v-if=\"isMtimeAvailable\"\n\t\t\tclass=\"files-list__column files-list__row-mtime\"\n\t\t\t:class=\"{ 'files-list__column--sortable': isMtimeAvailable }\"\n\t\t\t:aria-sort=\"ariaSortForMode('mtime')\">\n\t\t\t<FilesListTableHeaderButton :name=\"t('files', 'Modified')\" mode=\"mtime\" />\n\t\t</th>\n\n\t\t<!-- Custom views columns -->\n\t\t<th v-for=\"column in columns\"\n\t\t\t:key=\"column.id\"\n\t\t\t:class=\"classForColumn(column)\"\n\t\t\t:aria-sort=\"ariaSortForMode(column.id)\">\n\t\t\t<FilesListTableHeaderButton v-if=\"!!column.sort\" :name=\"column.title\" :mode=\"column.id\" />\n\t\t\t<span v-else>\n\t\t\t\t{{ column.title }}\n\t\t\t</span>\n\t\t</th>\n\t</tr>\n</template>\n\n<script lang=\"ts\">\nimport { translate as t } from '@nextcloud/l10n'\nimport NcCheckboxRadioSwitch from '@nextcloud/vue/dist/Components/NcCheckboxRadioSwitch.js'\nimport { defineComponent, type PropType } from 'vue'\n\nimport { useFilesStore } from '../store/files.ts'\nimport { useSelectionStore } from '../store/selection.ts'\nimport FilesListTableHeaderButton from './FilesListTableHeaderButton.vue'\nimport filesSortingMixin from '../mixins/filesSorting.ts'\nimport logger from '../logger.js'\nimport type { Node } from '@nextcloud/files'\n\nexport default defineComponent({\n\tname: 'FilesListTableHeader',\n\n\tcomponents: {\n\t\tFilesListTableHeaderButton,\n\t\tNcCheckboxRadioSwitch,\n\t},\n\n\tmixins: [\n\t\tfilesSortingMixin,\n\t],\n\n\tprops: {\n\t\tisMtimeAvailable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisSizeAvailable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tnodes: {\n\t\t\ttype: Array as PropType<Node[]>,\n\t\t\trequired: true,\n\t\t},\n\t\tfilesListWidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\n\tsetup() {\n\t\tconst filesStore = useFilesStore()\n\t\tconst selectionStore = useSelectionStore()\n\t\treturn {\n\t\t\tfilesStore,\n\t\t\tselectionStore,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tcurrentView() {\n\t\t\treturn this.$navigation.active\n\t\t},\n\n\t\tcolumns() {\n\t\t\t// Hide columns if the list is too small\n\t\t\tif (this.filesListWidth < 512) {\n\t\t\t\treturn []\n\t\t\t}\n\t\t\treturn this.currentView?.columns || []\n\t\t},\n\n\t\tdir() {\n\t\t\t// Remove any trailing slash but leave root slash\n\t\t\treturn (this.$route?.query?.dir || '/').replace(/^(.+)\\/$/, '$1')\n\t\t},\n\n\t\tselectAllBind() {\n\t\t\tconst label = t('files', 'Toggle selection for all files and folders')\n\t\t\treturn {\n\t\t\t\t'aria-label': label,\n\t\t\t\tchecked: this.isAllSelected,\n\t\t\t\tindeterminate: this.isSomeSelected,\n\t\t\t\ttitle: label,\n\t\t\t}\n\t\t},\n\n\t\tselectedNodes() {\n\t\t\treturn this.selectionStore.selected\n\t\t},\n\n\t\tisAllSelected() {\n\t\t\treturn this.selectedNodes.length === this.nodes.length\n\t\t},\n\n\t\tisNoneSelected() {\n\t\t\treturn this.selectedNodes.length === 0\n\t\t},\n\n\t\tisSomeSelected() {\n\t\t\treturn !this.isAllSelected && !this.isNoneSelected\n\t\t},\n\t},\n\n\tmethods: {\n\t\tariaSortForMode(mode: string): ARIAMixin['ariaSort'] {\n\t\t\tif (this.sortingMode === mode) {\n\t\t\t\treturn this.isAscSorting ? 'ascending' : 'descending'\n\t\t\t}\n\t\t\treturn null\n\t\t},\n\n\t\tclassForColumn(column) {\n\t\t\treturn {\n\t\t\t\t'files-list__column': true,\n\t\t\t\t'files-list__column--sortable': !!column.sort,\n\t\t\t\t'files-list__row-column-custom': true,\n\t\t\t\t[`files-list__row-${this.currentView?.id}-${column.id}`]: true,\n\t\t\t}\n\t\t},\n\n\t\tonToggleAll(selected) {\n\t\t\tif (selected) {\n\t\t\t\tconst selection = this.nodes.map(node => node.fileid).filter(Boolean) as number[]\n\t\t\t\tlogger.debug('Added all nodes to selection', { selection })\n\t\t\t\tthis.selectionStore.setLastIndex(null)\n\t\t\t\tthis.selectionStore.set(selection)\n\t\t\t} else {\n\t\t\t\tlogger.debug('Cleared selection')\n\t\t\t\tthis.selectionStore.reset()\n\t\t\t}\n\t\t},\n\n\t\tresetSelection() {\n\t\t\tthis.selectionStore.reset()\n\t\t},\n\n\t\tt,\n\t},\n})\n</script>\n\n<style scoped lang=\"scss\">\n.files-list__column {\n\tuser-select: none;\n\t// Make sure the cell colors don't apply to column headers\n\tcolor: var(--color-text-maxcontrast) !important;\n\n\t&--sortable {\n\t\tcursor: pointer;\n\t}\n}\n\n</style>\n","<template>\n\t<div class=\"files-list\" data-cy-files-list>\n\t\t<!-- Header -->\n\t\t<div ref=\"before\" class=\"files-list__before\">\n\t\t\t<slot name=\"before\" />\n\t\t</div>\n\n\t\t<div v-if=\"!!$scopedSlots['header-overlay']\" class=\"files-list__thead-overlay\">\n\t\t\t<slot name=\"header-overlay\" />\n\t\t</div>\n\n\t\t<table class=\"files-list__table\" :class=\"{ 'files-list__table--with-thead-overlay': !!$scopedSlots['header-overlay'] }\">\n\t\t\t<!-- Accessibility table caption for screen readers -->\n\t\t\t<caption v-if=\"caption\" class=\"hidden-visually\">\n\t\t\t\t{{ caption }}\n\t\t\t</caption>\n\n\t\t\t<!-- Header -->\n\t\t\t<thead ref=\"thead\" class=\"files-list__thead\" data-cy-files-list-thead>\n\t\t\t\t<slot name=\"header\" />\n\t\t\t</thead>\n\n\t\t\t<!-- Body -->\n\t\t\t<tbody :style=\"tbodyStyle\"\n\t\t\t\tclass=\"files-list__tbody\"\n\t\t\t\t:class=\"gridMode ? 'files-list__tbody--grid' : 'files-list__tbody--list'\"\n\t\t\t\tdata-cy-files-list-tbody>\n\t\t\t\t<component :is=\"dataComponent\"\n\t\t\t\t\tv-for=\"({key, item}, i) in renderedItems\"\n\t\t\t\t\t:key=\"key\"\n\t\t\t\t\t:source=\"item\"\n\t\t\t\t\t:index=\"i\"\n\t\t\t\t\tv-bind=\"extraProps\" />\n\t\t\t</tbody>\n\n\t\t\t<!-- Footer -->\n\t\t\t<tfoot v-show=\"isReady\"\n\t\t\t\tclass=\"files-list__tfoot\"\n\t\t\t\tdata-cy-files-list-tfoot>\n\t\t\t\t<slot name=\"footer\" />\n\t\t\t</tfoot>\n\t\t</table>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport type { File, Folder, Node } from '@nextcloud/files'\nimport type { PropType } from 'vue'\n\nimport { debounce } from 'debounce'\nimport Vue from 'vue'\n\nimport filesListWidthMixin from '../mixins/filesListWidth.ts'\nimport logger from '../logger.js'\n\ninterface RecycledPoolItem {\n\tkey: string,\n\titem: Node,\n}\n\nexport default Vue.extend({\n\tname: 'VirtualList',\n\n\tmixins: [filesListWidthMixin],\n\n\tprops: {\n\t\tdataComponent: {\n\t\t\ttype: [Object, Function],\n\t\t\trequired: true,\n\t\t},\n\t\tdataKey: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdataSources: {\n\t\t\ttype: Array as PropType<(File | Folder)[]>,\n\t\t\trequired: true,\n\t\t},\n\t\textraProps: {\n\t\t\ttype: Object as PropType<Record<string, unknown>>,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t\tscrollToIndex: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\tgridMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\t/**\n\t\t * Visually hidden caption for the table accesibility\n\t\t */\n\t\tcaption: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tindex: this.scrollToIndex,\n\t\t\tbeforeHeight: 0,\n\t\t\theaderHeight: 0,\n\t\t\ttableHeight: 0,\n\t\t\tresizeObserver: null as ResizeObserver | null,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t// Wait for measurements to be done before rendering\n\t\tisReady() {\n\t\t\treturn this.tableHeight > 0\n\t\t},\n\n\t\t// Items to render before and after the visible area\n\t\tbufferItems() {\n\t\t\tif (this.gridMode) {\n\t\t\t\treturn this.columnCount\n\t\t\t}\n\t\t\treturn 3\n\t\t},\n\n\t\titemHeight() {\n\t\t\t// Align with css in FilesListVirtual\n\t\t\t// 138px + 44px (name) + 15px (grid gap)\n\t\t\treturn this.gridMode ? (138 + 44 + 15) : 55\n\t\t},\n\t\t// Grid mode only\n\t\titemWidth() {\n\t\t\t// 160px + 15px grid gap\n\t\t\treturn 160 + 15\n\t\t},\n\n\t\trowCount() {\n\t\t\treturn Math.ceil((this.tableHeight - this.headerHeight) / this.itemHeight) + (this.bufferItems / this.columnCount) * 2 + 1\n\t\t},\n\t\tcolumnCount() {\n\t\t\tif (!this.gridMode) {\n\t\t\t\treturn 1\n\t\t\t}\n\t\t\treturn Math.floor(this.filesListWidth / this.itemWidth)\n\t\t},\n\n\t\tstartIndex() {\n\t\t\treturn Math.max(0, this.index - this.bufferItems)\n\t\t},\n\t\tshownItems() {\n\t\t\t// If in grid mode, we need to multiply the number of rows by the number of columns\n\t\t\tif (this.gridMode) {\n\t\t\t\treturn this.rowCount * this.columnCount\n\t\t\t}\n\n\t\t\treturn this.rowCount\n\t\t},\n\t\trenderedItems(): RecycledPoolItem[] {\n\t\t\tif (!this.isReady) {\n\t\t\t\treturn []\n\t\t\t}\n\n\t\t\tconst items = this.dataSources.slice(this.startIndex, this.startIndex + this.shownItems) as Node[]\n\n\t\t\tconst oldItems = items.filter(item => Object.values(this.$_recycledPool).includes(item[this.dataKey]))\n\t\t\tconst oldItemsKeys = oldItems.map(item => item[this.dataKey] as string)\n\t\t\tconst unusedKeys = Object.keys(this.$_recycledPool).filter(key => !oldItemsKeys.includes(this.$_recycledPool[key]))\n\n\t\t\treturn items.map(item => {\n\t\t\t\tconst index = Object.values(this.$_recycledPool).indexOf(item[this.dataKey])\n\t\t\t\t// If defined, let's keep the key\n\t\t\t\tif (index !== -1) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tkey: Object.keys(this.$_recycledPool)[index],\n\t\t\t\t\t\titem,\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Get and consume reusable key or generate a new one\n\t\t\t\tconst key = unusedKeys.pop() || Math.random().toString(36).substr(2)\n\t\t\t\tthis.$_recycledPool[key] = item[this.dataKey]\n\t\t\t\treturn { key, item }\n\t\t\t})\n\t\t},\n\n\t\ttbodyStyle() {\n\t\t\tconst isOverScrolled = this.startIndex + this.rowCount > this.dataSources.length\n\t\t\tconst lastIndex = this.dataSources.length - this.startIndex - this.shownItems\n\t\t\tconst hiddenAfterItems = Math.floor(Math.min(this.dataSources.length - this.startIndex, lastIndex) / this.columnCount)\n\t\t\treturn {\n\t\t\t\tpaddingTop: `${Math.floor(this.startIndex / this.columnCount) * this.itemHeight}px`,\n\t\t\t\tpaddingBottom: isOverScrolled ? 0 : `${hiddenAfterItems * this.itemHeight}px`,\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\tscrollToIndex(index) {\n\t\t\tthis.scrollTo(index)\n\t\t},\n\t\tcolumnCount(columnCount, oldColumnCount) {\n\t\t\tif (oldColumnCount === 0) {\n\t\t\t\t// We're initializing, the scroll position\n\t\t\t\t// is handled on mounted\n\t\t\t\tconsole.debug('VirtualList: columnCount is 0, skipping scroll')\n\t\t\t\treturn\n\t\t\t}\n\t\t\t// If the column count changes in grid view,\n\t\t\t// update the scroll position again\n\t\t\tthis.scrollTo(this.index)\n\t\t},\n\t},\n\n\tmounted() {\n\t\tconst before = this.$refs?.before as HTMLElement\n\t\tconst root = this.$el as HTMLElement\n\t\tconst thead = this.$refs?.thead as HTMLElement\n\n\t\tthis.resizeObserver = new ResizeObserver(debounce(() => {\n\t\t\tthis.beforeHeight = before?.clientHeight ?? 0\n\t\t\tthis.headerHeight = thead?.clientHeight ?? 0\n\t\t\tthis.tableHeight = root?.clientHeight ?? 0\n\t\t\tlogger.debug('VirtualList: resizeObserver updated')\n\t\t\tthis.onScroll()\n\t\t}, 100, false))\n\n\t\tthis.resizeObserver.observe(before)\n\t\tthis.resizeObserver.observe(root)\n\t\tthis.resizeObserver.observe(thead)\n\n\t\tif (this.scrollToIndex) {\n\t\t\tthis.scrollTo(this.scrollToIndex)\n\t\t}\n\n\t\t// Adding scroll listener AFTER the initial scroll to index\n\t\tthis.$el.addEventListener('scroll', this.onScroll, { passive: true })\n\n\t\tthis.$_recycledPool = {} as Record<string, any>\n\t},\n\n\tbeforeDestroy() {\n\t\tif (this.resizeObserver) {\n\t\t\tthis.resizeObserver.disconnect()\n\t\t}\n\t},\n\n\tmethods: {\n\t\tscrollTo(index: number) {\n\t\t\tconst targetRow = Math.ceil(this.dataSources.length / this.columnCount)\n\t\t\tif (targetRow < this.rowCount) {\n\t\t\t\tlogger.debug('VirtualList: Skip scrolling. nothing to scroll', { index, targetRow, rowCount: this.rowCount })\n\t\t\t\treturn\n\t\t\t}\n\t\t\tthis.index = index\n\t\t\t// Scroll to one row and a half before the index\n\t\t\tconst scrollTop = (Math.floor(index / this.columnCount) - 0.5) * this.itemHeight + this.beforeHeight\n\t\t\tlogger.debug('VirtualList: scrolling to index ' + index, { scrollTop, columnCount: this.columnCount })\n\t\t\tthis.$el.scrollTop = scrollTop\n\t\t},\n\n\t\tonScroll() {\n\t\t\tthis._onScrollHandle ??= requestAnimationFrame(() => {\n\t\t\t\tthis._onScrollHandle = null\n\t\t\t\tconst topScroll = this.$el.scrollTop - this.beforeHeight\n\t\t\t\tconst index = Math.floor(topScroll / this.itemHeight) * this.columnCount\n\t\t\t\t// Max 0 to prevent negative index\n\t\t\t\tthis.index = Math.max(0, index)\n\t\t\t\tthis.$emit('scroll')\n\t\t\t})\n\t\t},\n\t},\n})\n</script>\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<div class=\"files-list__column files-list__row-actions-batch\">\n\t\t<NcActions ref=\"actionsMenu\"\n\t\t\t:disabled=\"!!loading || areSomeNodesLoading\"\n\t\t\t:force-name=\"true\"\n\t\t\t:inline=\"inlineActions\"\n\t\t\t:menu-name=\"inlineActions <= 1 ? t('files', 'Actions') : null\"\n\t\t\t:open.sync=\"openedMenu\">\n\t\t\t<NcActionButton v-for=\"action in enabledActions\"\n\t\t\t\t:key=\"action.id\"\n\t\t\t\t:class=\"'files-list__row-actions-batch-' + action.id\"\n\t\t\t\t@click=\"onActionClick(action)\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<NcLoadingIcon v-if=\"loading === action.id\" :size=\"18\" />\n\t\t\t\t\t<NcIconSvgWrapper v-else :svg=\"action.iconSvgInline(nodes, currentView)\" />\n\t\t\t\t</template>\n\t\t\t\t{{ action.displayName(nodes, currentView) }}\n\t\t\t</NcActionButton>\n\t\t</NcActions>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport { Node, NodeStatus, View, getFileActions } from '@nextcloud/files'\nimport { showError, showSuccess } from '@nextcloud/dialogs'\nimport { translate } from '@nextcloud/l10n'\nimport NcActionButton from '@nextcloud/vue/dist/Components/NcActionButton.js'\nimport NcActions from '@nextcloud/vue/dist/Components/NcActions.js'\nimport NcIconSvgWrapper from '@nextcloud/vue/dist/Components/NcIconSvgWrapper.js'\nimport NcLoadingIcon from '@nextcloud/vue/dist/Components/NcLoadingIcon.js'\nimport Vue, { defineComponent, type PropType } from 'vue'\n\nimport { useActionsMenuStore } from '../store/actionsmenu.ts'\nimport { useFilesStore } from '../store/files.ts'\nimport { useSelectionStore } from '../store/selection.ts'\nimport filesListWidthMixin from '../mixins/filesListWidth.ts'\nimport logger from '../logger.js'\nimport type { FileId } from '../types'\n\n// The registered actions list\nconst actions = getFileActions()\n\nexport default defineComponent({\n\tname: 'FilesListTableHeaderActions',\n\n\tcomponents: {\n\t\tNcActions,\n\t\tNcActionButton,\n\t\tNcIconSvgWrapper,\n\t\tNcLoadingIcon,\n\t},\n\n\tmixins: [\n\t\tfilesListWidthMixin,\n\t],\n\n\tprops: {\n\t\tcurrentView: {\n\t\t\ttype: Object as PropType<View>,\n\t\t\trequired: true,\n\t\t},\n\t\tselectedNodes: {\n\t\t\ttype: Array as PropType<FileId[]>,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t},\n\n\tsetup() {\n\t\tconst actionsMenuStore = useActionsMenuStore()\n\t\tconst filesStore = useFilesStore()\n\t\tconst selectionStore = useSelectionStore()\n\t\treturn {\n\t\t\tactionsMenuStore,\n\t\t\tfilesStore,\n\t\t\tselectionStore,\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tloading: null,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tdir() {\n\t\t\t// Remove any trailing slash but leave root slash\n\t\t\treturn (this.$route?.query?.dir || '/').replace(/^(.+)\\/$/, '$1')\n\t\t},\n\t\tenabledActions() {\n\t\t\treturn actions\n\t\t\t\t.filter(action => action.execBatch)\n\t\t\t\t.filter(action => !action.enabled || action.enabled(this.nodes, this.currentView))\n\t\t\t\t.sort((a, b) => (a.order || 0) - (b.order || 0))\n\t\t},\n\n\t\tnodes() {\n\t\t\treturn this.selectedNodes\n\t\t\t\t.map(fileid => this.getNode(fileid))\n\t\t\t\t.filter(Boolean) as Node[]\n\t\t},\n\n\t\tareSomeNodesLoading() {\n\t\t\treturn this.nodes.some(node => node.status === NodeStatus.LOADING)\n\t\t},\n\n\t\topenedMenu: {\n\t\t\tget() {\n\t\t\t\treturn this.actionsMenuStore.opened === 'global'\n\t\t\t},\n\t\t\tset(opened) {\n\t\t\t\tthis.actionsMenuStore.opened = opened ? 'global' : null\n\t\t\t},\n\t\t},\n\n\t\tinlineActions() {\n\t\t\tif (this.filesListWidth < 512) {\n\t\t\t\treturn 0\n\t\t\t}\n\t\t\tif (this.filesListWidth < 768) {\n\t\t\t\treturn 1\n\t\t\t}\n\t\t\tif (this.filesListWidth < 1024) {\n\t\t\t\treturn 2\n\t\t\t}\n\t\t\treturn 3\n\t\t},\n\t},\n\n\tmethods: {\n\t\t/**\n\t\t * Get a cached note from the store\n\t\t *\n\t\t * @param {number} fileId the file id to get\n\t\t * @return {Folder|File}\n\t\t */\n\t\tgetNode(fileId) {\n\t\t\treturn this.filesStore.getNode(fileId)\n\t\t},\n\n\t\tasync onActionClick(action) {\n\t\t\tconst displayName = action.displayName(this.nodes, this.currentView)\n\t\t\tconst selectionIds = this.selectedNodes\n\t\t\ttry {\n\t\t\t\t// Set loading markers\n\t\t\t\tthis.loading = action.id\n\t\t\t\tthis.nodes.forEach(node => {\n\t\t\t\t\tVue.set(node, 'status', NodeStatus.LOADING)\n\t\t\t\t})\n\n\t\t\t\t// Dispatch action execution\n\t\t\t\tconst results = await action.execBatch(this.nodes, this.currentView, this.dir)\n\n\t\t\t\t// Check if all actions returned null\n\t\t\t\tif (!results.some(result => result !== null)) {\n\t\t\t\t\t// If the actions returned null, we stay silent\n\t\t\t\t\tthis.selectionStore.reset()\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\t// Handle potential failures\n\t\t\t\tif (results.some(result => result === false)) {\n\t\t\t\t\t// Remove the failed ids from the selection\n\t\t\t\t\tconst failedIds = selectionIds\n\t\t\t\t\t\t.filter((fileid, index) => results[index] === false)\n\t\t\t\t\tthis.selectionStore.set(failedIds)\n\n\t\t\t\t\tif (results.some(result => result === null)) {\n\t\t\t\t\t\t// If some actions returned null, we assume that the dev\n\t\t\t\t\t\t// is handling the error messages and we stay silent\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tshowError(this.t('files', '\"{displayName}\" failed on some elements ', { displayName }))\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\t// Show success message and clear selection\n\t\t\t\tshowSuccess(this.t('files', '\"{displayName}\" batch action executed successfully', { displayName }))\n\t\t\t\tthis.selectionStore.reset()\n\t\t\t} catch (e) {\n\t\t\t\tlogger.error('Error while executing action', { action, e })\n\t\t\t\tshowError(this.t('files', '\"{displayName}\" action failed', { displayName }))\n\t\t\t} finally {\n\t\t\t\t// Remove loading markers\n\t\t\t\tthis.loading = null\n\t\t\t\tthis.nodes.forEach(node => {\n\t\t\t\t\tVue.set(node, 'status', undefined)\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\n\t\tt: translate,\n\t},\n})\n</script>\n\n<style scoped lang=\"scss\">\n.files-list__row-actions-batch {\n\tflex: 1 1 100% !important;\n\tmax-width: 100%;\n}\n</style>\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license AGPL-3.0-or-later\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<VirtualList ref=\"table\"\n\t\t:data-component=\"userConfig.grid_view ? FileEntryGrid : FileEntry\"\n\t\t:data-key=\"'source'\"\n\t\t:data-sources=\"nodes\"\n\t\t:grid-mode=\"userConfig.grid_view\"\n\t\t:extra-props=\"{\n\t\t\tisMtimeAvailable,\n\t\t\tisSizeAvailable,\n\t\t\tnodes,\n\t\t\tfilesListWidth,\n\t\t}\"\n\t\t:scroll-to-index=\"scrollToIndex\"\n\t\t:caption=\"caption\">\n\t\t<template v-if=\"!isNoneSelected\" #header-overlay>\n\t\t\t<span class=\"files-list__selected\">{{ t('files', '{count} selected', { count: selectedNodes.length }) }}</span>\n\t\t\t<FilesListTableHeaderActions :current-view=\"currentView\"\n\t\t\t\t:selected-nodes=\"selectedNodes\" />\n\t\t</template>\n\n\t\t<template #before>\n\t\t\t<!-- Headers -->\n\t\t\t<FilesListHeader v-for=\"header in sortedHeaders\"\n\t\t\t\t:key=\"header.id\"\n\t\t\t\t:current-folder=\"currentFolder\"\n\t\t\t\t:current-view=\"currentView\"\n\t\t\t\t:header=\"header\" />\n\t\t</template>\n\n\t\t<!-- Thead-->\n\t\t<template #header>\n\t\t\t<!-- Table header and sort buttons -->\n\t\t\t<FilesListTableHeader ref=\"thead\"\n\t\t\t\t:files-list-width=\"filesListWidth\"\n\t\t\t\t:is-mtime-available=\"isMtimeAvailable\"\n\t\t\t\t:is-size-available=\"isSizeAvailable\"\n\t\t\t\t:nodes=\"nodes\" />\n\t\t</template>\n\n\t\t<!-- Tfoot-->\n\t\t<template #footer>\n\t\t\t<FilesListTableFooter :files-list-width=\"filesListWidth\"\n\t\t\t\t:is-mtime-available=\"isMtimeAvailable\"\n\t\t\t\t:is-size-available=\"isSizeAvailable\"\n\t\t\t\t:nodes=\"nodes\"\n\t\t\t\t:summary=\"summary\" />\n\t\t</template>\n\t</VirtualList>\n</template>\n\n<script lang=\"ts\">\nimport type { Node as NcNode } from '@nextcloud/files'\nimport type { PropType } from 'vue'\nimport type { UserConfig } from '../types'\n\nimport { getFileListHeaders, Folder, View, getFileActions, FileType } from '@nextcloud/files'\nimport { showError } from '@nextcloud/dialogs'\nimport { loadState } from '@nextcloud/initial-state'\nimport { translate as t, translatePlural as n } from '@nextcloud/l10n'\nimport { defineComponent } from 'vue'\n\nimport { action as sidebarAction } from '../actions/sidebarAction.ts'\nimport { getSummaryFor } from '../utils/fileUtils'\nimport { useSelectionStore } from '../store/selection.js'\nimport { useUserConfigStore } from '../store/userconfig.ts'\n\nimport FileEntry from './FileEntry.vue'\nimport FileEntryGrid from './FileEntryGrid.vue'\nimport FilesListHeader from './FilesListHeader.vue'\nimport FilesListTableFooter from './FilesListTableFooter.vue'\nimport FilesListTableHeader from './FilesListTableHeader.vue'\nimport filesListWidthMixin from '../mixins/filesListWidth.ts'\nimport VirtualList from './VirtualList.vue'\nimport logger from '../logger.js'\nimport FilesListTableHeaderActions from './FilesListTableHeaderActions.vue'\n\nexport default defineComponent({\n\tname: 'FilesListVirtual',\n\n\tcomponents: {\n\t\tFilesListHeader,\n\t\tFilesListTableFooter,\n\t\tFilesListTableHeader,\n\t\tVirtualList,\n\t\tFilesListTableHeaderActions,\n\t},\n\n\tmixins: [\n\t\tfilesListWidthMixin,\n\t],\n\n\tprops: {\n\t\tcurrentView: {\n\t\t\ttype: View,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentFolder: {\n\t\t\ttype: Folder,\n\t\t\trequired: true,\n\t\t},\n\t\tnodes: {\n\t\t\ttype: Array as PropType<NcNode[]>,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tsetup() {\n\t\tconst userConfigStore = useUserConfigStore()\n\t\tconst selectionStore = useSelectionStore()\n\t\treturn {\n\t\t\tuserConfigStore,\n\t\t\tselectionStore,\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tFileEntry,\n\t\t\tFileEntryGrid,\n\t\t\theaders: getFileListHeaders(),\n\t\t\tscrollToIndex: 0,\n\t\t\topenFileId: null as number|null,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tuserConfig(): UserConfig {\n\t\t\treturn this.userConfigStore.userConfig\n\t\t},\n\n\t\tfileId() {\n\t\t\treturn parseInt(this.$route.params.fileid) || null\n\t\t},\n\n\t\t/**\n\t\t * If the current `fileId` should be opened\n\t\t * The state of the `openfile` query param\n\t\t */\n\t\topenFile() {\n\t\t\treturn !!this.$route.query.openfile\n\t\t},\n\n\t\tsummary() {\n\t\t\treturn getSummaryFor(this.nodes)\n\t\t},\n\n\t\tisMtimeAvailable() {\n\t\t\t// Hide mtime column on narrow screens\n\t\t\tif (this.filesListWidth < 768) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t\treturn this.nodes.some(node => node.mtime !== undefined)\n\t\t},\n\t\tisSizeAvailable() {\n\t\t\t// Hide size column on narrow screens\n\t\t\tif (this.filesListWidth < 768) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t\treturn this.nodes.some(node => node.attributes.size !== undefined)\n\t\t},\n\n\t\tsortedHeaders() {\n\t\t\tif (!this.currentFolder || !this.currentView) {\n\t\t\t\treturn []\n\t\t\t}\n\n\t\t\treturn [...this.headers].sort((a, b) => a.order - b.order)\n\t\t},\n\n\t\tcaption() {\n\t\t\tconst defaultCaption = t('files', 'List of files and folders.')\n\t\t\tconst viewCaption = this.currentView.caption || defaultCaption\n\t\t\tconst sortableCaption = t('files', 'Column headers with buttons are sortable.')\n\t\t\tconst virtualListNote = t('files', 'This list is not fully rendered for performance reasons. The files will be rendered as you navigate through the list.')\n\t\t\treturn `${viewCaption}\\n${sortableCaption}\\n${virtualListNote}`\n\t\t},\n\n\t\tselectedNodes() {\n\t\t\treturn this.selectionStore.selected\n\t\t},\n\n\t\tisNoneSelected() {\n\t\t\treturn this.selectedNodes.length === 0\n\t\t},\n\t},\n\n\twatch: {\n\t\tfileId(fileId) {\n\t\t\tthis.scrollToFile(fileId, false)\n\t\t},\n\n\t\topenFile(open: boolean) {\n\t\t\tif (open) {\n\t\t\t\tthis.$nextTick(() => this.handleOpenFile(this.fileId))\n\t\t\t}\n\t\t},\n\t},\n\n\tmounted() {\n\t\t// Add events on parent to cover both the table and DragAndDrop notice\n\t\tconst mainContent = window.document.querySelector('main.app-content') as HTMLElement\n\t\tmainContent.addEventListener('dragover', this.onDragOver)\n\n\t\t// handle initially opening a given file\n\t\tconst { id } = loadState<{ id?: number }>('files', 'openFileInfo', {})\n\t\tthis.scrollToFile(id ?? this.fileId)\n\t\tthis.openSidebarForFile(id ?? this.fileId)\n\t\tthis.handleOpenFile(id ?? null)\n\t},\n\n\tbeforeDestroy() {\n\t\tconst mainContent = window.document.querySelector('main.app-content') as HTMLElement\n\t\tmainContent.removeEventListener('dragover', this.onDragOver)\n\t},\n\n\tmethods: {\n\t\t// Open the file sidebar if we have the room for it\n\t\t// but don't open the sidebar for the current folder\n\t\topenSidebarForFile(fileId) {\n\t\t\tif (document.documentElement.clientWidth > 1024 && this.currentFolder.fileid !== fileId) {\n\t\t\t\t// Open the sidebar for the given URL fileid\n\t\t\t\t// iif we just loaded the app.\n\t\t\t\tconst node = this.nodes.find(n => n.fileid === fileId) as NcNode\n\t\t\t\tif (node && sidebarAction?.enabled?.([node], this.currentView)) {\n\t\t\t\t\tlogger.debug('Opening sidebar on file ' + node.path, { node })\n\t\t\t\t\tsidebarAction.exec(node, this.currentView, this.currentFolder.path)\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tscrollToFile(fileId: number|null, warn = true) {\n\t\t\tif (fileId) {\n\t\t\t\tconst index = this.nodes.findIndex(node => node.fileid === fileId)\n\t\t\t\tif (warn && index === -1 && fileId !== this.currentFolder.fileid) {\n\t\t\t\t\tshowError(this.t('files', 'File not found'))\n\t\t\t\t}\n\t\t\t\tthis.scrollToIndex = Math.max(0, index)\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Handle opening a file (e.g. by ?openfile=true)\n\t\t * @param fileId File to open\n\t\t */\n\t\thandleOpenFile(fileId: number|null) {\n\t\t\tif (fileId === null || this.openFileId === fileId) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconst node = this.nodes.find(n => n.fileid === fileId) as NcNode\n\t\t\tif (node === undefined || node.type === FileType.Folder) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tlogger.debug('Opening file ' + node.path, { node })\n\t\t\tthis.openFileId = fileId\n\t\t\tgetFileActions()\n\t\t\t\t.filter(action => !action.enabled || action.enabled([node], this.currentView))\n\t\t\t\t.sort((a, b) => (a.order || 0) - (b.order || 0))\n\t\t\t\t.filter(action => !!action?.default)[0].exec(node, this.currentView, this.currentFolder.path)\n\t\t},\n\n\t\tgetFileId(node) {\n\t\t\treturn node.fileid\n\t\t},\n\n\t\tonDragOver(event: DragEvent) {\n\t\t\t// Detect if we're only dragging existing files or not\n\t\t\tconst isForeignFile = event.dataTransfer?.types.includes('Files')\n\t\t\tif (isForeignFile) {\n\t\t\t\t// Only handle uploading of existing Nextcloud files\n\t\t\t\t// See DragAndDropNotice for handling of foreign files\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tevent.preventDefault()\n\t\t\tevent.stopPropagation()\n\n\t\t\tconst tableTop = this.$refs.table.$el.getBoundingClientRect().top\n\t\t\tconst tableBottom = tableTop + this.$refs.table.$el.getBoundingClientRect().height\n\n\t\t\t// If reaching top, scroll up. Using 100 because of the floating header\n\t\t\tif (event.clientY < tableTop + 100) {\n\t\t\t\tthis.$refs.table.$el.scrollTop = this.$refs.table.$el.scrollTop - 25\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// If reaching bottom, scroll down\n\t\t\tif (event.clientY > tableBottom - 50) {\n\t\t\t\tthis.$refs.table.$el.scrollTop = this.$refs.table.$el.scrollTop + 25\n\t\t\t}\n\t\t},\n\n\t\tt,\n\t},\n})\n</script>\n\n<style scoped lang=\"scss\">\n.files-list {\n\t--row-height: 55px;\n\t--cell-margin: 14px;\n\n\t--checkbox-padding: calc((var(--row-height) - var(--checkbox-size)) / 2);\n\t--checkbox-size: 24px;\n\t--clickable-area: 44px;\n\t--icon-preview-size: 32px;\n\n\toverflow: auto;\n\theight: 100%;\n\twill-change: scroll-position;\n\n\t& :deep() {\n\t\t// Table head, body and footer\n\t\ttbody {\n\t\t\twill-change: padding;\n\t\t\tcontain: layout paint style;\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\twidth: 100%;\n\t\t\t// Necessary for virtual scrolling absolute\n\t\t\tposition: relative;\n\n\t\t\t/* Hover effect on tbody lines only */\n\t\t\ttr {\n\t\t\t\tcontain: strict;\n\t\t\t\t&:hover,\n\t\t\t\t&:focus {\n\t\t\t\t\tbackground-color: var(--color-background-dark);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Before table and thead\n\t\t.files-list__before {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t}\n\n\t\t.files-list__selected {\n\t\t\tpadding-right: 12px;\n\t\t\twhite-space: nowrap;\n\t\t}\n\n\t\t.files-list__table {\n\t\t\tdisplay: block;\n\n\t\t\t&.files-list__table--with-thead-overlay {\n\t\t\t\t// Hide the table header below the overlay\n\t\t\t\tmargin-top: calc(-1 * var(--row-height));\n\t\t\t}\n\t\t}\n\n\t\t.files-list__thead-overlay {\n\t\t\t// Pinned on top when scrolling\n\t\t\tposition: sticky;\n\t\t\ttop: 0;\n\t\t\t// Save space for a row checkbox\n\t\t\tmargin-left: var(--row-height);\n\t\t\t// More than .files-list__thead\n\t\t\tz-index: 20;\n\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\n\t\t\t// Reuse row styles\n\t\t\tbackground-color: var(--color-main-background);\n\t\t\tborder-bottom: 1px solid var(--color-border);\n\t\t\theight: var(--row-height);\n\t\t}\n\n\t\t.files-list__thead,\n\t\t.files-list__tfoot {\n\t\t\tdisplay: flex;\n\t\t\tflex-direction: column;\n\t\t\twidth: 100%;\n\t\t\tbackground-color: var(--color-main-background);\n\n\t\t}\n\n\t\t// Table header\n\t\t.files-list__thead {\n\t\t\t// Pinned on top when scrolling\n\t\t\tposition: sticky;\n\t\t\tz-index: 10;\n\t\t\ttop: 0;\n\t\t}\n\n\t\t// Table footer\n\t\t.files-list__tfoot {\n\t\t\tmin-height: 300px;\n\t\t}\n\n\t\ttr {\n\t\t\tposition: relative;\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\twidth: 100%;\n\t\t\tuser-select: none;\n\t\t\tborder-bottom: 1px solid var(--color-border);\n\t\t\tbox-sizing: border-box;\n\t\t\tuser-select: none;\n\t\t\theight: var(--row-height);\n\t\t}\n\n\t\ttd, th {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t\tflex: 0 0 auto;\n\t\t\tjustify-content: left;\n\t\t\twidth: var(--row-height);\n\t\t\theight: var(--row-height);\n\t\t\tmargin: 0;\n\t\t\tpadding: 0;\n\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t\tborder: none;\n\n\t\t\t// Columns should try to add any text\n\t\t\t// node wrapped in a span. That should help\n\t\t\t// with the ellipsis on overflow.\n\t\t\tspan {\n\t\t\t\toverflow: hidden;\n\t\t\t\twhite-space: nowrap;\n\t\t\t\ttext-overflow: ellipsis;\n\t\t\t}\n\t\t}\n\n\t\t.files-list__row--failed {\n\t\t\tposition: absolute;\n\t\t\tdisplay: block;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t\tright: 0;\n\t\t\tbottom: 0;\n\t\t\topacity: .1;\n\t\t\tz-index: -1;\n\t\t\tbackground: var(--color-error);\n\t\t}\n\n\t\t.files-list__row-checkbox {\n\t\t\tjustify-content: center;\n\n\t\t\t.checkbox-radio-switch {\n\t\t\t\tdisplay: flex;\n\t\t\t\tjustify-content: center;\n\n\t\t\t\t--icon-size: var(--checkbox-size);\n\n\t\t\t\tlabel.checkbox-radio-switch__label {\n\t\t\t\t\twidth: var(--clickable-area);\n\t\t\t\t\theight: var(--clickable-area);\n\t\t\t\t\tmargin: 0;\n\t\t\t\t\tpadding: calc((var(--clickable-area) - var(--checkbox-size)) / 2);\n\t\t\t\t}\n\n\t\t\t\t.checkbox-radio-switch__icon {\n\t\t\t\t\tmargin: 0 !important;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.files-list__row {\n\t\t\t&:hover, &:focus, &:active, &--active, &--dragover {\n\t\t\t\t// WCAG AA compliant\n\t\t\t\tbackground-color: var(--color-background-hover);\n\t\t\t\t// text-maxcontrast have been designed to pass WCAG AA over\n\t\t\t\t// a white background, we need to adjust then.\n\t\t\t\t--color-text-maxcontrast: var(--color-main-text);\n\t\t\t\t> * {\n\t\t\t\t\t--color-border: var(--color-border-dark);\n\t\t\t\t}\n\n\t\t\t\t// Hover state of the row should also change the favorite markers background\n\t\t\t\t.favorite-marker-icon svg path {\n\t\t\t\t\tstroke: var(--color-background-hover);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t&--dragover * {\n\t\t\t\t// Prevent dropping on row children\n\t\t\t\tpointer-events: none;\n\t\t\t}\n\t\t}\n\n\t\t// Entry preview or mime icon\n\t\t.files-list__row-icon {\n\t\t\tposition: relative;\n\t\t\tdisplay: flex;\n\t\t\toverflow: visible;\n\t\t\talign-items: center;\n\t\t\t// No shrinking or growing allowed\n\t\t\tflex: 0 0 var(--icon-preview-size);\n\t\t\tjustify-content: center;\n\t\t\twidth: var(--icon-preview-size);\n\t\t\theight: 100%;\n\t\t\t// Show same padding as the checkbox right padding for visual balance\n\t\t\tmargin-right: var(--checkbox-padding);\n\t\t\tcolor: var(--color-primary-element);\n\n\t\t\t// Icon is also clickable\n\t\t\t* {\n\t\t\t\tcursor: pointer;\n\t\t\t}\n\n\t\t\t& > span {\n\t\t\t\tjustify-content: flex-start;\n\n\t\t\t\t&:not(.files-list__row-icon-favorite) svg {\n\t\t\t\t\twidth: var(--icon-preview-size);\n\t\t\t\t\theight: var(--icon-preview-size);\n\t\t\t\t}\n\n\t\t\t\t// Slightly increase the size of the folder icon\n\t\t\t\t&.folder-icon,\n\t\t\t\t&.folder-open-icon {\n\t\t\t\t\tmargin: -3px;\n\t\t\t\t\tsvg {\n\t\t\t\t\t\twidth: calc(var(--icon-preview-size) + 6px);\n\t\t\t\t\t\theight: calc(var(--icon-preview-size) + 6px);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t&-preview {\n\t\t\t\toverflow: hidden;\n\t\t\t\twidth: var(--icon-preview-size);\n\t\t\t\theight: var(--icon-preview-size);\n\t\t\t\tborder-radius: var(--border-radius);\n\t\t\t\t// Center and contain the preview\n\t\t\t\tobject-fit: contain;\n\t\t\t\tobject-position: center;\n\n\t\t\t\t/* Preview not loaded animation effect */\n\t\t\t\t&:not(.files-list__row-icon-preview--loaded) {\n\t\t\t\t\tbackground: var(--color-loading-dark);\n\t\t\t\t\t// animation: preview-gradient-fade 1.2s ease-in-out infinite;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t&-favorite {\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 0px;\n\t\t\t\tright: -10px;\n\t\t\t}\n\n\t\t\t// File and folder overlay\n\t\t\t&-overlay {\n\t\t\t\tposition: absolute;\n\t\t\t\tmax-height: calc(var(--icon-preview-size) * 0.5);\n\t\t\t\tmax-width: calc(var(--icon-preview-size) * 0.5);\n\t\t\t\tcolor: var(--color-primary-element-text);\n\t\t\t\t// better alignment with the folder icon\n\t\t\t\tmargin-top: 2px;\n\n\t\t\t\t// Improve icon contrast with a background for files\n\t\t\t\t&--file {\n\t\t\t\t\tcolor: var(--color-main-text);\n\t\t\t\t\tbackground: var(--color-main-background);\n\t\t\t\t\tborder-radius: 100%;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Entry link\n\t\t.files-list__row-name {\n\t\t\t// Prevent link from overflowing\n\t\t\toverflow: hidden;\n\t\t\t// Take as much space as possible\n\t\t\tflex: 1 1 auto;\n\n\t\t\ta {\n\t\t\t\tdisplay: flex;\n\t\t\t\talign-items: center;\n\t\t\t\t// Fill cell height and width\n\t\t\t\twidth: 100%;\n\t\t\t\theight: 100%;\n\t\t\t\t// Necessary for flex grow to work\n\t\t\t\tmin-width: 0;\n\n\t\t\t\t// Already added to the inner text, see rule below\n\t\t\t\t&:focus-visible {\n\t\t\t\t\toutline: none;\n\t\t\t\t}\n\n\t\t\t\t// Keyboard indicator a11y\n\t\t\t\t&:focus .files-list__row-name-text {\n\t\t\t\t\toutline: 2px solid var(--color-main-text) !important;\n\t\t\t\t\tborder-radius: 20px;\n\t\t\t\t}\n\t\t\t\t&:focus:not(:focus-visible) .files-list__row-name-text {\n\t\t\t\t\toutline: none !important;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.files-list__row-name-text {\n\t\t\t\tcolor: var(--color-main-text);\n\t\t\t\t// Make some space for the outline\n\t\t\t\tpadding: 5px 10px;\n\t\t\t\tmargin-left: -10px;\n\t\t\t\t// Align two name and ext\n\t\t\t\tdisplay: inline-flex;\n\t\t\t}\n\n\t\t\t.files-list__row-name-ext {\n\t\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t\t\t// always show the extension\n\t\t\t\toverflow: visible;\n\t\t\t}\n\t\t}\n\n\t\t// Rename form\n\t\t.files-list__row-rename {\n\t\t\twidth: 100%;\n\t\t\tmax-width: 600px;\n\t\t\tinput {\n\t\t\t\twidth: 100%;\n\t\t\t\t// Align with text, 0 - padding - border\n\t\t\t\tmargin-left: -8px;\n\t\t\t\tpadding: 2px 6px;\n\t\t\t\tborder-width: 2px;\n\n\t\t\t\t&:invalid {\n\t\t\t\t\t// Show red border on invalid input\n\t\t\t\t\tborder-color: var(--color-error);\n\t\t\t\t\tcolor: red;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.files-list__row-actions {\n\t\t\t// take as much space as necessary\n\t\t\twidth: auto;\n\n\t\t\t// Add margin to all cells after the actions\n\t\t\t& ~ td,\n\t\t\t& ~ th {\n\t\t\t\tmargin: 0 var(--cell-margin);\n\t\t\t}\n\n\t\t\tbutton {\n\t\t\t\t.button-vue__text {\n\t\t\t\t\t// Remove bold from default button styling\n\t\t\t\t\tfont-weight: normal;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t.files-list__row-action--inline {\n\t\t\tmargin-right: 7px;\n\t\t}\n\n\t\t.files-list__row-mtime,\n\t\t.files-list__row-size {\n\t\t\tcolor: var(--color-text-maxcontrast);\n\t\t}\n\t\t.files-list__row-size {\n\t\t\twidth: calc(var(--row-height) * 1.5);\n\t\t\t// Right align content/text\n\t\t\tjustify-content: flex-end;\n\t\t}\n\n\t\t.files-list__row-mtime {\n\t\t\twidth: calc(var(--row-height) * 2);\n\t\t}\n\n\t\t.files-list__row-column-custom {\n\t\t\twidth: calc(var(--row-height) * 2);\n\t\t}\n\t}\n}\n</style>\n\n<style lang=\"scss\">\n// Grid mode\ntbody.files-list__tbody.files-list__tbody--grid {\n\t--half-clickable-area: calc(var(--clickable-area) / 2);\n\t--row-width: 160px;\n\t// We use half of the clickable area as visual balance margin\n\t--row-height: calc(var(--row-width) - var(--half-clickable-area));\n\t--icon-preview-size: calc(var(--row-width) - var(--clickable-area));\n\t--checkbox-padding: 0px;\n\n\tdisplay: grid;\n\tgrid-template-columns: repeat(auto-fill, var(--row-width));\n\tgrid-gap: 15px;\n\trow-gap: 15px;\n\n\talign-content: center;\n\talign-items: center;\n\tjustify-content: space-around;\n\tjustify-items: center;\n\n\ttr {\n\t\twidth: var(--row-width);\n\t\theight: calc(var(--row-height) + var(--clickable-area));\n\t\tborder: none;\n\t\tborder-radius: var(--border-radius);\n\t}\n\n\t// Checkbox in the top left\n\t.files-list__row-checkbox {\n\t\tposition: absolute;\n\t\tz-index: 9;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\toverflow: hidden;\n\t\twidth: var(--clickable-area);\n\t\theight: var(--clickable-area);\n\t\tborder-radius: var(--half-clickable-area);\n\t}\n\n\t// Star icon in the top right\n\t.files-list__row-icon-favorite {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tright: 0;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\twidth: var(--clickable-area);\n\t\theight: var(--clickable-area);\n\t}\n\n\t.files-list__row-name {\n\t\tdisplay: grid;\n\t\tjustify-content: stretch;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tgrid-auto-rows: var(--row-height) var(--clickable-area);\n\n\t\tspan.files-list__row-icon {\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\t// Visual balance, we use half of the clickable area\n\t\t\t// as a margin around the preview\n\t\t\tpadding-top: var(--half-clickable-area);\n\t\t}\n\n\t\ta.files-list__row-name-link {\n\t\t\t// Minus action menu\n\t\t\twidth: calc(100% - var(--clickable-area));\n\t\t\theight: var(--clickable-area);\n\t\t}\n\n\t\t.files-list__row-name-text {\n\t\t\tmargin: 0;\n\t\t\tpadding-right: 0;\n\t\t}\n\t}\n\n\t.files-list__row-actions {\n\t\tposition: absolute;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\twidth: var(--clickable-area);\n\t\theight: var(--clickable-area);\n\t}\n}\n</style>\n","<!--\n\t- @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n\t-\n\t- @author John Molakvoæ <skjnldsv@protonmail.com>\n\t- @author Ferdinand Thiessen <opensource@fthiessen.de>\n\t-\n\t- @license AGPL-3.0-or-later\n\t-\n\t- This program is free software: you can redistribute it and/or modify\n\t- it under the terms of the GNU Affero General Public License as\n\t- published by the Free Software Foundation, either version 3 of the\n\t- License, or (at your option) any later version.\n\t-\n\t- This program is distributed in the hope that it will be useful,\n\t- but WITHOUT ANY WARRANTY; without even the implied warranty of\n\t- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n\t- GNU Affero General Public License for more details.\n\t-\n\t- You should have received a copy of the GNU Affero General Public License\n\t- along with this program. If not, see <http://www.gnu.org/licenses/>.\n\t-\n\t-->\n<template>\n\t<div v-show=\"dragover\"\n\t\tdata-cy-files-drag-drop-area\n\t\tclass=\"files-list__drag-drop-notice\"\n\t\t@drop=\"onDrop\">\n\t\t<div class=\"files-list__drag-drop-notice-wrapper\">\n\t\t\t<template v-if=\"canUpload && !isQuotaExceeded\">\n\t\t\t\t<TrayArrowDownIcon :size=\"48\" />\n\t\t\t\t<h3 class=\"files-list-drag-drop-notice__title\">\n\t\t\t\t\t{{ t('files', 'Drag and drop files here to upload') }}\n\t\t\t\t</h3>\n\t\t\t</template>\n\n\t\t\t<!-- Not permitted to drop files here -->\n\t\t\t<template v-else>\n\t\t\t\t<h3 class=\"files-list-drag-drop-notice__title\">\n\t\t\t\t\t{{ cantUploadLabel }}\n\t\t\t\t</h3>\n\t\t\t</template>\n\t\t</div>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\nimport { Folder, Permission } from '@nextcloud/files'\nimport { showError } from '@nextcloud/dialogs'\nimport { translate as t } from '@nextcloud/l10n'\nimport { UploadStatus } from '@nextcloud/upload'\n\nimport TrayArrowDownIcon from 'vue-material-design-icons/TrayArrowDown.vue'\n\nimport logger from '../logger.js'\nimport { dataTransferToFileTree, onDropExternalFiles } from '../services/DropService'\n\nexport default defineComponent({\n\tname: 'DragAndDropNotice',\n\n\tcomponents: {\n\t\tTrayArrowDownIcon,\n\t},\n\n\tprops: {\n\t\tcurrentFolder: {\n\t\t\ttype: Folder,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tdragover: false,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tcurrentView() {\n\t\t\treturn this.$navigation.active\n\t\t},\n\n\t\t/**\n\t\t * Check if the current folder has create permissions\n\t\t */\n\t\tcanUpload() {\n\t\t\treturn this.currentFolder && (this.currentFolder.permissions & Permission.CREATE) !== 0\n\t\t},\n\t\tisQuotaExceeded() {\n\t\t\treturn this.currentFolder?.attributes?.['quota-available-bytes'] === 0\n\t\t},\n\n\t\tcantUploadLabel() {\n\t\t\tif (this.isQuotaExceeded) {\n\t\t\t\treturn this.t('files', 'Your have used your space quota and cannot upload files anymore')\n\t\t\t} else if (!this.canUpload) {\n\t\t\t\treturn this.t('files', 'You don’t have permission to upload or create files here')\n\t\t\t}\n\t\t\treturn null\n\t\t},\n\t},\n\n\tmounted() {\n\t\t// Add events on parent to cover both the table and DragAndDrop notice\n\t\tconst mainContent = window.document.querySelector('main.app-content') as HTMLElement\n\t\tmainContent.addEventListener('dragover', this.onDragOver)\n\t\tmainContent.addEventListener('dragleave', this.onDragLeave)\n\t\tmainContent.addEventListener('drop', this.onContentDrop)\n\t},\n\n\tbeforeDestroy() {\n\t\tconst mainContent = window.document.querySelector('main.app-content') as HTMLElement\n\t\tmainContent.removeEventListener('dragover', this.onDragOver)\n\t\tmainContent.removeEventListener('dragleave', this.onDragLeave)\n\t\tmainContent.removeEventListener('drop', this.onContentDrop)\n\t},\n\n\tmethods: {\n\t\tonDragOver(event: DragEvent) {\n\t\t\t// Needed to keep the drag/drop events chain working\n\t\t\tevent.preventDefault()\n\n\t\t\tconst isForeignFile = event.dataTransfer?.types.includes('Files')\n\t\t\tif (isForeignFile) {\n\t\t\t\t// Only handle uploading of outside files (not Nextcloud files)\n\t\t\t\tthis.dragover = true\n\t\t\t}\n\t\t},\n\n\t\tonDragLeave(event: DragEvent) {\n\t\t\t// Counter bubbling, make sure we're ending the drag\n\t\t\t// only when we're leaving the current element\n\t\t\t// Avoid flickering\n\t\t\tconst currentTarget = event.currentTarget as HTMLElement\n\t\t\tif (currentTarget?.contains((event.relatedTarget ?? event.target) as HTMLElement)) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (this.dragover) {\n\t\t\t\tthis.dragover = false\n\t\t\t}\n\t\t},\n\n\t\tonContentDrop(event: DragEvent) {\n\t\t\tlogger.debug('Drag and drop cancelled, dropped on empty space', { event })\n\t\t\tevent.preventDefault()\n\t\t\tif (this.dragover) {\n\t\t\t\tthis.dragover = false\n\t\t\t}\n\t\t},\n\n\t\tasync onDrop(event: DragEvent) {\n\t\t\t// cantUploadLabel is null if we can upload\n\t\t\tif (this.cantUploadLabel) {\n\t\t\t\tshowError(this.cantUploadLabel)\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (this.$el.querySelector('tbody')?.contains(event.target as Node)) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tevent.preventDefault()\n\t\t\tevent.stopPropagation()\n\n\t\t\t// Caching the selection\n\t\t\tconst items: DataTransferItem[] = [...event.dataTransfer?.items || []]\n\n\t\t\t// We need to process the dataTransfer ASAP before the\n\t\t\t// browser clears it. This is why we cache the items too.\n\t\t\tconst fileTree = await dataTransferToFileTree(items)\n\n\t\t\t// We might not have the target directory fetched yet\n\t\t\tconst contents = await this.currentView?.getContents(this.currentFolder.path)\n\t\t\tconst folder = contents?.folder\n\t\t\tif (!folder) {\n\t\t\t\tshowError(this.t('files', 'Target folder does not exist any more'))\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// If another button is pressed, cancel it. This\n\t\t\t// allows cancelling the drag with the right click.\n\t\t\tif (event.button) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tlogger.debug('Dropped', { event, folder, fileTree })\n\n\t\t\t// Check whether we're uploading files\n\t\t\tconst uploads = await onDropExternalFiles(fileTree, folder, contents.contents)\n\n\t\t\t// Scroll to last successful upload in current directory if terminated\n\t\t\tconst lastUpload = uploads.findLast((upload) => upload.status !== UploadStatus.FAILED\n\t\t\t\t&& !upload.file.webkitRelativePath.includes('/')\n\t\t\t\t&& upload.response?.headers?.['oc-fileid']\n\t\t\t\t// Only use the last ID if it's in the current folder\n\t\t\t\t&& upload.source.replace(folder.source, '').split('/').length === 2)\n\n\t\t\tif (lastUpload !== undefined) {\n\t\t\t\tlogger.debug('Scrolling to last upload in current folder', { lastUpload })\n\t\t\t\tthis.$router.push({\n\t\t\t\t\t...this.$route,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tview: this.$route.params?.view ?? 'files',\n\t\t\t\t\t\tfileid: parseInt(lastUpload.response!.headers['oc-fileid']),\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tthis.dragover = false\n\t\t},\n\n\t\tt,\n\t},\n})\n</script>\n\n<style lang=\"scss\" scoped>\n.files-list__drag-drop-notice {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\twidth: 100%;\n\t// Breadcrumbs height + row thead height\n\tmin-height: calc(58px + 55px);\n\tmargin: 0;\n\tuser-select: none;\n\tcolor: var(--color-text-maxcontrast);\n\tbackground-color: var(--color-main-background);\n\tborder-color: black;\n\n\th3 {\n\t\tmargin-left: 16px;\n\t\tcolor: inherit;\n\t}\n\n\t&-wrapper {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\theight: 15vh;\n\t\tmax-height: 70%;\n\t\tpadding: 0 5vw;\n\t\tborder: 2px var(--color-border-dark) dashed;\n\t\tborder-radius: var(--border-radius-large);\n\t}\n}\n\n</style>\n","<!--\n  - @copyright Copyright (c) 2023 John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @author John Molakvoæ <skjnldsv@protonmail.com>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -\n  -->\n<template>\n\t<NcAppContent :page-heading=\"pageHeading\" data-cy-files-content>\n\t\t<div class=\"files-list__header\">\n\t\t\t<!-- Current folder breadcrumbs -->\n\t\t\t<BreadCrumbs :path=\"dir\" @reload=\"fetchContent\">\n\t\t\t\t<template #actions>\n\t\t\t\t\t<!-- Sharing button -->\n\t\t\t\t\t<NcButton v-if=\"canShare && filesListWidth >= 512\"\n\t\t\t\t\t\t:aria-label=\"shareButtonLabel\"\n\t\t\t\t\t\t:class=\"{ 'files-list__header-share-button--shared': shareButtonType }\"\n\t\t\t\t\t\t:title=\"shareButtonLabel\"\n\t\t\t\t\t\tclass=\"files-list__header-share-button\"\n\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t@click=\"openSharingSidebar\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<LinkIcon v-if=\"shareButtonType === Type.SHARE_TYPE_LINK\" />\n\t\t\t\t\t\t\t<AccountPlusIcon v-else :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcButton>\n\n\t\t\t\t\t<!-- Disabled upload button -->\n\t\t\t\t\t<NcButton v-if=\"!canUpload || isQuotaExceeded\"\n\t\t\t\t\t\t:aria-label=\"cantUploadLabel\"\n\t\t\t\t\t\t:title=\"cantUploadLabel\"\n\t\t\t\t\t\tclass=\"files-list__header-upload-button--disabled\"\n\t\t\t\t\t\t:disabled=\"true\"\n\t\t\t\t\t\ttype=\"secondary\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<PlusIcon :size=\"20\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t{{ t('files', 'New') }}\n\t\t\t\t\t</NcButton>\n\n\t\t\t\t\t<!-- Uploader -->\n\t\t\t\t\t<UploadPicker v-else-if=\"currentFolder\"\n\t\t\t\t\t\t:content=\"dirContents\"\n\t\t\t\t\t\t:destination=\"currentFolder\"\n\t\t\t\t\t\t:multiple=\"true\"\n\t\t\t\t\t\tclass=\"files-list__header-upload-button\"\n\t\t\t\t\t\t@failed=\"onUploadFail\"\n\t\t\t\t\t\t@uploaded=\"onUpload\" />\n\t\t\t\t</template>\n\t\t\t</BreadCrumbs>\n\n\t\t\t<NcButton v-if=\"filesListWidth >= 512 && enableGridView\"\n\t\t\t\t:aria-label=\"gridViewButtonLabel\"\n\t\t\t\t:title=\"gridViewButtonLabel\"\n\t\t\t\tclass=\"files-list__header-grid-button\"\n\t\t\t\ttype=\"tertiary\"\n\t\t\t\t@click=\"toggleGridView\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<ListViewIcon v-if=\"userConfig.grid_view\" />\n\t\t\t\t\t<ViewGridIcon v-else />\n\t\t\t\t</template>\n\t\t\t</NcButton>\n\n\t\t\t<!-- Secondary loading indicator -->\n\t\t\t<NcLoadingIcon v-if=\"isRefreshing\" class=\"files-list__refresh-icon\" />\n\t\t</div>\n\n\t\t<!-- Drag and drop notice -->\n\t\t<DragAndDropNotice v-if=\"!loading && canUpload\" :current-folder=\"currentFolder\" />\n\n\t\t<!-- Initial loading -->\n\t\t<NcLoadingIcon v-if=\"loading && !isRefreshing\"\n\t\t\tclass=\"files-list__loading-icon\"\n\t\t\t:size=\"38\"\n\t\t\t:name=\"t('files', 'Loading current folder')\" />\n\n\t\t<!-- Empty content placeholder -->\n\t\t<NcEmptyContent v-else-if=\"!loading && isEmptyDir\"\n\t\t\t:name=\"currentView?.emptyTitle || t('files', 'No files in here')\"\n\t\t\t:description=\"currentView?.emptyCaption || t('files', 'Upload some content or sync with your devices!')\"\n\t\t\tdata-cy-files-content-empty>\n\t\t\t<template #action>\n\t\t\t\t<NcButton v-if=\"dir !== '/'\"\n\t\t\t\t\t:aria-label=\"t('files', 'Go to the previous folder')\"\n\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\t:to=\"toPreviousDir\">\n\t\t\t\t\t{{ t('files', 'Go back') }}\n\t\t\t\t</NcButton>\n\t\t\t</template>\n\t\t\t<template #icon>\n\t\t\t\t<NcIconSvgWrapper :svg=\"currentView.icon\" />\n\t\t\t</template>\n\t\t</NcEmptyContent>\n\n\t\t<!-- File list -->\n\t\t<FilesListVirtual v-else\n\t\t\tref=\"filesListVirtual\"\n\t\t\t:current-folder=\"currentFolder\"\n\t\t\t:current-view=\"currentView\"\n\t\t\t:nodes=\"dirContentsSorted\" />\n\t</NcAppContent>\n</template>\n\n<script lang=\"ts\">\nimport type { Route } from 'vue-router'\nimport type { Upload } from '@nextcloud/upload'\nimport type { UserConfig } from '../types.ts'\nimport type { View, ContentsWithRoot } from '@nextcloud/files'\n\nimport { emit, subscribe, unsubscribe } from '@nextcloud/event-bus'\nimport { Folder, Node, Permission } from '@nextcloud/files'\nimport { getCapabilities } from '@nextcloud/capabilities'\nimport { join, dirname } from 'path'\nimport { orderBy } from 'natural-orderby'\nimport { Parser } from 'xml2js'\nimport { showError } from '@nextcloud/dialogs'\nimport { translate, translatePlural } from '@nextcloud/l10n'\nimport { Type } from '@nextcloud/sharing'\nimport { UploadPicker } from '@nextcloud/upload'\nimport { loadState } from '@nextcloud/initial-state'\nimport { defineComponent } from 'vue'\n\nimport LinkIcon from 'vue-material-design-icons/Link.vue'\nimport ListViewIcon from 'vue-material-design-icons/FormatListBulletedSquare.vue'\nimport NcAppContent from '@nextcloud/vue/dist/Components/NcAppContent.js'\nimport NcButton from '@nextcloud/vue/dist/Components/NcButton.js'\nimport NcEmptyContent from '@nextcloud/vue/dist/Components/NcEmptyContent.js'\nimport NcIconSvgWrapper from '@nextcloud/vue/dist/Components/NcIconSvgWrapper.js'\nimport NcLoadingIcon from '@nextcloud/vue/dist/Components/NcLoadingIcon.js'\nimport PlusIcon from 'vue-material-design-icons/Plus.vue'\nimport AccountPlusIcon from 'vue-material-design-icons/AccountPlus.vue'\nimport ViewGridIcon from 'vue-material-design-icons/ViewGrid.vue'\n\nimport { action as sidebarAction } from '../actions/sidebarAction.ts'\nimport { useFilesStore } from '../store/files.ts'\nimport { usePathsStore } from '../store/paths.ts'\nimport { useSelectionStore } from '../store/selection.ts'\nimport { useUploaderStore } from '../store/uploader.ts'\nimport { useUserConfigStore } from '../store/userconfig.ts'\nimport { useViewConfigStore } from '../store/viewConfig.ts'\nimport BreadCrumbs from '../components/BreadCrumbs.vue'\nimport FilesListVirtual from '../components/FilesListVirtual.vue'\nimport filesListWidthMixin from '../mixins/filesListWidth.ts'\nimport filesSortingMixin from '../mixins/filesSorting.ts'\nimport logger from '../logger.js'\nimport DragAndDropNotice from '../components/DragAndDropNotice.vue'\nimport debounce from 'debounce'\n\nconst isSharingEnabled = (getCapabilities() as { files_sharing?: boolean })?.files_sharing !== undefined\n\nexport default defineComponent({\n\tname: 'FilesList',\n\n\tcomponents: {\n\t\tBreadCrumbs,\n\t\tDragAndDropNotice,\n\t\tFilesListVirtual,\n\t\tLinkIcon,\n\t\tListViewIcon,\n\t\tNcAppContent,\n\t\tNcButton,\n\t\tNcEmptyContent,\n\t\tNcIconSvgWrapper,\n\t\tNcLoadingIcon,\n\t\tPlusIcon,\n\t\tAccountPlusIcon,\n\t\tUploadPicker,\n\t\tViewGridIcon,\n\t},\n\n\tmixins: [\n\t\tfilesListWidthMixin,\n\t\tfilesSortingMixin,\n\t],\n\n\tsetup() {\n\t\tconst filesStore = useFilesStore()\n\t\tconst pathsStore = usePathsStore()\n\t\tconst selectionStore = useSelectionStore()\n\t\tconst uploaderStore = useUploaderStore()\n\t\tconst userConfigStore = useUserConfigStore()\n\t\tconst viewConfigStore = useViewConfigStore()\n\n\t\tconst enableGridView = (loadState('core', 'config', [])['enable_non-accessible_features'] ?? true)\n\n\t\treturn {\n\t\t\tfilesStore,\n\t\t\tpathsStore,\n\t\t\tselectionStore,\n\t\t\tuploaderStore,\n\t\t\tuserConfigStore,\n\t\t\tviewConfigStore,\n\t\t\tenableGridView,\n\t\t}\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tfilterText: '',\n\t\t\tloading: true,\n\t\t\tpromise: null,\n\t\t\tType,\n\n\t\t\t_unsubscribeStore: () => {},\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tuserConfig(): UserConfig {\n\t\t\treturn this.userConfigStore.userConfig\n\t\t},\n\n\t\tcurrentView(): View {\n\t\t\treturn this.$navigation.active || this.$navigation.views.find((view) => view.id === (this.$route.params?.view ?? 'files'))\n\t\t},\n\n\t\tpageHeading(): string {\n\t\t\treturn this.currentView?.name ?? this.t('files', 'Files')\n\t\t},\n\n\t\t/**\n\t\t * The current directory query.\n\t\t */\n\t\tdir(): string {\n\t\t\t// Remove any trailing slash but leave root slash\n\t\t\treturn (this.$route?.query?.dir?.toString() || '/').replace(/^(.+)\\/$/, '$1')\n\t\t},\n\n\t\t/**\n\t\t * The current folder.\n\t\t */\n\t\tcurrentFolder(): Folder | undefined {\n\t\t\tif (!this.currentView?.id) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (this.dir === '/') {\n\t\t\t\treturn this.filesStore.getRoot(this.currentView.id)\n\t\t\t}\n\t\t\tconst fileId = this.pathsStore.getPath(this.currentView.id, this.dir)\n\t\t\treturn this.filesStore.getNode(fileId)\n\t\t},\n\n\t\t/**\n\t\t * Directory content sorting parameters\n\t\t * Provided by an extra computed property for caching\n\t\t */\n\t\tsortingParameters() {\n\t\t\tconst identifiers = [\n\t\t\t\t// 1: Sort favorites first if enabled\n\t\t\t\t...(this.userConfig.sort_favorites_first ? [v => v.attributes?.favorite !== 1] : []),\n\t\t\t\t// 2: Sort folders first if sorting by name\n\t\t\t\t...(this.userConfig.sort_folders_first ? [v => v.type !== 'folder'] : []),\n\t\t\t\t// 3: Use sorting mode if NOT basename (to be able to use displayName too)\n\t\t\t\t...(this.sortingMode !== 'basename' ? [v => v[this.sortingMode]] : []),\n\t\t\t\t// 4: Use displayName if available, fallback to name\n\t\t\t\tv => v.attributes?.displayName || v.basename,\n\t\t\t\t// 5: Finally, use basename if all previous sorting methods failed\n\t\t\t\tv => v.basename,\n\t\t\t]\n\t\t\tconst orders = [\n\t\t\t\t// (for 1): always sort favorites before normal files\n\t\t\t\t...(this.userConfig.sort_favorites_first ? ['asc'] : []),\n\t\t\t\t// (for 2): always sort folders before files\n\t\t\t\t...(this.userConfig.sort_folders_first ? ['asc'] : []),\n\t\t\t\t// (for 3): Reverse if sorting by mtime as mtime higher means edited more recent -> lower\n\t\t\t\t...(this.sortingMode === 'mtime' ? [this.isAscSorting ? 'desc' : 'asc'] : []),\n\t\t\t\t// (also for 3 so make sure not to conflict with 2 and 3)\n\t\t\t\t...(this.sortingMode !== 'mtime' && this.sortingMode !== 'basename' ? [this.isAscSorting ? 'asc' : 'desc'] : []),\n\t\t\t\t// for 4: use configured sorting direction\n\t\t\t\tthis.isAscSorting ? 'asc' : 'desc',\n\t\t\t\t// for 5: use configured sorting direction\n\t\t\t\tthis.isAscSorting ? 'asc' : 'desc',\n\t\t\t]\n\t\t\treturn [identifiers, orders] as const\n\t\t},\n\n\t\t/**\n\t\t * The current directory contents.\n\t\t */\n\t\tdirContentsSorted(): Node[] {\n\t\t\tif (!this.currentView) {\n\t\t\t\treturn []\n\t\t\t}\n\n\t\t\tlet filteredDirContent = [...this.dirContents]\n\t\t\t// Filter based on the filterText obtained from nextcloud:unified-search.search event.\n\t\t\tif (this.filterText) {\n\t\t\t\tfilteredDirContent = filteredDirContent.filter(node => {\n\t\t\t\t\treturn node.attributes.basename.toLowerCase().includes(this.filterText.toLowerCase())\n\t\t\t\t})\n\t\t\t\tconsole.debug('Files view filtered', filteredDirContent)\n\t\t\t}\n\n\t\t\tconst customColumn = (this.currentView?.columns || [])\n\t\t\t\t.find(column => column.id === this.sortingMode)\n\n\t\t\t// Custom column must provide their own sorting methods\n\t\t\tif (customColumn?.sort && typeof customColumn.sort === 'function') {\n\t\t\t\tconst results = [...this.dirContents].sort(customColumn.sort)\n\t\t\t\treturn this.isAscSorting ? results : results.reverse()\n\t\t\t}\n\n\t\t\treturn orderBy(\n\t\t\t\tfilteredDirContent,\n\t\t\t\t...this.sortingParameters,\n\t\t\t)\n\t\t},\n\n\t\tdirContents(): Node[] {\n\t\t\tconst showHidden = this.userConfigStore?.userConfig.show_hidden\n\t\t\treturn (this.currentFolder?._children || [])\n\t\t\t\t.map(this.getNode)\n\t\t\t\t.filter(file => {\n\t\t\t\t\tif (!showHidden) {\n\t\t\t\t\t\treturn file && file?.attributes?.hidden !== true && !file?.basename.startsWith('.')\n\t\t\t\t\t}\n\n\t\t\t\t\treturn !!file\n\t\t\t\t})\n\t\t},\n\n\t\t/**\n\t\t * The current directory is empty.\n\t\t */\n\t\tisEmptyDir(): boolean {\n\t\t\treturn this.dirContents.length === 0\n\t\t},\n\n\t\t/**\n\t\t * We are refreshing the current directory.\n\t\t * But we already have a cached version of it\n\t\t * that is not empty.\n\t\t */\n\t\tisRefreshing(): boolean {\n\t\t\treturn this.currentFolder !== undefined\n\t\t\t\t&& !this.isEmptyDir\n\t\t\t\t&& this.loading\n\t\t},\n\n\t\t/**\n\t\t * Route to the previous directory.\n\t\t */\n\t\ttoPreviousDir(): Route {\n\t\t\tconst dir = this.dir.split('/').slice(0, -1).join('/') || '/'\n\t\t\treturn { ...this.$route, query: { dir } }\n\t\t},\n\n\t\tshareAttributes(): number[] | undefined {\n\t\t\tif (!this.currentFolder?.attributes?.['share-types']) {\n\t\t\t\treturn undefined\n\t\t\t}\n\t\t\treturn Object.values(this.currentFolder?.attributes?.['share-types'] || {}).flat() as number[]\n\t\t},\n\t\tshareButtonLabel() {\n\t\t\tif (!this.shareAttributes) {\n\t\t\t\treturn this.t('files', 'Share')\n\t\t\t}\n\n\t\t\tif (this.shareButtonType === Type.SHARE_TYPE_LINK) {\n\t\t\t\treturn this.t('files', 'Shared by link')\n\t\t\t}\n\t\t\treturn this.t('files', 'Shared')\n\t\t},\n\t\tshareButtonType(): Type | null {\n\t\t\tif (!this.shareAttributes) {\n\t\t\t\treturn null\n\t\t\t}\n\n\t\t\t// If all types are links, show the link icon\n\t\t\tif (this.shareAttributes.some(type => type === Type.SHARE_TYPE_LINK)) {\n\t\t\t\treturn Type.SHARE_TYPE_LINK\n\t\t\t}\n\n\t\t\treturn Type.SHARE_TYPE_USER\n\t\t},\n\n\t\tgridViewButtonLabel() {\n\t\t\treturn this.userConfig.grid_view\n\t\t\t\t? this.t('files', 'Switch to list view')\n\t\t\t\t: this.t('files', 'Switch to grid view')\n\t\t},\n\n\t\t/**\n\t\t * Check if the current folder has create permissions\n\t\t */\n\t\tcanUpload() {\n\t\t\treturn this.currentFolder && (this.currentFolder.permissions & Permission.CREATE) !== 0\n\t\t},\n\t\tisQuotaExceeded() {\n\t\t\treturn this.currentFolder?.attributes?.['quota-available-bytes'] === 0\n\t\t},\n\t\tcantUploadLabel() {\n\t\t\tif (this.isQuotaExceeded) {\n\t\t\t\treturn this.t('files', 'Your have used your space quota and cannot upload files anymore')\n\t\t\t}\n\t\t\treturn this.t('files', 'You don’t have permission to upload or create files here')\n\t\t},\n\n\t\t/**\n\t\t * Check if current folder has share permissions\n\t\t */\n\t\tcanShare() {\n\t\t\treturn isSharingEnabled\n\t\t\t\t&& this.currentFolder && (this.currentFolder.permissions & Permission.SHARE) !== 0\n\t\t},\n\t},\n\n\twatch: {\n\t\tcurrentView(newView, oldView) {\n\t\t\tif (newView?.id === oldView?.id) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tlogger.debug('View changed', { newView, oldView })\n\t\t\tthis.selectionStore.reset()\n\t\t\tthis.resetSearch()\n\t\t\tthis.fetchContent()\n\t\t},\n\n\t\tdir(newDir, oldDir) {\n\t\t\tlogger.debug('Directory changed', { newDir, oldDir })\n\t\t\t// TODO: preserve selection on browsing?\n\t\t\tthis.selectionStore.reset()\n\t\t\tthis.resetSearch()\n\t\t\tthis.fetchContent()\n\n\t\t\t// Scroll to top, force virtual scroller to re-render\n\t\t\tif (this.$refs?.filesListVirtual?.$el) {\n\t\t\t\tthis.$refs.filesListVirtual.$el.scrollTop = 0\n\t\t\t}\n\t\t},\n\n\t\tdirContents(contents) {\n\t\t\tlogger.debug('Directory contents changed', { view: this.currentView, folder: this.currentFolder, contents })\n\t\t\temit('files:list:updated', { view: this.currentView, folder: this.currentFolder, contents })\n\t\t},\n\t},\n\n\tmounted() {\n\t\tthis.fetchContent()\n\t\tsubscribe('files:node:updated', this.onUpdatedNode)\n\t\tsubscribe('nextcloud:unified-search.search', this.onSearch)\n\t\tsubscribe('nextcloud:unified-search.reset', this.onSearch)\n\n\t\t// reload on settings change\n\t\tthis._unsubscribeStore = this.userConfigStore.$subscribe(() => this.fetchContent(), { deep: true })\n\t},\n\n\tunmounted() {\n\t\tunsubscribe('files:node:updated', this.onUpdatedNode)\n\t\tunsubscribe('nextcloud:unified-search.search', this.onSearch)\n\t\tunsubscribe('nextcloud:unified-search.reset', this.onSearch)\n\t\tthis._unsubscribeStore()\n\t},\n\n\tmethods: {\n\t\tasync fetchContent() {\n\t\t\tthis.loading = true\n\t\t\tconst dir = this.dir\n\t\t\tconst currentView = this.currentView\n\n\t\t\tif (!currentView) {\n\t\t\t\tlogger.debug('The current view doesn\\'t exists or is not ready.', { currentView })\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// If we have a cancellable promise ongoing, cancel it\n\t\t\tif (typeof this.promise?.cancel === 'function') {\n\t\t\t\tthis.promise.cancel()\n\t\t\t\tlogger.debug('Cancelled previous ongoing fetch')\n\t\t\t}\n\n\t\t\t// Fetch the current dir contents\n\t\t\tthis.promise = currentView.getContents(dir) as Promise<ContentsWithRoot>\n\t\t\ttry {\n\t\t\t\tconst { folder, contents } = await this.promise\n\t\t\t\tlogger.debug('Fetched contents', { dir, folder, contents })\n\n\t\t\t\t// Update store\n\t\t\t\tthis.filesStore.updateNodes(contents)\n\n\t\t\t\t// Define current directory children\n\t\t\t\t// TODO: make it more official\n\t\t\t\tthis.$set(folder, '_children', contents.map(node => node.fileid))\n\n\t\t\t\t// If we're in the root dir, define the root\n\t\t\t\tif (dir === '/') {\n\t\t\t\t\tthis.filesStore.setRoot({ service: currentView.id, root: folder })\n\t\t\t\t} else {\n\t\t\t\t\t// Otherwise, add the folder to the store\n\t\t\t\t\tif (folder.fileid) {\n\t\t\t\t\t\tthis.filesStore.updateNodes([folder])\n\t\t\t\t\t\tthis.pathsStore.addPath({ service: currentView.id, fileid: folder.fileid, path: dir })\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// If we're here, the view API messed up\n\t\t\t\t\t\tlogger.error('Invalid root folder returned', { dir, folder, currentView })\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Update paths store\n\t\t\t\tconst folders = contents.filter(node => node.type === 'folder')\n\t\t\t\tfolders.forEach(node => {\n\t\t\t\t\tthis.pathsStore.addPath({ service: currentView.id, fileid: node.fileid, path: join(dir, node.basename) })\n\t\t\t\t})\n\t\t\t} catch (error) {\n\t\t\t\tlogger.error('Error while fetching content', { error })\n\t\t\t} finally {\n\t\t\t\tthis.loading = false\n\t\t\t}\n\n\t\t},\n\n\t\t/**\n\t\t * Get a cached note from the store\n\t\t *\n\t\t * @param {number} fileId the file id to get\n\t\t * @return {Folder|File}\n\t\t */\n\t\tgetNode(fileId) {\n\t\t\treturn this.filesStore.getNode(fileId)\n\t\t},\n\n\t\t/**\n\t\t * The upload manager have finished handling the queue\n\t\t * @param {Upload} upload the uploaded data\n\t\t */\n\t\tonUpload(upload: Upload) {\n\t\t\t// Let's only refresh the current Folder\n\t\t\t// Navigating to a different folder will refresh it anyway\n\t\t\tconst destinationSource = dirname(upload.source)\n\t\t\tconst needsRefresh = destinationSource === this.currentFolder?.source\n\n\t\t\t// TODO: fetch uploaded files data only\n\t\t\t// Use parseInt(upload.response?.headers?.['oc-fileid']) to get the fileid\n\t\t\tif (needsRefresh) {\n\t\t\t\t// fetchContent will cancel the previous ongoing promise\n\t\t\t\tthis.fetchContent()\n\t\t\t}\n\t\t},\n\n\t\tasync onUploadFail(upload: Upload) {\n\t\t\tconst status = upload.response?.status || 0\n\n\t\t\t// Check known status codes\n\t\t\tif (status === 507) {\n\t\t\t\tshowError(this.t('files', 'Not enough free space'))\n\t\t\t\treturn\n\t\t\t} else if (status === 404 || status === 409) {\n\t\t\t\tshowError(this.t('files', 'Target folder does not exist any more'))\n\t\t\t\treturn\n\t\t\t} else if (status === 403) {\n\t\t\t\tshowError(this.t('files', 'Operation is blocked by access control'))\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t// Else we try to parse the response error message\n\t\t\ttry {\n\t\t\t\tconst parser = new Parser({ trim: true, explicitRoot: false })\n\t\t\t\tconst response = await parser.parseStringPromise(upload.response?.data)\n\t\t\t\tconst message = response['s:message'][0] as string\n\t\t\t\tif (typeof message === 'string' && message.trim() !== '') {\n\t\t\t\t\t// The server message is also translated\n\t\t\t\t\tshowError(this.t('files', 'Error during upload: {message}', { message }))\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tlogger.error('Error while parsing', { error })\n\t\t\t}\n\n\t\t\t// Finally, check the status code if we have one\n\t\t\tif (status !== 0) {\n\t\t\t\tshowError(this.t('files', 'Error during upload, status code {status}', { status }))\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tshowError(this.t('files', 'Unknown error during upload'))\n\t\t},\n\n\t\t/**\n\t\t * Refreshes the current folder on update.\n\t\t *\n\t\t * @param node is the file/folder being updated.\n\t\t */\n\t\tonUpdatedNode(node?: Node) {\n\t\t\tif (node?.fileid === this.currentFolder?.fileid) {\n\t\t\t\tthis.fetchContent()\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Handle search event from unified search.\n\t\t *\n\t\t * @param searchEvent is event object.\n\t\t */\n\t\tonSearch: debounce(function(searchEvent) {\n\t\t\tconsole.debug('Files app handling search event from unified search...', searchEvent)\n\t\t\tthis.filterText = searchEvent.query\n\t\t}, 500),\n\n\t\t/**\n\t\t * Reset the search query\n\t\t */\n\t\tresetSearch() {\n\t\t\tthis.filterText = ''\n\t\t},\n\n\t\topenSharingSidebar() {\n\t\t\tif (!this.currentFolder) {\n\t\t\t\tlogger.debug('No current folder found for opening sharing sidebar')\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (window?.OCA?.Files?.Sidebar?.setActiveTab) {\n\t\t\t\twindow.OCA.Files.Sidebar.setActiveTab('sharing')\n\t\t\t}\n\t\t\tsidebarAction.exec(this.currentFolder, this.currentView, this.currentFolder.path)\n\t\t},\n\t\ttoggleGridView() {\n\t\t\tthis.userConfigStore.update('grid_view', !this.userConfig.grid_view)\n\t\t},\n\n\t\tt: translate,\n\t\tn: translatePlural,\n\t},\n})\n</script>\n\n<style scoped lang=\"scss\">\n.app-content {\n\t// Virtual list needs to be full height and is scrollable\n\tdisplay: flex;\n\toverflow: hidden;\n\tflex-direction: column;\n\tmax-height: 100%;\n\tposition: relative !important;\n}\n\n.files-list {\n\t&__header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\t// Do not grow or shrink (vertically)\n\t\tflex: 0 0;\n\t\tmax-width: 100%;\n\t\t// Align with the navigation toggle icon\n\t\tmargin-block: var(--app-navigation-padding, 4px);\n\t\tmargin-inline: calc(var(--default-clickable-area, 44px) + 2 * var(--app-navigation-padding, 4px)) var(--app-navigation-padding, 4px);\n\n\t\t>* {\n\t\t\t// Do not grow or shrink (horizontally)\n\t\t\t// Only the breadcrumbs shrinks\n\t\t\tflex: 0 0;\n\t\t}\n\n\t\t&-share-button {\n\t\t\tcolor: var(--color-text-maxcontrast) !important;\n\n\t\t\t&--shared {\n\t\t\t\tcolor: var(--color-main-text) !important;\n\t\t\t}\n\t\t}\n\t}\n\n\t&__refresh-icon {\n\t\tflex: 0 0 44px;\n\t\twidth: 44px;\n\t\theight: 44px;\n\t}\n\n\t&__loading-icon {\n\t\tmargin: auto;\n\t}\n}\n</style>\n","<template>\n\t<NcContent app-name=\"files\">\n\t\t<Navigation />\n\t\t<FilesList />\n\t</NcContent>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from 'vue'\n\nimport NcContent from '@nextcloud/vue/dist/Components/NcContent.js'\n\nimport Navigation from './views/Navigation.vue'\nimport FilesList from './views/FilesList.vue'\n\nexport default defineComponent({\n\tname: 'FilesApp',\n\n\tcomponents: {\n\t\tNcContent,\n\t\tFilesList,\n\t\tNavigation,\n\t},\n})\n</script>\n","import { PiniaVuePlugin } from 'pinia'\nimport { getNavigation } from '@nextcloud/files'\nimport Vue from 'vue'\n\nimport { pinia } from './store/index.ts'\nimport router from './router/router'\nimport RouterService from './services/RouterService'\nimport SettingsModel from './models/Setting.js'\nimport SettingsService from './services/Settings.js'\nimport FilesApp from './FilesApp.vue'\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\ndeclare global {\n\tinterface Window {\n\t\tOC: any;\n\t\tOCA: any;\n\t\tOCP: any;\n\t}\n}\n/* eslint-enable @typescript-eslint/no-explicit-any */\n\n// Init private and public Files namespace\nwindow.OCA.Files = window.OCA.Files ?? {}\nwindow.OCP.Files = window.OCP.Files ?? {}\n\n// Expose router\nconst Router = new RouterService(router)\nObject.assign(window.OCP.Files, { Router })\n\n// Init Pinia store\nVue.use(PiniaVuePlugin)\n\n// Init Navigation Service\n// This only works with Vue 2 - with Vue 3 this will not modify the source but return just a oberserver\nconst Navigation = Vue.observable(getNavigation())\nVue.prototype.$navigation = Navigation\n\n// Init Files App Settings Service\nconst Settings = new SettingsService()\nObject.assign(window.OCA.Files, { Settings })\nObject.assign(window.OCA.Files.Settings, { Setting: SettingsModel })\n\nconst FilesAppVue = Vue.extend(FilesApp)\nnew FilesAppVue({\n\trouter,\n\tpinia,\n}).$mount('#content')\n"],"names":["Vue","Router","originalPush","to","onComplete","onAbort","err","router","generateUrl","query","result","queryString","RouterService","__publicField","path","replace","name","params","Setting$1","el","open","close","Settings$1","view","e","viewConfig","loadState","useViewConfigStore","args","viewConfigStore","defineStore","state","key","value","axios","emit","newDirection","subscribe","throttle","delay","callback","options","_ref","_ref$noTrailing","noTrailing","_ref$noLeading","noLeading","_ref$debounceMode","debounceMode","timeoutID","cancelled","lastExec","clearExistingTimeout","cancel","_ref2","_ref2$upcomingOnly","upcomingOnly","wrapper","_len","arguments_","_key","self","elapsed","exec","clear","debounce","_ref$atBegin","atBegin","_sfc_main","ChartPie","NcAppNavigationItem","NcProgressBar","usedQuotaByte","formatFileSize","_a","quotaByte","_b","_c","event","response","error","logger","showError","translate","Clipboard","NcAppSettingsDialog","NcAppSettingsSection","NcCheckboxRadioSwitch","NcInputField","Setting","useUserConfigStore","generateRemoteUrl","getCurrentUser","setting","showSuccess","_sfc_main$l","Cog","NavigationQuota","NcAppNavigation","NcIconSvgWrapper","SettingsModal","a","b","list","oldView","_d","isExpanded","dir","compareNumbers","numberA","numberB","compareUnicode","stringA","stringB","RE_NUMBERS","RE_LEADING_OR_TRAILING_WHITESPACES","RE_WHITESPACES","RE_INT_OR_FLOAT","RE_DATE","RE_LEADING_ZERO","RE_UNICODE_CHARACTERS","stringCompare","compareChunks","chunksA","chunksB","lengthA","lengthB","size","i","chunkA","chunkB","compareOtherTypes","valueA","valueB","compareValues","normalizeAlphaChunk","chunk","parseNumber","parsedNumber","normalizeNumericChunk","index","chunks","createChunkMap","createChunks","createChunkMaps","chunksMaps","isFunction","isNaN","isNull","isObject","isSymbol","isUndefined","parseDate","parsedDate","numberify","stringify","getMappedValueRecord","stringValue","compareMultiple","recordA","recordB","orders","indexA","valuesA","indexB","valuesB","length","ordersLength","order","_result","createIdentifierFn","identifier","getElementByIndex","collection","getValueByIdentifier","getValue","baseOrderBy","identifiers","identifierFns","mappedCollection","element","values","getIdentifiers","identifierList","getOrders","orderList","orderBy","validatedIdentifiers","validatedOrders","defaults","this","assign","isArray","isEmpty","isPlainObject","slice","hasProp","len","source","sources","target","val","ref","ctor","proto","obj","Utility","XMLDOMImplementationModule","XMLDOMImplementation","feature","version","qualifiedName","publicId","systemId","namespaceURI","doctype","title","XMLDOMErrorHandlerModule","XMLDOMErrorHandler","XMLDOMStringListModule","XMLDOMStringList","arr","str","require$$0","require$$1","XMLDOMConfigurationModule","XMLDOMConfiguration","NodeTypeModule","NodeType","XMLAttributeModule","XMLAttribute","parent","node","XMLNamedNodeMapModule","XMLNamedNodeMap","nodes","oldNode","localName","XMLNode","extend","child","require$$2","require$$3","require$$4","XMLElementModule","superClass","XMLElement","attributes","j","ref1","att","attName","clonedSelf","clonedChild","attValue","newAttr","oldAttr","isId","idAttr","tagname","classNames","XMLCharacterDataModule","XMLCharacterData","offset","count","arg","XMLCDataModule","XMLCData","text","XMLCommentModule","XMLComment","XMLDeclarationModule","XMLDeclaration","encoding","standalone","XMLDTDAttListModule","XMLDTDAttList","elementName","attributeName","attributeType","defaultValueType","defaultValue","XMLDTDEntityModule","XMLDTDEntity","pe","XMLDTDElementModule","XMLDTDElement","XMLDTDNotationModule","XMLDTDNotation","require$$5","require$$6","require$$7","XMLDocTypeModule","XMLDocType","pubID","sysID","ref2","XMLRawModule","XMLRaw","XMLTextModule","XMLText","next","prev","content","XMLProcessingInstructionModule","XMLProcessingInstruction","XMLDummyModule","XMLDummy","XMLNodeListModule","XMLNodeList","DocumentPositionModule","DocumentPosition","XMLNodeModule","parent1","require$$8","require$$9","require$$10","require$$11","require$$12","require$$13","results","childNode","item","k","lastChild","len1","ref3","newChild","refChild","removed","insTarget","insValue","instruction","doc","xmldec","clonedRoot","oldChild","deep","other","res","prefix","data","handler","isDescendantChild","nodePos","thisPos","found","pos","func","bind","fn","me","XMLStringifierModule","XMLStringifier","regex","ampregex","WriterStateModule","WriterState","require$$14","require$$15","XMLWriterBaseModule","XMLWriterBase","filteredOptions","ref4","ref5","ref6","level","indentLevel","r","childNodeCount","firstChildNode","prettySuppressed","XMLStringWriterModule","XMLStringWriter","XMLDocumentModule","XMLDocument","writer","writerOptions","tagName","importedNode","elementId","eventInterface","root","whatToShow","filter","require$$16","require$$17","require$$18","XMLDocumentCBModule","XMLDocumentCB","onData","onEnd","oldValidationFlag","XMLStreamWriterModule","XMLStreamWriter","stream","lib","builder","escapeCDATA","requiresCDATA","wrapCDATA","entry","builder_1","Builder","opts","rootObj","attrkey","charkey","render","rootElement","rootName","_this","attr","R","ReflectApply","receiver","ReflectOwnKeys","ProcessEmitWarning","warning","NumberIsNaN","EventEmitter","eventsModule","once","defaultMaxListeners","checkListener","listener","n","_getMaxListeners","that","type","doError","events","er","listeners","arrayClone","_addListener","prepend","m","existing","w","onceWrapper","_onceWrap","wrapped","position","originalListener","spliceOne","keys","_listeners","unwrap","evlistener","unwrapListeners","emitter","listenerCount","copy","ret","resolve","reject","errorListener","resolver","eventTargetAgnosticAddListener","addErrorHandlerIfEventEmitter","flags","wrapListener","streamBrowser","ownKeys","object","enumerableOnly","symbols","sym","_objectSpread","_defineProperty","_toPropertyKey","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","_toPrimitive","input","hint","prim","_require","Buffer","_require2","inspect","custom","copyBuffer","src","buffer_list","BufferList","v","s","p","hasStrings","c","nb","buf","_","destroy","cb","readableDestroyed","writableDestroyed","process","emitErrorNT","emitCloseNT","emitErrorAndCloseNT","undestroy","errorOrDestroy","rState","wState","destroy_1","_inheritsLoose","subClass","codes","createErrorType","code","message","Base","getMessage","arg1","arg2","arg3","NodeError","_Base","oneOf","expected","thing","startsWith","search","endsWith","this_len","includes","start","actual","determiner","msg","errorsBrowser","ERR_INVALID_OPT_VALUE","highWaterMarkFrom","isDuplex","duplexKey","getHighWaterMark","hwm","browser","deprecate","config","warned","deprecated","global","_stream_writable","Writable","CorkedRequest","onCorkedFinish","Duplex","WritableState","internalUtil","Stream","OurUint8Array","_uint8ArrayToBuffer","_isUint8Array","destroyImpl","_require$codes","ERR_INVALID_ARG_TYPE","ERR_METHOD_NOT_IMPLEMENTED","ERR_MULTIPLE_CALLBACK","ERR_STREAM_CANNOT_PIPE","ERR_STREAM_DESTROYED","ERR_STREAM_NULL_VALUES","ERR_STREAM_WRITE_AFTER_END","ERR_UNKNOWN_ENCODING","nop","noDecode","onwrite","current","out","realHasInstance","writeAfterEnd","validChunk","isBuf","writeOrBuffer","clearBuffer","decodeChunk","newChunk","last","doWrite","writev","onwriteError","sync","finishMaybe","onwriteStateUpdate","finished","needFinish","afterWrite","onwriteDrain","l","buffer","holder","allBuffers","endWritable","callFinal","prefinish","need","corkReq","objectKeys","_stream_duplex","Readable","method","onend","onEndNT","copyProps","dst","module","exports","SafeBuffer","encodingOrOffset","fill","isEncoding","_normalizeEncoding","enc","retried","normalizeEncoding","nenc","string_decoder","StringDecoder","utf16Text","utf16End","utf8FillLast","base64Text","base64End","simpleWrite","simpleEnd","utf8End","utf8Text","utf8CheckByte","byte","utf8CheckIncomplete","utf8CheckExtraBytes","total","end","ERR_STREAM_PREMATURE_CLOSE","called","noop","isRequest","eos","readable","writable","onlegacyfinish","onfinish","writableEnded","readableEnded","onerror","onclose","onrequest","endOfStream","_Object$setPrototypeO","kLastResolve","kLastReject","kError","kEnded","kLastPromise","kHandlePromise","kStream","createIterResult","done","readAndResolve","iter","onReadable","wrapForNext","lastPromise","AsyncIteratorPrototype","ReadableStreamAsyncIteratorPrototype","promise","_this2","createReadableStreamAsyncIterator","_Object$create","iterator","async_iterator","fromBrowser","_stream_readable","ReadableState","EElistenerCount","debugUtil","debug","ERR_STREAM_PUSH_AFTER_EOF","ERR_STREAM_UNSHIFT_AFTER_END_EVENT","from","kProxyEvents","prependListener","skipChunkCheck","readableAddChunk","addToFront","onEofChunk","chunkInvalid","addChunk","maybeReadMore","emitReadable","decoder","MAX_HWM","computeNewHighWaterMark","howMuchToRead","nOrig","endReadable","doRead","fromList","emitReadable_","flow","maybeReadMore_","dest","pipeOpts","doEnd","endFn","unpipe","onunpipe","unpipeInfo","cleanup","ondrain","pipeOnDrain","cleanedUp","ondata","indexOf","dests","ev","nReadingNextTick","updateReadableListening","resume","resume_","paused","endReadableNT","iterable","xs","x","_stream_transform","Transform","ERR_TRANSFORM_ALREADY_TRANSFORMING","ERR_TRANSFORM_WITH_LENGTH_0","afterTransform","ts","rs","err2","_stream_passthrough","PassThrough","ERR_MISSING_ARGS","destroyer","reading","writing","closed","destroyed","call","pipe","popCallback","streams","pipeline","destroys","pipeline_1","streamBrowserify","EE","inherits","didOnEnd","sax","strict","opt","SAXParser","SAXStream","createStream","buffers","parser","clearBuffers","S","rootNS","o","F","newf","checkBufferLength","maxAllowed","maxActual","closeText","emitNode","flushBuffers","write","streamWraps","h","SD","CDATA","DOCTYPE","XML_NAMESPACE","XMLNS_NAMESPACE","nameStart","nameBody","entityStart","entityBody","isWhitespace","isQuote","isAttribEnd","isMatch","notMatch","nodeType","textopts","strictFail","newTag","tag","qname","attribute","qualName","local","attrib","qn","openTag","selfClosing","nv","uri","closeTag","t","closeTo","parseEntity","entity","entityLC","num","numStr","beginWhiteSpace","charAt","starti","pad","returnState","parsedEntity","stringFromCharCode","floor","fromCodePoint","MAX_SIZE","codeUnits","highSurrogate","lowSurrogate","codePoint","bom","prefixMatch","processors","undefined","nextHandle","tasksByHandle","currentlyRunningATask","registerImmediate","setImmediate","task","clearImmediate","handle","run","runIfPresent","installNextTickImplementation","canUsePostMessage","postMessageIsAsynchronous","oldOnMessage","installPostMessageImplementation","messagePrefix","onGlobalMessage","installMessageChannelImplementation","channel","installReadyStateChangeImplementation","html","script","installSetTimeoutImplementation","attachTo","scope","apply","main","Timeout","timeout","id","clearFn","msecs","defineProperty","processItem","Parser","error1","newValue","ontext","stack","processedKey","cdata","emptyStr","nodeName","objClone","old","xpath","charChild","ValidationError","useFilesStore","fileStore","ids","service","files","acc","usePathsStore","pathsStore","payload","getNavigation","FileType","parentId","parentFolder","useSelectionStore","selection","lastSelectedIndex","uploader","useUploaderStore","getUploader","Directory","contents","directory","file","traverseTree","entries","readDirectory","dirReader","getEntries","createDirectoryIfNotExists","absolutePath","davClient","davGetClient","stat","davGetDefaultPropfind","davResultToNode","resolveConflict","destination","conflicts","uploads","selected","renamed","openConflictPicker","showInfo","dataTransferToFileTree","items","fileTree","showWarning","onDropExternalFiles","hasConflict","queue","uploadDirectoryContents","relativePath","join","joinPaths","davRootPath","errors","onDropInternalFiles","isCopy","NodeStatus","handleCopyMoveNodeTo","MoveCopyAction","useDragAndDropStore","filesListWidthMixin","fileListEl","_sfc_main$k","defineComponent","NcBreadcrumbs","NcBreadcrumb","draggingStore","filesStore","selectionStore","uploaderStore","cumulativePath","fileid","HomeSvg","fileId","basename","folder","canDrop","Permission","section","useActionsMenuStore","useRenamingStore","renamingStore","_sfc_main$j","FileMultipleIcon","FolderIcon","totalSize","getSummaryFor","preview","Preview","DragAndDropPreview","getDragAndDropPreview","vOnClickOutside","FileEntryMixin","Folder","NcFile","Node","hashCode","extname","ext","canDrag","opened","contentRect","isMoreThanOneSelected","sidebarAction","currentTarget","image","_sfc_main$i","actions","getFileActions","_sfc_main$h","ArrowLeftIcon","CustomElementRender","NcActionButton","NcActions","NcActionSeparator","NcLoadingIcon","action","DefaultType","topActionsIds","isSubmenu","displayName","success","menuAction","useKeyboardStore","keyboardStore","_sfc_main$g","newSelectedIndex","isAlreadySelected","lastSelection","filesToSelect","forbiddenCharacters","_sfc_main$f","NcTextField","newName","enabledDefaultActions","renaming","trimmedName","char","extLength","oldName","oldEncodedSource","isAxiosError","_e","_sfc_main$d","StarSvg","_sfc_main$c","AccountGroupIcon","AccountPlusIcon","CollectivesIcon","FavoriteIcon","FileIcon","FolderOpenIcon","KeyIcon","LinkIcon","NetworkIcon","TagIcon","previewUrl","url","isLivePhoto","PlayCircleIcon","shareTypes","_f","ShareType","_h","_g","_sfc_main$b","FileEntryActions","FileEntryCheckbox","FileEntryName","FileEntryPreview","NcDateTime","actionsMenuStore","ratio","mtime","moment","_sfc_main$a","_sfc_main$9","enabled","_sfc_main$8","column","filesSortingMixin","mapState","_sfc_main$7","MenuDown","MenuUp","NcButton","_sfc_main$6","FilesListTableHeaderButton","label","mode","_sfc_main$5","oldItemsKeys","unusedKeys","isOverScrolled","lastIndex","hiddenAfterItems","columnCount","oldColumnCount","before","thead","targetRow","scrollTop","topScroll","_sfc_main$4","selectionIds","failedIds","_sfc_main$3","FilesListHeader","FilesListTableFooter","FilesListTableHeader","VirtualList","FilesListTableHeaderActions","View","userConfigStore","FileEntry","FileEntryGrid","getFileListHeaders","defaultCaption","viewCaption","sortableCaption","virtualListNote","warn","tableTop","tableBottom","_sfc_main$2","TrayArrowDownIcon","mainContent","lastUpload","upload","UploadStatus","isSharingEnabled","getCapabilities","_sfc_main$1","BreadCrumbs","DragAndDropNotice","FilesListVirtual","ListViewIcon","NcAppContent","NcEmptyContent","PlusIcon","UploadPicker","ViewGridIcon","enableGridView","Type","filteredDirContent","customColumn","showHidden","newView","newDir","oldDir","unsubscribe","currentView","dirname","status","searchEvent","translatePlural","NcContent","FilesList","Navigation","PiniaVuePlugin","Settings","SettingsService","SettingsModel","FilesAppVue","FilesApp","pinia"],"mappings":"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","x_google_ignoreList":[5,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71]}